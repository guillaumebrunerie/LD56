const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-C9m4gVXq.js","assets/webworkerAll-CwMkkGlD.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Jc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var PE={exports:{}},zp={},RE={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eh=Symbol.for("react.element"),PU=Symbol.for("react.portal"),RU=Symbol.for("react.fragment"),BU=Symbol.for("react.strict_mode"),MU=Symbol.for("react.profiler"),DU=Symbol.for("react.provider"),OU=Symbol.for("react.context"),kU=Symbol.for("react.forward_ref"),FU=Symbol.for("react.suspense"),IU=Symbol.for("react.memo"),UU=Symbol.for("react.lazy"),ew=Symbol.iterator;function LU(t){return t===null||typeof t!="object"?null:(t=ew&&t[ew]||t["@@iterator"],typeof t=="function"?t:null)}var BE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ME=Object.assign,DE={};function Iu(t,e,n){this.props=t,this.context=e,this.refs=DE,this.updater=n||BE}Iu.prototype.isReactComponent={};Iu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Iu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function OE(){}OE.prototype=Iu.prototype;function sx(t,e,n){this.props=t,this.context=e,this.refs=DE,this.updater=n||BE}var ox=sx.prototype=new OE;ox.constructor=sx;ME(ox,Iu.prototype);ox.isPureReactComponent=!0;var tw=Array.isArray,kE=Object.prototype.hasOwnProperty,ax={current:null},FE={key:!0,ref:!0,__self:!0,__source:!0};function IE(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)kE.call(e,r)&&!FE.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),h=0;h<a;h++)c[h]=arguments[h+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:eh,type:t,key:s,ref:o,props:i,_owner:ax.current}}function NU(t,e){return{$$typeof:eh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ux(t){return typeof t=="object"&&t!==null&&t.$$typeof===eh}function GU(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var nw=/\/+/g;function v0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?GU(""+t.key):e.toString(36)}function fd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case eh:case PU:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+v0(o,0):r,tw(i)?(n="",t!=null&&(n=t.replace(nw,"$&/")+"/"),fd(i,e,n,"",function(h){return h})):i!=null&&(ux(i)&&(i=NU(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(nw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",tw(t))for(var a=0;a<t.length;a++){s=t[a];var c=r+v0(s,a);o+=fd(s,e,n,c,i)}else if(c=LU(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=r+v0(s,a++),o+=fd(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function _f(t,e,n){if(t==null)return t;var r=[],i=0;return fd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function zU(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var _n={current:null},dd={transition:null},HU={ReactCurrentDispatcher:_n,ReactCurrentBatchConfig:dd,ReactCurrentOwner:ax};function UE(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:_f,forEach:function(t,e,n){_f(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _f(t,function(){e++}),e},toArray:function(t){return _f(t,function(e){return e})||[]},only:function(t){if(!ux(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Te.Component=Iu;Te.Fragment=RU;Te.Profiler=MU;Te.PureComponent=sx;Te.StrictMode=BU;Te.Suspense=FU;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HU;Te.act=UE;Te.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ME({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ax.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)kE.call(e,c)&&!FE.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var h=0;h<c;h++)a[h]=arguments[h+2];r.children=a}return{$$typeof:eh,type:t.type,key:i,ref:s,props:r,_owner:o}};Te.createContext=function(t){return t={$$typeof:OU,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:DU,_context:t},t.Consumer=t};Te.createElement=IE;Te.createFactory=function(t){var e=IE.bind(null,t);return e.type=t,e};Te.createRef=function(){return{current:null}};Te.forwardRef=function(t){return{$$typeof:kU,render:t}};Te.isValidElement=ux;Te.lazy=function(t){return{$$typeof:UU,_payload:{_status:-1,_result:t},_init:zU}};Te.memo=function(t,e){return{$$typeof:IU,type:t,compare:e===void 0?null:e}};Te.startTransition=function(t){var e=dd.transition;dd.transition={};try{t()}finally{dd.transition=e}};Te.unstable_act=UE;Te.useCallback=function(t,e){return _n.current.useCallback(t,e)};Te.useContext=function(t){return _n.current.useContext(t)};Te.useDebugValue=function(){};Te.useDeferredValue=function(t){return _n.current.useDeferredValue(t)};Te.useEffect=function(t,e){return _n.current.useEffect(t,e)};Te.useId=function(){return _n.current.useId()};Te.useImperativeHandle=function(t,e,n){return _n.current.useImperativeHandle(t,e,n)};Te.useInsertionEffect=function(t,e){return _n.current.useInsertionEffect(t,e)};Te.useLayoutEffect=function(t,e){return _n.current.useLayoutEffect(t,e)};Te.useMemo=function(t,e){return _n.current.useMemo(t,e)};Te.useReducer=function(t,e,n){return _n.current.useReducer(t,e,n)};Te.useRef=function(t){return _n.current.useRef(t)};Te.useState=function(t){return _n.current.useState(t)};Te.useSyncExternalStore=function(t,e,n){return _n.current.useSyncExternalStore(t,e,n)};Te.useTransition=function(){return _n.current.useTransition()};Te.version="18.3.1";RE.exports=Te;var Le=RE.exports;const rw=Jc(Le);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VU=Le,jU=Symbol.for("react.element"),WU=Symbol.for("react.fragment"),$U=Object.prototype.hasOwnProperty,XU=VU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YU={key:!0,ref:!0,__self:!0,__source:!0};function LE(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)$U.call(e,r)&&!YU.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:jU,type:t,key:s,ref:o,props:i,_owner:XU.current}}zp.Fragment=WU;zp.jsx=LE;zp.jsxs=LE;PE.exports=zp;var D=PE.exports,NE={exports:{}},Qn={},GE={exports:{}},zE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,z){var W=V.length;V.push(z);e:for(;0<W;){var je=W-1>>>1,ce=V[je];if(0<i(ce,z))V[je]=z,V[W]=ce,W=je;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var z=V[0],W=V.pop();if(W!==z){V[0]=W;e:for(var je=0,ce=V.length,Zt=ce>>>1;je<Zt;){var Jt=2*(je+1)-1,Nn=V[Jt],en=Jt+1,Xr=V[en];if(0>i(Nn,W))en<ce&&0>i(Xr,Nn)?(V[je]=Xr,V[en]=W,je=en):(V[je]=Nn,V[Jt]=W,je=Jt);else if(en<ce&&0>i(Xr,W))V[je]=Xr,V[en]=W,je=en;else break e}}return z}function i(V,z){var W=V.sortIndex-z.sortIndex;return W!==0?W:V.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],h=[],f=1,p=null,v=3,_=!1,y=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(V){for(var z=n(h);z!==null;){if(z.callback===null)r(h);else if(z.startTime<=V)r(h),z.sortIndex=z.expirationTime,e(c,z);else break;z=n(h)}}function A(V){if(S=!1,T(V),!y)if(n(c)!==null)y=!0,oe(M);else{var z=n(h);z!==null&&Y(A,z.startTime-V)}}function M(V,z){y=!1,S&&(S=!1,b(N),N=-1),_=!0;var W=v;try{for(T(z),p=n(c);p!==null&&(!(p.expirationTime>z)||V&&!ie());){var je=p.callback;if(typeof je=="function"){p.callback=null,v=p.priorityLevel;var ce=je(p.expirationTime<=z);z=t.unstable_now(),typeof ce=="function"?p.callback=ce:p===n(c)&&r(c),T(z)}else r(c);p=n(c)}if(p!==null)var Zt=!0;else{var Jt=n(h);Jt!==null&&Y(A,Jt.startTime-z),Zt=!1}return Zt}finally{p=null,v=W,_=!1}}var L=!1,I=null,N=-1,k=5,G=-1;function ie(){return!(t.unstable_now()-G<k)}function Ze(){if(I!==null){var V=t.unstable_now();G=V;var z=!0;try{z=I(!0,V)}finally{z?re():(L=!1,I=null)}}else L=!1}var re;if(typeof w=="function")re=function(){w(Ze)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ye=J.port2;J.port1.onmessage=Ze,re=function(){ye.postMessage(null)}}else re=function(){C(Ze,0)};function oe(V){I=V,L||(L=!0,re())}function Y(V,z){N=C(function(){V(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){y||_||(y=!0,oe(M))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(V){switch(v){case 1:case 2:case 3:var z=3;break;default:z=v}var W=v;v=z;try{return V()}finally{v=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,z){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var W=v;v=V;try{return z()}finally{v=W}},t.unstable_scheduleCallback=function(V,z,W){var je=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?je+W:je):W=je,V){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=W+ce,V={id:f++,callback:z,priorityLevel:V,startTime:W,expirationTime:ce,sortIndex:-1},W>je?(V.sortIndex=W,e(h,V),n(c)===null&&V===n(h)&&(S?(b(N),N=-1):S=!0,Y(A,W-je))):(V.sortIndex=ce,e(c,V),y||_||(y=!0,oe(M))),V},t.unstable_shouldYield=ie,t.unstable_wrapCallback=function(V){var z=v;return function(){var W=v;v=z;try{return V.apply(this,arguments)}finally{v=W}}}})(zE);GE.exports=zE;var HE=GE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qU=Le,qn=HE;function j(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VE=new Set,lc={};function Zo(t,e){xu(t,e),xu(t+"Capture",e)}function xu(t,e){for(lc[t]=e,t=0;t<e.length;t++)VE.add(e[t])}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uv=Object.prototype.hasOwnProperty,KU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iw={},sw={};function QU(t){return Uv.call(sw,t)?!0:Uv.call(iw,t)?!1:KU.test(t)?sw[t]=!0:(iw[t]=!0,!1)}function ZU(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function JU(t,e,n,r){if(e===null||typeof e>"u"||ZU(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){qt[t]=new xn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];qt[e]=new xn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){qt[t]=new xn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){qt[t]=new xn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){qt[t]=new xn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){qt[t]=new xn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){qt[t]=new xn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){qt[t]=new xn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){qt[t]=new xn(t,5,!1,t.toLowerCase(),null,!1,!1)});var lx=/[\-:]([a-z])/g;function cx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(lx,cx);qt[e]=new xn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(lx,cx);qt[e]=new xn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(lx,cx);qt[e]=new xn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){qt[t]=new xn(t,1,!1,t.toLowerCase(),null,!1,!1)});qt.xlinkHref=new xn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){qt[t]=new xn(t,1,!1,t.toLowerCase(),null,!0,!0)});function hx(t,e,n,r){var i=qt.hasOwnProperty(e)?qt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JU(e,n,i,r)&&(n=null),r||i===null?QU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var as=qU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xf=Symbol.for("react.element"),za=Symbol.for("react.portal"),Ha=Symbol.for("react.fragment"),fx=Symbol.for("react.strict_mode"),Lv=Symbol.for("react.profiler"),jE=Symbol.for("react.provider"),WE=Symbol.for("react.context"),dx=Symbol.for("react.forward_ref"),Nv=Symbol.for("react.suspense"),Gv=Symbol.for("react.suspense_list"),px=Symbol.for("react.memo"),Cs=Symbol.for("react.lazy"),$E=Symbol.for("react.offscreen"),ow=Symbol.iterator;function vl(t){return t===null||typeof t!="object"?null:(t=ow&&t[ow]||t["@@iterator"],typeof t=="function"?t:null)}var pt=Object.assign,_0;function Fl(t){if(_0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_0=e&&e[1]||""}return`
`+_0+t}var x0=!1;function y0(t,e){if(!t||x0)return"";x0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{x0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fl(t):""}function e8(t){switch(t.tag){case 5:return Fl(t.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return t=y0(t.type,!1),t;case 11:return t=y0(t.type.render,!1),t;case 1:return t=y0(t.type,!0),t;default:return""}}function zv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ha:return"Fragment";case za:return"Portal";case Lv:return"Profiler";case fx:return"StrictMode";case Nv:return"Suspense";case Gv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case WE:return(t.displayName||"Context")+".Consumer";case jE:return(t._context.displayName||"Context")+".Provider";case dx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case px:return e=t.displayName||null,e!==null?e:zv(t.type)||"Memo";case Cs:e=t._payload,t=t._init;try{return zv(t(e))}catch{}}return null}function t8(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zv(e);case 8:return e===fx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function XE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function n8(t){var e=XE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yf(t){t._valueTracker||(t._valueTracker=n8(t))}function YE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=XE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hv(t,e){var n=e.checked;return pt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function aw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qE(t,e){e=e.checked,e!=null&&hx(t,"checked",e,!1)}function Vv(t,e){qE(t,e);var n=Vs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?jv(t,e.type,n):e.hasOwnProperty("defaultValue")&&jv(t,e.type,Vs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function uw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function jv(t,e,n){(e!=="number"||Vd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Il=Array.isArray;function iu(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vs(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Wv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return pt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(j(92));if(Il(n)){if(1<n.length)throw Error(j(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vs(n)}}function KE(t,e){var n=Vs(e.value),r=Vs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function cw(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function QE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $v(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?QE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bf,ZE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bf=bf||document.createElement("div"),bf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function cc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var jl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r8=["Webkit","ms","Moz","O"];Object.keys(jl).forEach(function(t){r8.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jl[e]=jl[t]})});function JE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||jl.hasOwnProperty(t)&&jl[t]?(""+e).trim():e+"px"}function eA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=JE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var i8=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xv(t,e){if(e){if(i8[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function Yv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qv=null;function mx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kv=null,su=null,ou=null;function hw(t){if(t=rh(t)){if(typeof Kv!="function")throw Error(j(280));var e=t.stateNode;e&&(e=$p(e),Kv(t.stateNode,t.type,e))}}function tA(t){su?ou?ou.push(t):ou=[t]:su=t}function nA(){if(su){var t=su,e=ou;if(ou=su=null,hw(t),e)for(t=0;t<e.length;t++)hw(e[t])}}function rA(t,e){return t(e)}function iA(){}var b0=!1;function sA(t,e,n){if(b0)return t(e,n);b0=!0;try{return rA(t,e,n)}finally{b0=!1,(su!==null||ou!==null)&&(iA(),nA())}}function hc(t,e){var n=t.stateNode;if(n===null)return null;var r=$p(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(j(231,e,typeof n));return n}var Qv=!1;if(Zi)try{var _l={};Object.defineProperty(_l,"passive",{get:function(){Qv=!0}}),window.addEventListener("test",_l,_l),window.removeEventListener("test",_l,_l)}catch{Qv=!1}function s8(t,e,n,r,i,s,o,a,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(f){this.onError(f)}}var Wl=!1,jd=null,Wd=!1,Zv=null,o8={onError:function(t){Wl=!0,jd=t}};function a8(t,e,n,r,i,s,o,a,c){Wl=!1,jd=null,s8.apply(o8,arguments)}function u8(t,e,n,r,i,s,o,a,c){if(a8.apply(this,arguments),Wl){if(Wl){var h=jd;Wl=!1,jd=null}else throw Error(j(198));Wd||(Wd=!0,Zv=h)}}function Jo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function oA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function fw(t){if(Jo(t)!==t)throw Error(j(188))}function l8(t){var e=t.alternate;if(!e){if(e=Jo(t),e===null)throw Error(j(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return fw(i),t;if(s===r)return fw(i),e;s=s.sibling}throw Error(j(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(j(189))}}if(n.alternate!==r)throw Error(j(190))}if(n.tag!==3)throw Error(j(188));return n.stateNode.current===n?t:e}function aA(t){return t=l8(t),t!==null?uA(t):null}function uA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uA(t);if(e!==null)return e;t=t.sibling}return null}var lA=qn.unstable_scheduleCallback,dw=qn.unstable_cancelCallback,c8=qn.unstable_shouldYield,h8=qn.unstable_requestPaint,yt=qn.unstable_now,f8=qn.unstable_getCurrentPriorityLevel,gx=qn.unstable_ImmediatePriority,cA=qn.unstable_UserBlockingPriority,$d=qn.unstable_NormalPriority,d8=qn.unstable_LowPriority,hA=qn.unstable_IdlePriority,Hp=null,hi=null;function p8(t){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(Hp,t,void 0,(t.current.flags&128)===128)}catch{}}var Ir=Math.clz32?Math.clz32:v8,m8=Math.log,g8=Math.LN2;function v8(t){return t>>>=0,t===0?32:31-(m8(t)/g8|0)|0}var Sf=64,wf=4194304;function Ul(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ul(a):(s&=o,s!==0&&(r=Ul(s)))}else o=n&~i,o!==0?r=Ul(o):s!==0&&(r=Ul(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ir(e),i=1<<n,r|=t[n],e&=~i;return r}function _8(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function x8(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ir(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=_8(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function Jv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fA(){var t=Sf;return Sf<<=1,!(Sf&4194240)&&(Sf=64),t}function S0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function th(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ir(e),t[e]=n}function y8(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ir(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function vx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ir(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var He=0;function dA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pA,_x,mA,gA,vA,e_=!1,Cf=[],Fs=null,Is=null,Us=null,fc=new Map,dc=new Map,As=[],b8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pw(t,e){switch(t){case"focusin":case"focusout":Fs=null;break;case"dragenter":case"dragleave":Is=null;break;case"mouseover":case"mouseout":Us=null;break;case"pointerover":case"pointerout":fc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":dc.delete(e.pointerId)}}function xl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=rh(e),e!==null&&_x(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function S8(t,e,n,r,i){switch(e){case"focusin":return Fs=xl(Fs,t,e,n,r,i),!0;case"dragenter":return Is=xl(Is,t,e,n,r,i),!0;case"mouseover":return Us=xl(Us,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return fc.set(s,xl(fc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,dc.set(s,xl(dc.get(s)||null,t,e,n,r,i)),!0}return!1}function _A(t){var e=Ao(t.target);if(e!==null){var n=Jo(e);if(n!==null){if(e=n.tag,e===13){if(e=oA(n),e!==null){t.blockedOn=e,vA(t.priority,function(){mA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=t_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);qv=r,n.target.dispatchEvent(r),qv=null}else return e=rh(n),e!==null&&_x(e),t.blockedOn=n,!1;e.shift()}return!0}function mw(t,e,n){pd(t)&&n.delete(e)}function w8(){e_=!1,Fs!==null&&pd(Fs)&&(Fs=null),Is!==null&&pd(Is)&&(Is=null),Us!==null&&pd(Us)&&(Us=null),fc.forEach(mw),dc.forEach(mw)}function yl(t,e){t.blockedOn===e&&(t.blockedOn=null,e_||(e_=!0,qn.unstable_scheduleCallback(qn.unstable_NormalPriority,w8)))}function pc(t){function e(i){return yl(i,t)}if(0<Cf.length){yl(Cf[0],t);for(var n=1;n<Cf.length;n++){var r=Cf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Fs!==null&&yl(Fs,t),Is!==null&&yl(Is,t),Us!==null&&yl(Us,t),fc.forEach(e),dc.forEach(e),n=0;n<As.length;n++)r=As[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<As.length&&(n=As[0],n.blockedOn===null);)_A(n),n.blockedOn===null&&As.shift()}var au=as.ReactCurrentBatchConfig,Yd=!0;function C8(t,e,n,r){var i=He,s=au.transition;au.transition=null;try{He=1,xx(t,e,n,r)}finally{He=i,au.transition=s}}function T8(t,e,n,r){var i=He,s=au.transition;au.transition=null;try{He=4,xx(t,e,n,r)}finally{He=i,au.transition=s}}function xx(t,e,n,r){if(Yd){var i=t_(t,e,n,r);if(i===null)D0(t,e,r,qd,n),pw(t,r);else if(S8(i,t,e,n,r))r.stopPropagation();else if(pw(t,r),e&4&&-1<b8.indexOf(t)){for(;i!==null;){var s=rh(i);if(s!==null&&pA(s),s=t_(t,e,n,r),s===null&&D0(t,e,r,qd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else D0(t,e,r,null,n)}}var qd=null;function t_(t,e,n,r){if(qd=null,t=mx(r),t=Ao(t),t!==null)if(e=Jo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=oA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qd=t,null}function xA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(f8()){case gx:return 1;case cA:return 4;case $d:case d8:return 16;case hA:return 536870912;default:return 16}default:return 16}}var Rs=null,yx=null,md=null;function yA(){if(md)return md;var t,e=yx,n=e.length,r,i="value"in Rs?Rs.value:Rs.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return md=i.slice(t,1<r?1-r:void 0)}function gd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tf(){return!0}function gw(){return!1}function Zn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Tf:gw,this.isPropagationStopped=gw,this}return pt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tf)},persist:function(){},isPersistent:Tf}),e}var Uu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bx=Zn(Uu),nh=pt({},Uu,{view:0,detail:0}),E8=Zn(nh),w0,C0,bl,Vp=pt({},nh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==bl&&(bl&&t.type==="mousemove"?(w0=t.screenX-bl.screenX,C0=t.screenY-bl.screenY):C0=w0=0,bl=t),w0)},movementY:function(t){return"movementY"in t?t.movementY:C0}}),vw=Zn(Vp),A8=pt({},Vp,{dataTransfer:0}),P8=Zn(A8),R8=pt({},nh,{relatedTarget:0}),T0=Zn(R8),B8=pt({},Uu,{animationName:0,elapsedTime:0,pseudoElement:0}),M8=Zn(B8),D8=pt({},Uu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),O8=Zn(D8),k8=pt({},Uu,{data:0}),_w=Zn(k8),F8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L8(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=U8[t])?!!e[t]:!1}function Sx(){return L8}var N8=pt({},nh,{key:function(t){if(t.key){var e=F8[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?I8[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sx,charCode:function(t){return t.type==="keypress"?gd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),G8=Zn(N8),z8=pt({},Vp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xw=Zn(z8),H8=pt({},nh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sx}),V8=Zn(H8),j8=pt({},Uu,{propertyName:0,elapsedTime:0,pseudoElement:0}),W8=Zn(j8),$8=pt({},Vp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),X8=Zn($8),Y8=[9,13,27,32],wx=Zi&&"CompositionEvent"in window,$l=null;Zi&&"documentMode"in document&&($l=document.documentMode);var q8=Zi&&"TextEvent"in window&&!$l,bA=Zi&&(!wx||$l&&8<$l&&11>=$l),yw=" ",bw=!1;function SA(t,e){switch(t){case"keyup":return Y8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Va=!1;function K8(t,e){switch(t){case"compositionend":return wA(e);case"keypress":return e.which!==32?null:(bw=!0,yw);case"textInput":return t=e.data,t===yw&&bw?null:t;default:return null}}function Q8(t,e){if(Va)return t==="compositionend"||!wx&&SA(t,e)?(t=yA(),md=yx=Rs=null,Va=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return bA&&e.locale!=="ko"?null:e.data;default:return null}}var Z8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Z8[t.type]:e==="textarea"}function CA(t,e,n,r){tA(r),e=Kd(e,"onChange"),0<e.length&&(n=new bx("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xl=null,mc=null;function J8(t){FA(t,0)}function jp(t){var e=$a(t);if(YE(e))return t}function eL(t,e){if(t==="change")return e}var TA=!1;if(Zi){var E0;if(Zi){var A0="oninput"in document;if(!A0){var ww=document.createElement("div");ww.setAttribute("oninput","return;"),A0=typeof ww.oninput=="function"}E0=A0}else E0=!1;TA=E0&&(!document.documentMode||9<document.documentMode)}function Cw(){Xl&&(Xl.detachEvent("onpropertychange",EA),mc=Xl=null)}function EA(t){if(t.propertyName==="value"&&jp(mc)){var e=[];CA(e,mc,t,mx(t)),sA(J8,e)}}function tL(t,e,n){t==="focusin"?(Cw(),Xl=e,mc=n,Xl.attachEvent("onpropertychange",EA)):t==="focusout"&&Cw()}function nL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jp(mc)}function rL(t,e){if(t==="click")return jp(e)}function iL(t,e){if(t==="input"||t==="change")return jp(e)}function sL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zr=typeof Object.is=="function"?Object.is:sL;function gc(t,e){if(zr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Uv.call(e,i)||!zr(t[i],e[i]))return!1}return!0}function Tw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ew(t,e){var n=Tw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Tw(n)}}function AA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?AA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function PA(){for(var t=window,e=Vd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vd(t.document)}return e}function Cx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function oL(t){var e=PA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&AA(n.ownerDocument.documentElement,n)){if(r!==null&&Cx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Ew(n,s);var o=Ew(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var aL=Zi&&"documentMode"in document&&11>=document.documentMode,ja=null,n_=null,Yl=null,r_=!1;function Aw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;r_||ja==null||ja!==Vd(r)||(r=ja,"selectionStart"in r&&Cx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yl&&gc(Yl,r)||(Yl=r,r=Kd(n_,"onSelect"),0<r.length&&(e=new bx("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ja)))}function Ef(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Wa={animationend:Ef("Animation","AnimationEnd"),animationiteration:Ef("Animation","AnimationIteration"),animationstart:Ef("Animation","AnimationStart"),transitionend:Ef("Transition","TransitionEnd")},P0={},RA={};Zi&&(RA=document.createElement("div").style,"AnimationEvent"in window||(delete Wa.animationend.animation,delete Wa.animationiteration.animation,delete Wa.animationstart.animation),"TransitionEvent"in window||delete Wa.transitionend.transition);function Wp(t){if(P0[t])return P0[t];if(!Wa[t])return t;var e=Wa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in RA)return P0[t]=e[n];return t}var BA=Wp("animationend"),MA=Wp("animationiteration"),DA=Wp("animationstart"),OA=Wp("transitionend"),kA=new Map,Pw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qs(t,e){kA.set(t,e),Zo(e,[t])}for(var R0=0;R0<Pw.length;R0++){var B0=Pw[R0],uL=B0.toLowerCase(),lL=B0[0].toUpperCase()+B0.slice(1);qs(uL,"on"+lL)}qs(BA,"onAnimationEnd");qs(MA,"onAnimationIteration");qs(DA,"onAnimationStart");qs("dblclick","onDoubleClick");qs("focusin","onFocus");qs("focusout","onBlur");qs(OA,"onTransitionEnd");xu("onMouseEnter",["mouseout","mouseover"]);xu("onMouseLeave",["mouseout","mouseover"]);xu("onPointerEnter",["pointerout","pointerover"]);xu("onPointerLeave",["pointerout","pointerover"]);Zo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cL=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ll));function Rw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,u8(r,e,void 0,t),t.currentTarget=null}function FA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,h=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;Rw(i,a,h),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,h=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;Rw(i,a,h),s=c}}}if(Wd)throw t=Zv,Wd=!1,Zv=null,t}function tt(t,e){var n=e[u_];n===void 0&&(n=e[u_]=new Set);var r=t+"__bubble";n.has(r)||(IA(e,t,2,!1),n.add(r))}function M0(t,e,n){var r=0;e&&(r|=4),IA(n,t,r,e)}var Af="_reactListening"+Math.random().toString(36).slice(2);function vc(t){if(!t[Af]){t[Af]=!0,VE.forEach(function(n){n!=="selectionchange"&&(cL.has(n)||M0(n,!1,t),M0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Af]||(e[Af]=!0,M0("selectionchange",!1,e))}}function IA(t,e,n,r){switch(xA(e)){case 1:var i=C8;break;case 4:i=T8;break;default:i=xx}n=i.bind(null,e,n,t),i=void 0,!Qv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function D0(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ao(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}sA(function(){var h=s,f=mx(n),p=[];e:{var v=kA.get(t);if(v!==void 0){var _=bx,y=t;switch(t){case"keypress":if(gd(n)===0)break e;case"keydown":case"keyup":_=G8;break;case"focusin":y="focus",_=T0;break;case"focusout":y="blur",_=T0;break;case"beforeblur":case"afterblur":_=T0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=vw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=P8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=V8;break;case BA:case MA:case DA:_=M8;break;case OA:_=W8;break;case"scroll":_=E8;break;case"wheel":_=X8;break;case"copy":case"cut":case"paste":_=O8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=xw}var S=(e&4)!==0,C=!S&&t==="scroll",b=S?v!==null?v+"Capture":null:v;S=[];for(var w=h,T;w!==null;){T=w;var A=T.stateNode;if(T.tag===5&&A!==null&&(T=A,b!==null&&(A=hc(w,b),A!=null&&S.push(_c(w,A,T)))),C)break;w=w.return}0<S.length&&(v=new _(v,y,null,n,f),p.push({event:v,listeners:S}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",v&&n!==qv&&(y=n.relatedTarget||n.fromElement)&&(Ao(y)||y[Ji]))break e;if((_||v)&&(v=f.window===f?f:(v=f.ownerDocument)?v.defaultView||v.parentWindow:window,_?(y=n.relatedTarget||n.toElement,_=h,y=y?Ao(y):null,y!==null&&(C=Jo(y),y!==C||y.tag!==5&&y.tag!==6)&&(y=null)):(_=null,y=h),_!==y)){if(S=vw,A="onMouseLeave",b="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(S=xw,A="onPointerLeave",b="onPointerEnter",w="pointer"),C=_==null?v:$a(_),T=y==null?v:$a(y),v=new S(A,w+"leave",_,n,f),v.target=C,v.relatedTarget=T,A=null,Ao(f)===h&&(S=new S(b,w+"enter",y,n,f),S.target=T,S.relatedTarget=C,A=S),C=A,_&&y)t:{for(S=_,b=y,w=0,T=S;T;T=Ca(T))w++;for(T=0,A=b;A;A=Ca(A))T++;for(;0<w-T;)S=Ca(S),w--;for(;0<T-w;)b=Ca(b),T--;for(;w--;){if(S===b||b!==null&&S===b.alternate)break t;S=Ca(S),b=Ca(b)}S=null}else S=null;_!==null&&Bw(p,v,_,S,!1),y!==null&&C!==null&&Bw(p,C,y,S,!0)}}e:{if(v=h?$a(h):window,_=v.nodeName&&v.nodeName.toLowerCase(),_==="select"||_==="input"&&v.type==="file")var M=eL;else if(Sw(v))if(TA)M=iL;else{M=nL;var L=tL}else(_=v.nodeName)&&_.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(M=rL);if(M&&(M=M(t,h))){CA(p,M,n,f);break e}L&&L(t,v,h),t==="focusout"&&(L=v._wrapperState)&&L.controlled&&v.type==="number"&&jv(v,"number",v.value)}switch(L=h?$a(h):window,t){case"focusin":(Sw(L)||L.contentEditable==="true")&&(ja=L,n_=h,Yl=null);break;case"focusout":Yl=n_=ja=null;break;case"mousedown":r_=!0;break;case"contextmenu":case"mouseup":case"dragend":r_=!1,Aw(p,n,f);break;case"selectionchange":if(aL)break;case"keydown":case"keyup":Aw(p,n,f)}var I;if(wx)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Va?SA(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(bA&&n.locale!=="ko"&&(Va||N!=="onCompositionStart"?N==="onCompositionEnd"&&Va&&(I=yA()):(Rs=f,yx="value"in Rs?Rs.value:Rs.textContent,Va=!0)),L=Kd(h,N),0<L.length&&(N=new _w(N,t,null,n,f),p.push({event:N,listeners:L}),I?N.data=I:(I=wA(n),I!==null&&(N.data=I)))),(I=q8?K8(t,n):Q8(t,n))&&(h=Kd(h,"onBeforeInput"),0<h.length&&(f=new _w("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:h}),f.data=I))}FA(p,e)})}function _c(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Kd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=hc(t,n),s!=null&&r.unshift(_c(t,s,i)),s=hc(t,e),s!=null&&r.push(_c(t,s,i))),t=t.return}return r}function Ca(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Bw(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,h=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&h!==null&&(a=h,i?(c=hc(n,s),c!=null&&o.unshift(_c(n,c,a))):i||(c=hc(n,s),c!=null&&o.push(_c(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var hL=/\r\n?/g,fL=/\u0000|\uFFFD/g;function Mw(t){return(typeof t=="string"?t:""+t).replace(hL,`
`).replace(fL,"")}function Pf(t,e,n){if(e=Mw(e),Mw(t)!==e&&n)throw Error(j(425))}function Qd(){}var i_=null,s_=null;function o_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var a_=typeof setTimeout=="function"?setTimeout:void 0,dL=typeof clearTimeout=="function"?clearTimeout:void 0,Dw=typeof Promise=="function"?Promise:void 0,pL=typeof queueMicrotask=="function"?queueMicrotask:typeof Dw<"u"?function(t){return Dw.resolve(null).then(t).catch(mL)}:a_;function mL(t){setTimeout(function(){throw t})}function O0(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),pc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);pc(e)}function Ls(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ow(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Lu=Math.random().toString(36).slice(2),ui="__reactFiber$"+Lu,xc="__reactProps$"+Lu,Ji="__reactContainer$"+Lu,u_="__reactEvents$"+Lu,gL="__reactListeners$"+Lu,vL="__reactHandles$"+Lu;function Ao(t){var e=t[ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ji]||n[ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ow(t);t!==null;){if(n=t[ui])return n;t=Ow(t)}return e}t=n,n=t.parentNode}return null}function rh(t){return t=t[ui]||t[Ji],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $a(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(j(33))}function $p(t){return t[xc]||null}var l_=[],Xa=-1;function Ks(t){return{current:t}}function nt(t){0>Xa||(t.current=l_[Xa],l_[Xa]=null,Xa--)}function qe(t,e){Xa++,l_[Xa]=t.current,t.current=e}var js={},hn=Ks(js),Dn=Ks(!1),Uo=js;function yu(t,e){var n=t.type.contextTypes;if(!n)return js;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function On(t){return t=t.childContextTypes,t!=null}function Zd(){nt(Dn),nt(hn)}function kw(t,e,n){if(hn.current!==js)throw Error(j(168));qe(hn,e),qe(Dn,n)}function UA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(j(108,t8(t)||"Unknown",i));return pt({},n,r)}function Jd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||js,Uo=hn.current,qe(hn,t),qe(Dn,Dn.current),!0}function Fw(t,e,n){var r=t.stateNode;if(!r)throw Error(j(169));n?(t=UA(t,e,Uo),r.__reactInternalMemoizedMergedChildContext=t,nt(Dn),nt(hn),qe(hn,t)):nt(Dn),qe(Dn,n)}var zi=null,Xp=!1,k0=!1;function LA(t){zi===null?zi=[t]:zi.push(t)}function _L(t){Xp=!0,LA(t)}function Qs(){if(!k0&&zi!==null){k0=!0;var t=0,e=He;try{var n=zi;for(He=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}zi=null,Xp=!1}catch(i){throw zi!==null&&(zi=zi.slice(t+1)),lA(gx,Qs),i}finally{He=e,k0=!1}}return null}var Ya=[],qa=0,ep=null,tp=0,lr=[],cr=0,Lo=null,Wi=1,$i="";function _o(t,e){Ya[qa++]=tp,Ya[qa++]=ep,ep=t,tp=e}function NA(t,e,n){lr[cr++]=Wi,lr[cr++]=$i,lr[cr++]=Lo,Lo=t;var r=Wi;t=$i;var i=32-Ir(r)-1;r&=~(1<<i),n+=1;var s=32-Ir(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Wi=1<<32-Ir(e)+i|n<<i|r,$i=s+t}else Wi=1<<s|n<<i|r,$i=t}function Tx(t){t.return!==null&&(_o(t,1),NA(t,1,0))}function Ex(t){for(;t===ep;)ep=Ya[--qa],Ya[qa]=null,tp=Ya[--qa],Ya[qa]=null;for(;t===Lo;)Lo=lr[--cr],lr[cr]=null,$i=lr[--cr],lr[cr]=null,Wi=lr[--cr],lr[cr]=null}var Xn=null,$n=null,st=!1,kr=null;function GA(t,e){var n=pr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Iw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xn=t,$n=Ls(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xn=t,$n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Lo!==null?{id:Wi,overflow:$i}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xn=t,$n=null,!0):!1;default:return!1}}function c_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function h_(t){if(st){var e=$n;if(e){var n=e;if(!Iw(t,e)){if(c_(t))throw Error(j(418));e=Ls(n.nextSibling);var r=Xn;e&&Iw(t,e)?GA(r,n):(t.flags=t.flags&-4097|2,st=!1,Xn=t)}}else{if(c_(t))throw Error(j(418));t.flags=t.flags&-4097|2,st=!1,Xn=t}}}function Uw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xn=t}function Rf(t){if(t!==Xn)return!1;if(!st)return Uw(t),st=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!o_(t.type,t.memoizedProps)),e&&(e=$n)){if(c_(t))throw zA(),Error(j(418));for(;e;)GA(t,e),e=Ls(e.nextSibling)}if(Uw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(j(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$n=Ls(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$n=null}}else $n=Xn?Ls(t.stateNode.nextSibling):null;return!0}function zA(){for(var t=$n;t;)t=Ls(t.nextSibling)}function bu(){$n=Xn=null,st=!1}function Ax(t){kr===null?kr=[t]:kr.push(t)}var xL=as.ReactCurrentBatchConfig;function Sl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(j(309));var r=n.stateNode}if(!r)throw Error(j(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(j(284));if(!n._owner)throw Error(j(290,t))}return t}function Bf(t,e){throw t=Object.prototype.toString.call(e),Error(j(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Lw(t){var e=t._init;return e(t._payload)}function HA(t){function e(b,w){if(t){var T=b.deletions;T===null?(b.deletions=[w],b.flags|=16):T.push(w)}}function n(b,w){if(!t)return null;for(;w!==null;)e(b,w),w=w.sibling;return null}function r(b,w){for(b=new Map;w!==null;)w.key!==null?b.set(w.key,w):b.set(w.index,w),w=w.sibling;return b}function i(b,w){return b=Hs(b,w),b.index=0,b.sibling=null,b}function s(b,w,T){return b.index=T,t?(T=b.alternate,T!==null?(T=T.index,T<w?(b.flags|=2,w):T):(b.flags|=2,w)):(b.flags|=1048576,w)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function a(b,w,T,A){return w===null||w.tag!==6?(w=z0(T,b.mode,A),w.return=b,w):(w=i(w,T),w.return=b,w)}function c(b,w,T,A){var M=T.type;return M===Ha?f(b,w,T.props.children,A,T.key):w!==null&&(w.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Cs&&Lw(M)===w.type)?(A=i(w,T.props),A.ref=Sl(b,w,T),A.return=b,A):(A=wd(T.type,T.key,T.props,null,b.mode,A),A.ref=Sl(b,w,T),A.return=b,A)}function h(b,w,T,A){return w===null||w.tag!==4||w.stateNode.containerInfo!==T.containerInfo||w.stateNode.implementation!==T.implementation?(w=H0(T,b.mode,A),w.return=b,w):(w=i(w,T.children||[]),w.return=b,w)}function f(b,w,T,A,M){return w===null||w.tag!==7?(w=Oo(T,b.mode,A,M),w.return=b,w):(w=i(w,T),w.return=b,w)}function p(b,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return w=z0(""+w,b.mode,T),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xf:return T=wd(w.type,w.key,w.props,null,b.mode,T),T.ref=Sl(b,null,w),T.return=b,T;case za:return w=H0(w,b.mode,T),w.return=b,w;case Cs:var A=w._init;return p(b,A(w._payload),T)}if(Il(w)||vl(w))return w=Oo(w,b.mode,T,null),w.return=b,w;Bf(b,w)}return null}function v(b,w,T,A){var M=w!==null?w.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return M!==null?null:a(b,w,""+T,A);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case xf:return T.key===M?c(b,w,T,A):null;case za:return T.key===M?h(b,w,T,A):null;case Cs:return M=T._init,v(b,w,M(T._payload),A)}if(Il(T)||vl(T))return M!==null?null:f(b,w,T,A,null);Bf(b,T)}return null}function _(b,w,T,A,M){if(typeof A=="string"&&A!==""||typeof A=="number")return b=b.get(T)||null,a(w,b,""+A,M);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case xf:return b=b.get(A.key===null?T:A.key)||null,c(w,b,A,M);case za:return b=b.get(A.key===null?T:A.key)||null,h(w,b,A,M);case Cs:var L=A._init;return _(b,w,T,L(A._payload),M)}if(Il(A)||vl(A))return b=b.get(T)||null,f(w,b,A,M,null);Bf(w,A)}return null}function y(b,w,T,A){for(var M=null,L=null,I=w,N=w=0,k=null;I!==null&&N<T.length;N++){I.index>N?(k=I,I=null):k=I.sibling;var G=v(b,I,T[N],A);if(G===null){I===null&&(I=k);break}t&&I&&G.alternate===null&&e(b,I),w=s(G,w,N),L===null?M=G:L.sibling=G,L=G,I=k}if(N===T.length)return n(b,I),st&&_o(b,N),M;if(I===null){for(;N<T.length;N++)I=p(b,T[N],A),I!==null&&(w=s(I,w,N),L===null?M=I:L.sibling=I,L=I);return st&&_o(b,N),M}for(I=r(b,I);N<T.length;N++)k=_(I,b,N,T[N],A),k!==null&&(t&&k.alternate!==null&&I.delete(k.key===null?N:k.key),w=s(k,w,N),L===null?M=k:L.sibling=k,L=k);return t&&I.forEach(function(ie){return e(b,ie)}),st&&_o(b,N),M}function S(b,w,T,A){var M=vl(T);if(typeof M!="function")throw Error(j(150));if(T=M.call(T),T==null)throw Error(j(151));for(var L=M=null,I=w,N=w=0,k=null,G=T.next();I!==null&&!G.done;N++,G=T.next()){I.index>N?(k=I,I=null):k=I.sibling;var ie=v(b,I,G.value,A);if(ie===null){I===null&&(I=k);break}t&&I&&ie.alternate===null&&e(b,I),w=s(ie,w,N),L===null?M=ie:L.sibling=ie,L=ie,I=k}if(G.done)return n(b,I),st&&_o(b,N),M;if(I===null){for(;!G.done;N++,G=T.next())G=p(b,G.value,A),G!==null&&(w=s(G,w,N),L===null?M=G:L.sibling=G,L=G);return st&&_o(b,N),M}for(I=r(b,I);!G.done;N++,G=T.next())G=_(I,b,N,G.value,A),G!==null&&(t&&G.alternate!==null&&I.delete(G.key===null?N:G.key),w=s(G,w,N),L===null?M=G:L.sibling=G,L=G);return t&&I.forEach(function(Ze){return e(b,Ze)}),st&&_o(b,N),M}function C(b,w,T,A){if(typeof T=="object"&&T!==null&&T.type===Ha&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case xf:e:{for(var M=T.key,L=w;L!==null;){if(L.key===M){if(M=T.type,M===Ha){if(L.tag===7){n(b,L.sibling),w=i(L,T.props.children),w.return=b,b=w;break e}}else if(L.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Cs&&Lw(M)===L.type){n(b,L.sibling),w=i(L,T.props),w.ref=Sl(b,L,T),w.return=b,b=w;break e}n(b,L);break}else e(b,L);L=L.sibling}T.type===Ha?(w=Oo(T.props.children,b.mode,A,T.key),w.return=b,b=w):(A=wd(T.type,T.key,T.props,null,b.mode,A),A.ref=Sl(b,w,T),A.return=b,b=A)}return o(b);case za:e:{for(L=T.key;w!==null;){if(w.key===L)if(w.tag===4&&w.stateNode.containerInfo===T.containerInfo&&w.stateNode.implementation===T.implementation){n(b,w.sibling),w=i(w,T.children||[]),w.return=b,b=w;break e}else{n(b,w);break}else e(b,w);w=w.sibling}w=H0(T,b.mode,A),w.return=b,b=w}return o(b);case Cs:return L=T._init,C(b,w,L(T._payload),A)}if(Il(T))return y(b,w,T,A);if(vl(T))return S(b,w,T,A);Bf(b,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,w!==null&&w.tag===6?(n(b,w.sibling),w=i(w,T),w.return=b,b=w):(n(b,w),w=z0(T,b.mode,A),w.return=b,b=w),o(b)):n(b,w)}return C}var Su=HA(!0),VA=HA(!1),np=Ks(null),rp=null,Ka=null,Px=null;function Rx(){Px=Ka=rp=null}function Bx(t){var e=np.current;nt(np),t._currentValue=e}function f_(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function uu(t,e){rp=t,Px=Ka=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Mn=!0),t.firstContext=null)}function xr(t){var e=t._currentValue;if(Px!==t)if(t={context:t,memoizedValue:e,next:null},Ka===null){if(rp===null)throw Error(j(308));Ka=t,rp.dependencies={lanes:0,firstContext:t}}else Ka=Ka.next=t;return e}var Po=null;function Mx(t){Po===null?Po=[t]:Po.push(t)}function jA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Mx(e)):(n.next=i.next,i.next=n),e.interleaved=n,es(t,r)}function es(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ts=!1;function Dx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ns(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,es(t,n)}return i=r.interleaved,i===null?(e.next=e,Mx(r)):(e.next=i.next,i.next=e),r.interleaved=e,es(t,n)}function vd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vx(t,n)}}function Nw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ip(t,e,n,r){var i=t.updateQueue;Ts=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=h:a.next=h,f.lastBaseUpdate=c))}if(s!==null){var p=i.baseState;o=0,f=h=c=null,a=s;do{var v=a.lane,_=a.eventTime;if((r&v)===v){f!==null&&(f=f.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=t,S=a;switch(v=e,_=n,S.tag){case 1:if(y=S.payload,typeof y=="function"){p=y.call(_,p,v);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=S.payload,v=typeof y=="function"?y.call(_,p,v):y,v==null)break e;p=pt({},p,v);break e;case 2:Ts=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,v=i.effects,v===null?i.effects=[a]:v.push(a))}else _={eventTime:_,lane:v,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(h=f=_,c=p):f=f.next=_,o|=v;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;v=a,a=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(!0);if(f===null&&(c=p),i.baseState=c,i.firstBaseUpdate=h,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Go|=o,t.lanes=o,t.memoizedState=p}}function Gw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(j(191,i));i.call(r)}}}var ih={},fi=Ks(ih),yc=Ks(ih),bc=Ks(ih);function Ro(t){if(t===ih)throw Error(j(174));return t}function Ox(t,e){switch(qe(bc,e),qe(yc,t),qe(fi,ih),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$v(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=$v(e,t)}nt(fi),qe(fi,e)}function wu(){nt(fi),nt(yc),nt(bc)}function $A(t){Ro(bc.current);var e=Ro(fi.current),n=$v(e,t.type);e!==n&&(qe(yc,t),qe(fi,n))}function kx(t){yc.current===t&&(nt(fi),nt(yc))}var ct=Ks(0);function sp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var F0=[];function Fx(){for(var t=0;t<F0.length;t++)F0[t]._workInProgressVersionPrimary=null;F0.length=0}var _d=as.ReactCurrentDispatcher,I0=as.ReactCurrentBatchConfig,No=0,ft=null,Pt=null,Lt=null,op=!1,ql=!1,Sc=0,yL=0;function un(){throw Error(j(321))}function Ix(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zr(t[n],e[n]))return!1;return!0}function Ux(t,e,n,r,i,s){if(No=s,ft=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_d.current=t===null||t.memoizedState===null?CL:TL,t=n(r,i),ql){s=0;do{if(ql=!1,Sc=0,25<=s)throw Error(j(301));s+=1,Lt=Pt=null,e.updateQueue=null,_d.current=EL,t=n(r,i)}while(ql)}if(_d.current=ap,e=Pt!==null&&Pt.next!==null,No=0,Lt=Pt=ft=null,op=!1,e)throw Error(j(300));return t}function Lx(){var t=Sc!==0;return Sc=0,t}function oi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?ft.memoizedState=Lt=t:Lt=Lt.next=t,Lt}function yr(){if(Pt===null){var t=ft.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Lt===null?ft.memoizedState:Lt.next;if(e!==null)Lt=e,Pt=t;else{if(t===null)throw Error(j(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Lt===null?ft.memoizedState=Lt=t:Lt=Lt.next=t}return Lt}function wc(t,e){return typeof e=="function"?e(t):e}function U0(t){var e=yr(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=Pt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,h=s;do{var f=h.lane;if((No&f)===f)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var p={lane:f,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(a=c=p,o=r):c=c.next=p,ft.lanes|=f,Go|=f}h=h.next}while(h!==null&&h!==s);c===null?o=r:c.next=a,zr(r,e.memoizedState)||(Mn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ft.lanes|=s,Go|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function L0(t){var e=yr(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);zr(s,e.memoizedState)||(Mn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function XA(){}function YA(t,e){var n=ft,r=yr(),i=e(),s=!zr(r.memoizedState,i);if(s&&(r.memoizedState=i,Mn=!0),r=r.queue,Nx(QA.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Lt!==null&&Lt.memoizedState.tag&1){if(n.flags|=2048,Cc(9,KA.bind(null,n,r,i,e),void 0,null),Gt===null)throw Error(j(349));No&30||qA(n,e,i)}return i}function qA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ft.updateQueue,e===null?(e={lastEffect:null,stores:null},ft.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function KA(t,e,n,r){e.value=n,e.getSnapshot=r,ZA(e)&&JA(t)}function QA(t,e,n){return n(function(){ZA(e)&&JA(t)})}function ZA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zr(t,n)}catch{return!0}}function JA(t){var e=es(t,1);e!==null&&Ur(e,t,1,-1)}function zw(t){var e=oi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:t},e.queue=t,t=t.dispatch=wL.bind(null,ft,t),[e.memoizedState,t]}function Cc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ft.updateQueue,e===null?(e={lastEffect:null,stores:null},ft.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function eP(){return yr().memoizedState}function xd(t,e,n,r){var i=oi();ft.flags|=t,i.memoizedState=Cc(1|e,n,void 0,r===void 0?null:r)}function Yp(t,e,n,r){var i=yr();r=r===void 0?null:r;var s=void 0;if(Pt!==null){var o=Pt.memoizedState;if(s=o.destroy,r!==null&&Ix(r,o.deps)){i.memoizedState=Cc(e,n,s,r);return}}ft.flags|=t,i.memoizedState=Cc(1|e,n,s,r)}function Hw(t,e){return xd(8390656,8,t,e)}function Nx(t,e){return Yp(2048,8,t,e)}function tP(t,e){return Yp(4,2,t,e)}function nP(t,e){return Yp(4,4,t,e)}function rP(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function iP(t,e,n){return n=n!=null?n.concat([t]):null,Yp(4,4,rP.bind(null,e,t),n)}function Gx(){}function sP(t,e){var n=yr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ix(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function oP(t,e){var n=yr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ix(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function aP(t,e,n){return No&21?(zr(n,e)||(n=fA(),ft.lanes|=n,Go|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Mn=!0),t.memoizedState=n)}function bL(t,e){var n=He;He=n!==0&&4>n?n:4,t(!0);var r=I0.transition;I0.transition={};try{t(!1),e()}finally{He=n,I0.transition=r}}function uP(){return yr().memoizedState}function SL(t,e,n){var r=zs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},lP(t))cP(e,n);else if(n=jA(t,e,n,r),n!==null){var i=gn();Ur(n,t,r,i),hP(n,e,r)}}function wL(t,e,n){var r=zs(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(lP(t))cP(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,zr(a,o)){var c=e.interleaved;c===null?(i.next=i,Mx(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=jA(t,e,i,r),n!==null&&(i=gn(),Ur(n,t,r,i),hP(n,e,r))}}function lP(t){var e=t.alternate;return t===ft||e!==null&&e===ft}function cP(t,e){ql=op=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function hP(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vx(t,n)}}var ap={readContext:xr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},CL={readContext:xr,useCallback:function(t,e){return oi().memoizedState=[t,e===void 0?null:e],t},useContext:xr,useEffect:Hw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,xd(4194308,4,rP.bind(null,e,t),n)},useLayoutEffect:function(t,e){return xd(4194308,4,t,e)},useInsertionEffect:function(t,e){return xd(4,2,t,e)},useMemo:function(t,e){var n=oi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=oi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=SL.bind(null,ft,t),[r.memoizedState,t]},useRef:function(t){var e=oi();return t={current:t},e.memoizedState=t},useState:zw,useDebugValue:Gx,useDeferredValue:function(t){return oi().memoizedState=t},useTransition:function(){var t=zw(!1),e=t[0];return t=bL.bind(null,t[1]),oi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ft,i=oi();if(st){if(n===void 0)throw Error(j(407));n=n()}else{if(n=e(),Gt===null)throw Error(j(349));No&30||qA(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Hw(QA.bind(null,r,s,t),[t]),r.flags|=2048,Cc(9,KA.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=oi(),e=Gt.identifierPrefix;if(st){var n=$i,r=Wi;n=(r&~(1<<32-Ir(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Sc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yL++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},TL={readContext:xr,useCallback:sP,useContext:xr,useEffect:Nx,useImperativeHandle:iP,useInsertionEffect:tP,useLayoutEffect:nP,useMemo:oP,useReducer:U0,useRef:eP,useState:function(){return U0(wc)},useDebugValue:Gx,useDeferredValue:function(t){var e=yr();return aP(e,Pt.memoizedState,t)},useTransition:function(){var t=U0(wc)[0],e=yr().memoizedState;return[t,e]},useMutableSource:XA,useSyncExternalStore:YA,useId:uP,unstable_isNewReconciler:!1},EL={readContext:xr,useCallback:sP,useContext:xr,useEffect:Nx,useImperativeHandle:iP,useInsertionEffect:tP,useLayoutEffect:nP,useMemo:oP,useReducer:L0,useRef:eP,useState:function(){return L0(wc)},useDebugValue:Gx,useDeferredValue:function(t){var e=yr();return Pt===null?e.memoizedState=t:aP(e,Pt.memoizedState,t)},useTransition:function(){var t=L0(wc)[0],e=yr().memoizedState;return[t,e]},useMutableSource:XA,useSyncExternalStore:YA,useId:uP,unstable_isNewReconciler:!1};function Dr(t,e){if(t&&t.defaultProps){e=pt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function d_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:pt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var qp={isMounted:function(t){return(t=t._reactInternals)?Jo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=gn(),i=zs(t),s=Xi(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ns(t,s,i),e!==null&&(Ur(e,t,i,r),vd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=gn(),i=zs(t),s=Xi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ns(t,s,i),e!==null&&(Ur(e,t,i,r),vd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gn(),r=zs(t),i=Xi(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ns(t,i,r),e!==null&&(Ur(e,t,r,n),vd(e,t,r))}};function Vw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!gc(n,r)||!gc(i,s):!0}function fP(t,e,n){var r=!1,i=js,s=e.contextType;return typeof s=="object"&&s!==null?s=xr(s):(i=On(e)?Uo:hn.current,r=e.contextTypes,s=(r=r!=null)?yu(t,i):js),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function jw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&qp.enqueueReplaceState(e,e.state,null)}function p_(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Dx(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=xr(s):(s=On(e)?Uo:hn.current,i.context=yu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(d_(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&qp.enqueueReplaceState(i,i.state,null),ip(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Cu(t,e){try{var n="",r=e;do n+=e8(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function N0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function m_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var AL=typeof WeakMap=="function"?WeakMap:Map;function dP(t,e,n){n=Xi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){lp||(lp=!0,T_=r),m_(t,e)},n}function pP(t,e,n){n=Xi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){m_(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){m_(t,e),typeof r!="function"&&(Gs===null?Gs=new Set([this]):Gs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Ww(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new AL;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=zL.bind(null,t,e,n),e.then(t,t))}function $w(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Xw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Xi(-1,1),e.tag=2,Ns(n,e,1))),n.lanes|=1),t)}var PL=as.ReactCurrentOwner,Mn=!1;function pn(t,e,n,r){e.child=t===null?VA(e,null,n,r):Su(e,t.child,n,r)}function Yw(t,e,n,r,i){n=n.render;var s=e.ref;return uu(e,i),r=Ux(t,e,n,r,s,i),n=Lx(),t!==null&&!Mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ts(t,e,i)):(st&&n&&Tx(e),e.flags|=1,pn(t,e,r,i),e.child)}function qw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Yx(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,mP(t,e,s,r,i)):(t=wd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:gc,n(o,r)&&t.ref===e.ref)return ts(t,e,i)}return e.flags|=1,t=Hs(s,r),t.ref=e.ref,t.return=e,e.child=t}function mP(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(gc(s,r)&&t.ref===e.ref)if(Mn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Mn=!0);else return e.lanes=t.lanes,ts(t,e,i)}return g_(t,e,n,r,i)}function gP(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(Za,Vn),Vn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qe(Za,Vn),Vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,qe(Za,Vn),Vn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,qe(Za,Vn),Vn|=r;return pn(t,e,i,n),e.child}function vP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function g_(t,e,n,r,i){var s=On(n)?Uo:hn.current;return s=yu(e,s),uu(e,i),n=Ux(t,e,n,r,s,i),r=Lx(),t!==null&&!Mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ts(t,e,i)):(st&&r&&Tx(e),e.flags|=1,pn(t,e,n,i),e.child)}function Kw(t,e,n,r,i){if(On(n)){var s=!0;Jd(e)}else s=!1;if(uu(e,i),e.stateNode===null)yd(t,e),fP(e,n,r),p_(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=xr(h):(h=On(n)?Uo:hn.current,h=yu(e,h));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==h)&&jw(e,o,r,h),Ts=!1;var v=e.memoizedState;o.state=v,ip(e,r,o,i),c=e.memoizedState,a!==r||v!==c||Dn.current||Ts?(typeof f=="function"&&(d_(e,n,f,r),c=e.memoizedState),(a=Ts||Vw(e,n,a,r,v,c,h))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=h,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,WA(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:Dr(e.type,a),o.props=h,p=e.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=xr(c):(c=On(n)?Uo:hn.current,c=yu(e,c));var _=n.getDerivedStateFromProps;(f=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||v!==c)&&jw(e,o,r,c),Ts=!1,v=e.memoizedState,o.state=v,ip(e,r,o,i);var y=e.memoizedState;a!==p||v!==y||Dn.current||Ts?(typeof _=="function"&&(d_(e,n,_,r),y=e.memoizedState),(h=Ts||Vw(e,n,h,r,v,y,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=c,r=h):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),r=!1)}return v_(t,e,n,r,s,i)}function v_(t,e,n,r,i,s){vP(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Fw(e,n,!1),ts(t,e,s);r=e.stateNode,PL.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Su(e,t.child,null,s),e.child=Su(e,null,a,s)):pn(t,e,a,s),e.memoizedState=r.state,i&&Fw(e,n,!0),e.child}function _P(t){var e=t.stateNode;e.pendingContext?kw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&kw(t,e.context,!1),Ox(t,e.containerInfo)}function Qw(t,e,n,r,i){return bu(),Ax(i),e.flags|=256,pn(t,e,n,r),e.child}var __={dehydrated:null,treeContext:null,retryLane:0};function x_(t){return{baseLanes:t,cachePool:null,transitions:null}}function xP(t,e,n){var r=e.pendingProps,i=ct.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),qe(ct,i&1),t===null)return h_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Zp(o,r,0,null),t=Oo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=x_(n),e.memoizedState=__,t):zx(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return RL(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Hs(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Hs(a,s):(s=Oo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?x_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=__,r}return s=t.child,t=s.sibling,r=Hs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function zx(t,e){return e=Zp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Mf(t,e,n,r){return r!==null&&Ax(r),Su(e,t.child,null,n),t=zx(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function RL(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=N0(Error(j(422))),Mf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Zp({mode:"visible",children:r.children},i,0,null),s=Oo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Su(e,t.child,null,o),e.child.memoizedState=x_(o),e.memoizedState=__,s);if(!(e.mode&1))return Mf(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(j(419)),r=N0(s,r,void 0),Mf(t,e,o,r)}if(a=(o&t.childLanes)!==0,Mn||a){if(r=Gt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,es(t,i),Ur(r,t,i,-1))}return Xx(),r=N0(Error(j(421))),Mf(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=HL.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,$n=Ls(i.nextSibling),Xn=e,st=!0,kr=null,t!==null&&(lr[cr++]=Wi,lr[cr++]=$i,lr[cr++]=Lo,Wi=t.id,$i=t.overflow,Lo=e),e=zx(e,r.children),e.flags|=4096,e)}function Zw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),f_(t.return,e,n)}function G0(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function yP(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(pn(t,e,r.children,n),r=ct.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Zw(t,n,e);else if(t.tag===19)Zw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(qe(ct,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&sp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),G0(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&sp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}G0(e,!0,n,null,s);break;case"together":G0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ts(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Go|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(j(153));if(e.child!==null){for(t=e.child,n=Hs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Hs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function BL(t,e,n){switch(e.tag){case 3:_P(e),bu();break;case 5:$A(e);break;case 1:On(e.type)&&Jd(e);break;case 4:Ox(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;qe(np,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qe(ct,ct.current&1),e.flags|=128,null):n&e.child.childLanes?xP(t,e,n):(qe(ct,ct.current&1),t=ts(t,e,n),t!==null?t.sibling:null);qe(ct,ct.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return yP(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),qe(ct,ct.current),r)break;return null;case 22:case 23:return e.lanes=0,gP(t,e,n)}return ts(t,e,n)}var bP,y_,SP,wP;bP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};y_=function(){};SP=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ro(fi.current);var s=null;switch(n){case"input":i=Hv(t,i),r=Hv(t,r),s=[];break;case"select":i=pt({},i,{value:void 0}),r=pt({},r,{value:void 0}),s=[];break;case"textarea":i=Wv(t,i),r=Wv(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Qd)}Xv(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var a=i[h];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(lc.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var c=r[h];if(a=i?.[h],r.hasOwnProperty(h)&&c!==a&&(c!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(lc.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&tt("scroll",t),s||a===c||(s=[])):(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};wP=function(t,e,n,r){n!==r&&(e.flags|=4)};function wl(t,e){if(!st)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ln(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ML(t,e,n){var r=e.pendingProps;switch(Ex(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(e),null;case 1:return On(e.type)&&Zd(),ln(e),null;case 3:return r=e.stateNode,wu(),nt(Dn),nt(hn),Fx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Rf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,kr!==null&&(P_(kr),kr=null))),y_(t,e),ln(e),null;case 5:kx(e);var i=Ro(bc.current);if(n=e.type,t!==null&&e.stateNode!=null)SP(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(j(166));return ln(e),null}if(t=Ro(fi.current),Rf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[ui]=e,r[xc]=s,t=(e.mode&1)!==0,n){case"dialog":tt("cancel",r),tt("close",r);break;case"iframe":case"object":case"embed":tt("load",r);break;case"video":case"audio":for(i=0;i<Ll.length;i++)tt(Ll[i],r);break;case"source":tt("error",r);break;case"img":case"image":case"link":tt("error",r),tt("load",r);break;case"details":tt("toggle",r);break;case"input":aw(r,s),tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},tt("invalid",r);break;case"textarea":lw(r,s),tt("invalid",r)}Xv(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Pf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Pf(r.textContent,a,t),i=["children",""+a]):lc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&tt("scroll",r)}switch(n){case"input":yf(r),uw(r,s,!0);break;case"textarea":yf(r),cw(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Qd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=QE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ui]=e,t[xc]=r,bP(t,e,!1,!1),e.stateNode=t;e:{switch(o=Yv(n,r),n){case"dialog":tt("cancel",t),tt("close",t),i=r;break;case"iframe":case"object":case"embed":tt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ll.length;i++)tt(Ll[i],t);i=r;break;case"source":tt("error",t),i=r;break;case"img":case"image":case"link":tt("error",t),tt("load",t),i=r;break;case"details":tt("toggle",t),i=r;break;case"input":aw(t,r),i=Hv(t,r),tt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=pt({},r,{value:void 0}),tt("invalid",t);break;case"textarea":lw(t,r),i=Wv(t,r),tt("invalid",t);break;default:i=r}Xv(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?eA(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ZE(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&cc(t,c):typeof c=="number"&&cc(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(lc.hasOwnProperty(s)?c!=null&&s==="onScroll"&&tt("scroll",t):c!=null&&hx(t,s,c,o))}switch(n){case"input":yf(t),uw(t,r,!1);break;case"textarea":yf(t),cw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vs(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?iu(t,!!r.multiple,s,!1):r.defaultValue!=null&&iu(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Qd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ln(e),null;case 6:if(t&&e.stateNode!=null)wP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(j(166));if(n=Ro(bc.current),Ro(fi.current),Rf(e)){if(r=e.stateNode,n=e.memoizedProps,r[ui]=e,(s=r.nodeValue!==n)&&(t=Xn,t!==null))switch(t.tag){case 3:Pf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ui]=e,e.stateNode=r}return ln(e),null;case 13:if(nt(ct),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(st&&$n!==null&&e.mode&1&&!(e.flags&128))zA(),bu(),e.flags|=98560,s=!1;else if(s=Rf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(j(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(j(317));s[ui]=e}else bu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ln(e),s=!1}else kr!==null&&(P_(kr),kr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ct.current&1?Bt===0&&(Bt=3):Xx())),e.updateQueue!==null&&(e.flags|=4),ln(e),null);case 4:return wu(),y_(t,e),t===null&&vc(e.stateNode.containerInfo),ln(e),null;case 10:return Bx(e.type._context),ln(e),null;case 17:return On(e.type)&&Zd(),ln(e),null;case 19:if(nt(ct),s=e.memoizedState,s===null)return ln(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)wl(s,!1);else{if(Bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=sp(t),o!==null){for(e.flags|=128,wl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return qe(ct,ct.current&1|2),e.child}t=t.sibling}s.tail!==null&&yt()>Tu&&(e.flags|=128,r=!0,wl(s,!1),e.lanes=4194304)}else{if(!r)if(t=sp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),wl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!st)return ln(e),null}else 2*yt()-s.renderingStartTime>Tu&&n!==1073741824&&(e.flags|=128,r=!0,wl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=yt(),e.sibling=null,n=ct.current,qe(ct,r?n&1|2:n&1),e):(ln(e),null);case 22:case 23:return $x(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vn&1073741824&&(ln(e),e.subtreeFlags&6&&(e.flags|=8192)):ln(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function DL(t,e){switch(Ex(e),e.tag){case 1:return On(e.type)&&Zd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return wu(),nt(Dn),nt(hn),Fx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return kx(e),null;case 13:if(nt(ct),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(j(340));bu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return nt(ct),null;case 4:return wu(),null;case 10:return Bx(e.type._context),null;case 22:case 23:return $x(),null;case 24:return null;default:return null}}var Df=!1,cn=!1,OL=typeof WeakSet=="function"?WeakSet:Set,te=null;function Qa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){gt(t,e,r)}else n.current=null}function b_(t,e,n){try{n()}catch(r){gt(t,e,r)}}var Jw=!1;function kL(t,e){if(i_=Yd,t=PA(),Cx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,h=0,f=0,p=t,v=null;t:for(;;){for(var _;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(_=p.firstChild)!==null;)v=p,p=_;for(;;){if(p===t)break t;if(v===n&&++h===i&&(a=o),v===s&&++f===r&&(c=o),(_=p.nextSibling)!==null)break;p=v,v=p.parentNode}p=_}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(s_={focusedElem:t,selectionRange:n},Yd=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var S=y.memoizedProps,C=y.memoizedState,b=e.stateNode,w=b.getSnapshotBeforeUpdate(e.elementType===e.type?S:Dr(e.type,S),C);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(A){gt(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return y=Jw,Jw=!1,y}function Kl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&b_(e,n,s)}i=i.next}while(i!==r)}}function Kp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function S_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function CP(t){var e=t.alternate;e!==null&&(t.alternate=null,CP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ui],delete e[xc],delete e[u_],delete e[gL],delete e[vL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function TP(t){return t.tag===5||t.tag===3||t.tag===4}function eC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||TP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function w_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Qd));else if(r!==4&&(t=t.child,t!==null))for(w_(t,e,n),t=t.sibling;t!==null;)w_(t,e,n),t=t.sibling}function C_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(C_(t,e,n),t=t.sibling;t!==null;)C_(t,e,n),t=t.sibling}var $t=null,Or=!1;function bs(t,e,n){for(n=n.child;n!==null;)EP(t,e,n),n=n.sibling}function EP(t,e,n){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(Hp,n)}catch{}switch(n.tag){case 5:cn||Qa(n,e);case 6:var r=$t,i=Or;$t=null,bs(t,e,n),$t=r,Or=i,$t!==null&&(Or?(t=$t,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$t.removeChild(n.stateNode));break;case 18:$t!==null&&(Or?(t=$t,n=n.stateNode,t.nodeType===8?O0(t.parentNode,n):t.nodeType===1&&O0(t,n),pc(t)):O0($t,n.stateNode));break;case 4:r=$t,i=Or,$t=n.stateNode.containerInfo,Or=!0,bs(t,e,n),$t=r,Or=i;break;case 0:case 11:case 14:case 15:if(!cn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&b_(n,e,o),i=i.next}while(i!==r)}bs(t,e,n);break;case 1:if(!cn&&(Qa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){gt(n,e,a)}bs(t,e,n);break;case 21:bs(t,e,n);break;case 22:n.mode&1?(cn=(r=cn)||n.memoizedState!==null,bs(t,e,n),cn=r):bs(t,e,n);break;default:bs(t,e,n)}}function tC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new OL),e.forEach(function(r){var i=VL.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Br(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:$t=a.stateNode,Or=!1;break e;case 3:$t=a.stateNode.containerInfo,Or=!0;break e;case 4:$t=a.stateNode.containerInfo,Or=!0;break e}a=a.return}if($t===null)throw Error(j(160));EP(s,o,i),$t=null,Or=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(h){gt(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)AP(e,t),e=e.sibling}function AP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Br(e,t),ni(t),r&4){try{Kl(3,t,t.return),Kp(3,t)}catch(S){gt(t,t.return,S)}try{Kl(5,t,t.return)}catch(S){gt(t,t.return,S)}}break;case 1:Br(e,t),ni(t),r&512&&n!==null&&Qa(n,n.return);break;case 5:if(Br(e,t),ni(t),r&512&&n!==null&&Qa(n,n.return),t.flags&32){var i=t.stateNode;try{cc(i,"")}catch(S){gt(t,t.return,S)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&qE(i,s),Yv(a,o);var h=Yv(a,s);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?eA(i,p):f==="dangerouslySetInnerHTML"?ZE(i,p):f==="children"?cc(i,p):hx(i,f,p,h)}switch(a){case"input":Vv(i,s);break;case"textarea":KE(i,s);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var _=s.value;_!=null?iu(i,!!s.multiple,_,!1):v!==!!s.multiple&&(s.defaultValue!=null?iu(i,!!s.multiple,s.defaultValue,!0):iu(i,!!s.multiple,s.multiple?[]:"",!1))}i[xc]=s}catch(S){gt(t,t.return,S)}}break;case 6:if(Br(e,t),ni(t),r&4){if(t.stateNode===null)throw Error(j(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(S){gt(t,t.return,S)}}break;case 3:if(Br(e,t),ni(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{pc(e.containerInfo)}catch(S){gt(t,t.return,S)}break;case 4:Br(e,t),ni(t);break;case 13:Br(e,t),ni(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(jx=yt())),r&4&&tC(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(cn=(h=cn)||f,Br(e,t),cn=h):Br(e,t),ni(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!f&&t.mode&1)for(te=t,f=t.child;f!==null;){for(p=te=f;te!==null;){switch(v=te,_=v.child,v.tag){case 0:case 11:case 14:case 15:Kl(4,v,v.return);break;case 1:Qa(v,v.return);var y=v.stateNode;if(typeof y.componentWillUnmount=="function"){r=v,n=v.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(S){gt(r,n,S)}}break;case 5:Qa(v,v.return);break;case 22:if(v.memoizedState!==null){rC(p);continue}}_!==null?(_.return=v,te=_):rC(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=JE("display",o))}catch(S){gt(t,t.return,S)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(S){gt(t,t.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Br(e,t),ni(t),r&4&&tC(t);break;case 21:break;default:Br(e,t),ni(t)}}function ni(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(TP(n)){var r=n;break e}n=n.return}throw Error(j(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(cc(i,""),r.flags&=-33);var s=eC(t);C_(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=eC(t);w_(t,a,o);break;default:throw Error(j(161))}}catch(c){gt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function FL(t,e,n){te=t,PP(t)}function PP(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var i=te,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Df;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||cn;a=Df;var h=cn;if(Df=o,(cn=c)&&!h)for(te=i;te!==null;)o=te,c=o.child,o.tag===22&&o.memoizedState!==null?iC(i):c!==null?(c.return=o,te=c):iC(i);for(;s!==null;)te=s,PP(s),s=s.sibling;te=i,Df=a,cn=h}nC(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,te=s):nC(t)}}function nC(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:cn||Kp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!cn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Dr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Gw(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Gw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var f=h.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&pc(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}cn||e.flags&512&&S_(e)}catch(v){gt(e,e.return,v)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function rC(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function iC(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Kp(4,e)}catch(c){gt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){gt(e,i,c)}}var s=e.return;try{S_(e)}catch(c){gt(e,s,c)}break;case 5:var o=e.return;try{S_(e)}catch(c){gt(e,o,c)}}}catch(c){gt(e,e.return,c)}if(e===t){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var IL=Math.ceil,up=as.ReactCurrentDispatcher,Hx=as.ReactCurrentOwner,_r=as.ReactCurrentBatchConfig,Be=0,Gt=null,Ct=null,Yt=0,Vn=0,Za=Ks(0),Bt=0,Tc=null,Go=0,Qp=0,Vx=0,Ql=null,Pn=null,jx=0,Tu=1/0,Gi=null,lp=!1,T_=null,Gs=null,Of=!1,Bs=null,cp=0,Zl=0,E_=null,bd=-1,Sd=0;function gn(){return Be&6?yt():bd!==-1?bd:bd=yt()}function zs(t){return t.mode&1?Be&2&&Yt!==0?Yt&-Yt:xL.transition!==null?(Sd===0&&(Sd=fA()),Sd):(t=He,t!==0||(t=window.event,t=t===void 0?16:xA(t.type)),t):1}function Ur(t,e,n,r){if(50<Zl)throw Zl=0,E_=null,Error(j(185));th(t,n,r),(!(Be&2)||t!==Gt)&&(t===Gt&&(!(Be&2)&&(Qp|=n),Bt===4&&Ps(t,Yt)),kn(t,r),n===1&&Be===0&&!(e.mode&1)&&(Tu=yt()+500,Xp&&Qs()))}function kn(t,e){var n=t.callbackNode;x8(t,e);var r=Xd(t,t===Gt?Yt:0);if(r===0)n!==null&&dw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&dw(n),e===1)t.tag===0?_L(sC.bind(null,t)):LA(sC.bind(null,t)),pL(function(){!(Be&6)&&Qs()}),n=null;else{switch(dA(r)){case 1:n=gx;break;case 4:n=cA;break;case 16:n=$d;break;case 536870912:n=hA;break;default:n=$d}n=IP(n,RP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function RP(t,e){if(bd=-1,Sd=0,Be&6)throw Error(j(327));var n=t.callbackNode;if(lu()&&t.callbackNode!==n)return null;var r=Xd(t,t===Gt?Yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hp(t,r);else{e=r;var i=Be;Be|=2;var s=MP();(Gt!==t||Yt!==e)&&(Gi=null,Tu=yt()+500,Do(t,e));do try{NL();break}catch(a){BP(t,a)}while(!0);Rx(),up.current=s,Be=i,Ct!==null?e=0:(Gt=null,Yt=0,e=Bt)}if(e!==0){if(e===2&&(i=Jv(t),i!==0&&(r=i,e=A_(t,i))),e===1)throw n=Tc,Do(t,0),Ps(t,r),kn(t,yt()),n;if(e===6)Ps(t,r);else{if(i=t.current.alternate,!(r&30)&&!UL(i)&&(e=hp(t,r),e===2&&(s=Jv(t),s!==0&&(r=s,e=A_(t,s))),e===1))throw n=Tc,Do(t,0),Ps(t,r),kn(t,yt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(j(345));case 2:xo(t,Pn,Gi);break;case 3:if(Ps(t,r),(r&130023424)===r&&(e=jx+500-yt(),10<e)){if(Xd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){gn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=a_(xo.bind(null,t,Pn,Gi),e);break}xo(t,Pn,Gi);break;case 4:if(Ps(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Ir(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=yt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*IL(r/1960))-r,10<r){t.timeoutHandle=a_(xo.bind(null,t,Pn,Gi),r);break}xo(t,Pn,Gi);break;case 5:xo(t,Pn,Gi);break;default:throw Error(j(329))}}}return kn(t,yt()),t.callbackNode===n?RP.bind(null,t):null}function A_(t,e){var n=Ql;return t.current.memoizedState.isDehydrated&&(Do(t,e).flags|=256),t=hp(t,e),t!==2&&(e=Pn,Pn=n,e!==null&&P_(e)),t}function P_(t){Pn===null?Pn=t:Pn.push.apply(Pn,t)}function UL(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!zr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ps(t,e){for(e&=~Vx,e&=~Qp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ir(e),r=1<<n;t[n]=-1,e&=~r}}function sC(t){if(Be&6)throw Error(j(327));lu();var e=Xd(t,0);if(!(e&1))return kn(t,yt()),null;var n=hp(t,e);if(t.tag!==0&&n===2){var r=Jv(t);r!==0&&(e=r,n=A_(t,r))}if(n===1)throw n=Tc,Do(t,0),Ps(t,e),kn(t,yt()),n;if(n===6)throw Error(j(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xo(t,Pn,Gi),kn(t,yt()),null}function Wx(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(Tu=yt()+500,Xp&&Qs())}}function zo(t){Bs!==null&&Bs.tag===0&&!(Be&6)&&lu();var e=Be;Be|=1;var n=_r.transition,r=He;try{if(_r.transition=null,He=1,t)return t()}finally{He=r,_r.transition=n,Be=e,!(Be&6)&&Qs()}}function $x(){Vn=Za.current,nt(Za)}function Do(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dL(n)),Ct!==null)for(n=Ct.return;n!==null;){var r=n;switch(Ex(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zd();break;case 3:wu(),nt(Dn),nt(hn),Fx();break;case 5:kx(r);break;case 4:wu();break;case 13:nt(ct);break;case 19:nt(ct);break;case 10:Bx(r.type._context);break;case 22:case 23:$x()}n=n.return}if(Gt=t,Ct=t=Hs(t.current,null),Yt=Vn=e,Bt=0,Tc=null,Vx=Qp=Go=0,Pn=Ql=null,Po!==null){for(e=0;e<Po.length;e++)if(n=Po[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Po=null}return t}function BP(t,e){do{var n=Ct;try{if(Rx(),_d.current=ap,op){for(var r=ft.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}op=!1}if(No=0,Lt=Pt=ft=null,ql=!1,Sc=0,Hx.current=null,n===null||n.return===null){Bt=1,Tc=e,Ct=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=Yt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,f=a,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var v=f.alternate;v?(f.updateQueue=v.updateQueue,f.memoizedState=v.memoizedState,f.lanes=v.lanes):(f.updateQueue=null,f.memoizedState=null)}var _=$w(o);if(_!==null){_.flags&=-257,Xw(_,o,a,s,e),_.mode&1&&Ww(s,h,e),e=_,c=h;var y=e.updateQueue;if(y===null){var S=new Set;S.add(c),e.updateQueue=S}else y.add(c);break e}else{if(!(e&1)){Ww(s,h,e),Xx();break e}c=Error(j(426))}}else if(st&&a.mode&1){var C=$w(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Xw(C,o,a,s,e),Ax(Cu(c,a));break e}}s=c=Cu(c,a),Bt!==4&&(Bt=2),Ql===null?Ql=[s]:Ql.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=dP(s,c,e);Nw(s,b);break e;case 1:a=c;var w=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Gs===null||!Gs.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var A=pP(s,a,e);Nw(s,A);break e}}s=s.return}while(s!==null)}OP(n)}catch(M){e=M,Ct===n&&n!==null&&(Ct=n=n.return);continue}break}while(!0)}function MP(){var t=up.current;return up.current=ap,t===null?ap:t}function Xx(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),Gt===null||!(Go&268435455)&&!(Qp&268435455)||Ps(Gt,Yt)}function hp(t,e){var n=Be;Be|=2;var r=MP();(Gt!==t||Yt!==e)&&(Gi=null,Do(t,e));do try{LL();break}catch(i){BP(t,i)}while(!0);if(Rx(),Be=n,up.current=r,Ct!==null)throw Error(j(261));return Gt=null,Yt=0,Bt}function LL(){for(;Ct!==null;)DP(Ct)}function NL(){for(;Ct!==null&&!c8();)DP(Ct)}function DP(t){var e=FP(t.alternate,t,Vn);t.memoizedProps=t.pendingProps,e===null?OP(t):Ct=e,Hx.current=null}function OP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=DL(n,e),n!==null){n.flags&=32767,Ct=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Bt=6,Ct=null;return}}else if(n=ML(n,e,Vn),n!==null){Ct=n;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=t}while(e!==null);Bt===0&&(Bt=5)}function xo(t,e,n){var r=He,i=_r.transition;try{_r.transition=null,He=1,GL(t,e,n,r)}finally{_r.transition=i,He=r}return null}function GL(t,e,n,r){do lu();while(Bs!==null);if(Be&6)throw Error(j(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(j(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(y8(t,s),t===Gt&&(Ct=Gt=null,Yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Of||(Of=!0,IP($d,function(){return lu(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=_r.transition,_r.transition=null;var o=He;He=1;var a=Be;Be|=4,Hx.current=null,kL(t,n),AP(n,t),oL(s_),Yd=!!i_,s_=i_=null,t.current=n,FL(n),h8(),Be=a,He=o,_r.transition=s}else t.current=n;if(Of&&(Of=!1,Bs=t,cp=i),s=t.pendingLanes,s===0&&(Gs=null),p8(n.stateNode),kn(t,yt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(lp)throw lp=!1,t=T_,T_=null,t;return cp&1&&t.tag!==0&&lu(),s=t.pendingLanes,s&1?t===E_?Zl++:(Zl=0,E_=t):Zl=0,Qs(),null}function lu(){if(Bs!==null){var t=dA(cp),e=_r.transition,n=He;try{if(_r.transition=null,He=16>t?16:t,Bs===null)var r=!1;else{if(t=Bs,Bs=null,cp=0,Be&6)throw Error(j(331));var i=Be;for(Be|=4,te=t.current;te!==null;){var s=te,o=s.child;if(te.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var h=a[c];for(te=h;te!==null;){var f=te;switch(f.tag){case 0:case 11:case 15:Kl(8,f,s)}var p=f.child;if(p!==null)p.return=f,te=p;else for(;te!==null;){f=te;var v=f.sibling,_=f.return;if(CP(f),f===h){te=null;break}if(v!==null){v.return=_,te=v;break}te=_}}}var y=s.alternate;if(y!==null){var S=y.child;if(S!==null){y.child=null;do{var C=S.sibling;S.sibling=null,S=C}while(S!==null)}}te=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,te=o;else e:for(;te!==null;){if(s=te,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Kl(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,te=b;break e}te=s.return}}var w=t.current;for(te=w;te!==null;){o=te;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,te=T;else e:for(o=w;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Kp(9,a)}}catch(M){gt(a,a.return,M)}if(a===o){te=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,te=A;break e}te=a.return}}if(Be=i,Qs(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(Hp,t)}catch{}r=!0}return r}finally{He=n,_r.transition=e}}return!1}function oC(t,e,n){e=Cu(n,e),e=dP(t,e,1),t=Ns(t,e,1),e=gn(),t!==null&&(th(t,1,e),kn(t,e))}function gt(t,e,n){if(t.tag===3)oC(t,t,n);else for(;e!==null;){if(e.tag===3){oC(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Gs===null||!Gs.has(r))){t=Cu(n,t),t=pP(e,t,1),e=Ns(e,t,1),t=gn(),e!==null&&(th(e,1,t),kn(e,t));break}}e=e.return}}function zL(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=gn(),t.pingedLanes|=t.suspendedLanes&n,Gt===t&&(Yt&n)===n&&(Bt===4||Bt===3&&(Yt&130023424)===Yt&&500>yt()-jx?Do(t,0):Vx|=n),kn(t,e)}function kP(t,e){e===0&&(t.mode&1?(e=wf,wf<<=1,!(wf&130023424)&&(wf=4194304)):e=1);var n=gn();t=es(t,e),t!==null&&(th(t,e,n),kn(t,n))}function HL(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kP(t,n)}function VL(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(j(314))}r!==null&&r.delete(e),kP(t,n)}var FP;FP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dn.current)Mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Mn=!1,BL(t,e,n);Mn=!!(t.flags&131072)}else Mn=!1,st&&e.flags&1048576&&NA(e,tp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;yd(t,e),t=e.pendingProps;var i=yu(e,hn.current);uu(e,n),i=Ux(null,e,r,t,i,n);var s=Lx();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,On(r)?(s=!0,Jd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Dx(e),i.updater=qp,e.stateNode=i,i._reactInternals=e,p_(e,r,t,n),e=v_(null,e,r,!0,s,n)):(e.tag=0,st&&s&&Tx(e),pn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(yd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=WL(r),t=Dr(r,t),i){case 0:e=g_(null,e,r,t,n);break e;case 1:e=Kw(null,e,r,t,n);break e;case 11:e=Yw(null,e,r,t,n);break e;case 14:e=qw(null,e,r,Dr(r.type,t),n);break e}throw Error(j(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dr(r,i),g_(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dr(r,i),Kw(t,e,r,i,n);case 3:e:{if(_P(e),t===null)throw Error(j(387));r=e.pendingProps,s=e.memoizedState,i=s.element,WA(t,e),ip(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Cu(Error(j(423)),e),e=Qw(t,e,r,n,i);break e}else if(r!==i){i=Cu(Error(j(424)),e),e=Qw(t,e,r,n,i);break e}else for($n=Ls(e.stateNode.containerInfo.firstChild),Xn=e,st=!0,kr=null,n=VA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bu(),r===i){e=ts(t,e,n);break e}pn(t,e,r,n)}e=e.child}return e;case 5:return $A(e),t===null&&h_(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,o_(r,i)?o=null:s!==null&&o_(r,s)&&(e.flags|=32),vP(t,e),pn(t,e,o,n),e.child;case 6:return t===null&&h_(e),null;case 13:return xP(t,e,n);case 4:return Ox(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Su(e,null,r,n):pn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dr(r,i),Yw(t,e,r,i,n);case 7:return pn(t,e,e.pendingProps,n),e.child;case 8:return pn(t,e,e.pendingProps.children,n),e.child;case 12:return pn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,qe(np,r._currentValue),r._currentValue=o,s!==null)if(zr(s.value,o)){if(s.children===i.children&&!Dn.current){e=ts(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Xi(-1,n&-n),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var f=h.pending;f===null?c.next=c:(c.next=f.next,f.next=c),h.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),f_(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(j(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),f_(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}pn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,uu(e,n),i=xr(i),r=r(i),e.flags|=1,pn(t,e,r,n),e.child;case 14:return r=e.type,i=Dr(r,e.pendingProps),i=Dr(r.type,i),qw(t,e,r,i,n);case 15:return mP(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dr(r,i),yd(t,e),e.tag=1,On(r)?(t=!0,Jd(e)):t=!1,uu(e,n),fP(e,r,i),p_(e,r,i,n),v_(null,e,r,!0,t,n);case 19:return yP(t,e,n);case 22:return gP(t,e,n)}throw Error(j(156,e.tag))};function IP(t,e){return lA(t,e)}function jL(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(t,e,n,r){return new jL(t,e,n,r)}function Yx(t){return t=t.prototype,!(!t||!t.isReactComponent)}function WL(t){if(typeof t=="function")return Yx(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dx)return 11;if(t===px)return 14}return 2}function Hs(t,e){var n=t.alternate;return n===null?(n=pr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function wd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Yx(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ha:return Oo(n.children,i,s,e);case fx:o=8,i|=8;break;case Lv:return t=pr(12,n,e,i|2),t.elementType=Lv,t.lanes=s,t;case Nv:return t=pr(13,n,e,i),t.elementType=Nv,t.lanes=s,t;case Gv:return t=pr(19,n,e,i),t.elementType=Gv,t.lanes=s,t;case $E:return Zp(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case jE:o=10;break e;case WE:o=9;break e;case dx:o=11;break e;case px:o=14;break e;case Cs:o=16,r=null;break e}throw Error(j(130,t==null?t:typeof t,""))}return e=pr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Oo(t,e,n,r){return t=pr(7,t,r,e),t.lanes=n,t}function Zp(t,e,n,r){return t=pr(22,t,r,e),t.elementType=$E,t.lanes=n,t.stateNode={isHidden:!1},t}function z0(t,e,n){return t=pr(6,t,null,e),t.lanes=n,t}function H0(t,e,n){return e=pr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $L(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S0(0),this.expirationTimes=S0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S0(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qx(t,e,n,r,i,s,o,a,c){return t=new $L(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=pr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dx(s),t}function XL(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:za,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function UP(t){if(!t)return js;t=t._reactInternals;e:{if(Jo(t)!==t||t.tag!==1)throw Error(j(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(On(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(t.tag===1){var n=t.type;if(On(n))return UA(t,n,e)}return e}function LP(t,e,n,r,i,s,o,a,c){return t=qx(n,r,!0,t,i,s,o,a,c),t.context=UP(null),n=t.current,r=gn(),i=zs(n),s=Xi(r,i),s.callback=e??null,Ns(n,s,i),t.current.lanes=i,th(t,i,r),kn(t,r),t}function Jp(t,e,n,r){var i=e.current,s=gn(),o=zs(i);return n=UP(n),e.context===null?e.context=n:e.pendingContext=n,e=Xi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ns(i,e,o),t!==null&&(Ur(t,i,o,s),vd(t,i,o)),o}function fp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function aC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Kx(t,e){aC(t,e),(t=t.alternate)&&aC(t,e)}function YL(){return null}var NP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qx(t){this._internalRoot=t}em.prototype.render=Qx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(j(409));Jp(t,e,null,null)};em.prototype.unmount=Qx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;zo(function(){Jp(null,t,null,null)}),e[Ji]=null}};function em(t){this._internalRoot=t}em.prototype.unstable_scheduleHydration=function(t){if(t){var e=gA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<As.length&&e!==0&&e<As[n].priority;n++);As.splice(n,0,t),n===0&&_A(t)}};function Zx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function uC(){}function qL(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=fp(o);s.call(h)}}var o=LP(e,r,t,0,null,!1,!1,"",uC);return t._reactRootContainer=o,t[Ji]=o.current,vc(t.nodeType===8?t.parentNode:t),zo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var h=fp(c);a.call(h)}}var c=qx(t,0,!1,null,null,!1,!1,"",uC);return t._reactRootContainer=c,t[Ji]=c.current,vc(t.nodeType===8?t.parentNode:t),zo(function(){Jp(e,c,n,r)}),c}function nm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=fp(o);a.call(c)}}Jp(e,o,t,i)}else o=qL(n,e,t,i,r);return fp(o)}pA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ul(e.pendingLanes);n!==0&&(vx(e,n|1),kn(e,yt()),!(Be&6)&&(Tu=yt()+500,Qs()))}break;case 13:zo(function(){var r=es(t,1);if(r!==null){var i=gn();Ur(r,t,1,i)}}),Kx(t,1)}};_x=function(t){if(t.tag===13){var e=es(t,134217728);if(e!==null){var n=gn();Ur(e,t,134217728,n)}Kx(t,134217728)}};mA=function(t){if(t.tag===13){var e=zs(t),n=es(t,e);if(n!==null){var r=gn();Ur(n,t,e,r)}Kx(t,e)}};gA=function(){return He};vA=function(t,e){var n=He;try{return He=t,e()}finally{He=n}};Kv=function(t,e,n){switch(e){case"input":if(Vv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=$p(r);if(!i)throw Error(j(90));YE(r),Vv(r,i)}}}break;case"textarea":KE(t,n);break;case"select":e=n.value,e!=null&&iu(t,!!n.multiple,e,!1)}};rA=Wx;iA=zo;var KL={usingClientEntryPoint:!1,Events:[rh,$a,$p,tA,nA,Wx]},Cl={findFiberByHostInstance:Ao,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QL={bundleType:Cl.bundleType,version:Cl.version,rendererPackageName:Cl.rendererPackageName,rendererConfig:Cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:as.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=aA(t),t===null?null:t.stateNode},findFiberByHostInstance:Cl.findFiberByHostInstance||YL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kf.isDisabled&&kf.supportsFiber)try{Hp=kf.inject(QL),hi=kf}catch{}}Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KL;Qn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zx(e))throw Error(j(200));return XL(t,e,null,n)};Qn.createRoot=function(t,e){if(!Zx(t))throw Error(j(299));var n=!1,r="",i=NP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=qx(t,1,!1,null,null,n,!1,r,i),t[Ji]=e.current,vc(t.nodeType===8?t.parentNode:t),new Qx(e)};Qn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(j(188)):(t=Object.keys(t).join(","),Error(j(268,t)));return t=aA(e),t=t===null?null:t.stateNode,t};Qn.flushSync=function(t){return zo(t)};Qn.hydrate=function(t,e,n){if(!tm(e))throw Error(j(200));return nm(null,t,e,!0,n)};Qn.hydrateRoot=function(t,e,n){if(!Zx(t))throw Error(j(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=NP;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=LP(e,null,t,1,n??null,i,!1,s,o),t[Ji]=e.current,vc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new em(e)};Qn.render=function(t,e,n){if(!tm(e))throw Error(j(200));return nm(null,t,e,!1,n)};Qn.unmountComponentAtNode=function(t){if(!tm(t))throw Error(j(40));return t._reactRootContainer?(zo(function(){nm(null,null,t,!1,function(){t._reactRootContainer=null,t[Ji]=null})}),!0):!1};Qn.unstable_batchedUpdates=Wx;Qn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!tm(n))throw Error(j(200));if(t==null||t._reactInternals===void 0)throw Error(j(38));return nm(t,e,n,!1,r)};Qn.version="18.3.1-next-f1338f8080-20240426";function GP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(GP)}catch(t){console.error(t)}}GP(),NE.exports=Qn;var zP=NE.exports,HP,lC=zP;HP=lC.createRoot,lC.hydrateRoot;const ZL="modulepreload",JL=function(t){return"/"+t},cC={},Ec=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=Promise.allSettled(n.map(c=>{if(c=JL(c),c in cC)return;cC[c]=!0;const h=c.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":ZL,h||(p.as="script"),p.crossOrigin="",p.href=c,a&&p.setAttribute("nonce",a),document.head.appendChild(p),h)return new Promise((v,_)=>{p.addEventListener("load",v),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var P=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(P||{});const R_=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},Nl=(t,e)=>R_(t).priority??e,Ne={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(R_).forEach(e=>{e.type.forEach(n=>this._removeHandlers[n]?.(e))}),this},add(...t){return t.map(R_).forEach(e=>{e.type.forEach(n=>{const r=this._addHandlers,i=this._queue;r[n]?r[n]?.(e):(i[n]=i[n]||[],i[n]?.push(e))})}),this},handle(t,e,n){const r=this._addHandlers,i=this._removeHandlers;if(r[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);r[t]=e,i[t]=n;const s=this._queue;return s[t]&&(s[t]?.forEach(o=>e(o)),delete s[t]),this},handleByMap(t,e){return this.handle(t,n=>{n.name&&(e[n.name]=n.ref)},n=>{n.name&&delete e[n.name]})},handleByNamedList(t,e,n=-1){return this.handle(t,r=>{e.findIndex(s=>s.name===r.name)>=0||(e.push({name:r.name,value:r.ref}),e.sort((s,o)=>Nl(o.value,n)-Nl(s.value,n)))},r=>{const i=e.findIndex(s=>s.name===r.name);i!==-1&&e.splice(i,1)})},handleByList(t,e,n=-1){return this.handle(t,r=>{e.includes(r.ref)||(e.push(r.ref),e.sort((i,s)=>Nl(s,n)-Nl(i,n)))},r=>{const i=e.indexOf(r.ref);i!==-1&&e.splice(i,1)})}},VP={extension:{type:P.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Ec(()=>import("./browserAll-C9m4gVXq.js"),__vite__mapDeps([0,1]))}},jP={extension:{type:P.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Ec(()=>import("./webworkerAll-CwMkkGlD.js"),[])}};class xt{constructor(e,n,r){this._x=n||0,this._y=r||0,this._observer=e}clone(e){return new xt(e??this._observer,this._x,this._y)}set(e=0,n=e){return(this._x!==e||this._y!==n)&&(this._x=e,this._y=n,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var WP={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,h,f){this.fn=c,this.context=h,this.once=f||!1}function s(c,h,f,p,v){if(typeof f!="function")throw new TypeError("The listener must be a function");var _=new i(f,p||c,v),y=n?n+h:h;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],_]:c._events[y].push(_):(c._events[y]=_,c._eventsCount++),c}function o(c,h){--c._eventsCount===0?c._events=new r:delete c._events[h]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],f,p;if(this._eventsCount===0)return h;for(p in f=this._events)e.call(f,p)&&h.push(n?p.slice(1):p);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(f)):h},a.prototype.listeners=function(h){var f=n?n+h:h,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var v=0,_=p.length,y=new Array(_);v<_;v++)y[v]=p[v].fn;return y},a.prototype.listenerCount=function(h){var f=n?n+h:h,p=this._events[f];return p?p.fn?1:p.length:0},a.prototype.emit=function(h,f,p,v,_,y){var S=n?n+h:h;if(!this._events[S])return!1;var C=this._events[S],b=arguments.length,w,T;if(C.fn){switch(C.once&&this.removeListener(h,C.fn,void 0,!0),b){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,f),!0;case 3:return C.fn.call(C.context,f,p),!0;case 4:return C.fn.call(C.context,f,p,v),!0;case 5:return C.fn.call(C.context,f,p,v,_),!0;case 6:return C.fn.call(C.context,f,p,v,_,y),!0}for(T=1,w=new Array(b-1);T<b;T++)w[T-1]=arguments[T];C.fn.apply(C.context,w)}else{var A=C.length,M;for(T=0;T<A;T++)switch(C[T].once&&this.removeListener(h,C[T].fn,void 0,!0),b){case 1:C[T].fn.call(C[T].context);break;case 2:C[T].fn.call(C[T].context,f);break;case 3:C[T].fn.call(C[T].context,f,p);break;case 4:C[T].fn.call(C[T].context,f,p,v);break;default:if(!w)for(M=1,w=new Array(b-1);M<b;M++)w[M-1]=arguments[M];C[T].fn.apply(C[T].context,w)}}return!0},a.prototype.on=function(h,f,p){return s(this,h,f,p,!1)},a.prototype.once=function(h,f,p){return s(this,h,f,p,!0)},a.prototype.removeListener=function(h,f,p,v){var _=n?n+h:h;if(!this._events[_])return this;if(!f)return o(this,_),this;var y=this._events[_];if(y.fn)y.fn===f&&(!v||y.once)&&(!p||y.context===p)&&o(this,_);else{for(var S=0,C=[],b=y.length;S<b;S++)(y[S].fn!==f||v&&!y[S].once||p&&y[S].context!==p)&&C.push(y[S]);C.length?this._events[_]=C.length===1?C[0]:C:o(this,_)}return this},a.prototype.removeAllListeners=function(h){var f;return h?(f=n?n+h:h,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(WP);var e6=WP.exports;const Mt=Jc(e6),$P=Math.PI*2,XP=180/Math.PI,Ho=Math.PI/180;class ze{constructor(e=0,n=0){this.x=0,this.y=0,this.x=e,this.y=n}clone(){return new ze(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,n=e){return this.x=e,this.y=n,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return V0.x=0,V0.y=0,V0}}const V0=new ze;class ae{constructor(e=1,n=0,r=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,n,r,i,s,o){return this.a=e,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o,this}toArray(e,n){this.array||(this.array=new Float32Array(9));const r=n||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,n){n=n||new ze;const r=e.x,i=e.y;return n.x=this.a*r+this.c*i+this.tx,n.y=this.b*r+this.d*i+this.ty,n}applyInverse(e,n){n=n||new ze;const r=this.a,i=this.b,s=this.c,o=this.d,a=this.tx,c=this.ty,h=1/(r*o+s*-i),f=e.x,p=e.y;return n.x=o*h*f+-s*h*p+(c*s-a*o)*h,n.y=r*h*p+-i*h*f+(-c*r+a*i)*h,n}translate(e,n){return this.tx+=e,this.ty+=n,this}scale(e,n){return this.a*=e,this.d*=n,this.c*=e,this.b*=n,this.tx*=e,this.ty*=n,this}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*n-this.b*r,this.b=i*r+this.b*n,this.c=s*n-this.d*r,this.d=s*r+this.d*n,this.tx=o*n-this.ty*r,this.ty=o*r+this.ty*n,this}append(e){const n=this.a,r=this.b,i=this.c,s=this.d;return this.a=e.a*n+e.b*i,this.b=e.a*r+e.b*s,this.c=e.c*n+e.d*i,this.d=e.c*r+e.d*s,this.tx=e.tx*n+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*s+this.ty,this}appendFrom(e,n){const r=e.a,i=e.b,s=e.c,o=e.d,a=e.tx,c=e.ty,h=n.a,f=n.b,p=n.c,v=n.d;return this.a=r*h+i*p,this.b=r*f+i*v,this.c=s*h+o*p,this.d=s*f+o*v,this.tx=a*h+c*p+n.tx,this.ty=a*f+c*v+n.ty,this}setTransform(e,n,r,i,s,o,a,c,h){return this.a=Math.cos(a+h)*s,this.b=Math.sin(a+h)*s,this.c=-Math.sin(a-c)*o,this.d=Math.cos(a-c)*o,this.tx=e-(r*this.a+i*this.c),this.ty=n-(r*this.b+i*this.d),this}prepend(e){const n=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const r=this.a,i=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this}decompose(e){const n=this.a,r=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),c=Math.atan2(r,n),h=Math.abs(a+c);return h<1e-5||Math.abs($P-h)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=c),e.scale.x=Math.sqrt(n*n+r*r),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*n+o.y*i),e.position.y=this.ty+(o.x*r+o.y*s),e}invert(){const e=this.a,n=this.b,r=this.c,i=this.d,s=this.tx,o=e*i-n*r;return this.a=i/o,this.b=-n/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-i*s)/o,this.ty=-(e*this.ty-n*s)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ae;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return n6.identity()}static get shared(){return t6.identity()}}const t6=new ae,n6=new ae,yo=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],bo=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],So=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],wo=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],B_=[],YP=[],Ff=Math.sign;function r6(){for(let t=0;t<16;t++){const e=[];B_.push(e);for(let n=0;n<16;n++){const r=Ff(yo[t]*yo[n]+So[t]*bo[n]),i=Ff(bo[t]*yo[n]+wo[t]*bo[n]),s=Ff(yo[t]*So[n]+So[t]*wo[n]),o=Ff(bo[t]*So[n]+wo[t]*wo[n]);for(let a=0;a<16;a++)if(yo[a]===r&&bo[a]===i&&So[a]===s&&wo[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new ae;e.set(yo[t],bo[t],So[t],wo[t],0,0),YP.push(e)}}r6();const we={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>yo[t],uY:t=>bo[t],vX:t=>So[t],vY:t=>wo[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>B_[t][e],sub:(t,e)=>B_[t][we.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?we.S:we.N:Math.abs(e)*2<=Math.abs(t)?t>0?we.E:we.W:e>0?t>0?we.SE:we.SW:t>0?we.NE:we.NW,matrixAppendRotationInv:(t,e,n=0,r=0)=>{const i=YP[we.inv(e)];i.tx=n,i.ty=r,t.append(i)}},If=[new ze,new ze,new ze,new ze];let Ke=class Cd{constructor(e=0,n=0,r=0,i=0){this.type="rectangle",this.x=Number(e),this.y=Number(n),this.width=Number(r),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Cd(0,0,0,0)}clone(){return new Cd(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,n){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height}strokeContains(e,n,r){const{width:i,height:s}=this;if(i<=0||s<=0)return!1;const o=this.x,a=this.y,c=o-r/2,h=o+i+r/2,f=a-r/2,p=a+s+r/2,v=o+r/2,_=o+i-r/2,y=a+r/2,S=a+s-r/2;return e>=c&&e<=h&&n>=f&&n<=p&&!(e>v&&e<_&&n>y&&n<S)}intersects(e,n){if(!n){const N=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=N)return!1;const G=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>G}const r=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=r||o<=s)return!1;const a=If[0].set(e.left,e.top),c=If[1].set(e.left,e.bottom),h=If[2].set(e.right,e.top),f=If[3].set(e.right,e.bottom);if(h.x<=a.x||c.y<=a.y)return!1;const p=Math.sign(n.a*n.d-n.b*n.c);if(p===0||(n.apply(a,a),n.apply(c,c),n.apply(h,h),n.apply(f,f),Math.max(a.x,c.x,h.x,f.x)<=r||Math.min(a.x,c.x,h.x,f.x)>=i||Math.max(a.y,c.y,h.y,f.y)<=s||Math.min(a.y,c.y,h.y,f.y)>=o))return!1;const v=p*(c.y-a.y),_=p*(a.x-c.x),y=v*r+_*s,S=v*i+_*s,C=v*r+_*o,b=v*i+_*o;if(Math.max(y,S,C,b)<=v*a.x+_*a.y||Math.min(y,S,C,b)>=v*f.x+_*f.y)return!1;const w=p*(a.y-h.y),T=p*(h.x-a.x),A=w*r+T*s,M=w*i+T*s,L=w*r+T*o,I=w*i+T*o;return!(Math.max(A,M,L,I)<=w*a.x+T*a.y||Math.min(A,M,L,I)>=w*f.x+T*f.y)}pad(e=0,n=e){return this.x-=e,this.y-=n,this.width+=e*2,this.height+=n*2,this}fit(e){const n=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=n,this.width=Math.max(r-n,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,n=.001){const r=Math.ceil((this.x+this.width-n)*e)/e,i=Math.ceil((this.y+this.height-n)*e)/e;return this.x=Math.floor((this.x+n)*e)/e,this.y=Math.floor((this.y+n)*e)/e,this.width=r-this.x,this.height=i-this.y,this}enlarge(e){const n=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=n,this.width=r-n,this.y=i,this.height=s-i,this}getBounds(e){return e=e||new Cd,e.copyFrom(this),e}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};const Jl={default:-1};function ot(t="default"){return Jl[t]===void 0&&(Jl[t]=-1),++Jl[t]}function i6(){for(const t in Jl)delete Jl[t]}const hC={},ge="8.0.0",qP="8.3.4";function q(t,e,n=3){if(hC[e])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(r=r.split(`
`).splice(n).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(r))),hC[e]=!0}const Jx=()=>{};function Vo(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function M_(t){return!(t&t-1)&&!!t}function s6(t){let e=(t>65535?1:0)<<4;t>>>=e;let n=(t>255?1:0)<<3;return t>>>=n,e|=n,n=(t>15?1:0)<<2,t>>>=n,e|=n,n=(t>3?1:0)<<1,t>>>=n,e|=n,e|t>>1}function Si(t){const e={};for(const n in t)t[n]!==void 0&&(e[n]=t[n]);return e}const fC=Object.create(null);function o6(t){const e=fC[t];return e===void 0&&(fC[t]=ot("resource")),e}const KP=class QP extends Mt{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...QP.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){q(ge,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=o6(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};KP.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let ZP=KP;const JP=class e4 extends Mt{constructor(e={}){super(),this.options=e,this.uid=ot("textureSource"),this._resourceType="textureSource",this._resourceId=ot("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...e4.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new ZP(Si(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=ot("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,n,r){r=r||this._resolution,e=e||this.width,n=n||this.height;const i=Math.round(e*r),s=Math.round(n*r);return this.width=i/r,this.height=s/r,this._resolution=r,this.pixelWidth===i&&this.pixelHeight===s?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=s,this.emit("resize",this),this._resourceId=ot("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=M_(this.pixelWidth)&&M_(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};JP.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let dt=JP;class rm extends dt{constructor(e){const n=e.resource||new Float32Array(e.width*e.height*4);let r=e.format;r||(n instanceof Float32Array?r="rgba32float":n instanceof Int32Array||n instanceof Uint32Array?r="rgba32uint":n instanceof Int16Array||n instanceof Uint16Array?r="rgba16uint":(n instanceof Int8Array,r="bgra8unorm")),super({...e,resource:n,format:r}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}rm.extension=P.TextureSource;const dC=new ae;class ey{constructor(e,n){this.mapCoord=new ae,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof n>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=n,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,n){n===void 0&&(n=e);const r=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];n[i]=s*r.a+o*r.c+r.tx,n[i+1]=s*r.b+o*r.d+r.ty}return n}update(){const e=this._texture;this._updateID++;const n=e.uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const r=e.orig,i=e.trim;i&&(dC.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(dC));const s=e.source,o=this.uClampFrame,a=this.clampMargin/s._resolution,c=this.clampOffset/s._resolution;return o[0]=(e.frame.x+a+c)/s.width,o[1]=(e.frame.y+a+c)/s.height,o[2]=(e.frame.x+e.frame.width-a+c)/s.width,o[3]=(e.frame.y+e.frame.height-a+c)/s.height,this.uClampOffset[0]=this.clampOffset/s.pixelWidth,this.uClampOffset[1]=this.clampOffset/s.pixelHeight,this.isSimple=e.frame.width===s.width&&e.frame.height===s.height&&e.rotate===0,!0}}class X extends Mt{constructor({source:e,label:n,frame:r,orig:i,trim:s,defaultAnchor:o,defaultBorders:a,rotate:c,dynamic:h}={}){if(super(),this.uid=ot("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Ke,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=n,this.source=e?.source??new dt,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:f,height:p}=this._source;this.frame.width=f,this.frame.height=p}this.orig=i||this.frame,this.trim=s,this.rotate=c??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=h||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ey(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:n}=this,{width:r,height:i}=this._source,s=n.x/r,o=n.y/i,a=n.width/r,c=n.height/i;let h=this.rotate;if(h){const f=a/2,p=c/2,v=s+f,_=o+p;h=we.add(h,we.NW),e.x0=v+f*we.uX(h),e.y0=_+p*we.uY(h),h=we.add(h,2),e.x1=v+f*we.uX(h),e.y1=_+p*we.uY(h),h=we.add(h,2),e.x2=v+f*we.uX(h),e.y2=_+p*we.uY(h),h=we.add(h,2),e.x3=v+f*we.uX(h),e.y3=_+p*we.uY(h)}else e.x0=s,e.y0=o,e.x1=s+a,e.y1=o,e.x2=s+a,e.y2=o+c,e.x3=s,e.y3=o+c}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return q(ge,"Texture.baseTexture is now Texture.source"),this._source}}X.EMPTY=new X({label:"EMPTY",source:new dt({label:"EMPTY"})});X.EMPTY.destroy=Jx;X.WHITE=new X({source:new rm({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});X.WHITE.destroy=Jx;function Ac(t,e,n,r){const{width:i,height:s}=n.orig,o=n.trim;if(o){const a=o.width,c=o.height;t.minX=o.x-e._x*i-r,t.maxX=t.minX+a,t.minY=o.y-e._y*s-r,t.maxY=t.minY+c}else t.minX=-e._x*i-r,t.maxX=t.minX+i,t.minY=-e._y*s-r,t.maxY=t.minY+s}const pC=new ae;class Kt{constructor(e=1/0,n=1/0,r=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=pC,this.minX=e,this.minY=n,this.maxX=r,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Ke);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=pC,this}set(e,n,r,i){this.minX=e,this.minY=n,this.maxX=r,this.maxY=i}addFrame(e,n,r,i,s){s||(s=this.matrix);const o=s.a,a=s.b,c=s.c,h=s.d,f=s.tx,p=s.ty;let v=this.minX,_=this.minY,y=this.maxX,S=this.maxY,C=o*e+c*n+f,b=a*e+h*n+p;C<v&&(v=C),b<_&&(_=b),C>y&&(y=C),b>S&&(S=b),C=o*r+c*n+f,b=a*r+h*n+p,C<v&&(v=C),b<_&&(_=b),C>y&&(y=C),b>S&&(S=b),C=o*e+c*i+f,b=a*e+h*i+p,C<v&&(v=C),b<_&&(_=b),C>y&&(y=C),b>S&&(S=b),C=o*r+c*i+f,b=a*r+h*i+p,C<v&&(v=C),b<_&&(_=b),C>y&&(y=C),b>S&&(S=b),this.minX=v,this.minY=_,this.maxX=y,this.maxY=S}addRect(e,n){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,n)}addBounds(e,n){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,n)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const n=this.minX,r=this.minY,i=this.maxX,s=this.maxY,{a:o,b:a,c,d:h,tx:f,ty:p}=e;let v=o*n+c*r+f,_=a*n+h*r+p;this.minX=v,this.minY=_,this.maxX=v,this.maxY=_,v=o*i+c*r+f,_=a*i+h*r+p,this.minX=v<this.minX?v:this.minX,this.minY=_<this.minY?_:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=_>this.maxY?_:this.maxY,v=o*n+c*s+f,_=a*n+h*s+p,this.minX=v<this.minX?v:this.minX,this.minY=_<this.minY?_:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=_>this.maxY?_:this.maxY,v=o*i+c*s+f,_=a*i+h*s+p,this.minX=v<this.minX?v:this.minX,this.minY=_<this.minY?_:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=_>this.maxY?_:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,n,r,i){return this.minX<e&&(this.minX=e),this.maxX>n&&(this.maxX=n),this.minY<r&&(this.minY=r),this.maxY>i&&(this.maxY=i),this}pad(e,n=e){return this.minX-=e,this.maxX+=e,this.minY-=n,this.maxY+=n,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Kt(this.minX,this.minY,this.maxX,this.maxY)}scale(e,n=e){return this.minX*=e,this.minY*=n,this.maxX*=e,this.maxY*=n,this}get x(){return this.minX}set x(e){const n=this.maxX-this.minX;this.minX=e,this.maxX=e+n}get y(){return this.minY}set y(e){const n=this.maxY-this.minY;this.minY=e,this.maxY=e+n}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,n,r,i){let s=this.minX,o=this.minY,a=this.maxX,c=this.maxY;i||(i=this.matrix);const h=i.a,f=i.b,p=i.c,v=i.d,_=i.tx,y=i.ty;for(let S=n;S<r;S+=2){const C=e[S],b=e[S+1],w=h*C+p*b+_,T=f*C+v*b+y;s=w<s?w:s,o=T<o?T:o,a=w>a?w:a,c=T>c?T:c}this.minX=s,this.minY=o,this.maxX=a,this.maxY=c}containsPoint(e,n){return this.minX<=e&&this.minY<=n&&this.maxX>=e&&this.maxY>=n}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}var a6={grad:.9,turn:360,rad:360/(2*Math.PI)},Ui=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Nt=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},mr=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),t>n?n:t>e?t:e},t4=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},mC=function(t){return{r:mr(t.r,0,255),g:mr(t.g,0,255),b:mr(t.b,0,255),a:mr(t.a)}},j0=function(t){return{r:Nt(t.r),g:Nt(t.g),b:Nt(t.b),a:Nt(t.a,3)}},u6=/^#([0-9a-f]{3,8})$/i,Uf=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},n4=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},r4=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var s=Math.floor(e),o=r*(1-n),a=r*(1-(e-s)*n),c=r*(1-(1-e+s)*n),h=s%6;return{r:255*[r,a,o,o,c,r][h],g:255*[c,r,r,a,o,o][h],b:255*[o,o,c,r,r,a][h],a:i}},gC=function(t){return{h:t4(t.h),s:mr(t.s,0,100),l:mr(t.l,0,100),a:mr(t.a)}},vC=function(t){return{h:Nt(t.h),s:Nt(t.s),l:Nt(t.l),a:Nt(t.a,3)}},_C=function(t){return r4((n=(e=t).s,{h:e.h,s:(n*=((r=e.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:e.a}));var e,n,r},ec=function(t){return{h:(e=n4(t)).h,s:(i=(200-(n=e.s))*(r=e.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,r,i},l6=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,c6=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,h6=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,f6=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,D_={string:[[function(t){var e=u6.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Nt(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Nt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=h6.exec(t)||f6.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:mC({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=l6.exec(t)||c6.exec(t);if(!e)return null;var n,r,i=gC({h:(n=e[1],r=e[2],r===void 0&&(r="deg"),Number(n)*(a6[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return _C(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=i===void 0?1:i;return Ui(e)&&Ui(n)&&Ui(r)?mC({r:Number(e),g:Number(n),b:Number(r),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,n=t.s,r=t.l,i=t.a,s=i===void 0?1:i;if(!Ui(e)||!Ui(n)||!Ui(r))return null;var o=gC({h:Number(e),s:Number(n),l:Number(r),a:Number(s)});return _C(o)},"hsl"],[function(t){var e=t.h,n=t.s,r=t.v,i=t.a,s=i===void 0?1:i;if(!Ui(e)||!Ui(n)||!Ui(r))return null;var o=function(a){return{h:t4(a.h),s:mr(a.s,0,100),v:mr(a.v,0,100),a:mr(a.a)}}({h:Number(e),s:Number(n),v:Number(r),a:Number(s)});return r4(o)},"hsv"]]},xC=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0](t);if(r)return[r,e[n][1]]}return[null,void 0]},d6=function(t){return typeof t=="string"?xC(t.trim(),D_.string):typeof t=="object"&&t!==null?xC(t,D_.object):[null,void 0]},W0=function(t,e){var n=ec(t);return{h:n.h,s:mr(n.s+100*e,0,100),l:n.l,a:n.a}},$0=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},yC=function(t,e){var n=ec(t);return{h:n.h,s:n.s,l:mr(n.l+100*e,0,100),a:n.a}},O_=function(){function t(e){this.parsed=d6(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Nt($0(this.rgba),2)},t.prototype.isDark=function(){return $0(this.rgba)<.5},t.prototype.isLight=function(){return $0(this.rgba)>=.5},t.prototype.toHex=function(){return e=j0(this.rgba),n=e.r,r=e.g,i=e.b,o=(s=e.a)<1?Uf(Nt(255*s)):"","#"+Uf(n)+Uf(r)+Uf(i)+o;var e,n,r,i,s,o},t.prototype.toRgb=function(){return j0(this.rgba)},t.prototype.toRgbString=function(){return e=j0(this.rgba),n=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+n+", "+r+", "+i+", "+s+")":"rgb("+n+", "+r+", "+i+")";var e,n,r,i,s},t.prototype.toHsl=function(){return vC(ec(this.rgba))},t.prototype.toHslString=function(){return e=vC(ec(this.rgba)),n=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+n+", "+r+"%, "+i+"%, "+s+")":"hsl("+n+", "+r+"%, "+i+"%)";var e,n,r,i,s},t.prototype.toHsv=function(){return e=n4(this.rgba),{h:Nt(e.h),s:Nt(e.s),v:Nt(e.v),a:Nt(e.a,3)};var e},t.prototype.invert=function(){return ri({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),ri(W0(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),ri(W0(this.rgba,-e))},t.prototype.grayscale=function(){return ri(W0(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),ri(yC(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),ri(yC(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?ri({r:(n=this.rgba).r,g:n.g,b:n.b,a:e}):Nt(this.rgba.a,3);var n},t.prototype.hue=function(e){var n=ec(this.rgba);return typeof e=="number"?ri({h:e,s:n.s,l:n.l,a:n.a}):Nt(n.h)},t.prototype.isEqual=function(e){return this.toHex()===ri(e).toHex()},t}(),ri=function(t){return t instanceof O_?t:new O_(t)},bC=[],p6=function(t){t.forEach(function(e){bC.indexOf(e)<0&&(e(O_,D_),bC.push(e))})};function m6(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,c,h=r[this.toHex()];if(h)return h;if(o?.closest){var f=this.toRgb(),p=1/0,v="black";if(!s.length)for(var _ in n)s[_]=new t(n[_]).toRgb();for(var y in n){var S=(a=f,c=s[y],Math.pow(a.r-c.r,2)+Math.pow(a.g-c.g,2)+Math.pow(a.b-c.b,2));S<p&&(p=S,v=y)}return v}},e.string.push([function(o){var a=o.toLowerCase(),c=a==="transparent"?"#0000":n[a];return c?new t(c).toRgb():null},"name"])}p6([m6]);const Eu=class Gl{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Gl)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,n){const r=typeof e;if(r!==typeof n)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===n;if(Array.isArray(e)&&Array.isArray(n)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(n))return e.length!==n.length?!1:e.every((s,o)=>s===n[o]);if(e!==null&&n!==null){const s=Object.keys(e),o=Object.keys(n);return s.length!==o.length?!1:s.every(a=>e[a]===n[a])}return e===n}toRgba(){const[e,n,r,i]=this._components;return{r:e,g:n,b:r,a:i}}toRgb(){const[e,n,r]=this._components;return{r:e,g:n,b:r}}toRgbaString(){const[e,n,r]=this.toUint8RgbArray();return`rgba(${e},${n},${r},${this.alpha})`}toUint8RgbArray(e){const[n,r,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb,e[0]=Math.round(n*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e=e||this._arrayRgba;const[n,r,i,s]=this._components;return e[0]=n,e[1]=r,e[2]=i,e[3]=s,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb;const[n,r,i]=this._components;return e[0]=n,e[1]=r,e[2]=i,e}toNumber(){return this._int}toBgrNumber(){const[e,n,r]=this.toUint8RgbArray();return(r<<16)+(n<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[n,r,i,s]=Gl._temp.setValue(e)._components;return this._components[0]*=n,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this._refreshInt(),this._value=null,this}premultiply(e,n=!0){return n&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,n=!0){if(e===1)return(255<<24)+this._int;if(e===0)return n?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return n&&(r=r*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(r<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const n=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-n.length)+n}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let n,r,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;n=(o>>16&255)/255,r=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[n,r,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[n,r,i,s=255]=e,n/=255,r/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Gl.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=ri(e);o.isValid()&&({r:n,g:r,b:i,a:s}=o.rgba,n/=255,r/=255,i/=255)}if(n!==void 0)this._components[0]=n,this._components[1]=r,this._components[2]=i,this._components[3]=s,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,n,r]=this._components;this._int=(e*255<<16)+(n*255<<8)+(r*255|0)}_clamp(e,n=0,r=1){return typeof e=="number"?Math.min(Math.max(e,n),r):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,n),r)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Gl||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Eu.shared=new Eu;Eu._temp=new Eu;Eu.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ve=Eu;const i4={cullArea:null,cullable:!1,cullableChildren:!0};class im{constructor(e,n){this._pool=[],this._count=0,this._index=0,this._classType=e,n&&this.prepopulate(n)}prepopulate(e){for(let n=0;n<e;n++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let n;return this._index>0?n=this._pool[--this._index]:n=new this._classType,n.init?.(e),n}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class s4{constructor(){this._poolsByClass=new Map}prepopulate(e,n){this.getPool(e).prepopulate(n)}get(e,n){return this.getPool(e).get(n)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new im(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(n=>{const r=e[n._classType.name]?n._classType.name+n._classType.ID:n._classType.name;e[r]={free:n.totalFree,used:n.totalUsed,size:n.totalSize}}),e}}const Ae=new s4;function ty(t,e,n){const r=t.length;let i;if(e>=r||n===0)return;n=e+n>r?r-e:n;const s=r-n;for(i=e;i<s;++i)t[i]=t[i+n];t.length=s}const o4={allowChildren:!0,removeChildren(t=0,e){const n=e??this.children.length,r=n-t,i=[];if(r>0&&r<=n){for(let o=n-1;o>=t;o--){const a=this.children[o];a&&(i.push(a),a.parent=null)}ty(this.children,t,n);const s=this.renderGroup||this.parentRenderGroup;s&&s.removeChildren(i);for(let o=0;o<i.length;++o)this.emit("childRemoved",i[o],this,o),i[o].emit("removed",this);return i}else if(r===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const e=this.getChildAt(t);return this.removeChild(e)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,e)},getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(t,e){this.allowChildren||q(ge,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:n}=this;if(e<0||e>n.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${n.length}`);if(t.parent){const i=t.parent.children.indexOf(t);if(t.parent===this&&i===e)return t;i!==-1&&t.parent.children.splice(i,1)}e===n.length?n.push(t):n.splice(e,0,t),t.parent=this,t.didChange=!0,t.didViewUpdate=!1,t._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,e),t.emit("added",this),t},swapChildren(t,e){if(t===e)return;const n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...t){return t.length===1?this.reparentChildAt(t[0],this.children.length):(t.forEach(e=>this.reparentChildAt(e,this.children.length)),t[0])},reparentChildAt(t,e){if(t.parent===this)return this.setChildIndex(t,e),t;const n=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,e);const r=this.worldTransform.clone();return r.invert(),n.prepend(r),t.setFromMatrix(n),t}};class Pc{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class a4{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let n=0;n<this._tests.length;n++){const r=this._tests[n];if(r.test(e))return Ae.get(r.maskClass,e)}return e}returnMaskEffect(e){Ae.return(e)}}const dp=new a4;Ne.handleByList(P.MaskEffect,dp._effectClasses);const u4={_maskEffect:null,_filterEffect:null,effects:[],addEffect(t){if(this.effects.indexOf(t)!==-1)return;this.effects.push(t),this.effects.sort((r,i)=>r.priority-i.priority);const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._updateIsSimple()},removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(t){const e=this._maskEffect;e?.mask!==t&&(e&&(this.removeEffect(e),dp.returnMaskEffect(e),this._maskEffect=null),t!=null&&(this._maskEffect=dp.getMaskEffect(t),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},set filters(t){!Array.isArray(t)&&t&&(t=[t]);const e=this._filterEffect||(this._filterEffect=new Pc);t=t;const n=t?.length>0,r=e.filters?.length>0,i=n!==r;t=Array.isArray(t)?t.slice(0):t,e.filters=Object.freeze(t),i&&(n?this.addEffect(e):(this.removeEffect(e),e.filters=t??null))},get filters(){return this._filterEffect?.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new Pc),this._filterEffect.filterArea=t},get filterArea(){return this._filterEffect?.filterArea}},l4={label:null,get name(){return q(ge,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){q(ge,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,e=!1){return this.getChildByLabel(t,e)},getChildByLabel(t,e=!1){const n=this.children;for(let r=0;r<n.length;r++){const i=n[r];if(i.label===t||t instanceof RegExp&&t.test(i.label))return i}if(e)for(let r=0;r<n.length;r++){const s=n[r].getChildByLabel(t,!0);if(s)return s}return null},getChildrenByLabel(t,e=!1,n=[]){const r=this.children;for(let i=0;i<r.length;i++){const s=r[i];(s.label===t||t instanceof RegExp&&t.test(s.label))&&n.push(s)}if(e)for(let i=0;i<r.length;i++)r[i].getChildrenByLabel(t,!0,n);return n}},di=new im(ae),pi=new im(Kt);function sh(t,e,n){n.clear();let r,i;return t.parent?e?r=t.parent.worldTransform:(i=di.get().identity(),r=Rc(t,i)):r=ae.IDENTITY,ny(t,n,r,e),i&&di.return(i),n.isValid||n.set(0,0,0,0),n}function ny(t,e,n,r){if(!t.visible||!t.measurable)return;let i;r?i=t.worldTransform:(t.updateLocalTransform(),i=di.get(),i.appendFrom(t.localTransform,n));const s=e,o=!!t.effects.length;if(o&&(e=pi.get().clear()),t.boundsArea)e.addRect(t.boundsArea,i);else{t.addBounds&&(e.matrix=i,t.addBounds(e));for(let a=0;a<t.children.length;a++)ny(t.children[a],e,i,r)}if(o){for(let a=0;a<t.effects.length;a++)t.effects[a].addBounds?.(e);s.addBounds(e,ae.IDENTITY),pi.return(e)}r||di.return(i)}function Rc(t,e){const n=t.parent;return n&&(Rc(n,e),n.updateLocalTransform(),e.append(n.localTransform)),e}let X0=0;const SC=500;function de(...t){X0!==SC&&(X0++,X0===SC?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}function sm(t,e,n){return e.clear(),n||(n=ae.IDENTITY),c4(t,e,n,t,!0),e.isValid||e.set(0,0,0,0),e}function c4(t,e,n,r,i){let s;if(i)s=di.get(),s=n.copyTo(s);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const c=t.localTransform;s=di.get(),s.appendFrom(c,n)}const o=e,a=!!t.effects.length;if(a&&(e=pi.get().clear()),t.boundsArea)e.addRect(t.boundsArea,s);else{t.renderPipeId&&(e.matrix=s,t.addBounds(e));const c=t.children;for(let h=0;h<c.length;h++)c4(c[h],e,s,r,!1)}if(a){for(let c=0;c<t.effects.length;c++)t.effects[c].addLocalBounds?.(e,r);o.addBounds(e,ae.IDENTITY),pi.return(e)}di.return(s)}function h4(t,e,n){const r=t.parent;if(!r){de("Item is not inside the root container");return}r!==e&&(h4(r,e,n),r.updateLocalTransform(),n.append(r.localTransform))}function ry(t,e){const n=t.children;for(let r=0;r<n.length;r++){const i=n[r],s=i.uid,o=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,a=e.index;(e.data[a]!==s||e.data[a+1]!==o)&&(e.data[e.index]=s,e.data[e.index+1]=o,e.didChange=!0),e.index=a+2,i.children.length&&ry(i,e)}return e.didChange}const g6=new ae,f4={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,e){const n=Math.sign(this.scale.x)||1;e!==0?this.scale.x=t/e*n:this.scale.x=n},_setHeight(t,e){const n=Math.sign(this.scale.y)||1;e!==0?this.scale.y=t/e*n:this.scale.y=n},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Kt});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),ry(this,t),t.didChange&&sm(this,t.localBounds,g6),t.localBounds},getBounds(t,e){return sh(this,t,e||new Kt)}},d4={_onRender:null,set onRender(t){const e=this.renderGroup||this.parentRenderGroup;if(!t){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},p4={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(v6))}};function v6(t,e){return t._zIndex-e._zIndex}const m4={getGlobalPosition(t=new ze,e=!1){return this.parent?this.parent.toGlobal(this._position,t,e):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,e,n=!1){if(!n){this.updateLocalTransform();const r=Rc(this,new ae);return r.append(this.localTransform),r.apply(t,e)}return this.worldTransform.apply(t,e)},toLocal(t,e,n,r){if(e&&(t=e.toGlobal(t,n,r)),!r){this.updateLocalTransform();const i=Rc(this,new ae);return i.append(this.localTransform),i.applyInverse(t,n)}return this.worldTransform.applyInverse(t,n)}};let _6=0;class iy{constructor(){this.uid=ot("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=_6++}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class g4{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new ae,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new iy,this._onRenderContainers=[]}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const n=e.children;for(let r=0;r<n.length;r++)this.addChild(n[r])}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const n=this.childrenToUpdate[e];n.list.fill(null),n.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const n=this.renderGroupChildren.indexOf(e);n>-1&&this.renderGroupChildren.splice(n,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const n=e.children;for(let r=0;r<n.length;r++)this.addChild(n[r])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const n=e.children;for(let r=0;r<n.length;r++)this.removeChild(n[r])}removeChildren(e){for(let n=0;n<e.length;n++)this.removeChild(e[n])}onChildUpdate(e){let n=this.childrenToUpdate[e.relativeRenderGroupDepth];n||(n=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),n.list[n.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(e.didViewUpdate=!1,this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e))}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender()}destroy(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const n=this.root.children;for(let r=0;r<n.length;r++)this._getChildren(n[r],e);return e}_getChildren(e,n=[]){if(n.push(e),e.renderGroup)return n;const r=e.children;for(let i=0;i<r.length;i++)this._getChildren(r[i],n);return n}}function v4(t,e,n={}){for(const r in e)!n[r]&&e[r]!==void 0&&(t[r]=e[r])}const Y0=new xt(null),q0=new xt(null),K0=new xt(null,1,1),Bc=1,om=2,cu=4,x6=8;class $e extends Mt{constructor(e={}){super(),this.uid=ot("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new ae,this.relativeGroupTransform=new ae,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new xt(this,0,0),this._scale=K0,this._pivot=q0,this._skew=Y0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],v4(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(n=>this.addChild(n)),e.parent?.addChild(this)}static mixin(e){Object.defineProperties($e.prototype,Object.getOwnPropertyDescriptors(e))}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||q(ge,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let i=0;i<e.length;i++)this.addChild(e[i]);return e[0]}const n=e[0];if(n.parent===this)return this.children.splice(this.children.indexOf(n),1),this.children.push(n),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),n;n.parent&&n.parent.removeChild(n),this.children.push(n),this.sortableChildren&&(this.sortDirty=!0),n.parent=this,n.didChange=!0,n.didViewUpdate=!1,n._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(n),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this),this._didViewChangeTick++,n._zIndex!==0&&n.depthOfChildModified(),n}removeChild(...e){if(e.length>1){for(let i=0;i<e.length;i++)this.removeChild(e[i]);return e[0]}const n=e[0],r=this.children.indexOf(n);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(n):this.parentRenderGroup&&this.parentRenderGroup.removeChild(n),n.parent=null,this.emit("childRemoved",n,this,r),n.emit("removed",this)),n}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Ae.get(g4,this),this.groupTransform=ae.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Ae.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new ae),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*XP}set angle(e){this.rotation=e*Ho}get pivot(){return this._pivot===q0&&(this._pivot=new xt(this,0,0)),this._pivot}set pivot(e){this._pivot===q0&&(this._pivot=new xt(this,0,0)),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Y0&&(this._skew=new xt(this,0,0)),this._skew}set skew(e){this._skew===Y0&&(this._skew=new xt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===K0&&(this._scale=new xt(this,1,1)),this._scale}set scale(e){this._scale===K0&&(this._scale=new xt(this,0,0)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const n=this.getLocalBounds().width;this._setWidth(e,n)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const n=this.getLocalBounds().height;this._setHeight(e,n)}getSize(e){e||(e={});const n=this.getLocalBounds();return e.width=Math.abs(this.scale.x*n.width),e.height=Math.abs(this.scale.y*n.height),e}setSize(e,n){const r=this.getLocalBounds();typeof e=="object"?(n=e.height??e.width,e=e.width):n??(n=e),e!==void 0&&this._setWidth(e,r.width),n!==void 0&&this._setHeight(n,r.height)}_updateSkew(){const e=this._rotation,n=this._skew;this._cx=Math.cos(e+n._y),this._sx=Math.sin(e+n._y),this._cy=-Math.sin(e-n._x),this._sy=Math.cos(e-n._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const n=this.localTransform,r=this._scale,i=this._pivot,s=this._position,o=r._x,a=r._y,c=i._x,h=i._y;n.a=this._cx*o,n.b=this._sx*o,n.c=this._cy*a,n.d=this._sy*a,n.tx=s._x-(c*n.a+h*n.c),n.ty=s._y-(c*n.b+h*n.d)}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Bc,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const r=ve.shared.setValue(e??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=Bc,this._onUpdate())}get tint(){const e=this.localColor;return((e&255)<<16)+(e&65280)+(e>>16&255)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=om,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const n=e?2:0;(this.localDisplayStatus&2)!==n&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=cu,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const n=e?0:4;(this.localDisplayStatus&4)!==n&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=cu,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const n=e?1:0;(this.localDisplayStatus&1)!==n&&(this._updateFlags|=cu,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;const n=this.removeChildren(0,this.children.length);if(this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.children)for(let i=0;i<n.length;++i)n[i].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}$e.mixin(o4);$e.mixin(m4);$e.mixin(d4);$e.mixin(f4);$e.mixin(u4);$e.mixin(l4);$e.mixin(p4);$e.mixin(i4);class ea extends $e{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new Kt(0,1,0,0),this._boundsDirty=!0}_updateBounds(){}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const n=this.bounds,{x:r,y:i}=e;return r>=n.minX&&r<=n.maxX&&i>=n.minY&&i<=n.maxY}destroy(e){super.destroy(e),this._bounds=null}}class br extends ea{constructor(e=X.EMPTY){e instanceof X&&(e={texture:e});const{texture:n=X.EMPTY,anchor:r,roundPixels:i,width:s,height:o,...a}=e;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._didSpriteUpdate=!1,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new xt({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:n.defaultAnchor&&(this.anchor=n.defaultAnchor),this.texture=n,this.allowChildren=!1,this.roundPixels=i??!1,s!==void 0&&(this.width=s),o!==void 0&&(this.height=o)}static from(e,n=!1){return e instanceof X?new br(e):new br(X.from(e,n))}set texture(e){e||(e=X.EMPTY);const n=this._texture;n!==e&&(n&&n.dynamic&&n.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(e){const n=this.sourceBounds;return e.x>=n.maxX&&e.x<=n.minX&&e.y>=n.maxY&&e.y<=n.minY}addBounds(e){const n=this._texture.trim?this.sourceBounds:this.bounds;e.addFrame(n.minX,n.minY,n.maxX,n.maxY)}onViewUpdate(){if(this._didViewChangeTick++,this._didSpriteUpdate=!0,this._sourceBoundsDirty=this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}_updateBounds(){Ac(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const e=this._anchor,n=this._texture,r=this._sourceBounds,{width:i,height:s}=n.orig;r.maxX=-e._x*i,r.minX=r.maxX+i,r.maxY=-e._y*s,r.minY=r.maxY+s}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(r)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,n){typeof e=="object"?(n=e.height??e.width,e=e.width):n??(n=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),n!==void 0&&this._setHeight(n,this._texture.orig.height)}}const y6=new Kt;function am(t,e,n){const r=y6;t.measurable=!0,sh(t,n,r),e.addBoundsMask(r),t.measurable=!1}function um(t,e,n){const r=pi.get();t.measurable=!0;const i=di.get().identity(),s=sy(t,n,i);sm(t,r,s),t.measurable=!1,e.addBoundsMask(r),di.return(i),pi.return(r)}function sy(t,e,n){return t?(t!==e&&(sy(t.parent,e,n),t.updateLocalTransform(),n.append(t.localTransform)),n):(de("Mask bounds, renderable is not inside the root container"),n)}class oy{constructor(e){this.priority=0,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof br),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,n){am(this.mask,e,n)}addLocalBounds(e,n){um(this.mask,e,n)}containsPoint(e,n){const r=this.mask;return n(r,e)}destroy(){this.reset()}static test(e){return e instanceof br}}oy.extension=P.MaskEffect;class ay{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}ay.extension=P.MaskEffect;class uy{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,n){am(this.mask,e,n)}addLocalBounds(e,n){um(this.mask,e,n)}containsPoint(e,n){const r=this.mask;return n(r,e)}destroy(){this.reset()}static test(e){return e instanceof $e}}uy.extension=P.MaskEffect;const _4={createCanvas:(t,e)=>{const n=document.createElement("canvas");return n.width=t,n.height=e,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")};let wC=_4;const Ce={get(){return wC},set(t){wC=t}};class ns extends dt{constructor(e){e.resource||(e.resource=Ce.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity;const n=e.resource;(this.pixelWidth!==n.width||this.pixelWidth!==n.height)&&this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,n=this.height,r=this._resolution){const i=super.resize(e,n,r);return i&&this.resizeCanvas(),i}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}ns.extension=P.TextureSource;class Zs extends dt{constructor(e){if(e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){const n=Ce.get().createCanvas(e.resource.width,e.resource.height);n.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=n,de("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Zs.extension=P.TextureSource;var rs=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(rs||{});class Td{constructor(e,n=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=n,this.priority=r,this._once=i}match(e,n=null){return this._fn===e&&this._context===n}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const n=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),n}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const n=this.next;return this.next=e?null:n,this.previous=null,n}}const x4=class Hn{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Td(null,null,1/0),this.deltaMS=1/Hn.targetFPMS,this.elapsedMS=1/Hn.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,n,r=rs.NORMAL){return this._addListener(new Td(e,n,r))}addOnce(e,n,r=rs.NORMAL){return this._addListener(new Td(e,n,r,!0))}_addListener(e){let n=this._head.next,r=this._head;if(!n)e.connect(r);else{for(;n;){if(e.priority>n.priority){e.connect(r);break}r=n,n=n.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,n){let r=this._head.next;for(;r;)r.match(e,n)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,n=this._head;for(;n=n.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let n;if(e>this.lastTime){if(n=this.elapsedMS=e-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*Hn.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const n=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,n)/1e3,Hn.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const n=Math.max(this.minFPS,e);this._minElapsedMS=1/(n/1e3)}}static get shared(){if(!Hn._shared){const e=Hn._shared=new Hn;e.autoStart=!0,e._protected=!0}return Hn._shared}static get system(){if(!Hn._system){const e=Hn._system=new Hn;e.autoStart=!0,e._protected=!0}return Hn._system}};x4.targetFPMS=.06;let at=x4,Q0;async function ly(){return Q0??(Q0=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const n=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!n)return"premultiply-alpha-on-upload";const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n);const s=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,s),e.deleteFramebuffer(i),e.deleteTexture(r),e.getExtension("WEBGL_lose_context")?.loseContext(),s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Q0}const lm=class y4 extends dt{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...y4.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=at.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,n=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(n.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await ly(),this._load=new Promise((r,i)=>{this.isValid?r(this):(this._resolve=r,this._reject=i,n.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${n.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(at.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(at.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(at.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};lm.extension=P.TextureSource;lm.defaultOptions={...dt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};lm.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let tc=lm;const hr=(t,e,n=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(r=>typeof r=="string"||n?e(r):r):t);class b6{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const n=this._cache.get(e);return n||de(`[Assets] Asset id ${e} was not found in the Cache`),n}set(e,n){const r=hr(e);let i;for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];if(h.test(n)){i=h.getCacheableAssets(r,n);break}}const s=new Map(Object.entries(i||{}));i||r.forEach(c=>{s.set(c,n)});const o=[...s.keys()],a={cacheKeys:o,keys:r};r.forEach(c=>{this._cacheMap.set(c,a)}),o.forEach(c=>{const h=i?i[c]:n;this._cache.has(c)&&this._cache.get(c)!==h&&de("[Cache] already has key:",c),this._cache.set(c,s.get(c))})}remove(e){if(!this._cacheMap.has(e)){de(`[Assets] Asset id ${e} was not found in the Cache`);return}const n=this._cacheMap.get(e);n.cacheKeys.forEach(i=>{this._cache.delete(i)}),n.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const We=new b6,k_=[];Ne.handleByList(P.TextureSource,k_);function S6(t={}){return cy(t)}function cy(t={}){const e=t&&t.resource,n=e?t.resource:t,r=e?t:{resource:t};for(let i=0;i<k_.length;i++){const s=k_[i];if(s.test(n))return new s(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function b4(t={},e=!1){const n=t&&t.resource,r=n?t.resource:t,i=n?t:{resource:t};if(!e&&We.has(r))return We.get(r);const s=new X({source:cy(i)});return s.on("destroy",()=>{We.has(r)&&We.remove(r)}),e||We.set(r,s),s}function S4(t,e=!1){return typeof t=="string"?We.get(t):t instanceof dt?new X({source:t}):b4(t,e)}X.from=S4;dt.from=cy;Ne.add(oy,ay,uy,tc,Zs,ns,rm);var In=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(In||{});function Mr(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Tl(t){return t.split("?")[0].split("#")[0]}function w6(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C6(t,e,n){return t.replace(new RegExp(w6(e),"g"),n)}function T6(t,e){let n="",r=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){const c=n.lastIndexOf("/");if(c!==n.length-1){c===-1?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),i=a,s=0;continue}}else if(n.length===2||n.length===1){n="",r=0,i=a,s=0;continue}}}else n.length>0?n+=`/${t.slice(i+1,a)}`:n=t.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return n}const zt={toPosix(t){return C6(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){Mr(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const n=/^[^/:]+:\/{0,2}/.exec(t);return n?n[0]:""},toAbsolute(t,e,n){if(Mr(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const r=Tl(this.toPosix(e??Ce.get().getBaseUrl())),i=Tl(this.toPosix(n??this.rootname(r)));return t=this.toPosix(t),t.startsWith("/")?zt.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize(t){if(Mr(t),t.length===0)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="";const n=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return t=T6(t),t.length>0&&r&&(t+="/"),n?`/${t}`:e+t},isAbsolute(t){return Mr(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let n=0;n<t.length;++n){const r=t[n];if(Mr(r),r.length>0)if(e===void 0)e=r;else{const i=t[n-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Mr(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const n=e===47;let r=-1,i=!0;const s=this.getProtocol(t),o=t;t=t.slice(s.length);for(let a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!i){r=a;break}}else i=!1;return r===-1?n?"/":this.isUrl(o)?s+t:s:n&&r===1?"//":s+t.slice(0,r)},rootname(t){Mr(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const n=t.indexOf("/",e.length);n!==-1?e=t.slice(0,n):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Mr(t),e&&Mr(e),t=Tl(this.toPosix(t));let n=0,r=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const c=t.charCodeAt(s);if(c===47){if(!i){n=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=a))}return n===r?r=a:r===-1&&(r=t.length),t.slice(n,r)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!i){n=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":t.slice(n,r)},extname(t){Mr(t),t=Tl(this.toPosix(t));let e=-1,n=0,r=-1,i=!0,s=0;for(let o=t.length-1;o>=0;--o){const a=t.charCodeAt(o);if(a===47){if(!i){n=o+1;break}continue}r===-1&&(i=!1,r=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||r===-1||s===0||s===1&&e===r-1&&e===n+1?"":t.slice(e,r)},parse(t){Mr(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Tl(this.toPosix(t));let n=t.charCodeAt(0);const r=this.isAbsolute(t);let i;e.root=this.rootname(t),r||this.hasProtocol(t)?i=1:i=0;let s=-1,o=0,a=-1,c=!0,h=t.length-1,f=0;for(;h>=i;--h){if(n=t.charCodeAt(h),n===47){if(!c){o=h+1;break}continue}a===-1&&(c=!1,a=h+1),n===46?s===-1?s=h:f!==1&&(f=1):s!==-1&&(f=-1)}return s===-1||a===-1||f===0||f===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&r?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(o,a)):(o===0&&r?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function w4(t,e,n,r,i){const s=e[n];for(let o=0;o<s.length;o++){const a=s[o];n<e.length-1?w4(t.replace(r[n],a),e,n+1,r,i):i.push(t.replace(r[n],a))}}function C4(t){const e=/\{(.*?)\}/g,n=t.match(e),r=[];if(n){const i=[];n.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),w4(t,i,0,n,r)}else r.push(t);return r}const Mc=t=>!Array.isArray(t);class Js{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,n)=>`${e}${this._bundleIdConnector}${n}`,extractAssetIdFromBundle:(e,n)=>n.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(n=>{this._preferredOrder.push(n),n.priority||(n.priority=Object.keys(n.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const n=e;this._defaultSearchParams=Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}}getAlias(e){const{alias:n,src:r}=e;return hr(n||r,s=>typeof s=="string"?s:Array.isArray(s)?s.map(o=>o?.src??o):s?.src?s.src:s,!0)}addManifest(e){this._manifest&&de("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(n=>{this.addBundle(n.name,n.assets)})}addBundle(e,n){const r=[];let i=n;Array.isArray(n)||(i=Object.entries(n).map(([s,o])=>typeof o=="string"||Array.isArray(o)?{alias:s,src:o}:{alias:s,...o})),i.forEach(s=>{const o=s.src,a=s.alias;let c;if(typeof a=="string"){const h=this._createBundleAssetId(e,a);r.push(h),c=[a,h]}else{const h=a.map(f=>this._createBundleAssetId(e,f));r.push(...h),c=[...a,...h]}this.add({...s,alias:c,src:o})}),this._bundles[e]=r}add(e){const n=[];Array.isArray(e)?n.push(...e):n.push(e);let r;r=s=>{this.hasKey(s)&&de(`[Resolver] already has key: ${s} overwriting`)},hr(n).forEach(s=>{const{src:o}=s;let{data:a,format:c,loadParser:h}=s;const f=hr(o).map(_=>typeof _=="string"?C4(_):Array.isArray(_)?_:[_]),p=this.getAlias(s);Array.isArray(p)?p.forEach(r):r(p);const v=[];f.forEach(_=>{_.forEach(y=>{let S={};if(typeof y!="object"){S.src=y;for(let C=0;C<this._parsers.length;C++){const b=this._parsers[C];if(b.test(y)){S=b.parse(y);break}}}else a=y.data??a,c=y.format??c,h=y.loadParser??h,S={...S,...y};if(!p)throw new Error(`[Resolver] alias is undefined for this asset: ${S.src}`);S=this._buildResolvedAsset(S,{aliases:p,data:a,format:c,loadParser:h}),v.push(S)})}),p.forEach(_=>{this._assetMap[_]=v})})}resolveBundle(e){const n=Mc(e);e=hr(e);const r={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const c in o){const h=o[c];a[this._extractAssetIdFromBundle(i,c)]=h}r[i]=a}}),n?r[e[0]]:r}resolveUrl(e){const n=this.resolve(e);if(typeof e!="string"){const r={};for(const i in n)r[i]=n[i].src;return r}return n.src}resolve(e){const n=Mc(e);e=hr(e);const r={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=this._getPreferredOrder(s);o?.priority.forEach(a=>{o.params[a].forEach(c=>{const h=s.filter(f=>f[a]?f[a]===c:!1);h.length&&(s=h)})}),this._resolverHash[i]=s[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});r[i]=this._resolverHash[i]}),n?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let n=0;n<e.length;n++){const r=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const n=/\?/.test(e)?"&":"?";return`${e}${n}${this._defaultSearchParams}`}_buildResolvedAsset(e,n){const{aliases:r,data:i,loadParser:s,format:o}=n;return(this._basePath||this._rootPath)&&(e.src=zt.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??T4(e.src),e}}Js.RETINA_PREFIX=/@([0-9\.]+)x/;function T4(t){return t.split(".").pop().split("?").shift().split("#").shift()}const pp=(t,e)=>{const n=e.split("?")[1];return n&&(t+=`?${n}`),t},E4=class zl{constructor(e,n){this.linkedSheets=[],this._texture=e instanceof X?e:null,this.textureSource=e.source,this.textures={},this.animations={},this.data=n;const r=parseFloat(n.meta.scale);r?(this.resolution=r,e.source.resolution=this.resolution):this.resolution=e.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=zl.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let n=e;const r=zl.BATCH_SIZE;for(;n-e<r&&n<this._frameKeys.length;){const i=this._frameKeys[n],s=this._frames[i],o=s.frame;if(o){let a=null,c=null;const h=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,f=new Ke(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);s.rotated?a=new Ke(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Ke(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(c=new Ke(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new X({source:this.textureSource,frame:a,orig:f,trim:c,rotate:s.rotated?2:0,defaultAnchor:s.anchor,defaultBorders:s.borders,label:i.toString()})}n++}}_processAnimations(){const e=this.data.animations||{};for(const n in e){this.animations[n]=[];for(let r=0;r<e[n].length;r++){const i=e[n][r];this.animations[n].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*zl.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*zl.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};E4.BATCH_SIZE=1e3;let F_=E4;const E6=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function A4(t,e,n){const r={};if(t.forEach(i=>{r[i]=e}),Object.keys(e.textures).forEach(i=>{r[i]=e.textures[i]}),!n){const i=zt.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{const a=A4([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(r,a)})}return r}const P4={extension:P.Asset,cache:{test:t=>t instanceof F_,getCacheableAssets:(t,e)=>A4(t,e,!1)},resolver:{extension:{type:P.ResolveParser,name:"resolveSpritesheet"},test:t=>{const n=t.split("?")[0].split("."),r=n.pop(),i=n.pop();return r==="json"&&E6.includes(i)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(Js.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:P.LoadParser,priority:In.Normal,name:"spritesheetLoader"},async testParse(t,e){return zt.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,n){const{texture:r,imageFilename:i}=e?.data??{};let s=zt.dirname(e.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let o;if(r instanceof X)o=r;else{const h=pp(s+(i??t.meta.image),e.src);o=(await n.load([h]))[h]}const a=new F_(o.source,t);await a.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const h=[];for(const p of c){if(typeof p!="string")continue;let v=s+p;e.data?.ignoreMultiPack||(v=pp(v,e.src),h.push(n.load({src:v,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(h);a.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[a].concat(a.linkedSheets.filter(v=>v!==p))})}return a},async unload(t,e,n){await n.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};Ne.add(P4);class Nu{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Nu.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ze,this.page=new ze,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,n,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,n,r,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}var Z0=/iPhone/i,CC=/iPod/i,TC=/iPad/i,EC=/\biOS-universal(?:.+)Mac\b/i,J0=/\bAndroid(?:.+)Mobile\b/i,AC=/Android/i,Ta=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Lf=/Silk/i,Li=/Windows Phone/i,PC=/\bWindows(?:.+)ARM\b/i,RC=/BlackBerry/i,BC=/BB10/i,MC=/Opera Mini/i,DC=/\b(CriOS|Chrome)(?:.+)Mobile/i,OC=/Mobile(?:.+)Firefox\b/i,kC=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function A6(t){return function(e){return e.test(t)}}function FC(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var n=e.userAgent,r=n.split("[FBAN");typeof r[1]<"u"&&(n=r[0]),r=n.split("Twitter"),typeof r[1]<"u"&&(n=r[0]);var i=A6(n),s={apple:{phone:i(Z0)&&!i(Li),ipod:i(CC),tablet:!i(Z0)&&(i(TC)||kC(e))&&!i(Li),universal:i(EC),device:(i(Z0)||i(CC)||i(TC)||i(EC)||kC(e))&&!i(Li)},amazon:{phone:i(Ta),tablet:!i(Ta)&&i(Lf),device:i(Ta)||i(Lf)},android:{phone:!i(Li)&&i(Ta)||!i(Li)&&i(J0),tablet:!i(Li)&&!i(Ta)&&!i(J0)&&(i(Lf)||i(AC)),device:!i(Li)&&(i(Ta)||i(Lf)||i(J0)||i(AC))||i(/\bokhttp\b/i)},windows:{phone:i(Li),tablet:i(PC),device:i(Li)||i(PC)},other:{blackberry:i(RC),blackberry10:i(BC),opera:i(MC),firefox:i(OC),chrome:i(DC),device:i(RC)||i(BC)||i(MC)||i(OC)||i(DC)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const P6=FC.default??FC,R4=P6(globalThis.navigator),R6=9,Nf=100,B6=0,M6=0,IC=2,UC=1,D6=-1e3,O6=-1e3,k6=2;class B4{constructor(e,n=R4){this._mobileInfo=n,this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this._pool=[],this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._hookDiv=null,(n.tablet||n.phone)&&this._createTouchHook();const r=document.createElement("div");r.style.width=`${Nf}px`,r.style.height=`${Nf}px`,r.style.position="absolute",r.style.top=`${B6}px`,r.style.left=`${M6}px`,r.style.zIndex=IC.toString(),this._div=r,this._renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}get hookDiv(){return this._hookDiv}_createTouchHook(){const e=document.createElement("button");e.style.width=`${UC}px`,e.style.height=`${UC}px`,e.style.position="absolute",e.style.top=`${D6}px`,e.style.left=`${O6}px`,e.style.zIndex=k6.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this._activate(),this._destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}_destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}_activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.add(this),this._renderer.view.canvas.parentNode?.appendChild(this._div))}_deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.remove(this),this._div.parentNode?.removeChild(this._div))}_updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this._addChild(e),e._renderId=this._renderId);const n=e.children;if(n)for(let r=0;r<n.length;r++)this._updateAccessibleObjects(n[r])}init(e){this.debug=e?.debug??this.debug,this._renderer.runners.postrender.remove(this)}postrender(){const e=performance.now();if(this._mobileInfo.android.device&&e<this._androidUpdateCount||(this._androidUpdateCount=e+this._androidUpdateFrequency,!this._renderer.renderingToScreen||!this._renderer.view.canvas))return;this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered);const{x:n,y:r,width:i,height:s}=this._renderer.view.canvas.getBoundingClientRect(),{width:o,height:a,resolution:c}=this._renderer,h=i/o*c,f=s/a*c;let p=this._div;p.style.left=`${n}px`,p.style.top=`${r}px`,p.style.width=`${o}px`,p.style.height=`${a}px`;for(let v=0;v<this._children.length;v++){const _=this._children[v];if(_._renderId!==this._renderId)_._accessibleActive=!1,ty(this._children,v,1),this._div.removeChild(_._accessibleDiv),this._pool.push(_._accessibleDiv),_._accessibleDiv=null,v--;else{p=_._accessibleDiv;let y=_.hitArea;const S=_.worldTransform;_.hitArea?(p.style.left=`${(S.tx+y.x*S.a)*h}px`,p.style.top=`${(S.ty+y.y*S.d)*f}px`,p.style.width=`${y.width*S.a*h}px`,p.style.height=`${y.height*S.d*f}px`):(y=_.getBounds().rectangle,this._capHitArea(y),p.style.left=`${y.x*h}px`,p.style.top=`${y.y*f}px`,p.style.width=`${y.width*h}px`,p.style.height=`${y.height*f}px`,p.title!==_.accessibleTitle&&_.accessibleTitle!==null&&(p.title=_.accessibleTitle||""),p.getAttribute("aria-label")!==_.accessibleHint&&_.accessibleHint!==null&&p.setAttribute("aria-label",_.accessibleHint||"")),(_.accessibleTitle!==p.title||_.tabIndex!==p.tabIndex)&&(p.title=_.accessibleTitle||"",p.tabIndex=_.tabIndex,this.debug&&this._updateDebugHTML(p))}}this._renderId++}_updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}_capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:n,height:r}=this._renderer;e.x+e.width>n&&(e.width=n-e.x),e.y+e.height>r&&(e.height=r-e.y)}_addChild(e){let n=this._pool.pop();n||(n=document.createElement("button"),n.style.width=`${Nf}px`,n.style.height=`${Nf}px`,n.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",n.style.position="absolute",n.style.zIndex=IC.toString(),n.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?n.setAttribute("aria-live","off"):n.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?n.setAttribute("aria-relevant","additions"):n.setAttribute("aria-relevant","text"),n.addEventListener("click",this._onClick.bind(this)),n.addEventListener("focus",this._onFocus.bind(this)),n.addEventListener("focusout",this._onFocusOut.bind(this))),n.style.pointerEvents=e.accessiblePointerEvents,n.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?n.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(n.title=`container ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&n.setAttribute("aria-label",e.accessibleHint),this.debug&&this._updateDebugHTML(n),e._accessibleActive=!0,e._accessibleDiv=n,n.container=e,this._children.push(e),this._div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,n){const{container:r}=e.target,i=this._renderer.events.rootBoundary,s=Object.assign(new Nu(i),{target:r});i.rootTarget=this._renderer.lastObjectRendered,n.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===R6&&this._activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this._deactivate()}destroy(){this._destroyTouchHook(),this._div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this._pool=null,this._children=null,this._renderer=null}}B4.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"accessibility"};const F6={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,_renderId:-1},ev=Object.create(null),LC=Object.create(null);function Au(t,e){let n=LC[t];return n===void 0&&(ev[e]===void 0&&(ev[e]=1),LC[t]=n=ev[e]++),n}let Gf;function hy(){return(!Gf||Gf?.isContextLost())&&(Gf=Ce.get().createCanvas().getContext("webgl",{})),Gf}let zf;function M4(){if(!zf){zf="mediump";const t=hy();t&&t.getShaderPrecisionFormat&&(zf=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?"highp":"mediump")}return zf}function D4(t,e,n){return e?t:n?(t=t.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `}function O4(t,e,n){const r=n?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(t.substring(0,9)!=="precision"){let i=n?e.requestedFragmentPrecision:e.requestedVertexPrecision;return i==="highp"&&r!=="highp"&&(i="mediump"),`precision ${i} float;
${t}`}else if(r!=="highp"&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}function k4(t,e){return e?`#version 300 es
${t}`:t}const I6={},U6={};function F4(t,{name:e="pixi-program"},n=!0){e=e.replace(/\s+/g,"-"),e+=n?"-fragment":"-vertex";const r=n?I6:U6;return r[e]?(r[e]++,e+=`-${r[e]}`):r[e]=1,t.indexOf("#define SHADER_NAME")!==-1?t:`${`#define SHADER_NAME ${e}`}
${t}`}function I4(t,e){return e?t.replace("#version 300 es",""):t}const tv={stripVersion:I4,ensurePrecision:O4,addProgramDefines:D4,setProgramName:F4,insertVersion:k4},nv=Object.create(null),U4=class I_{constructor(e){e={...I_.defaultOptions,...e};const n=e.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:n,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:M4()},setProgramName:{name:e.name},addProgramDefines:n,insertVersion:n};let i=e.fragment,s=e.vertex;Object.keys(tv).forEach(o=>{const a=r[o];i=tv[o](i,a,!0),s=tv[o](s,a,!1)}),this.fragment=i,this.vertex=s,this._key=Au(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(e){const n=`${e.vertex}:${e.fragment}`;return nv[n]||(nv[n]=new I_(e)),nv[n]}};U4.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let me=U4;const NC={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function Pu(t){return NC[t]??NC.float32}const L6={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function L4({source:t,entryPoint:e}){const n={},r=t.indexOf(`fn ${e}`);if(r!==-1){const i=t.indexOf("->",r);if(i!==-1){const s=t.substring(r,i),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(s))!==null;){const c=L6[a[3]]??"float32";n[a[2]]={location:parseInt(a[1],10),format:c,stride:Pu(c).stride,offset:0,instance:!1,start:0}}}}return n}function Ed(t){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,n=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,c=/struct\s+(\w+)/,h=t.match(e)?.map(p=>({group:parseInt(p.match(n)[1],10),binding:parseInt(p.match(r)[1],10),name:p.match(i)[2],isUniform:p.match(i)[1]==="<uniform>",type:p.match(s)[1]}));if(!h)return{groups:[],structs:[]};const f=t.match(o)?.map(p=>{const v=p.match(c)[1],_=p.match(a).reduce((y,S)=>{const[C,b]=S.split(":");return y[C.trim()]=b.trim(),y},{});return _?{name:v,members:_}:null}).filter(({name:p})=>h.some(v=>v.type===p))??[];return{groups:h,structs:f}}var Ja=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))(Ja||{});function N4({groups:t}){const e=[];for(let n=0;n<t.length;n++){const r=t[n];e[r.group]||(e[r.group]=[]),r.isUniform?e[r.group].push({binding:r.binding,visibility:Ja.VERTEX|Ja.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?e[r.group].push({binding:r.binding,visibility:Ja.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"&&e[r.group].push({binding:r.binding,visibility:Ja.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function G4({groups:t}){const e=[];for(let n=0;n<t.length;n++){const r=t[n];e[r.group]||(e[r.group]={}),e[r.group][r.name]=r.binding}return e}function z4(t,e){const n=new Set,r=new Set,i=[...t.structs,...e.structs].filter(o=>n.has(o.name)?!1:(n.add(o.name),!0)),s=[...t.groups,...e.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return r.has(a)?!1:(r.add(a),!0)});return{structs:i,groups:s}}const rv=Object.create(null);class he{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:n,vertex:r,layout:i,gpuLayout:s,name:o}=e;if(this.name=o,this.fragment=n,this.vertex=r,n.source===r.source){const a=Ed(n.source);this.structsAndGroups=a}else{const a=Ed(r.source),c=Ed(n.source);this.structsAndGroups=z4(a,c)}this.layout=i??G4(this.structsAndGroups),this.gpuLayout=s??N4(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:n}=this,r=e.source+n.source+e.entryPoint+n.entryPoint;this._layoutKey=Au(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=L4(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(e){const n=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return rv[n]||(rv[n]=new he(e)),rv[n]}}const fy=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>"],H4=fy.reduce((t,e)=>(t[e]=!0,t),{});function V4(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const j4=class W4{constructor(e,n){this._touched=0,this.uid=ot("uniform"),this._resourceType="uniformGroup",this._resourceId=ot("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,n={...W4.defaultOptions,...n},this.uniformStructures=e;const r={};for(const i in e){const s=e[i];if(s.name=i,s.size=s.size??1,!H4[s.type])throw new Error(`Uniform type ${s.type} is not supported. Supported uniform types are: ${fy.join(", ")}`);s.value??(s.value=V4(s.type,s.size)),r[i]=s.value}this.uniforms=r,this._dirtyId=1,this.ubo=n.ubo,this.isStatic=n.isStatic,this._signature=Au(Object.keys(r).map(i=>`${i}-${e[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};j4.defaultOptions={ubo:!1,isStatic:!1};let Tt=j4;class mi{constructor(e){this.resources=Object.create(null),this._dirty=!0;let n=0;for(const r in e){const i=e[r];this.setResource(i,n++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let n=0;for(const r in this.resources)e[n++]=this.resources[r]._resourceId;this._key=e.join("|")}setResource(e,n){const r=this.resources[n];e!==r&&(r&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[n]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const n=this.resources;for(const r in n)n[r]._touched=e}destroy(){const e=this.resources;for(const n in e)e[n].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const n=this.resources;for(const r in n)n[r]===e&&(n[r]=null)}else this._updateKey()}}var Fn=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(Fn||{});class Sr extends Mt{constructor(e){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:n,glProgram:r,groups:i,resources:s,compatibleRenderers:o,groupMap:a}=e;this.gpuProgram=n,this.glProgram=r,o===void 0&&(o=0,n&&(o|=Fn.WEBGPU),r&&(o|=Fn.WEBGL)),this.compatibleRenderers=o;const c={};if(!s&&!i&&(s={}),s&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!n&&i&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!n&&i&&a)for(const h in a)for(const f in a[h]){const p=a[h][f];c[p]={group:h,binding:f,name:p}}else if(n&&i&&!a){const h=n.structsAndGroups.groups;a={},h.forEach(f=>{a[f.group]=a[f.group]||{},a[f.group][f.binding]=f.name,c[f.name]=f})}else if(s){i={},a={},n&&n.structsAndGroups.groups.forEach(p=>{a[p.group]=a[p.group]||{},a[p.group][p.binding]=p.name,c[p.name]=p});let h=0;for(const f in s)c[f]||(i[99]||(i[99]=new mi,this._ownedBindGroups.push(i[99])),c[f]={group:99,binding:h,name:f},a[99]=a[99]||{},a[99][h]=f,h++);for(const f in s){const p=f;let v=s[f];!v.source&&!v._resourceType&&(v=new Tt(v));const _=c[p];_&&(i[_.group]||(i[_.group]=new mi,this._ownedBindGroups.push(i[_.group])),i[_.group].setResource(v,_.binding))}}this.groups=i,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(i,c)}addResource(e,n,r){var i,s;(i=this._uniformBindMap)[n]||(i[n]={}),(s=this._uniformBindMap[n])[r]||(s[r]=e),this.groups[n]||(this.groups[n]=new mi,this._ownedBindGroups.push(this.groups[n]))}_buildResourceAccessor(e,n){const r={};for(const i in n){const s=n[i];Object.defineProperty(r,s.name,{get(){return e[s.group].getResource(s.binding)},set(o){e[s.group].setResource(o,s.binding)}})}return r}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(n=>{n.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:n,gl:r,...i}=e;let s,o;return n&&(s=he.from(n)),r&&(o=me.from(r)),new Sr({gpuProgram:s,glProgram:o,...i})}}const N6={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},iv=0,sv=1,ov=2,av=3,uv=4,lv=5,U_=class $4{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<iv)}set blend(e){!!(this.data&1<<iv)!==e&&(this.data^=1<<iv)}get offsets(){return!!(this.data&1<<sv)}set offsets(e){!!(this.data&1<<sv)!==e&&(this.data^=1<<sv)}set cullMode(e){if(e==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=e==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<ov)}set culling(e){!!(this.data&1<<ov)!==e&&(this.data^=1<<ov)}get depthTest(){return!!(this.data&1<<av)}set depthTest(e){!!(this.data&1<<av)!==e&&(this.data^=1<<av)}get depthMask(){return!!(this.data&1<<lv)}set depthMask(e){!!(this.data&1<<lv)!==e&&(this.data^=1<<lv)}get clockwiseFrontFace(){return!!(this.data&1<<uv)}set clockwiseFrontFace(e){!!(this.data&1<<uv)!==e&&(this.data^=1<<uv)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!=="none",this._blendMode=e,this._blendModeId=N6[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new $4;return e.depthTest=!1,e.blend=!0,e}};U_.default2d=U_.for2d();let jr=U_;const X4=class L_ extends Sr{constructor(e){e={...L_.defaultOptions,...e},super(e),this.enabled=!0,this._state=jr.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.addResource("uTexture",0,1)}apply(e,n,r,i){e.applyFilter(this,n,r,i)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:n,gl:r,...i}=e;let s,o;return n&&(s=he.from(n)),r&&(o=me.from(r)),new L_({gpuProgram:s,glProgram:o,...i})}};X4.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1};let le=X4;var Y4=`
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uBlend;

uniform sampler2D uTexture;
uniform sampler2D uBackTexture;

{FUNCTIONS}

void main()
{ 
    vec4 back = texture(uBackTexture, vTextureCoord);
    vec4 front = texture(uTexture, vTextureCoord);
    float blendedAlpha = front.a + back.a * (1.0 - front.a);
    
    {MAIN}
}
`,q4=`in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 backgroundUv;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,K4=`
struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlendUniforms {
  uBlend:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;
@group(0) @binding(3) var uBackTexture: texture_2d<f32>;

@group(1) @binding(0) var<uniform> blendUniforms : BlendUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

{FUNCTIONS}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>
) -> @location(0) vec4<f32> {


   var back =  textureSample(uBackTexture, uSampler, uv);
   var front = textureSample(uTexture, uSampler, uv);
   var blendedAlpha = front.a + back.a * (1.0 - front.a);
   
   var out = vec4<f32>(0.0,0.0,0.0,0.0);

   {MAIN}

   return out;
}`;class vt extends le{constructor(e){const n=e.gpu,r=GC({source:K4,...n}),i=he.from({vertex:{source:r,entryPoint:"mainVertex"},fragment:{source:r,entryPoint:"mainFragment"}}),s=e.gl,o=GC({source:Y4,...s}),a=me.from({vertex:q4,fragment:o}),c=new Tt({uBlend:{value:1,type:"f32"}});super({gpuProgram:i,glProgram:a,blendRequired:!0,resources:{blendUniforms:c,uBackTexture:X.EMPTY}})}}function GC(t){const{source:e,functions:n,main:r}=t;return e.replace("{FUNCTIONS}",n).replace("{MAIN}",r)}const cm=`
	float getLuminosity(vec3 c) {
		return 0.3 * c.r + 0.59 * c.g + 0.11 * c.b;
	}

	vec3 setLuminosity(vec3 c, float lum) {
		float modLum = lum - getLuminosity(c);
		vec3 color = c.rgb + vec3(modLum);

		// clip back into legal range
		modLum = getLuminosity(color);
		vec3 modLumVec = vec3(modLum);

		float cMin = min(color.r, min(color.g, color.b));
		float cMax = max(color.r, max(color.g, color.b));

		if(cMin < 0.0) {
			color = mix(modLumVec, color, modLum / (modLum - cMin));
		}

		if(cMax > 1.0) {
			color = mix(modLumVec, color, (1.0 - modLum) / (cMax - modLum));
		}

		return color;
	}

	float getSaturation(vec3 c) {
		return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
	}

	vec3 setSaturationMinMidMax(vec3 cSorted, float s) {
		vec3 colorSorted = cSorted;

		if(colorSorted.z > colorSorted.x) {
			colorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));
			colorSorted.z = s;
		}
		else {
			colorSorted.y = 0.0;
			colorSorted.z = 0.0;
		}

		colorSorted.x = 0.0;

		return colorSorted;
	}

	vec3 setSaturation(vec3 c, float s) {
		vec3 color = c;

		if(color.r <= color.g && color.r <= color.b) {
			if(color.g <= color.b) {
				color = setSaturationMinMidMax(color.rgb, s).rgb;
			}
			else {
				color = setSaturationMinMidMax(color.rbg, s).rbg;
			}
		}
		else if(color.g <= color.r && color.g <= color.b) {
			if(color.r <= color.b) {
				color = setSaturationMinMidMax(color.grb, s).grb;
			}
			else {
				color = setSaturationMinMidMax(color.gbr, s).gbr;
			}
		}
		else {
			// Using bgr for both fixes part of hue
			if(color.r <= color.g) {
				color = setSaturationMinMidMax(color.brg, s).brg;
			}
			else {
				color = setSaturationMinMidMax(color.bgr, s).bgr;
			}
		}

		return color;
	}
    `,hm=`
	fn getLuminosity(c: vec3<f32>) -> f32
	{
		return 0.3*c.r + 0.59*c.g + 0.11*c.b;
	}

	fn setLuminosity(c: vec3<f32>, lum: f32) -> vec3<f32>
	{
		var modLum: f32 = lum - getLuminosity(c);
		var color: vec3<f32> = c.rgb + modLum;

		// clip back into legal range
		modLum = getLuminosity(color);
		let modLumVec = vec3<f32>(modLum);

		let cMin: f32 = min(color.r, min(color.g, color.b));
		let cMax: f32 = max(color.r, max(color.g, color.b));

		if(cMin < 0.0)
		{
			color = mix(modLumVec, color, modLum / (modLum - cMin));
		}

		if(cMax > 1.0)
		{
			color = mix(modLumVec, color, (1 - modLum) / (cMax - modLum));
		}

		return color;
	}

	fn getSaturation(c: vec3<f32>) -> f32
	{
		return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
	}

	fn setSaturationMinMidMax(cSorted: vec3<f32>, s: f32) -> vec3<f32>
	{
		var colorSorted = cSorted;

		if(colorSorted.z > colorSorted.x)
		{
			colorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));
			colorSorted.z = s;
		}
		else
		{
			colorSorted.y = 0;
			colorSorted.z = 0;
		}

		colorSorted.x = 0;

		return colorSorted;
	}

	fn setSaturation(c: vec3<f32>, s: f32) -> vec3<f32>
	{
		var color = c;

		if (color.r <= color.g && color.r <= color.b)
		{
			if (color.g <= color.b)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.rgb, s)).rgb;
			}
			else
			{
				color = vec3<f32>(setSaturationMinMidMax(color.rbg, s)).rbg;
			}
		}
		else if (color.g <= color.r && color.g <= color.b)
		{
			if (color.r <= color.b)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.grb, s)).grb;
			}
			else
			{
				color = vec3<f32>(setSaturationMinMidMax(color.gbr, s)).gbr;
			}
		}
		else
		{
			// Using bgr for both fixes part of hue
			if (color.r <= color.g)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.brg, s)).brg;
			}
			else
			{
				color  = vec3<f32>(setSaturationMinMidMax(color.bgr, s)).bgr;
			}
		}

		return color;
	}
	`;class dy extends vt{constructor(){super({gl:{functions:`
                ${cm}

                vec3 blendColor(vec3 base, vec3 blend,  float opacity)
                {
                    return (setLuminosity(blend, getLuminosity(base)) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendColor(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                ${hm}

                fn blendColorOpacity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (setLuminosity(blend, getLuminosity(base)) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendColorOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}dy.extension={name:"color",type:P.BlendMode};class py extends vt{constructor(){super({gl:{functions:`
                float colorBurn(float base, float blend)
                {
                    return max((1.0 - ((1.0 - base) / blend)), 0.0);
                }

                vec3 blendColorBurn(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        colorBurn(base.r, blend.r),
                        colorBurn(base.g, blend.g),
                        colorBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendColorBurn(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn colorBurn(base:f32, blend:f32) -> f32
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                fn blendColorBurn(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        colorBurn(base.r, blend.r),
                        colorBurn(base.g, blend.g),
                        colorBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendColorBurn(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}py.extension={name:"color-burn",type:P.BlendMode};class my extends vt{constructor(){super({gl:{functions:`
                float colorDodge(float base, float blend)
                {
                    return base / (1.0 - blend);
                }

                vec3 blendColorDodge(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        colorDodge(base.r, blend.r),
                        colorDodge(base.g, blend.g),
                        colorDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendColorDodge(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn colorDodge(base: f32, blend: f32) -> f32
                {
                    return base / (1.0 - blend);
                }

                fn blendColorDodge(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        colorDodge(base.r, blend.r),
                        colorDodge(base.g, blend.g),
                        colorDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                    out = vec4<f32>(blendColorDodge(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}my.extension={name:"color-dodge",type:P.BlendMode};class gy extends vt{constructor(){super({gl:{functions:`
                vec3 blendDarken(vec3 base, vec3 blend, float opacity)
                {
                    return (min(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendDarken(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn blendDarken(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (min(blend,base) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendDarken(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}gy.extension={name:"darken",type:P.BlendMode};class vy extends vt{constructor(){super({gl:{functions:`
                vec3 blendDifference(vec3 base, vec3 blend,  float opacity)
                {
                    return (abs(blend - base) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendDifference(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn blendDifference(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (abs(blend - base) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendDifference(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}vy.extension={name:"difference",type:P.BlendMode};class _y extends vt{constructor(){super({gl:{functions:`
                float divide(float base, float blend)
                {
                    return (blend > 0.0) ? clamp(base / blend, 0.0, 1.0) : 1.0;
                }

                vec3 blendDivide(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        divide(base.r, blend.r),
                        divide(base.g, blend.g),
                        divide(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendDivide(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn divide(base: f32, blend: f32) -> f32
                {
                    return select(1.0, clamp(base / blend, 0.0, 1.0), blend > 0.0);
                }

                fn blendDivide(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        divide(base.r, blend.r),
                        divide(base.g, blend.g),
                        divide(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendDivide(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}_y.extension={name:"divide",type:P.BlendMode};class xy extends vt{constructor(){super({gl:{functions:`
                vec3 exclusion(vec3 base, vec3 blend)
                {
                    return base + blend - 2.0 * base * blend;
                }

                vec3 blendExclusion(vec3 base, vec3 blend, float opacity)
                {
                    return (exclusion(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendExclusion(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn exclusion(base: vec3<f32>, blend: vec3<f32>) -> vec3<f32>
                {
                    return base+blend-2.0*base*blend;
                }

                fn blendExclusion(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    return (exclusion(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendExclusion(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}xy.extension={name:"exclusion",type:P.BlendMode};class yy extends vt{constructor(){super({gl:{functions:`
                float hardLight(float base, float blend)
                {
                    return (blend < 0.5) ? 2.0 * base * blend : 1.0 - 2.0 * (1.0 - base) * (1.0 - blend);
                }

                vec3 blendHardLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        hardLight(base.r, blend.r),
                        hardLight(base.g, blend.g),
                        hardLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendHardLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn hardLight(base: f32, blend: f32) -> f32
                {
                    return select(1.0 - 2.0 * (1.0 - base) * (1.0 - blend), 2.0 * base * blend, blend < 0.5);
                }

                fn blendHardLight(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        hardLight(base.r, blend.r),
                        hardLight(base.g, blend.g),
                        hardLight(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendHardLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}yy.extension={name:"hard-light",type:P.BlendMode};class by extends vt{constructor(){super({gl:{functions:`
                float hardMix(float base, float blend)
                {
                    return (base + blend >= 1.0) ? 1.0 : 0.0;
                }

                vec3 blendHardMix(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blended = vec3(
                        hardMix(base.r, blend.r),
                        hardMix(base.g, blend.g),
                        hardMix(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendHardMix(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn hardMix(base: f32, blend: f32) -> f32
                {
                    return select(0.0, 1.0, base + blend >= 1.0);
                }

                fn blendHardMix(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        hardMix(base.r, blend.r),
                        hardMix(base.g, blend.g),
                        hardMix(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendHardMix(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}by.extension={name:"hard-mix",type:P.BlendMode};class Sy extends vt{constructor(){super({gl:{functions:`
                vec3 blendLighten(vec3 base, vec3 blend, float opacity)
                {
                    return (max(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLighten(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn blendLighten(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (max(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLighten(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}Sy.extension={name:"lighten",type:P.BlendMode};class wy extends vt{constructor(){super({gl:{functions:`
                float linearBurn(float base, float blend)
                {
                    return max(0.0, base + blend - 1.0);
                }

                vec3 blendLinearBurn(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        linearBurn(base.r, blend.r),
                        linearBurn(base.g, blend.g),
                        linearBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLinearBurn(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn linearBurn(base: f32, blend: f32) -> f32
                {
                    return max(0.0, base + blend - 1.0);
                }

                fn blendLinearBurn(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearBurn(base.r, blend.r),
                        linearBurn(base.g, blend.g),
                        linearBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendLinearBurn(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}wy.extension={name:"linear-burn",type:P.BlendMode};class Cy extends vt{constructor(){super({gl:{functions:`
                float linearDodge(float base, float blend) {
                    return min(1.0, base + blend);
                }

                vec3 blendLinearDodge(vec3 base, vec3 blend, float opacity) {
                    vec3 blended = vec3(
                        linearDodge(base.r, blend.r),
                        linearDodge(base.g, blend.g),
                        linearDodge(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLinearDodge(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn linearDodge(base: f32, blend: f32) -> f32
                {
                    return min(1, base + blend);
                }

                fn blendLinearDodge(base:vec3<f32>, blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearDodge(base.r, blend.r),
                        linearDodge(base.g, blend.g),
                        linearDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLinearDodge(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}Cy.extension={name:"linear-dodge",type:P.BlendMode};class Ty extends vt{constructor(){super({gl:{functions:`
                float linearBurn(float base, float blend) {
                    return max(0.0, base + blend - 1.0);
                }

                float linearDodge(float base, float blend) {
                    return min(1.0, base + blend);
                }

                float linearLight(float base, float blend) {
                    return (blend <= 0.5) ? linearBurn(base,2.0*blend) : linearBurn(base,2.0*(blend-0.5));
                }

                vec3 blendLinearLight(vec3 base, vec3 blend, float opacity) {
                    vec3 blended = vec3(
                        linearLight(base.r, blend.r),
                        linearLight(base.g, blend.g),
                        linearLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendLinearLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn linearBurn(base: f32, blend: f32) -> f32
                {
                    return max(0.0, base + blend - 1.0);
                }

                fn linearDodge(base: f32, blend: f32) -> f32
                {
                    return min(1.0, base + blend);
                }

                fn linearLight(base: f32, blend: f32) -> f32
                {
                    return select(linearBurn(base,2.0*(blend-0.5)), linearBurn(base,2.0*blend), blend <= 0.5);
                }

                fn blendLinearLightOpacity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearLight(base.r, blend.r),
                        linearLight(base.g, blend.g),
                        linearLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLinearLightOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}Ty.extension={name:"linear-light",type:P.BlendMode};class Ey extends vt{constructor(){super({gl:{functions:`
                ${cm}

                vec3 blendLuminosity(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blendLuminosity = setLuminosity(base, getLuminosity(blend));
                    return (blendLuminosity * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLuminosity(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                ${hm}

                fn blendLuminosity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blendLuminosity: vec3<f32> = setLuminosity(base, getLuminosity(blend));
                    return (blendLuminosity * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLuminosity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}Ey.extension={name:"luminosity",type:P.BlendMode};class Ay extends vt{constructor(){super({gl:{functions:`
                vec3 negation(vec3 base, vec3 blend)
                {
                    return 1.0-abs(1.0-base-blend);
                }

                vec3 blendNegation(vec3 base, vec3 blend, float opacity)
                {
                    return (negation(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendNegation(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn blendNegation(base: vec3<f32>, blend: vec3<f32>) -> vec3<f32>
                {
                    return 1.0-abs(1.0-base-blend);
                }

                fn blendNegationOpacity(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    return (blendNegation(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendNegationOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}Ay.extension={name:"negation",type:P.BlendMode};class Py extends vt{constructor(){super({gl:{functions:`
                float overlay(float base, float blend)
                {
                    return (base < 0.5) ? (2.0*base*blend) : (1.0-2.0*(1.0-base)*(1.0-blend));
                }

                vec3 blendOverlay(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        overlay(base.r, blend.r),
                        overlay(base.g, blend.g),
                        overlay(base.b, blend.b)
                    );
   
                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendOverlay(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn overlay(base: f32, blend: f32) -> f32
                {
                    return select((1.0-2.0*(1.0-base)*(1.0-blend)), (2.0*base*blend), base < 0.5);
                }

                fn blendOverlay(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        overlay(base.r, blend.r),
                        overlay(base.g, blend.g),
                        overlay(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendOverlay(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}Py.extension={name:"overlay",type:P.BlendMode};class Ry extends vt{constructor(){super({gl:{functions:`
                float pinLight(float base, float blend)
                {
                    return (blend <= 0.5) ? min(base, 2.0 * blend) : max(base, 2.0 * (blend - 0.5));
                }

                vec3 blendPinLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        pinLight(base.r, blend.r),
                        pinLight(base.g, blend.g),
                        pinLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendPinLight(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn pinLight(base: f32, blend: f32) -> f32
                {
                    return select(max(base,2.0*(blend-0.5)), min(base,2.0*blend), blend <= 0.5);
                }

                fn blendPinLight(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        pinLight(base.r, blend.r),
                        pinLight(base.g, blend.g),
                        pinLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendPinLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}Ry.extension={name:"pin-light",type:P.BlendMode};class By extends vt{constructor(){super({gl:{functions:`
                ${cm}

                vec3 blendSaturation(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blendSaturation = setLuminosity(setSaturation(base, getSaturation(blend)), getLuminosity(base));
                    return (blendSaturation * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendSaturation(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                ${hm}

                fn blendSaturation(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blendSaturation = setLuminosity(setSaturation(base, getSaturation(blend)), getLuminosity(base));
                    return (blendSaturation * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendSaturation(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}}By.extension={name:"saturation",type:P.BlendMode};class My extends vt{constructor(){super({gl:{functions:`
                float softLight(float base, float blend)
                {
                    return (blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend));
                }

                vec3 blendSoftLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        softLight(base.r, blend.r),
                        softLight(base.g, blend.g),
                        softLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendSoftLight(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn softLight(base: f32, blend: f32) -> f32
                {
                    return select(2.0 * base * blend + base * base * (1.0 - 2.0 * blend), sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend), blend < 0.5);
                }

                fn blendSoftLight(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        softLight(base.r, blend.r),
                        softLight(base.g, blend.g),
                        softLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendSoftLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}My.extension={name:"soft-light",type:P.BlendMode};class Dy extends vt{constructor(){super({gl:{functions:`
                float subtract(float base, float blend)
                {
                    return max(0.0, base - blend);
                }

                vec3 blendSubtract(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        subtract(base.r, blend.r),
                        subtract(base.g, blend.g),
                        subtract(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendSubtract(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn subtract(base: f32, blend: f32) -> f32
                {
                    return max(0, base - blend);
                }

                fn blendSubtract(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        subtract(base.r, blend.r),
                        subtract(base.g, blend.g),
                        subtract(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendSubtract(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}Dy.extension={name:"subtract",type:P.BlendMode};class Oy extends vt{constructor(){super({gl:{functions:`
                float colorBurn(float base, float blend)
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                float colorDodge(float base, float blend)
                {
                    return min(1.0, base / (1.0-blend));
                }

                float vividLight(float base, float blend)
                {
                    return (blend < 0.5) ? colorBurn(base,(2.0*blend)) : colorDodge(base,(2.0*(blend-0.5)));
                }

                vec3 blendVividLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        vividLight(base.r, blend.r),
                        vividLight(base.g, blend.g),
                        vividLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendVividLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn colorBurn(base:f32, blend:f32) -> f32
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                fn colorDodge(base: f32, blend: f32) -> f32
                {
                    return min(1.0, base / (1.0-blend));
                }

                fn vividLight(base: f32, blend: f32) -> f32
                {
                    return select(colorDodge(base,(2.0*(blend-0.5))), colorBurn(base,(2.0*blend)), blend<0.5);
                }

                fn blendVividLight(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        vividLight(base.r, blend.r),
                        vividLight(base.g, blend.g),
                        vividLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendVividLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}}Oy.extension={name:"vivid-light",type:P.BlendMode};const N_=[];Ne.handleByNamedList(P.Environment,N_);async function ky(t){if(!t)for(let e=0;e<N_.length;e++){const n=N_[e];if(n.value.test()){await n.value.load();return}}}async function G6(t){return ky(!t)}let El;function Fy(){if(typeof El=="boolean")return El;try{El=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{El=!1}return El}var Iy={exports:{}};Iy.exports=fm;Iy.exports.default=fm;function fm(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=Q4(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,c,h,f,p,v,_;if(r&&(s=W6(t,e,s,n)),t.length>80*n){a=h=t[0],c=f=t[1];for(var y=n;y<i;y+=n)p=t[y],v=t[y+1],p<a&&(a=p),v<c&&(c=v),p>h&&(h=p),v>f&&(f=v);_=Math.max(h-a,f-c),_=_!==0?32767/_:0}return Dc(s,o,n,a,c,_,0),o}function Q4(t,e,n,r,i){var s,o;if(i===H_(t,e,n,r)>0)for(s=e;s<n;s+=r)o=zC(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=zC(s,t[s],t[s+1],o);return o&&dm(o,o.next)&&(kc(o),o=o.next),o}function jo(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(dm(n,n.next)||ht(n.prev,n,n.next)===0)){if(kc(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Dc(t,e,n,r,i,s,o){if(t){!o&&s&&K6(t,r,i,s);for(var a=t,c,h;t.prev!==t.next;){if(c=t.prev,h=t.next,s?H6(t,r,i,s):z6(t)){e.push(c.i/n|0),e.push(t.i/n|0),e.push(h.i/n|0),kc(t),t=h.next,a=h.next;continue}if(t=h,t===a){o?o===1?(t=V6(jo(t),e,n),Dc(t,e,n,r,i,s,2)):o===2&&j6(t,e,n,r,i,s):Dc(jo(t),e,n,r,i,s,1);break}}}}function z6(t){var e=t.prev,n=t,r=t.next;if(ht(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,c=n.y,h=r.y,f=i<s?i<o?i:o:s<o?s:o,p=a<c?a<h?a:h:c<h?c:h,v=i>s?i>o?i:o:s>o?s:o,_=a>c?a>h?a:h:c>h?c:h,y=r.next;y!==e;){if(y.x>=f&&y.x<=v&&y.y>=p&&y.y<=_&&eu(i,a,s,c,o,h,y.x,y.y)&&ht(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function H6(t,e,n,r){var i=t.prev,s=t,o=t.next;if(ht(i,s,o)>=0)return!1;for(var a=i.x,c=s.x,h=o.x,f=i.y,p=s.y,v=o.y,_=a<c?a<h?a:h:c<h?c:h,y=f<p?f<v?f:v:p<v?p:v,S=a>c?a>h?a:h:c>h?c:h,C=f>p?f>v?f:v:p>v?p:v,b=G_(_,y,e,n,r),w=G_(S,C,e,n,r),T=t.prevZ,A=t.nextZ;T&&T.z>=b&&A&&A.z<=w;){if(T.x>=_&&T.x<=S&&T.y>=y&&T.y<=C&&T!==i&&T!==o&&eu(a,f,c,p,h,v,T.x,T.y)&&ht(T.prev,T,T.next)>=0||(T=T.prevZ,A.x>=_&&A.x<=S&&A.y>=y&&A.y<=C&&A!==i&&A!==o&&eu(a,f,c,p,h,v,A.x,A.y)&&ht(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;T&&T.z>=b;){if(T.x>=_&&T.x<=S&&T.y>=y&&T.y<=C&&T!==i&&T!==o&&eu(a,f,c,p,h,v,T.x,T.y)&&ht(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;A&&A.z<=w;){if(A.x>=_&&A.x<=S&&A.y>=y&&A.y<=C&&A!==i&&A!==o&&eu(a,f,c,p,h,v,A.x,A.y)&&ht(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function V6(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!dm(i,s)&&Z4(i,r,r.next,s)&&Oc(i,s)&&Oc(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),kc(r),kc(r.next),r=t=s),r=r.next}while(r!==t);return jo(r)}function j6(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&J6(o,a)){var c=J4(o,a);o=jo(o,o.next),c=jo(c,c.next),Dc(o,e,n,r,i,s,0),Dc(c,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function W6(t,e,n,r){var i=[],s,o,a,c,h;for(s=0,o=e.length;s<o;s++)a=e[s]*r,c=s<o-1?e[s+1]*r:t.length,h=Q4(t,a,c,r,!1),h===h.next&&(h.steiner=!0),i.push(Z6(h));for(i.sort($6),s=0;s<i.length;s++)n=X6(i[s],n);return n}function $6(t,e){return t.x-e.x}function X6(t,e){var n=Y6(t,e);if(!n)return e;var r=J4(n,t);return jo(r,r.next),jo(n,n.next)}function Y6(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var c=o,h=o.x,f=o.y,p=1/0,v;n=o;do r>=n.x&&n.x>=h&&r!==n.x&&eu(i<f?r:s,i,h,f,i<f?s:r,i,n.x,n.y)&&(v=Math.abs(i-n.y)/(r-n.x),Oc(n,t)&&(v<p||v===p&&(n.x>o.x||n.x===o.x&&q6(o,n)))&&(o=n,p=v)),n=n.next;while(n!==c);return o}function q6(t,e){return ht(t.prev,t,e.prev)<0&&ht(e.next,t,t.next)<0}function K6(t,e,n,r){var i=t;do i.z===0&&(i.z=G_(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Q6(i)}function Q6(t){var e,n,r,i,s,o,a,c,h=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<h&&(a++,r=r.nextZ,!!r);e++);for(c=h;a>0||c>0&&r;)a!==0&&(c===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,c--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,h*=2}while(o>1);return t}function G_(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Z6(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function eu(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function J6(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!eN(t,e)&&(Oc(t,e)&&Oc(e,t)&&tN(t,e)&&(ht(t.prev,t,e.prev)||ht(t,e.prev,e))||dm(t,e)&&ht(t.prev,t,t.next)>0&&ht(e.prev,e,e.next)>0)}function ht(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function dm(t,e){return t.x===e.x&&t.y===e.y}function Z4(t,e,n,r){var i=Vf(ht(t,e,n)),s=Vf(ht(t,e,r)),o=Vf(ht(n,r,t)),a=Vf(ht(n,r,e));return!!(i!==s&&o!==a||i===0&&Hf(t,n,e)||s===0&&Hf(t,r,e)||o===0&&Hf(n,t,r)||a===0&&Hf(n,e,r))}function Hf(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Vf(t){return t>0?1:t<0?-1:0}function eN(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Z4(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Oc(t,e){return ht(t.prev,t,t.next)<0?ht(t,e,t.next)>=0&&ht(t,t.prev,e)>=0:ht(t,e,t.prev)<0||ht(t,t.next,e)<0}function tN(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function J4(t,e){var n=new z_(t.i,t.x,t.y),r=new z_(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function zC(t,e,n,r){var i=new z_(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function kc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function z_(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}fm.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(H_(t,0,s,n));if(i)for(var a=0,c=e.length;a<c;a++){var h=e[a]*n,f=a<c-1?e[a+1]*n:t.length;o-=Math.abs(H_(t,h,f,n))}var p=0;for(a=0;a<r.length;a+=3){var v=r[a]*n,_=r[a+1]*n,y=r[a+2]*n;p+=Math.abs((t[v]-t[y])*(t[_+1]-t[v+1])-(t[v]-t[_])*(t[y+1]-t[v+1]))}return o===0&&p===0?0:Math.abs((p-o)/o)};function H_(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}fm.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var nN=Iy.exports;const eR=Jc(nN);var Bn=(t=>(t[t.NONE=0]="NONE",t[t.COLOR=16384]="COLOR",t[t.STENCIL=1024]="STENCIL",t[t.DEPTH=256]="DEPTH",t[t.COLOR_DEPTH=16640]="COLOR_DEPTH",t[t.COLOR_STENCIL=17408]="COLOR_STENCIL",t[t.DEPTH_STENCIL=1280]="DEPTH_STENCIL",t[t.ALL=17664]="ALL",t))(Bn||{});class Uy{constructor(e){this.items=[],this._name=e}emit(e,n,r,i,s,o,a,c){const{name:h,items:f}=this;for(let p=0,v=f.length;p<v;p++)f[p][h](e,n,r,i,s,o,a,c);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const n=this.items.indexOf(e);return n!==-1&&this.items.splice(n,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const rN=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],tR=class nR extends Mt{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const n=[...rN,...this.config.runners??[]];this._addRunners(...n),this._unsafeEvalCheck()}async init(e={}){const n=e.skipExtensionImports===!0?!0:e.manageImports===!1;await ky(n),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)e={...this._systemsHash[r].constructor.defaultOptions,...e};e={...nR.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(e);this._initOptions=e}render(e,n){let r=e;if(r instanceof $e&&(r={container:r},n&&(q(ge,"passing a second argument is deprecated, please use render options instead"),r.target=n.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor=this.background.colorRgba),r.clearColor){const i=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=i?r.clearColor:ve.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r)}resize(e,n,r){const i=this.view.resolution;this.view.resize(e,n,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==i&&this.runners.resolutionChange.emit(r)}clear(e={}){const n=this;e.target||(e.target=n.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Bn.ALL);const{clear:r,clearColor:i,target:s}=e;ve.shared.setValue(i??this.background.colorRgba),n.renderTarget.clear(s,r,ve.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(n=>{this.runners[n]=new Uy(n)})}_addSystems(e){let n;for(n in e){const r=e[n];this._addSystem(r.value,r.name)}}_addSystem(e,n){const r=new e(this);if(this[n])throw new Error(`Whoops! The name "${n}" is already in use`);this[n]=r,this._systemsHash[n]=r;for(const i in this.runners)this.runners[i].add(r);return this}_addPipes(e,n){const r=n.reduce((i,s)=>(i[s.name]=s.value,i),{});e.forEach(i=>{const s=i.value,o=i.name,a=r[o];this.renderPipes[o]=new s(this,a?new a:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(n=>{n.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Fy())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};tR.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let oh=tR,jf;function ah(t){return jf!==void 0||(jf=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:t??oh.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Ce.get().getWebGLRenderingContext())return!1;let r=Ce.get().createCanvas().getContext("webgl",e);const i=!!r?.getContextAttributes()?.stencil;if(r){const s=r.getExtension("WEBGL_lose_context");s&&s.loseContext()}return r=null,i}catch{return!1}})()),jf}let Wf;async function uh(t={}){return Wf!==void 0||(Wf=await(async()=>{const e=Ce.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(t)).requestDevice(),!0}catch{return!1}})()),Wf}const HC=["webgl","webgpu","canvas"];async function rR(t){let e=[];t.preference?(e.push(t.preference),HC.forEach(s=>{s!==t.preference&&e.push(s)})):e=HC.slice();let n,r={};for(let s=0;s<e.length;s++){const o=e[s];if(o==="webgpu"&&await uh()){const{WebGPURenderer:a}=await Ec(async()=>{const{WebGPURenderer:c}=await Promise.resolve().then(()=>X9);return{WebGPURenderer:c}},void 0);n=a,r={...t,...t.webgpu};break}else if(o==="webgl"&&ah(t.failIfMajorPerformanceCaveat??oh.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Ec(async()=>{const{WebGLRenderer:c}=await Promise.resolve().then(()=>L9);return{WebGLRenderer:c}},void 0);n=a,r={...t,...t.webgl};break}else if(o==="canvas")throw r={...t},new Error("CanvasRenderer is not yet implemented")}if(delete r.webgpu,delete r.webgl,!n)throw new Error("No available renderer for the current environment");const i=new n;return await i.init(r),i}const iN=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i,Fc="8.4.1";class Ly{static init(){globalThis.__PIXI_APP_INIT__?.(this,Fc)}static destroy(){}}Ly.extension=P.Application;class Ny{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,Fc)}destroy(){this._renderer=null}}Ny.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"initHook",priority:-10};const iR=class V_{constructor(...e){this.stage=new $e,e[0]!==void 0&&q(ge,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await rR(e),V_._plugins.forEach(n=>{n.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return q(ge,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,n=!1){const r=V_._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null}};iR._plugins=[];let Gy=iR;Ne.handleByList(P.Application,Gy._plugins);Ne.add(Ly);class sR{static init(e){Object.defineProperty(this,"resizeTo",{set(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let n,r;if(this._resizeTo===globalThis.window)n=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;n=i,r=s}this.renderer.resize(n,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}sR.extension=P.Application;class oR{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(n){this._ticker&&this._ticker.remove(this.render,this),this._ticker=n,n&&n.add(this.render,this,rs.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?at.shared:new at,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}oR.extension=P.Application;class zy extends Mt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return q(ge,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return q(ge,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return q(ge,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return q(ge,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return q(ge,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const n in this.chars)this.chars[n].texture?.destroy();this.chars=null,e&&(this.pages.forEach(n=>n.texture.destroy(!0)),this.pages=null)}}const aR=class j_{constructor(e,n,r,i){this.uid=ot("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=e,this.y0=n,this.x1=r,this.y1=i}addColorStop(e,n){return this.gradientStops.push({offset:e,color:ve.shared.setValue(n).toHexa()}),this._styleKey=null,this}buildLinearGradient(){const e=j_.defaultTextureSize,{gradientStops:n}=this,r=Ce.get().createCanvas();r.width=e,r.height=e;const i=r.getContext("2d"),s=i.createLinearGradient(0,0,j_.defaultTextureSize,1);for(let S=0;S<n.length;S++){const C=n[S];s.addColorStop(C.offset,C.color)}i.fillStyle=s,i.fillRect(0,0,e,e),this.texture=new X({source:new Zs({resource:r,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:o,y0:a,x1:c,y1:h}=this,f=new ae,p=c-o,v=h-a,_=Math.sqrt(p*p+v*v),y=Math.atan2(v,p);f.translate(-o,-a),f.scale(1/e,1/e),f.rotate(-y),f.scale(256/_,1),this.transform=f,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const e=this.gradientStops.map(i=>`${i.offset}-${i.color}`).join("-"),n=this.texture.uid,r=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${e}-${n}-${r}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};aR.defaultTextureSize=256;let Ru=aR;const VC={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class lh{constructor(e,n){this.uid=ot("fillPattern"),this.transform=new ae,this._styleKey=null,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),n&&(e.source.style.addressModeU=VC[n].addressModeU,e.source.style.addressModeV=VC[n].addressModeV)}setTransform(e){const n=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/n.frame.width,1/n.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var sN=aN,cv={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},oN=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function aN(t){var e=[];return t.replace(oN,function(n,r,i){var s=r.toLowerCase();for(i=lN(i),s=="m"&&i.length>2&&(e.push([r].concat(i.splice(0,2))),s="l",r=r=="m"?"l":"L");;){if(i.length==cv[s])return i.unshift(r),e.push(i);if(i.length<cv[s])throw new Error("malformed path data");e.push([r].concat(i.splice(0,cv[s])))}}),e}var uN=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function lN(t){var e=t.match(uN);return e?e.map(Number):[]}const cN=Jc(sN);function uR(t,e){const n=cN(t),r=[];let i=null,s=0,o=0;for(let a=0;a<n.length;a++){const c=n[a],h=c[0],f=c;switch(h){case"M":s=f[1],o=f[2],e.moveTo(s,o);break;case"m":s+=f[1],o+=f[2],e.moveTo(s,o);break;case"H":s=f[1],e.lineTo(s,o);break;case"h":s+=f[1],e.lineTo(s,o);break;case"V":o=f[1],e.lineTo(s,o);break;case"v":o+=f[1],e.lineTo(s,o);break;case"L":s=f[1],o=f[2],e.lineTo(s,o);break;case"l":s+=f[1],o+=f[2],e.lineTo(s,o);break;case"C":s=f[5],o=f[6],e.bezierCurveTo(f[1],f[2],f[3],f[4],s,o);break;case"c":e.bezierCurveTo(s+f[1],o+f[2],s+f[3],o+f[4],s+f[5],o+f[6]),s+=f[5],o+=f[6];break;case"S":s=f[3],o=f[4],e.bezierCurveToShort(f[1],f[2],s,o);break;case"s":e.bezierCurveToShort(s+f[1],o+f[2],s+f[3],o+f[4]),s+=f[3],o+=f[4];break;case"Q":s=f[3],o=f[4],e.quadraticCurveTo(f[1],f[2],s,o);break;case"q":e.quadraticCurveTo(s+f[1],o+f[2],s+f[3],o+f[4]),s+=f[3],o+=f[4];break;case"T":s=f[1],o=f[2],e.quadraticCurveToShort(s,o);break;case"t":s+=f[1],o+=f[2],e.quadraticCurveToShort(s,o);break;case"A":s=f[6],o=f[7],e.arcToSvg(f[1],f[2],f[3],f[4],f[5],s,o);break;case"a":s+=f[6],o+=f[7],e.arcToSvg(f[1],f[2],f[3],f[4],f[5],s,o);break;case"Z":case"z":e.closePath(),r.length>0&&(i=r.pop(),i?(s=i.startX,o=i.startY):(s=0,o=0)),i=null;break;default:de(`Unknown SVG path command: ${h}`)}h!=="Z"&&h!=="z"&&i===null&&(i={startX:s,startY:o},r.push(i))}return e}class pm{constructor(e=0,n=0,r=0){this.type="circle",this.x=e,this.y=n,this.radius=r}clone(){return new pm(this.x,this.y,this.radius)}contains(e,n){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-e,s=this.y-n;return i*=i,s*=s,i+s<=r}strokeContains(e,n,r){if(this.radius===0)return!1;const i=this.x-e,s=this.y-n,o=this.radius,a=r/2,c=Math.sqrt(i*i+s*s);return c<o+a&&c>o-a}getBounds(e){return e=e||new Ke,e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class mm{constructor(e=0,n=0,r=0,i=0){this.type="ellipse",this.x=e,this.y=n,this.halfWidth=r,this.halfHeight=i}clone(){return new mm(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,n){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(e-this.x)/this.halfWidth,i=(n-this.y)/this.halfHeight;return r*=r,i*=i,r+i<=1}strokeContains(e,n,r){const{halfWidth:i,halfHeight:s}=this;if(i<=0||s<=0)return!1;const o=r/2,a=i-o,c=s-o,h=i+o,f=s+o,p=e-this.x,v=n-this.y,_=p*p/(a*a)+v*v/(c*c),y=p*p/(h*h)+v*v/(f*f);return _>1&&y<=1}getBounds(e){return e=e||new Ke,e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function nc(t,e,n,r,i,s){const o=t-n,a=e-r,c=i-n,h=s-r,f=o*c+a*h,p=c*c+h*h;let v=-1;p!==0&&(v=f/p);let _,y;v<0?(_=n,y=r):v>1?(_=i,y=s):(_=n+v*c,y=r+v*h);const S=t-_,C=e-y;return S*S+C*C}class hu{constructor(...e){this.type="polygon";let n=Array.isArray(e[0])?e[0]:e;if(typeof n[0]!="number"){const r=[];for(let i=0,s=n.length;i<s;i++)r.push(n[i].x,n[i].y);n=r}this.points=n,this.closePath=!0}clone(){const e=this.points.slice(),n=new hu(e);return n.closePath=this.closePath,n}contains(e,n){let r=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],c=this.points[s*2+1],h=this.points[o*2],f=this.points[o*2+1];c>n!=f>n&&e<(h-a)*((n-c)/(f-c))+a&&(r=!r)}return r}strokeContains(e,n,r){const i=r/2,s=i*i,{points:o}=this,a=o.length-(this.closePath?0:2);for(let c=0;c<a;c+=2){const h=o[c],f=o[c+1],p=o[(c+2)%o.length],v=o[(c+3)%o.length];if(nc(e,n,h,f,p,v)<=s)return!0}return!1}getBounds(e){e=e||new Ke;const n=this.points;let r=1/0,i=-1/0,s=1/0,o=-1/0;for(let a=0,c=n.length;a<c;a+=2){const h=n[a],f=n[a+1];r=h<r?h:r,i=h>i?h:i,s=f<s?f:s,o=f>o?f:o}return e.x=r,e.width=i-r,e.y=s,e.height=o-s,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,n)=>`${e}, ${n}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const $f=(t,e,n,r,i,s)=>{const o=t-n,a=e-r,c=Math.sqrt(o*o+a*a);return c>=i-s&&c<=i+s};class gm{constructor(e=0,n=0,r=0,i=0,s=20){this.type="roundedRectangle",this.x=e,this.y=n,this.width=r,this.height=i,this.radius=s}getBounds(e){return e=e||new Ke,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new gm(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,n){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(n>=this.y+r&&n<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let i=e-(this.x+r),s=n-(this.y+r);const o=r*r;if(i*i+s*s<=o||(i=e-(this.x+this.width-r),i*i+s*s<=o)||(s=n-(this.y+this.height-r),i*i+s*s<=o)||(i=e-(this.x+r),i*i+s*s<=o))return!0}return!1}strokeContains(e,n,r){const{x:i,y:s,width:o,height:a,radius:c}=this,h=r/2,f=i+c,p=s+c,v=o-c*2,_=a-c*2,y=i+o,S=s+a;return(e>=i-h&&e<=i+h||e>=y-h&&e<=y+h)&&n>=p&&n<=p+_||(n>=s-h&&n<=s+h||n>=S-h&&n<=S+h)&&e>=f&&e<=f+v?!0:e<f&&n<p&&$f(e,n,f,p,c,h)||e>y-c&&n<p&&$f(e,n,y-c,p,c,h)||e>y-c&&n>S-c&&$f(e,n,y-c,S-c,c,h)||e<f&&n>S-c&&$f(e,n,f,S-c,c,h)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const hN=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function fN(t){let e="";for(let n=0;n<t;++n)n>0&&(e+=`
else `),n<t-1&&(e+=`if(test == ${n}.0){}`);return e}function lR(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const r=hN.replace(/%forloop%/gi,fN(t));if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))t=t/2|0;else break}}finally{e.deleteShader(n)}return t}let Ea=null;function ta(){if(Ea)return Ea;const t=hy();return Ea=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Ea=lR(Ea,t),t.getExtension("WEBGL_lose_context")?.loseContext(),Ea}const cR={};function vm(t,e){let n=2166136261;for(let r=0;r<e;r++)n^=t[r].uid,n=Math.imul(n,16777619),n>>>=0;return cR[n]||dN(t,e,n)}let hv=0;function dN(t,e,n){const r={};let i=0;hv||(hv=ta());for(let o=0;o<hv;o++){const a=o<e?t[o]:X.EMPTY.source;r[i++]=a.source,r[i++]=a.style}const s=new mi(r);return cR[n]=s,s}class W_{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function mp(t,e){const n=t.byteLength/8|0,r=new Float64Array(t,0,n);new Float64Array(e,0,n).set(r);const s=t.byteLength-n*8;if(s>0){const o=new Uint8Array(t,n*8,s);new Uint8Array(e,n*8,s).set(o)}}const hR={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var Rt=(t=>(t[t.DISABLED=0]="DISABLED",t[t.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",t[t.MASK_ACTIVE=2]="MASK_ACTIVE",t[t.RENDERING_MASK_REMOVE=3]="RENDERING_MASK_REMOVE",t[t.NONE=4]="NONE",t))(Rt||{});function Ic(t,e){return e.alphaMode==="no-premultiply-alpha"&&hR[t]||t}class fR{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const n=this.textures[e];this.textures[e]=null,this.ids[n.uid]=null}this.count=0}}class dR{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new fR,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const pR=[];let $_=0;function jC(){return $_>0?pR[--$_]:new dR}function WC(t){pR[$_++]=t}let Al=0;const mR=class Ad{constructor(e={}){this.uid=ot("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Ad.defaultOptions.maxTextures=Ad.defaultOptions.maxTextures??ta(),e={...Ad.defaultOptions,...e};const{maxTextures:n,attributesInitialSize:r,indicesInitialSize:i}=e;this.attributeBuffer=new W_(r*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=n}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)WC(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,n){const r=e._batch.textures.ids[n._source.uid];return!r&&r!==0?!1:(e._textureId=r,e.texture=n,!0)}updateElement(e){this.dirty=!0;const n=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,n.float32View,n.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,n.float32View,n.uint32View,e._attributeStart,e._textureId)}break(e){const n=this._elements;if(!n[this.elementStart])return;let r=jC(),i=r.textures;i.clear();const s=n[this.elementStart];let o=Ic(s.blendMode,s.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const a=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,h=this.indexBuffer;let f=this._batchIndexSize,p=this._batchIndexStart,v="startBatch";const _=this.maxTextures;for(let y=this.elementStart;y<this.elementSize;++y){const S=n[y];n[y]=null;const b=S.texture._source,w=Ic(S.blendMode,b),T=o!==w;if(b._batchTick===Al&&!T){S._textureId=b._textureBindLocation,f+=S.indexSize,S.packAsQuad?(this.packQuadAttributes(S,a,c,S._attributeStart,S._textureId),this.packQuadIndex(h,S._indexStart,S._attributeStart/this.vertexSize)):(this.packAttributes(S,a,c,S._attributeStart,S._textureId),this.packIndex(S,h,S._indexStart,S._attributeStart/this.vertexSize)),S._batch=r;continue}b._batchTick=Al,(i.count>=_||T)&&(this._finishBatch(r,p,f-p,i,o,e,v),v="renderBatch",p=f,o=w,r=jC(),i=r.textures,i.clear(),++Al),S._textureId=b._textureBindLocation=i.count,i.ids[b.uid]=i.count,i.textures[i.count++]=b,S._batch=r,f+=S.indexSize,S.packAsQuad?(this.packQuadAttributes(S,a,c,S._attributeStart,S._textureId),this.packQuadIndex(h,S._indexStart,S._attributeStart/this.vertexSize)):(this.packAttributes(S,a,c,S._attributeStart,S._textureId),this.packIndex(S,h,S._indexStart,S._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(r,p,f-p,i,o,e,v),p=f,++Al),this.elementStart=this.elementSize,this._batchIndexStart=p,this._batchIndexSize=f}_finishBatch(e,n,r,i,s,o,a){e.gpuBindGroup=null,e.bindGroup=null,e.action=a,e.batcher=this,e.textures=i,e.blendMode=s,e.start=n,e.size=r,++Al,this.batches[this.batchIndex++]=e,o.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const n=Math.max(e,this.attributeBuffer.size*2),r=new W_(n);mp(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(e){const n=this.indexBuffer;let r=Math.max(e,n.length*1.5);r+=r%2;const i=r>65535?new Uint32Array(r):new Uint16Array(r);if(i.BYTES_PER_ELEMENT!==n.BYTES_PER_ELEMENT)for(let s=0;s<n.length;s++)i[s]=n[s];else mp(n.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(e,n,r){e[n]=r+0,e[n+1]=r+1,e[n+2]=r+2,e[n+3]=r+0,e[n+4]=r+2,e[n+5]=r+3}packIndex(e,n,r,i){const s=e.indices,o=e.indexSize,a=e.indexOffset,c=e.attributeOffset;for(let h=0;h<o;h++)n[r++]=i+s[h+a]-c}destroy(){for(let e=0;e<this.batches.length;e++)WC(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};mR.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let gR=mR;var Re=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(Re||{});class Yn extends Mt{constructor(e){let{data:n,size:r}=e;const{usage:i,label:s,shrinkToFit:o}=e;super(),this.uid=ot("buffer"),this._resourceType="buffer",this._resourceId=ot("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,n instanceof Array&&(n=new Float32Array(n)),this._data=n,r=r??n?.byteLength;const a=!!n;this.descriptor={size:r,usage:i,mappedAtCreation:a,label:s},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get static(){return!!(this.descriptor.usage&Re.STATIC)}set static(e){e?this.descriptor.usage|=Re.STATIC:this.descriptor.usage&=~Re.STATIC}setDataWithSize(e,n,r){if(this._updateID++,this._updateSize=n*e.BYTES_PER_ELEMENT,this._data===e){r&&this.emit("update",this);return}const i=this._data;if(this._data=e,i.length!==e.length){!this.shrinkToFit&&e.byteLength<i.byteLength?r&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=ot("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Hy(t,e){if(!(t instanceof Yn)){let n=e?Re.INDEX:Re.VERTEX;t instanceof Array&&(e?(t=new Uint32Array(t),n=Re.INDEX|Re.COPY_DST):(t=new Float32Array(t),n=Re.VERTEX|Re.COPY_DST)),t=new Yn({data:t,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:n})}return t}function vR(t,e,n){const r=t.getAttribute(e);if(!r)return n.minX=0,n.minY=0,n.maxX=0,n.maxY=0,n;const i=r.buffer.data;let s=1/0,o=1/0,a=-1/0,c=-1/0;const h=i.BYTES_PER_ELEMENT,f=(r.offset||0)/h,p=(r.stride||2*4)/h;for(let v=f;v<i.length;v+=p){const _=i[v],y=i[v+1];_>a&&(a=_),y>c&&(c=y),_<s&&(s=_),y<o&&(o=y)}return n.minX=s,n.minY=o,n.maxX=a,n.maxY=c,n}function pN(t){return(t instanceof Yn||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=Hy(t.buffer,!1),t}class Gu extends Mt{constructor(e){const{attributes:n,indexBuffer:r,topology:i}=e;super(),this.uid=ot("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Kt,this._boundsDirty=!0,this.attributes=n,this.buffers=[],this.instanceCount=e.instanceCount||1;for(const s in n){const o=n[s]=pN(n[s]);this.buffers.indexOf(o.buffer)===-1&&(this.buffers.push(o.buffer),o.buffer.on("update",this.onBufferUpdate,this),o.buffer.on("change",this.onBufferUpdate,this))}r&&(this.indexBuffer=Hy(r,!0),this.buffers.push(this.indexBuffer)),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const n=this.attributes[e];return n.buffer.data.length/(n.stride/4||n.size)}return 0}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,vR(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(n=>n.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const mN=new Float32Array(1),gN=new Uint32Array(1);class _R extends Gu{constructor(){const n=new Yn({data:mN,label:"attribute-batch-buffer",usage:Re.VERTEX|Re.COPY_DST,shrinkToFit:!1}),r=new Yn({data:gN,label:"index-batch-buffer",usage:Re.INDEX|Re.COPY_DST,shrinkToFit:!1}),i=6*4;super({attributes:{aPosition:{buffer:n,format:"float32x2",stride:i,offset:0},aUV:{buffer:n,format:"float32x2",stride:i,offset:2*4},aColor:{buffer:n,format:"unorm8x4",stride:i,offset:4*4},aTextureIdAndRound:{buffer:n,format:"uint16x2",stride:i,offset:5*4}},indexBuffer:r})}}function X_(t,e,n){if(t)for(const r in t){const i=r.toLocaleLowerCase(),s=e[i];if(s){let o=t[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),n&&s.push(`//----${n}----//`),s.push(o)}else de(`${r} placement hook does not exist in shader`)}}const xR=/\{\{(.*?)\}\}/g;function Y_(t){const e={};return(t.match(xR)?.map(r=>r.replace(/[{()}]/g,""))??[]).forEach(r=>{e[r]=[]}),e}function $C(t,e){let n;const r=/@in\s+([^;]+);/g;for(;(n=r.exec(t))!==null;)e.push(n[1])}function q_(t,e,n=!1){const r=[];$C(e,r),t.forEach(a=>{a.header&&$C(a.header,r)});const i=r;n&&i.sort();const s=i.map((a,c)=>`       @location(${c}) ${a},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${s}
`),o}function XC(t,e){let n;const r=/@out\s+([^;]+);/g;for(;(n=r.exec(t))!==null;)e.push(n[1])}function vN(t){const n=/\b(\w+)\s*:/g.exec(t);return n?n[1]:""}function _N(t){const e=/@.*?\s+/g;return t.replace(e,"")}function yR(t,e){const n=[];XC(e,n),t.forEach(c=>{c.header&&XC(c.header,n)});let r=0;const i=n.sort().map(c=>c.indexOf("builtin")>-1?c:`@location(${r++}) ${c}`).join(`,
`),s=n.sort().map(c=>`       var ${_N(c)};`).join(`
`),o=`return VSOutput(
                ${n.sort().map(c=>` ${vN(c)}`).join(`,
`)});`;let a=e.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${i}
`),a=a.replace("{{start}}",`
${s}
`),a=a.replace("{{return}}",`
${o}
`),a}function K_(t,e){let n=t;for(const r in e){const i=e[r];i.join(`
`).length?n=n.replace(`{{${r}}}`,`//-----${r} START-----//
${i.join(`
`)}
//----${r} FINISH----//`):n=n.replace(`{{${r}}}`,"")}return n}const Ms=Object.create(null),fv=new Map;let xN=0;function bR({template:t,bits:e}){const n=wR(t,e);if(Ms[n])return Ms[n];const{vertex:r,fragment:i}=yN(t,e);return Ms[n]=CR(r,i,e),Ms[n]}function SR({template:t,bits:e}){const n=wR(t,e);return Ms[n]||(Ms[n]=CR(t.vertex,t.fragment,e)),Ms[n]}function yN(t,e){const n=e.map(o=>o.vertex).filter(o=>!!o),r=e.map(o=>o.fragment).filter(o=>!!o);let i=q_(n,t.vertex,!0);i=yR(n,i);const s=q_(r,t.fragment,!0);return{vertex:i,fragment:s}}function wR(t,e){return e.map(n=>(fv.has(n)||fv.set(n,xN++),fv.get(n))).sort((n,r)=>n-r).join("-")+t.vertex+t.fragment}function CR(t,e,n){const r=Y_(t),i=Y_(e);return n.forEach(s=>{X_(s.vertex,r,s.name),X_(s.fragment,i,s.name)}),{vertex:K_(t,r),fragment:K_(e,i)}}const TR=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,ER=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,AR=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,PR=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,RR={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},bN={name:"global-uniforms-ubo-bit",vertex:{header:`
          uniform globalUniforms {
            mat3 uProjectionMatrix;
            mat3 uWorldTransformMatrix;
            vec4 uWorldColorAlpha;
            vec2 uResolution;
          };
        `}},BR={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function zu({bits:t,name:e}){const n=bR({template:{fragment:ER,vertex:TR},bits:[RR,...t]});return he.from({name:e,vertex:{source:n.vertex,entryPoint:"main"},fragment:{source:n.fragment,entryPoint:"main"}})}function Hu({bits:t,name:e}){return new me({name:e,...SR({template:{vertex:AR,fragment:PR},bits:[BR,...t]})})}const _m={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},xm={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},dv={};function SN(t){const e=[];if(t===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let n=0;for(let r=0;r<t;r++)e.push(`@group(1) @binding(${n++}) var textureSource${r+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${n++}) var textureSampler${r+1}: sampler;`)}return e.join(`
`)}function wN(t){const e=[];if(t===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let n=0;n<t;n++)n===t-1?e.push("  default:{"):e.push(`  case ${n}:{`),e.push(`      outColor = textureSampleGrad(textureSource${n+1}, textureSampler${n+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function ym(t){return dv[t]||(dv[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${SN(t)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${wN(t)}
            `}}),dv[t]}const pv={};function CN(t){const e=[];for(let n=0;n<t;n++)n>0&&e.push("else"),n<t-1&&e.push(`if(vTextureId < ${n}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${n}], vUV);`),e.push("}");return e.join(`
`)}function bm(t){return pv[t]||(pv[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${t}];

            `,main:`

                ${CN(t)}
            `}}),pv[t]}const Vu={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},ju={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},YC={};function Sm(t){let e=YC[t];if(e)return e;const n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=r;return e=YC[t]=new Tt({uTextures:{value:n,type:"i32",size:t}},{isStatic:!0}),e}class MR extends Sr{constructor(e){const n=Hu({name:"batch",bits:[xm,bm(e),ju]}),r=zu({name:"batch",bits:[_m,ym(e),Vu]});super({glProgram:n,gpuProgram:r,resources:{batchSamplers:Sm(e)}})}}let qC=null;const DR=class OR extends gR{constructor(){super(...arguments),this.geometry=new _R,this.shader=qC||(qC=new MR(this.maxTextures)),this.name=OR.extension.name,this.vertexSize=6}packAttributes(e,n,r,i,s){const o=s<<16|e.roundPixels&65535,a=e.transform,c=a.a,h=a.b,f=a.c,p=a.d,v=a.tx,_=a.ty,{positions:y,uvs:S}=e,C=e.color,b=e.attributeOffset,w=b+e.attributeSize;for(let T=b;T<w;T++){const A=T*2,M=y[A],L=y[A+1];n[i++]=c*M+f*L+v,n[i++]=p*L+h*M+_,n[i++]=S[A],n[i++]=S[A+1],r[i++]=C,r[i++]=o}}packQuadAttributes(e,n,r,i,s){const o=e.texture,a=e.transform,c=a.a,h=a.b,f=a.c,p=a.d,v=a.tx,_=a.ty,y=e.bounds,S=y.maxX,C=y.minX,b=y.maxY,w=y.minY,T=o.uvs,A=e.color,M=s<<16|e.roundPixels&65535;n[i+0]=c*C+f*w+v,n[i+1]=p*w+h*C+_,n[i+2]=T.x0,n[i+3]=T.y0,r[i+4]=A,r[i+5]=M,n[i+6]=c*S+f*w+v,n[i+7]=p*w+h*S+_,n[i+8]=T.x1,n[i+9]=T.y1,r[i+10]=A,r[i+11]=M,n[i+12]=c*S+f*b+v,n[i+13]=p*b+h*S+_,n[i+14]=T.x2,n[i+15]=T.y2,r[i+16]=A,r[i+17]=M,n[i+18]=c*C+f*b+v,n[i+19]=p*b+h*C+_,n[i+20]=T.x3,n[i+21]=T.y3,r[i+22]=A,r[i+23]=M}};DR.extension={type:[P.Batcher],name:"default"};let wm=DR;function Vy(t,e,n,r,i,s,o,a=null){let c=0;n*=e,i*=s;const h=a.a,f=a.b,p=a.c,v=a.d,_=a.tx,y=a.ty;for(;c<o;){const S=t[n],C=t[n+1];r[i]=h*S+p*C+_,r[i+1]=f*S+v*C+y,i+=s,n+=e,c++}}function jy(t,e,n,r){let i=0;for(e*=n;i<r;)t[e]=0,t[e+1]=0,e+=n,i++}function Cm(t,e,n,r,i){const s=e.a,o=e.b,a=e.c,c=e.d,h=e.tx,f=e.ty;n=n||0,r=r||2,i=i||t.length/r-n;let p=n*r;for(let v=0;v<i;v++){const _=t[p],y=t[p+1];t[p]=s*_+a*y+h,t[p+1]=o*_+c*y+f,p+=r}}function kR(t,e){if(t===16777215||!e)return e;if(e===16777215||!t)return t;const n=t>>16&255,r=t>>8&255,i=t&255,s=e>>16&255,o=e>>8&255,a=e&255,c=n*s/255,h=r*o/255,f=i*a/255;return(c<<16)+(h<<8)+f}const TN=new ae;class Tm{constructor(){this.packAsQuad=!1,this.batcherName="default",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,n=e>>16|e&65280|(e&255)<<16,r=this.renderable;return r?kR(n,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):n+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||TN}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData}reset(){this.applyTransform=!0,this.renderable=null}}const Yi={extension:{type:P.ShapeBuilder,name:"circle"},build(t,e){let n,r,i,s,o,a;if(t.type==="circle"){const A=t;n=A.x,r=A.y,o=a=A.radius,i=s=0}else if(t.type==="ellipse"){const A=t;n=A.x,r=A.y,o=A.halfWidth,a=A.halfHeight,i=s=0}else{const A=t,M=A.width/2,L=A.height/2;n=A.x+M,r=A.y+L,o=a=Math.max(0,Math.min(A.radius,Math.min(M,L))),i=M-o,s=L-a}if(!(o>=0&&a>=0&&i>=0&&s>=0))return e;const c=Math.ceil(2.3*Math.sqrt(o+a)),h=c*8+(i?4:0)+(s?4:0);if(h===0)return e;if(c===0)return e[0]=e[6]=n+i,e[1]=e[3]=r+s,e[2]=e[4]=n-i,e[5]=e[7]=r-s,e;let f=0,p=c*4+(i?2:0)+2,v=p,_=h,y=i+o,S=s,C=n+y,b=n-y,w=r+S;if(e[f++]=C,e[f++]=w,e[--p]=w,e[--p]=b,s){const A=r-S;e[v++]=b,e[v++]=A,e[--_]=A,e[--_]=C}for(let A=1;A<c;A++){const M=Math.PI/2*(A/c),L=i+Math.cos(M)*o,I=s+Math.sin(M)*a,N=n+L,k=n-L,G=r+I,ie=r-I;e[f++]=N,e[f++]=G,e[--p]=G,e[--p]=k,e[v++]=k,e[v++]=ie,e[--_]=ie,e[--_]=N}y=i,S=s+a,C=n+y,b=n-y,w=r+S;const T=r-S;return e[f++]=C,e[f++]=w,e[--_]=T,e[--_]=C,i&&(e[f++]=b,e[f++]=w,e[--_]=T,e[--_]=b),e},triangulate(t,e,n,r,i,s){if(t.length===0)return;let o=0,a=0;for(let f=0;f<t.length;f+=2)o+=t[f],a+=t[f+1];o/=t.length/2,a/=t.length/2;let c=r;e[c*n]=o,e[c*n+1]=a;const h=c++;for(let f=0;f<t.length;f+=2)e[c*n]=t[f],e[c*n+1]=t[f+1],f>0&&(i[s++]=c,i[s++]=h,i[s++]=c-1),c++;i[s++]=h+1,i[s++]=h,i[s++]=c-1}},FR={...Yi,extension:{...Yi.extension,name:"ellipse"}},IR={...Yi,extension:{...Yi.extension,name:"roundedRectangle"}},UR=1e-4,Q_=1e-4;function LR(t){const e=t.length;if(e<6)return 1;let n=0;for(let r=0,i=t[e-2],s=t[e-1];r<e;r+=2){const o=t[r],a=t[r+1];n+=(o-i)*(a+s),i=o,s=a}return n<0?-1:1}function KC(t,e,n,r,i,s,o,a){const c=t-n*i,h=e-r*i,f=t+n*s,p=e+r*s;let v,_;o?(v=r,_=-n):(v=-r,_=n);const y=c+v,S=h+_,C=f+v,b=p+_;return a.push(y,S),a.push(C,b),2}function vo(t,e,n,r,i,s,o,a){const c=n-t,h=r-e;let f=Math.atan2(c,h),p=Math.atan2(i-t,s-e);a&&f<p?f+=Math.PI*2:!a&&f>p&&(p+=Math.PI*2);let v=f;const _=p-f,y=Math.abs(_),S=Math.sqrt(c*c+h*h),C=(15*y*Math.sqrt(S)/Math.PI>>0)+1,b=_/C;if(v+=b,a){o.push(t,e),o.push(n,r);for(let w=1,T=v;w<C;w++,T+=b)o.push(t,e),o.push(t+Math.sin(T)*S,e+Math.cos(T)*S);o.push(t,e),o.push(i,s)}else{o.push(n,r),o.push(t,e);for(let w=1,T=v;w<C;w++,T+=b)o.push(t+Math.sin(T)*S,e+Math.cos(T)*S),o.push(t,e);o.push(i,s),o.push(t,e)}return C*2}function NR(t,e,n,r,i,s,o,a,c){const h=UR;if(t.length===0)return;const f=e;let p=f.alignment;if(e.alignment!==.5){let ce=LR(t);n&&(ce*=-1),p=(p-.5)*ce+.5}const v=new ze(t[0],t[1]),_=new ze(t[t.length-2],t[t.length-1]),y=r,S=Math.abs(v.x-_.x)<h&&Math.abs(v.y-_.y)<h;if(y){t=t.slice(),S&&(t.pop(),t.pop(),_.set(t[t.length-2],t[t.length-1]));const ce=(v.x+_.x)*.5,Zt=(_.y+v.y)*.5;t.unshift(ce,Zt),t.push(ce,Zt)}const C=i,b=t.length/2;let w=t.length;const T=C.length/2,A=f.width/2,M=A*A,L=f.miterLimit*f.miterLimit;let I=t[0],N=t[1],k=t[2],G=t[3],ie=0,Ze=0,re=-(N-G),J=I-k,ye=0,oe=0,Y=Math.sqrt(re*re+J*J);re/=Y,J/=Y,re*=A,J*=A;const V=p,z=(1-V)*2,W=V*2;y||(f.cap==="round"?w+=vo(I-re*(z-W)*.5,N-J*(z-W)*.5,I-re*z,N-J*z,I+re*W,N+J*W,C,!0)+2:f.cap==="square"&&(w+=KC(I,N,re,J,z,W,!0,C))),C.push(I-re*z,N-J*z),C.push(I+re*W,N+J*W);for(let ce=1;ce<b-1;++ce){I=t[(ce-1)*2],N=t[(ce-1)*2+1],k=t[ce*2],G=t[ce*2+1],ie=t[(ce+1)*2],Ze=t[(ce+1)*2+1],re=-(N-G),J=I-k,Y=Math.sqrt(re*re+J*J),re/=Y,J/=Y,re*=A,J*=A,ye=-(G-Ze),oe=k-ie,Y=Math.sqrt(ye*ye+oe*oe),ye/=Y,oe/=Y,ye*=A,oe*=A;const Zt=k-I,Jt=N-G,Nn=k-ie,en=Ze-G,Xr=Zt*Nn+Jt*en,la=Jt*Nn-en*Zt,Ci=la<0;if(Math.abs(la)<.001*Math.abs(Xr)){C.push(k-re*z,G-J*z),C.push(k+re*W,G+J*W),Xr>=0&&(f.join==="round"?w+=vo(k,G,k-re*z,G-J*z,k-ye*z,G-oe*z,C,!1)+4:w+=2,C.push(k-ye*W,G-oe*W),C.push(k+ye*z,G+oe*z));continue}const so=(-re+I)*(-J+G)-(-re+k)*(-J+N),tn=(-ye+ie)*(-oe+G)-(-ye+k)*(-oe+Ze),Ti=(Zt*tn-Nn*so)/la,Vt=(en*so-Jt*tn)/la,Ku=(Ti-k)*(Ti-k)+(Vt-G)*(Vt-G),Ei=k+(Ti-k)*z,Ai=G+(Vt-G)*z,Pi=k-(Ti-k)*W,Ri=G-(Vt-G)*W,tg=Math.min(Zt*Zt+Jt*Jt,Nn*Nn+en*en),cs=Ci?z:W,ng=tg+cs*cs*M;Ku<=ng?f.join==="bevel"||Ku/M>L?(Ci?(C.push(Ei,Ai),C.push(k+re*W,G+J*W),C.push(Ei,Ai),C.push(k+ye*W,G+oe*W)):(C.push(k-re*z,G-J*z),C.push(Pi,Ri),C.push(k-ye*z,G-oe*z),C.push(Pi,Ri)),w+=2):f.join==="round"?Ci?(C.push(Ei,Ai),C.push(k+re*W,G+J*W),w+=vo(k,G,k+re*W,G+J*W,k+ye*W,G+oe*W,C,!0)+4,C.push(Ei,Ai),C.push(k+ye*W,G+oe*W)):(C.push(k-re*z,G-J*z),C.push(Pi,Ri),w+=vo(k,G,k-re*z,G-J*z,k-ye*z,G-oe*z,C,!1)+4,C.push(k-ye*z,G-oe*z),C.push(Pi,Ri)):(C.push(Ei,Ai),C.push(Pi,Ri)):(C.push(k-re*z,G-J*z),C.push(k+re*W,G+J*W),f.join==="round"?Ci?w+=vo(k,G,k+re*W,G+J*W,k+ye*W,G+oe*W,C,!0)+2:w+=vo(k,G,k-re*z,G-J*z,k-ye*z,G-oe*z,C,!1)+2:f.join==="miter"&&Ku/M<=L&&(Ci?(C.push(Pi,Ri),C.push(Pi,Ri)):(C.push(Ei,Ai),C.push(Ei,Ai)),w+=2),C.push(k-ye*z,G-oe*z),C.push(k+ye*W,G+oe*W),w+=2)}I=t[(b-2)*2],N=t[(b-2)*2+1],k=t[(b-1)*2],G=t[(b-1)*2+1],re=-(N-G),J=I-k,Y=Math.sqrt(re*re+J*J),re/=Y,J/=Y,re*=A,J*=A,C.push(k-re*z,G-J*z),C.push(k+re*W,G+J*W),y||(f.cap==="round"?w+=vo(k-re*(z-W)*.5,G-J*(z-W)*.5,k-re*z,G-J*z,k+re*W,G+J*W,C,!1)+2:f.cap==="square"&&(w+=KC(k,G,re,J,z,W,!1,C)));const je=Q_*Q_;for(let ce=T;ce<w+T-2;++ce)I=C[ce*2],N=C[ce*2+1],k=C[(ce+1)*2],G=C[(ce+1)*2+1],ie=C[(ce+2)*2],Ze=C[(ce+2)*2+1],!(Math.abs(I*(G-Ze)+k*(Ze-N)+ie*(N-G))<je)&&a.push(ce,ce+1,ce+2)}function Wy(t,e,n,r,i,s,o){const a=eR(t,e,2);if(!a)return;for(let h=0;h<a.length;h+=3)s[o++]=a[h]+i,s[o++]=a[h+1]+i,s[o++]=a[h+2]+i;let c=i*r;for(let h=0;h<t.length;h+=2)n[c]=t[h],n[c+1]=t[h+1],c+=r}const EN=[],$y={extension:{type:P.ShapeBuilder,name:"polygon"},build(t,e){for(let n=0;n<t.points.length;n++)e[n]=t.points[n];return e},triangulate(t,e,n,r,i,s){Wy(t,EN,e,n,r,i,s)}},Xy={extension:{type:P.ShapeBuilder,name:"rectangle"},build(t,e){const n=t,r=n.x,i=n.y,s=n.width,o=n.height;return s>=0&&o>=0&&(e[0]=r,e[1]=i,e[2]=r+s,e[3]=i,e[4]=r+s,e[5]=i+o,e[6]=r,e[7]=i+o),e},triangulate(t,e,n,r,i,s){let o=0;r*=n,e[r+o]=t[0],e[r+o+1]=t[1],o+=n,e[r+o]=t[2],e[r+o+1]=t[3],o+=n,e[r+o]=t[6],e[r+o+1]=t[7],o+=n,e[r+o]=t[4],e[r+o+1]=t[5],o+=n;const a=r/n;i[s++]=a,i[s++]=a+1,i[s++]=a+2,i[s++]=a+1,i[s++]=a+3,i[s++]=a+2}},Yy={extension:{type:P.ShapeBuilder,name:"triangle"},build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,n,r,i,s){let o=0;r*=n,e[r+o]=t[0],e[r+o+1]=t[1],o+=n,e[r+o]=t[2],e[r+o+1]=t[3],o+=n,e[r+o]=t[4],e[r+o+1]=t[5];const a=r/n;i[s++]=a,i[s++]=a+1,i[s++]=a+2}},ch={};Ne.handleByMap(P.ShapeBuilder,ch);Ne.add(Xy,$y,Yy,Yi,FR,IR);const AN=new Ke;function GR(t,e){const{geometryData:n,batches:r}=e;r.length=0,n.indices.length=0,n.vertices.length=0,n.uvs.length=0;for(let i=0;i<t.instructions.length;i++){const s=t.instructions[i];if(s.action==="texture")PN(s.data,r,n);else if(s.action==="fill"||s.action==="stroke"){const o=s.action==="stroke",a=s.data.path.shapePath,c=s.data.style,h=s.data.hole;o&&h&&QC(h.shapePath,c,null,!0,r,n),QC(a,c,h,o,r,n)}}}function PN(t,e,n){const{vertices:r,uvs:i,indices:s}=n,o=s.length,a=r.length/2,c=[],h=ch.rectangle,f=AN,p=t.image;f.x=t.dx,f.y=t.dy,f.width=t.dw,f.height=t.dh;const v=t.transform;h.build(f,c),v&&Cm(c,v),h.triangulate(c,r,2,a,s,o);const _=p.uvs;i.push(_.x0,_.y0,_.x1,_.y1,_.x3,_.y3,_.x2,_.y2);const y=Ae.get(Tm);y.indexOffset=o,y.indexSize=s.length-o,y.attributeOffset=a,y.attributeSize=r.length/2-a,y.baseColor=t.style,y.alpha=t.alpha,y.texture=p,y.geometryData=n,e.push(y)}function QC(t,e,n,r,i,s){const{vertices:o,uvs:a,indices:c}=s,h=t.shapePrimitives.length-1;t.shapePrimitives.forEach(({shape:f,transform:p},v)=>{const _=c.length,y=o.length/2,S=[],C=ch[f.type];if(C.build(f,S),p&&Cm(S,p),r){const A=f.closePath??!0;NR(S,e,!1,A,o,2,y,c)}else if(n&&h===v){h!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const A=[],M=S.slice();RN(n.shapePath).forEach(I=>{A.push(M.length/2),M.push(...I)}),Wy(M,A,o,2,y,c,_)}else C.triangulate(S,o,2,y,c,_);const b=a.length/2,w=e.texture;if(w!==X.WHITE){const A=e.matrix;A&&(p&&A.append(p.clone().invert()),Vy(o,2,y,a,b,2,o.length/2-y,A))}else jy(a,b,2,o.length/2-y);const T=Ae.get(Tm);T.indexOffset=_,T.indexSize=c.length-_,T.attributeOffset=y,T.attributeSize=o.length/2-y,T.baseColor=e.color,T.alpha=e.alpha,T.texture=w,T.geometryData=s,i.push(T)})}function RN(t){if(!t)return[];const e=t.shapePrimitives,n=[];for(let r=0;r<e.length;r++){const i=e[r].shape,s=[];ch[i.type].build(i,s),n.push(s)}return n}class zR{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class HR{constructor(){this.batcher=new wm,this.instructions=new iy}init(){this.instructions.reset()}get geometry(){return q(qP,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const qy=class Z_{constructor(){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null)}init(e){Z_.defaultOptions.bezierSmoothness=e?.bezierSmoothness??Z_.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let n=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){n?this._cleanGraphicsContextData(e):n=this._initContext(e),GR(e,n);const r=e.batchMode;e.customShader||r==="no-batch"?n.isBatchable=!1:r==="auto"&&(n.isBatchable=n.geometryData.vertices.length<400),e.dirty=!1}return n}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const n=Ae.get(HR),{batches:r,geometryData:i}=this._gpuContextHash[e.uid],s=i.vertices.length,o=i.indices.length;for(let f=0;f<r.length;f++)r[f].applyTransform=!1;const a=n.batcher;a.ensureAttributeBuffer(s),a.ensureIndexBuffer(o),a.begin();for(let f=0;f<r.length;f++){const p=r[f];a.add(p)}a.finish(n.instructions);const c=a.geometry;c.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),c.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const h=a.batches;for(let f=0;f<h.length;f++){const p=h[f];p.bindGroup=vm(p.textures.textures,p.textures.count)}return this._graphicsDataContextHash[e.uid]=n,n}_initContext(e){const n=new zR;return n.context=e,this._gpuContextHash[e.uid]=n,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const n=this._gpuContextHash[e.uid];n.isBatchable||this._graphicsDataContextHash[e.uid]&&(Ae.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),n.batches&&n.batches.forEach(r=>{Ae.return(r)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};qy.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"graphicsContext"};qy.defaultOptions={bezierSmoothness:.5};let Ky=qy;const BN=8,Xf=11920929e-14,MN=1;function Qy(t,e,n,r,i,s,o,a,c,h){const p=Math.min(.99,Math.max(0,h??Ky.defaultOptions.bezierSmoothness));let v=(MN-p)/1;return v*=v,DN(e,n,r,i,s,o,a,c,t,v),t}function DN(t,e,n,r,i,s,o,a,c,h){J_(t,e,n,r,i,s,o,a,c,h,0),c.push(o,a)}function J_(t,e,n,r,i,s,o,a,c,h,f){if(f>BN)return;const p=(t+n)/2,v=(e+r)/2,_=(n+i)/2,y=(r+s)/2,S=(i+o)/2,C=(s+a)/2,b=(p+_)/2,w=(v+y)/2,T=(_+S)/2,A=(y+C)/2,M=(b+T)/2,L=(w+A)/2;if(f>0){let I=o-t,N=a-e;const k=Math.abs((n-o)*N-(r-a)*I),G=Math.abs((i-o)*N-(s-a)*I);if(k>Xf&&G>Xf){if((k+G)*(k+G)<=h*(I*I+N*N)){c.push(M,L);return}}else if(k>Xf){if(k*k<=h*(I*I+N*N)){c.push(M,L);return}}else if(G>Xf){if(G*G<=h*(I*I+N*N)){c.push(M,L);return}}else if(I=M-(t+o)/2,N=L-(e+a)/2,I*I+N*N<=h){c.push(M,L);return}}J_(t,e,p,v,b,w,M,L,c,h,f+1),J_(M,L,T,A,S,C,o,a,c,h,f+1)}const ON=8,kN=11920929e-14,FN=1;function VR(t,e,n,r,i,s,o,a){const h=Math.min(.99,Math.max(0,a??Ky.defaultOptions.bezierSmoothness));let f=(FN-h)/1;return f*=f,IN(e,n,r,i,s,o,t,f),t}function IN(t,e,n,r,i,s,o,a){e2(o,t,e,n,r,i,s,a,0),o.push(i,s)}function e2(t,e,n,r,i,s,o,a,c){if(c>ON)return;const h=(e+r)/2,f=(n+i)/2,p=(r+s)/2,v=(i+o)/2,_=(h+p)/2,y=(f+v)/2;let S=s-e,C=o-n;const b=Math.abs((r-s)*C-(i-o)*S);if(b>kN){if(b*b<=a*(S*S+C*C)){t.push(_,y);return}}else if(S=_-(e+s)/2,C=y-(n+o)/2,S*S+C*C<=a){t.push(_,y);return}e2(t,e,n,h,f,_,y,a,c+1),e2(t,_,y,p,v,s,o,a,c+1)}function Zy(t,e,n,r,i,s,o,a){let c=Math.abs(i-s);(!o&&i>s||o&&s>i)&&(c=2*Math.PI-c),a=a||Math.max(6,Math.floor(6*Math.pow(r,1/3)*(c/Math.PI))),a=Math.max(a,3);let h=c/a,f=i;h*=o?-1:1;for(let p=0;p<a+1;p++){const v=Math.cos(f),_=Math.sin(f),y=e+v*r,S=n+_*r;t.push(y,S),f+=h}}function jR(t,e,n,r,i,s){const o=t[t.length-2],c=t[t.length-1]-n,h=o-e,f=i-n,p=r-e,v=Math.abs(c*p-h*f);if(v<1e-8||s===0){(t[t.length-2]!==e||t[t.length-1]!==n)&&t.push(e,n);return}const _=c*c+h*h,y=f*f+p*p,S=c*f+h*p,C=s*Math.sqrt(_)/v,b=s*Math.sqrt(y)/v,w=C*S/_,T=b*S/y,A=C*p+b*h,M=C*f+b*c,L=h*(b+w),I=c*(b+w),N=p*(C+T),k=f*(C+T),G=Math.atan2(I-M,L-A),ie=Math.atan2(k-M,N-A);Zy(t,A+e,M+n,s,G,ie,h*f>p*c)}const rc=Math.PI*2,mv={centerX:0,centerY:0,ang1:0,ang2:0},gv=({x:t,y:e},n,r,i,s,o,a,c)=>{t*=n,e*=r;const h=i*t-s*e,f=s*t+i*e;return c.x=h+o,c.y=f+a,c};function UN(t,e){const n=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),r=e===1.5707963267948966?.551915024494:n,i=Math.cos(t),s=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:i-s*r,y:s+i*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]}const ZC=(t,e,n,r)=>{const i=t*r-e*n<0?-1:1;let s=t*n+e*r;return s>1&&(s=1),s<-1&&(s=-1),i*Math.acos(s)},LN=(t,e,n,r,i,s,o,a,c,h,f,p,v)=>{const _=Math.pow(i,2),y=Math.pow(s,2),S=Math.pow(f,2),C=Math.pow(p,2);let b=_*y-_*C-y*S;b<0&&(b=0),b/=_*C+y*S,b=Math.sqrt(b)*(o===a?-1:1);const w=b*i/s*p,T=b*-s/i*f,A=h*w-c*T+(t+n)/2,M=c*w+h*T+(e+r)/2,L=(f-w)/i,I=(p-T)/s,N=(-f-w)/i,k=(-p-T)/s,G=ZC(1,0,L,I);let ie=ZC(L,I,N,k);a===0&&ie>0&&(ie-=rc),a===1&&ie<0&&(ie+=rc),v.centerX=A,v.centerY=M,v.ang1=G,v.ang2=ie};function WR(t,e,n,r,i,s,o,a=0,c=0,h=0){if(s===0||o===0)return;const f=Math.sin(a*rc/360),p=Math.cos(a*rc/360),v=p*(e-r)/2+f*(n-i)/2,_=-f*(e-r)/2+p*(n-i)/2;if(v===0&&_===0)return;s=Math.abs(s),o=Math.abs(o);const y=Math.pow(v,2)/Math.pow(s,2)+Math.pow(_,2)/Math.pow(o,2);y>1&&(s*=Math.sqrt(y),o*=Math.sqrt(y)),LN(e,n,r,i,s,o,c,h,f,p,v,_,mv);let{ang1:S,ang2:C}=mv;const{centerX:b,centerY:w}=mv;let T=Math.abs(C)/(rc/4);Math.abs(1-T)<1e-7&&(T=1);const A=Math.max(Math.ceil(T),1);C/=A;let M=t[t.length-2],L=t[t.length-1];const I={x:0,y:0};for(let N=0;N<A;N++){const k=UN(S,C),{x:G,y:ie}=gv(k[0],s,o,p,f,b,w,I),{x:Ze,y:re}=gv(k[1],s,o,p,f,b,w,I),{x:J,y:ye}=gv(k[2],s,o,p,f,b,w,I);Qy(t,M,L,G,ie,Ze,re,J,ye),M=J,L=ye,S+=C}}function $R(t,e,n){const r=(o,a)=>{const c=a.x-o.x,h=a.y-o.y,f=Math.sqrt(c*c+h*h),p=c/f,v=h/f;return{len:f,nx:p,ny:v}},i=(o,a)=>{o===0?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)};let s=e[e.length-1];for(let o=0;o<e.length;o++){const a=e[o%e.length],c=a.radius??n;if(c<=0){i(o,a),s=a;continue}const h=e[(o+1)%e.length],f=r(a,s),p=r(a,h);if(f.len<1e-4||p.len<1e-4){i(o,a),s=a;continue}let v=Math.asin(f.nx*p.ny-f.ny*p.nx),_=1,y=!1;f.nx*p.nx-f.ny*-p.ny<0?v<0?v=Math.PI+v:(v=Math.PI-v,_=-1,y=!0):v>0&&(_=-1,y=!0);const S=v/2;let C,b=Math.abs(Math.cos(S)*c/Math.sin(S));b>Math.min(f.len/2,p.len/2)?(b=Math.min(f.len/2,p.len/2),C=Math.abs(b*Math.sin(S)/Math.cos(S))):C=c;const w=a.x+p.nx*b+-p.ny*C*_,T=a.y+p.ny*b+p.nx*C*_,A=Math.atan2(f.ny,f.nx)+Math.PI/2*_,M=Math.atan2(p.ny,p.nx)-Math.PI/2*_;o===0&&t.moveTo(w+Math.cos(A)*C,T+Math.sin(A)*C),t.arc(w,T,C,A,M,y),s=a}}function XR(t,e,n,r){const i=(a,c)=>Math.sqrt((a.x-c.x)**2+(a.y-c.y)**2),s=(a,c,h)=>({x:a.x+(c.x-a.x)*h,y:a.y+(c.y-a.y)*h}),o=e.length;for(let a=0;a<o;a++){const c=e[(a+1)%o],h=c.radius??n;if(h<=0){a===0?t.moveTo(c.x,c.y):t.lineTo(c.x,c.y);continue}const f=e[a],p=e[(a+2)%o],v=i(f,c);let _;if(v<1e-4)_=c;else{const C=Math.min(v/2,h);_=s(c,f,C/v)}const y=i(p,c);let S;if(y<1e-4)S=c;else{const C=Math.min(y/2,h);S=s(c,p,C/y)}a===0?t.moveTo(_.x,_.y):t.lineTo(_.x,_.y),t.quadraticCurveTo(c.x,c.y,S.x,S.y,r)}}const NN=new Ke;class YR{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Kt,this._graphicsPath2D=e}moveTo(e,n){return this.startPoly(e,n),this}lineTo(e,n){this._ensurePoly();const r=this._currentPoly.points,i=r[r.length-2],s=r[r.length-1];return(i!==e||s!==n)&&r.push(e,n),this}arc(e,n,r,i,s,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Zy(a,e,n,r,i,s,o),this}arcTo(e,n,r,i,s){this._ensurePoly();const o=this._currentPoly.points;return jR(o,e,n,r,i,s),this}arcToSvg(e,n,r,i,s,o,a){const c=this._currentPoly.points;return WR(c,this._currentPoly.lastX,this._currentPoly.lastY,o,a,e,n,r,i,s),this}bezierCurveTo(e,n,r,i,s,o,a){this._ensurePoly();const c=this._currentPoly;return Qy(this._currentPoly.points,c.lastX,c.lastY,e,n,r,i,s,o,a),this}quadraticCurveTo(e,n,r,i,s){this._ensurePoly();const o=this._currentPoly;return VR(this._currentPoly.points,o.lastX,o.lastY,e,n,r,i,s),this}closePath(){return this.endPoly(!0),this}addPath(e,n){this.endPoly(),n&&!n.isIdentity()&&(e=e.clone(!0),e.transform(n));for(let r=0;r<e.instructions.length;r++){const i=e.instructions[r];this[i.action](...i.data)}return this}finish(e=!1){this.endPoly(e)}rect(e,n,r,i,s){return this.drawShape(new Ke(e,n,r,i),s),this}circle(e,n,r,i){return this.drawShape(new pm(e,n,r),i),this}poly(e,n,r){const i=new hu(e);return i.closePath=n,this.drawShape(i,r),this}regularPoly(e,n,r,i,s=0,o){i=Math.max(i|0,3);const a=-1*Math.PI/2+s,c=Math.PI*2/i,h=[];for(let f=0;f<i;f++){const p=f*c+a;h.push(e+r*Math.cos(p),n+r*Math.sin(p))}return this.poly(h,!0,o),this}roundPoly(e,n,r,i,s,o=0,a){if(i=Math.max(i|0,3),s<=0)return this.regularPoly(e,n,r,i,o);const c=r*Math.sin(Math.PI/i)-.001;s=Math.min(s,c);const h=-1*Math.PI/2+o,f=Math.PI*2/i,p=(i-2)*Math.PI/i/2;for(let v=0;v<i;v++){const _=v*f+h,y=e+r*Math.cos(_),S=n+r*Math.sin(_),C=_+Math.PI+p,b=_-Math.PI-p,w=y+s*Math.cos(C),T=S+s*Math.sin(C),A=y+s*Math.cos(b),M=S+s*Math.sin(b);v===0?this.moveTo(w,T):this.lineTo(w,T),this.quadraticCurveTo(y,S,A,M,a)}return this.closePath()}roundShape(e,n,r=!1,i){return e.length<3?this:(r?XR(this,e,n,i):$R(this,e,n),this.closePath())}filletRect(e,n,r,i,s){if(s===0)return this.rect(e,n,r,i);const o=Math.min(r,i)/2,a=Math.min(o,Math.max(-o,s)),c=e+r,h=n+i,f=a<0?-a:0,p=Math.abs(a);return this.moveTo(e,n+p).arcTo(e+f,n+f,e+p,n,p).lineTo(c-p,n).arcTo(c-f,n+f,c,n+p,p).lineTo(c,h-p).arcTo(c-f,h-f,e+r-p,h,p).lineTo(e+p,h).arcTo(e+f,h-f,e,h-p,p).closePath()}chamferRect(e,n,r,i,s,o){if(s<=0)return this.rect(e,n,r,i);const a=Math.min(s,Math.min(r,i)/2),c=e+r,h=n+i,f=[e+a,n,c-a,n,c,n+a,c,h-a,c-a,h,e+a,h,e,h-a,e,n+a];for(let p=f.length-1;p>=2;p-=2)f[p]===f[p-2]&&f[p-1]===f[p-3]&&f.splice(p-1,2);return this.poly(f,!0,o)}ellipse(e,n,r,i,s){return this.drawShape(new mm(e,n,r,i),s),this}roundRect(e,n,r,i,s,o){return this.drawShape(new gm(e,n,r,i,s),o),this}drawShape(e,n){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:n}),this}startPoly(e,n){let r=this._currentPoly;return r&&this.endPoly(),r=new hu,r.points.push(e,n),this._currentPoly=r,this}endPoly(e=!1){const n=this._currentPoly;return n&&n.points.length>2&&(n.closePath=e,this.shapePrimitives.push({shape:n})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new hu,e)){const n=this.shapePrimitives[this.shapePrimitives.length-1];if(n){let r=n.shape.x,i=n.shape.y;if(n.transform&&!n.transform.isIdentity()){const s=n.transform,o=r;r=s.a*r+s.c*i+s.tx,i=s.b*o+s.d*i+s.ty}this._currentPoly.points.push(r,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let n=0;n<e.instructions.length;n++){const r=e.instructions[n];this[r.action](...r.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const n=this.shapePrimitives;for(let r=0;r<n.length;r++){const i=n[r],s=i.shape.getBounds(NN);i.transform?e.addRect(s,i.transform):e.addRect(s)}return e}}class Ws{constructor(e){this.instructions=[],this.uid=ot("graphicsPath"),this._dirty=!0,typeof e=="string"?uR(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new YR(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,n){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,n]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,n,r,i,s){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(ze.shared);let c=0,h=0;if(!o||o.action!=="bezierCurveTo")c=a.x,h=a.y;else{c=o.data[2],h=o.data[3];const f=a.x,p=a.y;c=f+(f-c),h=p+(p-h)}return this.instructions.push({action:"bezierCurveTo",data:[c,h,e,n,r,i,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,n,r){const i=this.instructions[this.instructions.length-1],s=this.getLastPoint(ze.shared);let o=0,a=0;if(!i||i.action!=="quadraticCurveTo")o=s.x,a=s.y;else{o=i.data[0],a=i.data[1];const c=s.x,h=s.y;o=c+(c-o),a=h+(h-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,e,n,r]}),this._dirty=!0,this}rect(e,n,r,i,s){return this.instructions.push({action:"rect",data:[e,n,r,i,s]}),this._dirty=!0,this}circle(e,n,r,i){return this.instructions.push({action:"circle",data:[e,n,r,i]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,n,r,i,s,o,a){s=s||i/2;const c=-1*Math.PI/2+o,h=r*2,f=Math.PI*2/h,p=[];for(let v=0;v<h;v++){const _=v%2?s:i,y=v*f+c;p.push(e+_*Math.cos(y),n+_*Math.sin(y))}return this.poly(p,!0,a),this}clone(e=!1){const n=new Ws;if(!e)n.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const i=this.instructions[r];n.instructions.push({action:i.action,data:i.data.slice()})}return n}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const n=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty;let c=0,h=0,f=0,p=0,v=0,_=0,y=0,S=0;for(let C=0;C<this.instructions.length;C++){const b=this.instructions[C],w=b.data;switch(b.action){case"moveTo":case"lineTo":c=w[0],h=w[1],w[0]=n*c+i*h+o,w[1]=r*c+s*h+a;break;case"bezierCurveTo":f=w[0],p=w[1],v=w[2],_=w[3],c=w[4],h=w[5],w[0]=n*f+i*p+o,w[1]=r*f+s*p+a,w[2]=n*v+i*_+o,w[3]=r*v+s*_+a,w[4]=n*c+i*h+o,w[5]=r*c+s*h+a;break;case"quadraticCurveTo":f=w[0],p=w[1],c=w[2],h=w[3],w[0]=n*f+i*p+o,w[1]=r*f+s*p+a,w[2]=n*c+i*h+o,w[3]=r*c+s*h+a;break;case"arcToSvg":c=w[5],h=w[6],y=w[0],S=w[1],w[0]=n*y+i*S,w[1]=r*y+s*S,w[5]=n*c+i*h+o,w[6]=r*c+s*h+a;break;case"circle":w[4]=Pl(w[3],e);break;case"rect":w[4]=Pl(w[4],e);break;case"ellipse":w[8]=Pl(w[8],e);break;case"roundRect":w[5]=Pl(w[5],e);break;case"addPath":w[0].transform(e);break;case"poly":w[2]=Pl(w[2],e);break;default:de("unknown transform action",b.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let n=this.instructions.length-1,r=this.instructions[n];if(!r)return e.x=0,e.y=0,e;for(;r.action==="closePath";){if(n--,n<0)return e.x=0,e.y=0,e;r=this.instructions[n]}switch(r.action){case"moveTo":case"lineTo":e.x=r.data[0],e.y=r.data[1];break;case"quadraticCurveTo":e.x=r.data[2],e.y=r.data[3];break;case"bezierCurveTo":e.x=r.data[4],e.y=r.data[5];break;case"arc":case"arcToSvg":e.x=r.data[5],e.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(e);break}return e}}function Pl(t,e){return t?t.prepend(e):e.clone()}function qR(t,e){if(typeof t=="string"){const r=document.createElement("div");r.innerHTML=t.trim(),t=r.querySelector("svg")}const n={context:e,path:new Ws};return KR(t,n,null,null),e}function KR(t,e,n,r){const i=t.children,{fillStyle:s,strokeStyle:o}=GN(t);s&&n?n={...n,...s}:s&&(n=s),o&&r?r={...r,...o}:o&&(r=o),e.context.fillStyle=n,e.context.strokeStyle=r;let a,c,h,f,p,v,_,y,S,C,b,w,T,A,M,L,I;switch(t.nodeName.toLowerCase()){case"path":A=t.getAttribute("d"),M=new Ws(A),e.context.path(M),n&&e.context.fill(),r&&e.context.stroke();break;case"circle":_=Ut(t,"cx",0),y=Ut(t,"cy",0),S=Ut(t,"r",0),e.context.ellipse(_,y,S,S),n&&e.context.fill(),r&&e.context.stroke();break;case"rect":a=Ut(t,"x",0),c=Ut(t,"y",0),L=Ut(t,"width",0),I=Ut(t,"height",0),C=Ut(t,"rx",0),b=Ut(t,"ry",0),C||b?e.context.roundRect(a,c,L,I,C||b):e.context.rect(a,c,L,I),n&&e.context.fill(),r&&e.context.stroke();break;case"ellipse":_=Ut(t,"cx",0),y=Ut(t,"cy",0),C=Ut(t,"rx",0),b=Ut(t,"ry",0),e.context.beginPath(),e.context.ellipse(_,y,C,b),n&&e.context.fill(),r&&e.context.stroke();break;case"line":h=Ut(t,"x1",0),f=Ut(t,"y1",0),p=Ut(t,"x2",0),v=Ut(t,"y2",0),e.context.beginPath(),e.context.moveTo(h,f),e.context.lineTo(p,v),r&&e.context.stroke();break;case"polygon":T=t.getAttribute("points"),w=T.match(/\d+/g).map(N=>parseInt(N,10)),e.context.poly(w,!0),n&&e.context.fill(),r&&e.context.stroke();break;case"polyline":T=t.getAttribute("points"),w=T.match(/\d+/g).map(N=>parseInt(N,10)),e.context.poly(w,!1),r&&e.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${t.nodeName}> elements unsupported`);break}}for(let N=0;N<i.length;N++)KR(i[N],e,n,r)}function Ut(t,e,n){const r=t.getAttribute(e);return r?Number(r):n}function GN(t){const e=t.getAttribute("style"),n={},r={};let i=!1,s=!1;if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const c=o[a],[h,f]=c.split(":");switch(h){case"stroke":f!=="none"&&(n.color=ve.shared.setValue(f).toNumber(),s=!0);break;case"stroke-width":n.width=Number(f);break;case"fill":f!=="none"&&(i=!0,r.color=ve.shared.setValue(f).toNumber());break;case"fill-opacity":r.alpha=Number(f);break;case"stroke-opacity":n.alpha=Number(f);break;case"opacity":r.alpha=Number(f),n.alpha=Number(f);break}}}else{const o=t.getAttribute("stroke");o&&o!=="none"&&(s=!0,n.color=ve.shared.setValue(o).toNumber(),n.width=Ut(t,"stroke-width",1));const a=t.getAttribute("fill");a&&a!=="none"&&(i=!0,r.color=ve.shared.setValue(a).toNumber())}return{strokeStyle:s?n:null,fillStyle:i?r:null}}function zN(t){return ve.isColorLike(t)}function JC(t){return t instanceof lh}function eT(t){return t instanceof Ru}function HN(t,e,n){const r=ve.shared.setValue(e??0);return t.color=r.toNumber(),t.alpha=r.alpha===1?n.alpha:r.alpha,t.texture=X.WHITE,{...n,...t}}function tT(t,e,n){return t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...n,...t}}function nT(t,e,n){return e.buildLinearGradient(),t.fill=e,t.color=16777215,t.texture=e.texture,t.matrix=e.transform,{...n,...t}}function VN(t,e){const n={...e,...t};if(n.texture){if(n.texture!==X.WHITE){const s=n.matrix?.invert()||new ae;s.translate(n.texture.frame.x,n.texture.frame.y),s.scale(1/n.texture.source.width,1/n.texture.source.height),n.matrix=s}const i=n.texture.source.style;i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update())}const r=ve.shared.setValue(n.color);return n.alpha*=r.alpha,n.color=r.toNumber(),n.matrix=n.matrix?n.matrix.clone():null,n}function Ds(t,e){if(t==null)return null;const n={},r=t;return zN(t)?HN(n,t,e):JC(t)?tT(n,t,e):eT(t)?nT(n,t,e):r.fill&&JC(r.fill)?tT(r,r.fill,e):r.fill&&eT(r.fill)?nT(r,r.fill,e):VN(r,e)}function Uc(t,e){const{width:n,alignment:r,miterLimit:i,cap:s,join:o,...a}=e,c=Ds(t,a);return c?{width:n,alignment:r,miterLimit:i,cap:s,join:o,...c}:null}const jN=new ze,rT=new ae,Jy=class ii extends Mt{constructor(){super(...arguments),this.uid=ot("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Ws,this._transform=new ae,this._fillStyle={...ii.defaultFillStyle},this._strokeStyle={...ii.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Kt,this._boundsDirty=!0}clone(){const e=new ii;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Ds(e,ii.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Uc(e,ii.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Ds(e,ii.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Ds(e,ii.defaultStrokeStyle),this}texture(e,n,r,i,s,o){return this.instructions.push({action:"texture",data:{image:e,dx:r||0,dy:i||0,dw:s||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:n?ve.shared.setValue(n).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Ws,this}fill(e,n){let r;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="stroke"?r=i.data.path:r=this._activePath.clone(),r?(e!=null&&(n!==void 0&&typeof e=="number"&&(q(ge,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:n}),this._fillStyle=Ds(e,ii.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:n}=this._activePath.getLastPoint(ze.shared);this._activePath.clear(),this._activePath.moveTo(e,n)}stroke(e){let n;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="fill"?n=r.data.path:n=this._activePath.clone(),n?(e!=null&&(this._strokeStyle=Uc(e,ii.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const n=this.instructions[this.instructions.length-1-e],r=this._activePath.clone();if(n&&(n.action==="stroke"||n.action==="fill"))if(n.data.hole)n.data.hole.addPath(r);else{n.data.hole=r;break}}return this._initNextPathLocation(),this}arc(e,n,r,i,s,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*n+a.tx,a.b*e+a.d*n+a.ty,r,i,s,o),this}arcTo(e,n,r,i,s){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*n+o.tx,o.b*e+o.d*n+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}arcToSvg(e,n,r,i,s,o,a){this._tick++;const c=this._transform;return this._activePath.arcToSvg(e,n,r,i,s,c.a*o+c.c*a+c.tx,c.b*o+c.d*a+c.ty),this}bezierCurveTo(e,n,r,i,s,o,a){this._tick++;const c=this._transform;return this._activePath.bezierCurveTo(c.a*e+c.c*n+c.tx,c.b*e+c.d*n+c.ty,c.a*r+c.c*i+c.tx,c.b*r+c.d*i+c.ty,c.a*s+c.c*o+c.tx,c.b*s+c.d*o+c.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,n,r,i){return this._tick++,this._activePath.ellipse(e,n,r,i,this._transform.clone()),this}circle(e,n,r){return this._tick++,this._activePath.circle(e,n,r,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,n){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*e+r.c*n+r.tx,r.b*e+r.d*n+r.ty),this}moveTo(e,n){this._tick++;const r=this._transform,i=this._activePath.instructions,s=r.a*e+r.c*n+r.tx,o=r.b*e+r.d*n+r.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=s,i[0].data[1]=o,this):(this._activePath.moveTo(s,o),this)}quadraticCurveTo(e,n,r,i,s){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*n+o.tx,o.b*e+o.d*n+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}rect(e,n,r,i){return this._tick++,this._activePath.rect(e,n,r,i,this._transform.clone()),this}roundRect(e,n,r,i,s){return this._tick++,this._activePath.roundRect(e,n,r,i,s,this._transform.clone()),this}poly(e,n){return this._tick++,this._activePath.poly(e,n,this._transform.clone()),this}regularPoly(e,n,r,i,s=0,o){return this._tick++,this._activePath.regularPoly(e,n,r,i,s,o),this}roundPoly(e,n,r,i,s,o){return this._tick++,this._activePath.roundPoly(e,n,r,i,s,o),this}roundShape(e,n,r,i){return this._tick++,this._activePath.roundShape(e,n,r,i),this}filletRect(e,n,r,i,s){return this._tick++,this._activePath.filletRect(e,n,r,i,s),this}chamferRect(e,n,r,i,s,o){return this._tick++,this._activePath.chamferRect(e,n,r,i,s,o),this}star(e,n,r,i,s=0,o=0){return this._tick++,this._activePath.star(e,n,r,i,s,o,this._transform.clone()),this}svg(e){return this._tick++,qR(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,n=e){return this._transform.scale(e,n),this}setTransform(e,n,r,i,s,o){return e instanceof ae?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,n,r,i,s,o),this)}transform(e,n,r,i,s,o){return e instanceof ae?(this._transform.append(e),this):(rT.set(e,n,r,i,s,o),this._transform.append(rT),this)}translate(e,n=e){return this._transform.translate(e,n),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const e=this._bounds;e.clear();for(let n=0;n<this.instructions.length;n++){const r=this.instructions[n],i=r.action;if(i==="fill"){const s=r.data;e.addBounds(s.path.bounds)}else if(i==="texture"){const s=r.data;e.addFrame(s.dx,s.dy,s.dx+s.dw,s.dy+s.dh,s.transform)}if(i==="stroke"){const s=r.data,o=s.style.width/2,a=s.path.bounds;e.addFrame(a.minX-o,a.minY-o,a.maxX+o,a.maxY+o)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const n=this.instructions;let r=!1;for(let i=0;i<n.length;i++){const s=n[i],o=s.data,a=o.path;if(!s.action||!a)continue;const c=o.style,h=a.shapePath.shapePrimitives;for(let f=0;f<h.length;f++){const p=h[f].shape;if(!c||!p)continue;const v=h[f].transform,_=v?v.applyInverse(e,jN):e;s.action==="fill"?r=p.contains(_.x,_.y):r=p.strokeContains(_.x,_.y,c.width);const y=o.hole;if(y){const S=y.shapePath?.shapePrimitives;if(S)for(let C=0;C<S.length;C++)S[C].shape.contains(_.x,_.y)&&(r=!1)}if(r)return!0}}return r}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(r),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(r)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Jy.defaultFillStyle={color:16777215,alpha:1,texture:X.WHITE,matrix:null,fill:null};Jy.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:X.WHITE,matrix:null,fill:null};let mn=Jy;const iT=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function e1(t){const e=[];let n=0;for(let r=0;r<iT.length;r++){const i=`_${iT[r]}`;e[n++]=t[i]}return n=QR(t._fill,e,n),n=WN(t._stroke,e,n),n=$N(t.dropShadow,e,n),e.join("-")}function QR(t,e,n){return t&&(e[n++]=t.color,e[n++]=t.alpha,e[n++]=t.fill?.styleKey),n}function WN(t,e,n){return t&&(n=QR(t,e,n),e[n++]=t.width,e[n++]=t.alignment,e[n++]=t.cap,e[n++]=t.join,e[n++]=t.miterLimit),n}function $N(t,e,n){return t&&(e[n++]=t.alpha,e[n++]=t.angle,e[n++]=t.blur,e[n++]=t.distance,e[n++]=ve.shared.setValue(t.color).toNumber()),n}const t1=class ka extends Mt{constructor(e={}){super(),XN(e);const n={...ka.defaultTextStyle,...e};for(const r in n){const i=r;this[i]=n[r]}this.update()}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...ka.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...ka.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e,this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...mn.defaultFillStyle,...e},()=>{this._fill=Ds({...this._originalFill},mn.defaultFillStyle)})),this._fill=Ds(e===0?"black":e,mn.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...mn.defaultStrokeStyle,...e},()=>{this._stroke=Uc({...this._originalStroke},mn.defaultStrokeStyle)})),this._stroke=Uc(e,mn.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=e1(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=ka.defaultTextStyle;for(const n in e)this[n]=e[n]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new ka({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(r),this._originalFill?.texture&&this._originalFill.texture.destroy(r),this._stroke?.texture&&this._stroke.texture.destroy(r),this._originalStroke?.texture&&this._originalStroke.texture.destroy(r)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,n){return new Proxy(e,{set:(r,i,s)=>(r[i]=s,n?.(i,s),this.update(),!0)})}_isFillStyle(e){return(e??null)!==null&&!(ve.isColorLike(e)||e instanceof Ru||e instanceof lh)}};t1.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};t1.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Qt=t1;function XN(t){const e=t;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const n=Qt.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??n.alpha,angle:e.dropShadowAngle??n.angle,blur:e.dropShadowBlur??n.blur,color:e.dropShadowColor??n.color,distance:e.dropShadowDistance??n.distance}}if(e.strokeThickness!==void 0){q(ge,"strokeThickness is now a part of stroke");const n=e.stroke;let r={};if(ve.isColorLike(n))r.color=n;else if(n instanceof Ru||n instanceof lh)r.fill=n;else if(Object.hasOwnProperty.call(n,"color")||Object.hasOwnProperty.call(n,"fill"))r=n;else throw new Error("Invalid stroke value.");t.stroke={...r,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){q(ge,"gradient fill is now a fill pattern: `new FillGradient(...)`");let n;t.fontSize==null?t.fontSize=Qt.defaultTextStyle.fontSize:typeof t.fontSize=="string"?n=parseInt(t.fontSize,10):n=t.fontSize;const r=new Ru(0,0,0,n*1.7),i=e.fillGradientStops.map(s=>ve.shared.setValue(s).toNumber());i.forEach((s,o)=>{const a=o/(i.length-1);r.addColorStop(a,s)}),t.fill={fill:r}}}class ZR{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,n){const r=Ce.get().createCanvas();r.width=e,r.height=n;const i=r.getContext("2d");return{canvas:r,context:i}}getOptimalCanvasAndContext(e,n,r=1){e=Math.ceil(e*r-1e-6),n=Math.ceil(n*r-1e-6),e=Vo(e),n=Vo(n);const i=(e<<17)+(n<<1);this._canvasPool[i]||(this._canvasPool[i]=[]);let s=this._canvasPool[i].pop();return s||(s=this._createCanvasAndContext(e,n)),s}returnCanvasAndContext(e){const n=e.canvas,{width:r,height:i}=n,s=(r<<17)+(i<<1);this._canvasPool[s].push(e)}clear(){this._canvasPool={}}}const gi=new ZR,YN=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Lc(t){const e=typeof t.fontSize=="number"?`${t.fontSize}px`:t.fontSize;let n=t.fontFamily;Array.isArray(t.fontFamily)||(n=t.fontFamily.split(","));for(let r=n.length-1;r>=0;r--){let i=n[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!YN.includes(i)&&(i=`"${i}"`),n[r]=i}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${n.join(",")}`}const vv={willReadFrequently:!0},Wr=class se{static get experimentalLetterSpacingSupported(){let e=se._experimentalLetterSpacingSupported;if(e!==void 0){const n=Ce.get().getCanvasRenderingContext2D().prototype;e=se._experimentalLetterSpacingSupported="letterSpacing"in n||"textLetterSpacing"in n}return e}constructor(e,n,r,i,s,o,a,c,h){this.text=e,this.style=n,this.width=r,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=h}static measureText(e=" ",n,r=se._canvas,i=n.wordWrap){const s=`${e}:${n.styleKey}`;if(se._measurementCache[s])return se._measurementCache[s];const o=Lc(n),a=se.measureFont(o);a.fontSize===0&&(a.fontSize=n.fontSize,a.ascent=n.fontSize);const c=se.__context;c.font=o;const f=(i?se._wordWrap(e,n,r):e).split(/(?:\r\n|\r|\n)/),p=new Array(f.length);let v=0;for(let w=0;w<f.length;w++){const T=se._measureText(f[w],n.letterSpacing,c);p[w]=T,v=Math.max(v,T)}const _=n._stroke?.width||0;let y=v+_;n.dropShadow&&(y+=n.dropShadow.distance);const S=n.lineHeight||a.fontSize;let C=Math.max(S,a.fontSize+_)+(f.length-1)*(S+n.leading);return n.dropShadow&&(C+=n.dropShadow.distance),new se(e,n,y,C,f,p,S+n.leading,v,a)}static _measureText(e,n,r){let i=!1;se.experimentalLetterSpacingSupported&&(se.experimentalLetterSpacing?(r.letterSpacing=`${n}px`,r.textLetterSpacing=`${n}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let s=r.measureText(e).width;return s>0&&(i?s-=n:s+=(se.graphemeSegmenter(e).length-1)*n),s}static _wordWrap(e,n,r=se._canvas){const i=r.getContext("2d",vv);let s=0,o="",a="";const c=Object.create(null),{letterSpacing:h,whiteSpace:f}=n,p=se._collapseSpaces(f),v=se._collapseNewlines(f);let _=!p;const y=n.wordWrapWidth+h,S=se._tokenize(e);for(let C=0;C<S.length;C++){let b=S[C];if(se._isNewline(b)){if(!v){a+=se._addLine(o),_=!p,o="",s=0;continue}b=" "}if(p){const T=se.isBreakingSpace(b),A=se.isBreakingSpace(o[o.length-1]);if(T&&A)continue}const w=se._getFromCache(b,h,c,i);if(w>y)if(o!==""&&(a+=se._addLine(o),o="",s=0),se.canBreakWords(b,n.breakWords)){const T=se.wordWrapSplit(b);for(let A=0;A<T.length;A++){let M=T[A],L=M,I=1;for(;T[A+I];){const k=T[A+I];if(!se.canBreakChars(L,k,b,A,n.breakWords))M+=k;else break;L=k,I++}A+=I-1;const N=se._getFromCache(M,h,c,i);N+s>y&&(a+=se._addLine(o),_=!1,o="",s=0),o+=M,s+=N}}else{o.length>0&&(a+=se._addLine(o),o="",s=0);const T=C===S.length-1;a+=se._addLine(b,!T),_=!1,o="",s=0}else w+s>y&&(_=!1,a+=se._addLine(o),o="",s=0),(o.length>0||!se.isBreakingSpace(b)||_)&&(o+=b,s+=w)}return a+=se._addLine(o,!1),a}static _addLine(e,n=!0){return e=se._trimRight(e),e=n?`${e}
`:e,e}static _getFromCache(e,n,r,i){let s=r[e];return typeof s!="number"&&(s=se._measureText(e,n,i)+n,r[e]=s),s}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let n=e.length-1;n>=0;n--){const r=e[n];if(!se.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:se._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,n){return typeof e!="string"?!1:se._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const n=[];let r="";if(typeof e!="string")return n;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(se.isBreakingSpace(s,o)||se._isNewline(s)){r!==""&&(n.push(r),r=""),n.push(s);continue}r+=s}return r!==""&&n.push(r),n}static canBreakWords(e,n){return n}static canBreakChars(e,n,r,i,s){return!0}static wordWrapSplit(e){return se.graphemeSegmenter(e)}static measureFont(e){if(se._fonts[e])return se._fonts[e];const n=se._context;n.font=e;const r=n.measureText(se.METRICS_STRING+se.BASELINE_SYMBOL),i={ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,fontSize:r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};return se._fonts[e]=i,i}static clearMetrics(e=""){e?delete se._fonts[e]:se._fonts={}}static get _canvas(){if(!se.__canvas){let e;try{const n=new OffscreenCanvas(0,0);if(n.getContext("2d",vv)?.measureText)return se.__canvas=n,n;e=Ce.get().createCanvas()}catch{e=Ce.get().createCanvas()}e.width=e.height=10,se.__canvas=e}return se.__canvas}static get _context(){return se.__context||(se.__context=se._canvas.getContext("2d",vv)),se.__context}};Wr.METRICS_STRING="|q";Wr.BASELINE_SYMBOL="M";Wr.BASELINE_MULTIPLIER=1.4;Wr.HEIGHT_MULTIPLIER=2;Wr.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(n=>n.segment)}return t=>[...t]})();Wr.experimentalLetterSpacing=!1;Wr._fonts={};Wr._newlines=[10,13];Wr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Wr._measurementCache={};let Fr=Wr;function Nc(t,e){if(t.texture===X.WHITE&&!t.fill)return ve.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof lh){const n=t.fill,r=e.createPattern(n.texture.source.resource,"repeat"),i=n.transform.copyTo(ae.shared);return i.scale(n.texture.frame.width,n.texture.frame.height),r.setTransform(i),r}else if(t.fill instanceof Ru){const n=t.fill;if(n.type==="linear"){const r=e.createLinearGradient(n.x0,n.y0,n.x1,n.y1);return n.gradientStops.forEach(i=>{r.addColorStop(i.offset,ve.shared.setValue(i.color).toHex())}),r}}}else{const n=e.createPattern(t.texture.source.resource,"repeat"),r=t.matrix.copyTo(ae.shared);return r.scale(t.texture.frame.width,t.texture.frame.height),n.setTransform(r),n}return de("FillStyle not recognised",t),"red"}function n1(t){if(t==="")return[];typeof t=="string"&&(t=[t]);const e=[];for(let n=0,r=t.length;n<r;n++){const i=t[n];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);if(i[0].length===0||i[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,c=o;a<=c;a++)e.push(String.fromCharCode(a))}else e.push(...Array.from(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const JR=class eB extends zy{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const n={...eB.defaultOptions,...e};this._textureSize=n.textureSize,this._mipmap=n.mipmap;const r=n.style.clone();n.overrideFill&&(r._fill.color=16777215,r._fill.alpha=1,r._fill.texture=X.WHITE,r._fill.fill=null),this.applyFillAsTint=n.overrideFill;const i=r.fontSize;r.fontSize=this.baseMeasurementFontSize;const s=Lc(r);n.overrideSize?r._stroke&&(r._stroke.width*=this.baseRenderedFontSize/i):r.fontSize=this.baseRenderedFontSize=i,this._style=r,this._skipKerning=n.skipKerning??!1,this.resolution=n.resolution??1,this._padding=n.padding??4,this.fontMetrics=Fr.measureFont(s),this.lineHeight=r.lineHeight||this.fontMetrics.fontSize||r.fontSize}ensureCharacters(e){const n=n1(e).filter(S=>!this._currentChars.includes(S)).filter((S,C,b)=>b.indexOf(S)===C);if(!n.length)return;this._currentChars=[...this._currentChars,...n];let r;this._currentPageIndex===-1?r=this._nextPage():r=this.pages[this._currentPageIndex];let{canvas:i,context:s}=r.canvasAndContext,o=r.texture.source;const a=this._style;let c=this._currentX,h=this._currentY;const f=this.baseRenderedFontSize/this.baseMeasurementFontSize,p=this._padding*f,v=a.fontStyle==="italic"?2:1;let _=0,y=!1;for(let S=0;S<n.length;S++){const C=n[S],b=Fr.measureText(C,a,i,!1);b.lineHeight=b.height;const w=v*b.width*f,T=b.height*f,A=w+p*2,M=T+p*2;if(y=!1,C!==`
`&&C!=="\r"&&C!=="	"&&C!==" "&&(y=!0,_=Math.ceil(Math.max(M,_))),c+A>this._textureSize&&(h+=_,_=M,c=0,h+_>this._textureSize)){o.update();const I=this._nextPage();i=I.canvasAndContext.canvas,s=I.canvasAndContext.context,o=I.texture.source,h=0}const L=w/f-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[C]={id:C.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:L,kerning:{}},y){this._drawGlyph(s,b,c+p,h+p,f,a);const I=o.width*f,N=o.height*f,k=new Ke(c/I*o.width,h/N*o.height,A/I*o.width,M/N*o.height);this.chars[C].texture=new X({source:o,frame:k}),c+=Math.ceil(A)}}o.update(),this._currentX=c,this._currentY=h,this._skipKerning&&this._applyKerning(n,s)}get pageTextures(){return q(ge,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,n){const r=this._measureCache;for(let i=0;i<e.length;i++){const s=e[i];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let c=r[s];c||(c=r[s]=n.measureText(s).width);let h=r[a];h||(h=r[a]=n.measureText(a).width);let f=n.measureText(s+a).width,p=f-(c+h);p&&(this.chars[s].kerning[a]=p),f=n.measureText(s+a).width,p=f-(c+h),p&&(this.chars[a].kerning[s]=p)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,n=gi.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(n.context,this._style,e);const r=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),i=new X({source:new Zs({resource:n.canvas,resolution:r,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),s={canvasAndContext:n,texture:i};return this.pages[this._currentPageIndex]=s,s}_setupContext(e,n,r){n.fontSize=this.baseRenderedFontSize,e.scale(r,r),e.font=Lc(n),n.fontSize=this.baseMeasurementFontSize,e.textBaseline=n.textBaseline;const i=n._stroke,s=i?.width??0;if(i&&(e.lineWidth=s,e.lineJoin=i.join,e.miterLimit=i.miterLimit,e.strokeStyle=Nc(i,e)),n._fill&&(e.fillStyle=Nc(n._fill,e)),n.dropShadow){const o=n.dropShadow,a=ve.shared.setValue(o.color).toArray(),c=o.blur*r,h=o.distance*r;e.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,e.shadowBlur=c,e.shadowOffsetX=Math.cos(o.angle)*h,e.shadowOffsetY=Math.sin(o.angle)*h}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,n,r,i,s,o){const a=n.text,c=n.fontProperties,f=(o._stroke?.width??0)*s,p=r+f/2,v=i-f/2,_=c.descent*s,y=n.lineHeight*s;o.stroke&&f&&e.strokeText(a,p,v+y-_),o._fill&&e.fillText(a,p,v+y-_)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:n,texture:r}=this.pages[e];n.canvas.width=n.canvas.width,gi.returnCanvasAndContext(n),r.destroy(!0)}this.pages=null}};JR.defaultOptions={textureSize:512,style:new Qt,mipmap:!0};let t2=JR;function r1(t,e,n,r){const i={width:0,height:0,offsetY:0,scale:e.fontSize/n.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=n.baseLineOffset;let s=i.lines[0],o=null,a=!0;const c={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},h=y=>{const S=s.width;for(let C=0;C<c.index;C++){const b=y.positions[C];s.chars.push(y.chars[C]),s.charPositions.push(b+S)}s.width+=y.width,a=!1,c.width=0,c.index=0,c.chars.length=0},f=()=>{let y=s.chars.length-1;if(r){let S=s.chars[y];for(;S===" ";)s.width-=n.chars[S].xAdvance,S=s.chars[--y]}i.width=Math.max(i.width,s.width),s={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,i.lines.push(s),i.height+=n.lineHeight},p=n.baseMeasurementFontSize/e.fontSize,v=e.letterSpacing*p,_=e.wordWrapWidth*p;for(let y=0;y<t.length+1;y++){let S;const C=y===t.length;C||(S=t[y]);const b=n.chars[S]||n.chars[" "];if(/(?:\s)/.test(S)||S==="\r"||S===`
`||C){if(!a&&e.wordWrap&&s.width+c.width-v>_?(f(),h(c),C||s.charPositions.push(0)):(c.start=s.width,h(c),C||s.charPositions.push(0)),S==="\r"||S===`
`)s.width!==0&&f();else if(!C){const M=b.xAdvance+(b.kerning[o]||0)+v;s.width+=M,s.spaceWidth=M,s.spacesIndex.push(s.charPositions.length),s.chars.push(S)}}else{const A=b.kerning[o]||0,M=b.xAdvance+A+v;c.positions[c.index++]=c.width+A,c.chars.push(S),c.width+=M}o=S}return f(),e.align==="center"?qN(i):e.align==="right"?KN(i):e.align==="justify"&&QN(i),i}function qN(t){for(let e=0;e<t.lines.length;e++){const n=t.lines[e],r=t.width/2-n.width/2;for(let i=0;i<n.charPositions.length;i++)n.charPositions[i]+=r}}function KN(t){for(let e=0;e<t.lines.length;e++){const n=t.lines[e],r=t.width-n.width;for(let i=0;i<n.charPositions.length;i++)n.charPositions[i]+=r}}function QN(t){const e=t.width;for(let n=0;n<t.lines.length;n++){const r=t.lines[n];let i=0,s=r.spacesIndex[i++],o=0;const a=r.spacesIndex.length,h=(e-r.width)/a;for(let f=0;f<r.charPositions.length;f++)f===s&&(s=r.spacesIndex[i++],o+=h),r.charPositions[f]+=o}}let Yf=0;class ZN{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(e,n){let r=`${n.fontFamily}-bitmap`,i=!0;if(n._fill.fill&&!n._stroke)r+=n._fill.fill.styleKey,i=!1;else if(n._stroke||n.dropShadow){let o=n.styleKey;o=o.substring(0,o.lastIndexOf("-")),r=`${o}-bitmap`,i=!1}if(!We.has(r)){const o=new t2({style:n,overrideFill:i,overrideSize:!0,...this.defaultOptions});Yf++,Yf>50&&de("BitmapText",`You have dynamically created ${Yf} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{Yf--,We.remove(r)}),We.set(r,o)}const s=We.get(r);return s.ensureCharacters?.(e),s}getLayout(e,n,r=!0){const i=this.getFont(e,n);return r1([...e],n,i,r)}measureText(e,n,r=!0){return this.getLayout(e,n,r)}install(...e){let n=e[0];typeof n=="string"&&(n={name:n,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},q(ge,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const r=n?.name;if(!r)throw new Error("[BitmapFontManager] Property `name` is required.");n={...this.defaultOptions,...n};const i=n.style,s=i instanceof Qt?i:new Qt(i),o=s._fill.fill!==null&&s._fill.fill!==void 0,a=new t2({style:s,overrideFill:o,skipKerning:n.skipKerning,padding:n.padding,resolution:n.resolution,overrideSize:!1}),c=n1(n.chars);return a.ensureCharacters(c.join("")),We.set(`${r}-bitmap`,a),a.once("destroy",()=>We.remove(`${r}-bitmap`)),a}uninstall(e){const n=`${e}-bitmap`,r=We.get(n);r&&(We.remove(n),r.destroy())}}const Gc=new ZN;class i1 extends zy{constructor(e,n){super();const{textures:r,data:i}=e;Object.keys(i.pages).forEach(s=>{const o=i.pages[parseInt(s,10)],a=r[o.id];this.pages.push({texture:a})}),Object.keys(i.chars).forEach(s=>{const o=i.chars[s],{frame:a,source:c}=r[o.page],h=new Ke(o.x+a.x,o.y+a.y,o.width,o.height),f=new X({source:c,frame:h});this.chars[s]={id:s.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:f}}),this.baseRenderedFontSize=i.fontSize,this.baseMeasurementFontSize=i.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:i.fontSize},this.baseLineOffset=i.baseLineOffset,this.lineHeight=i.lineHeight,this.fontFamily=i.fontFamily,this.distanceField=i.distanceField??{type:"none",range:0},this.url=n}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:n}=this.pages[e];n.destroy(!0)}this.pages=null}static install(e){Gc.install(e)}static uninstall(e){Gc.uninstall(e)}}const Pd={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const p in e){const v=e[p].match(/^[a-z]+/gm)[0],_=e[p].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),y={};for(const S in _){const C=_[S].split("="),b=C[0],w=C[1].replace(/"/gm,""),T=parseFloat(w),A=isNaN(T)?w:T;y[b]=A}n[v].push(y)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=n.info,[s]=n.common,[o]=n.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(i.size,10),r.fontFamily=i.face,r.lineHeight=parseInt(s.lineHeight,10);const a=n.page;for(let p=0;p<a.length;p++)r.pages.push({id:parseInt(a[p].id,10)||0,file:a[p].file});const c={};r.baseLineOffset=r.lineHeight-parseInt(s.base,10);const h=n.char;for(let p=0;p<h.length;p++){const v=h[p],_=parseInt(v.id,10);let y=v.letter??v.char??String.fromCharCode(_);y==="space"&&(y=" "),c[_]=y,r.chars[y]={id:_,page:parseInt(v.page,10)||0,x:parseInt(v.x,10),y:parseInt(v.y,10),width:parseInt(v.width,10),height:parseInt(v.height,10),xOffset:parseInt(v.xoffset,10),yOffset:parseInt(v.yoffset,10),xAdvance:parseInt(v.xadvance,10),kerning:{}}}const f=n.kerning||[];for(let p=0;p<f.length;p++){const v=parseInt(f[p].first,10),_=parseInt(f[p].second,10),y=parseInt(f[p].amount,10);r.chars[c[_]].kerning[c[v]]=y}return r}},n2={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},n=t.getElementsByTagName("info")[0],r=t.getElementsByTagName("common")[0],i=t.getElementsByTagName("distanceField")[0];i&&(e.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});const s=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning");e.fontSize=parseInt(n.getAttribute("size"),10),e.fontFamily=n.getAttribute("face"),e.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let h=0;h<s.length;h++)e.pages.push({id:parseInt(s[h].getAttribute("id"),10)||0,file:s[h].getAttribute("file")});const c={};e.baseLineOffset=e.lineHeight-parseInt(r.getAttribute("base"),10);for(let h=0;h<o.length;h++){const f=o[h],p=parseInt(f.getAttribute("id"),10);let v=f.getAttribute("letter")??f.getAttribute("char")??String.fromCharCode(p);v==="space"&&(v=" "),c[p]=v,e.chars[v]={id:p,page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xOffset:parseInt(f.getAttribute("xoffset"),10),yOffset:parseInt(f.getAttribute("yoffset"),10),xAdvance:parseInt(f.getAttribute("xadvance"),10),kerning:{}}}for(let h=0;h<a.length;h++){const f=parseInt(a[h].getAttribute("first"),10),p=parseInt(a[h].getAttribute("second"),10),v=parseInt(a[h].getAttribute("amount"),10);e.chars[c[p]].kerning[c[f]]=v}return e}},r2={test(t){return typeof t=="string"&&t.includes("<font>")?n2.test(Ce.get().parseXML(t)):!1},parse(t){return n2.parse(Ce.get().parseXML(t))}},JN=[".xml",".fnt"],tB={extension:{type:P.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof i1,getCacheableAssets(t,e){const n={};return t.forEach(r=>{n[r]=e,n[`${r}-bitmap`]=e}),n[`${e.fontFamily}-bitmap`]=e,n}},nB={extension:{type:P.LoadParser,priority:In.Normal},name:"loadBitmapFont",test(t){return JN.includes(zt.extname(t).toLowerCase())},async testParse(t){return Pd.test(t)||r2.test(t)},async parse(t,e,n){const r=Pd.test(t)?Pd.parse(t):r2.parse(t),{src:i}=e,{pages:s}=r,o=[],a=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let p=0;p<s.length;++p){const v=s[p].file;let _=zt.join(zt.dirname(i),v);_=pp(_,i),o.push({src:_,data:a})}const c=await n.load(o),h=o.map(p=>c[p.src]);return new i1({data:r,textures:h},i)},async load(t,e){return await(await Ce.get().fetch(t)).text()},async unload(t,e,n){await Promise.all(t.pages.map(r=>n.unload(r.texture.source._sourceOrigin))),t.destroy()}};class rB{constructor(e,n=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=n}add(e){e.forEach(n=>{this._assetList.push(n)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],n=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<n;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const iB={extension:{type:P.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof X),getCacheableAssets:(t,e)=>{const n={};return t.forEach(r=>{e.forEach((i,s)=>{n[r+(s===0?"":s+1)]=i})}),n}};async function s1(t){if("Image"in globalThis)return new Promise(e=>{const n=new Image;n.onload=()=>{e(!0)},n.onerror=()=>{e(!1)},n.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const sB={extension:{type:P.DetectionParser,priority:1},test:async()=>s1("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},sT=["png","jpg","jpeg"],oB={extension:{type:P.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...sT],remove:async t=>t.filter(e=>!sT.includes(e))},eG="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Em(t){return eG?!1:document.createElement("video").canPlayType(t)!==""}const aB={extension:{type:P.DetectionParser,priority:0},test:async()=>Em("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},uB={extension:{type:P.DetectionParser,priority:0},test:async()=>Em("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},lB={extension:{type:P.DetectionParser,priority:0},test:async()=>Em("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},cB={extension:{type:P.DetectionParser,priority:0},test:async()=>s1("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class hB{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,n,r)=>(this._parsersValidated=!1,e[n]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,n){const r={promise:null,parser:null};return r.promise=(async()=>{let i=null,s=null;if(n.loadParser&&(s=this._parserHash[n.loadParser],s||de(`[Assets] specified load parser "${n.loadParser}" not found while loading ${e}`)),!s){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(e,n,this)){s=a;break}}if(!s)return de(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,n,this),r.parser=s;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(i,n,this)&&(i=await a.parse(i,n,this)||i,r.parser=a)}return i})(),r}async load(e,n){this._parsersValidated||this._validateParsers();let r=0;const i={},s=Mc(e),o=hr(e,h=>({alias:[h],src:h,data:{}})),a=o.length,c=o.map(async h=>{const f=zt.toAbsolute(h.src);if(!i[h.src])try{this.promiseCache[f]||(this.promiseCache[f]=this._getLoadPromiseAndParser(f,h)),i[h.src]=await this.promiseCache[f].promise,n&&n(++r/a)}catch(p){throw delete this.promiseCache[f],delete i[h.src],new Error(`[Loader.load] Failed to load ${f}.
${p}`)}});return await Promise.all(c),s?i[o[0].src]:i}async unload(e){const r=hr(e,i=>({alias:[i],src:i})).map(async i=>{const s=zt.toAbsolute(i.src),o=this.promiseCache[s];if(o){const a=await o.promise;delete this.promiseCache[s],await o.parser?.unload?.(a,i,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,n)=>(n.name?e[n.name]&&de(`[Assets] loadParser name conflict "${n.name}"`):de("[Assets] loadParser should have a name"),{...e,[n.name]:n}),{})}}function na(t,e){if(Array.isArray(e)){for(const n of e)if(t.startsWith(`data:${n}`))return!0;return!1}return t.startsWith(`data:${e}`)}function wr(t,e){const n=t.split("?")[0],r=zt.extname(n).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const tG=".json",nG="application/json",fB={extension:{type:P.LoadParser,priority:In.Low},name:"loadJson",test(t){return na(t,nG)||wr(t,tG)},async load(t){return await(await Ce.get().fetch(t)).json()}},rG=".txt",iG="text/plain",dB={name:"loadTxt",extension:{type:P.LoadParser,priority:In.Low,name:"loadTxt"},test(t){return na(t,iG)||wr(t,rG)},async load(t){return await(await Ce.get().fetch(t)).text()}},sG=["normal","bold","100","200","300","400","500","600","700","800","900"],oG=[".ttf",".otf",".woff",".woff2"],aG=["font/ttf","font/otf","font/woff","font/woff2"],uG=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function pB(t){const e=zt.extname(t),i=zt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let s=i.length>0;for(const a of i)if(!a.match(uG)){s=!1;break}let o=i.join(" ");return s||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const lG=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function cG(t){return lG.test(t)?t:encodeURI(t)}const mB={extension:{type:P.LoadParser,priority:In.Low},name:"loadWebFont",test(t){return na(t,aG)||wr(t,oG)},async load(t,e){const n=Ce.get().getFontFaceSet();if(n){const r=[],i=e.data?.family??pB(t),s=e.data?.weights?.filter(a=>sG.includes(a))??["normal"],o=e.data??{};for(let a=0;a<s.length;a++){const c=s[a],h=new FontFace(i,`url(${cG(t)})`,{...o,weight:c});await h.load(),n.add(h),r.push(h)}return We.set(`${i}-and-url`,{url:t,fontFaces:r}),r.length===1?r[0]:r}return de("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{We.remove(e.family),Ce.get().getFontFaceSet().delete(e)})}};function Am(t,e=1){const n=Js.RETINA_PREFIX?.exec(t);return n?parseFloat(n[1]):e}function eo(t,e,n){t.label=n,t._sourceOrigin=n;const r=new X({source:t,label:n}),i=()=>{delete e.promiseCache[n],We.has(n)&&We.remove(n)};return r.source.once("destroy",()=>{e.promiseCache[n]&&(de("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),r.once("destroy",()=>{t.destroyed||(de("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const hG=".svg",fG="image/svg+xml",gB={extension:{type:P.LoadParser,priority:In.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return na(t,fG)||wr(t,hG)},async load(t,e,n){return e.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?pG(t):dG(t,e,n,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function dG(t,e,n,r){const s=await(await Ce.get().fetch(t)).blob(),o=URL.createObjectURL(s),a=new Image;a.src=o,a.crossOrigin=r,await a.decode(),URL.revokeObjectURL(o);const c=document.createElement("canvas"),h=c.getContext("2d"),f=e.data?.resolution||Am(t),p=e.data?.width??a.width,v=e.data?.height??a.height;c.width=p*f,c.height=v*f,h.drawImage(a,0,0,p*f,v*f);const{parseAsGraphicsContext:_,...y}=e.data,S=new Zs({resource:c,alphaMode:"premultiply-alpha-on-upload",resolution:f,...y});return eo(S,n,t)}async function pG(t){const n=await(await Ce.get().fetch(t)).text(),r=new mn;return r.svg(n),r}const mG=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let fu=null,i2=class{constructor(){fu||(fu=URL.createObjectURL(new Blob([mG],{type:"application/javascript"}))),this.worker=new Worker(fu)}};i2.revokeObjectURL=function(){fu&&(URL.revokeObjectURL(fu),fu=null)};const gG=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let du=null,vB=class{constructor(){du||(du=URL.createObjectURL(new Blob([gG],{type:"application/javascript"}))),this.worker=new Worker(du)}};vB.revokeObjectURL=function(){du&&(URL.revokeObjectURL(du),du=null)};let oT=0,_v;class vG{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:n}=new i2;n.addEventListener("message",r=>{n.terminate(),i2.revokeObjectURL(),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,n){return this._run("loadImageBitmap",[e,n?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){_v===void 0&&(_v=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<_v&&(this._createdWorkers++,e=new vB().worker,e.addEventListener("message",n=>{this._complete(n.data),this._returnWorker(n.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,n){await this._initWorkers();const r=new Promise((i,s)=>{this._queue.push({id:e,arguments:n,resolve:i,reject:s})});return this._next(),r}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const n=this._queue.pop(),r=n.id;this._resolveHash[oT]={resolve:n.resolve,reject:n.reject},e.postMessage({data:n.arguments,uuid:oT++,id:r})}}const s2=new vG,_G=[".jpeg",".jpg",".png",".webp",".avif"],xG=["image/jpeg","image/png","image/webp","image/avif"];async function _B(t,e){const n=await Ce.get().fetch(t);if(!n.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${n.status} ${n.statusText}`);const r=await n.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const o1={name:"loadTextures",extension:{type:P.LoadParser,priority:In.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return na(t,xG)||wr(t,_G)},async load(t,e,n){let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await s2.isImageBitmapSupported()?r=await s2.loadImageBitmap(t,e):r=await _B(t,e):r=await new Promise(s=>{r=new Image,r.crossOrigin=this.config.crossOrigin,r.src=t,r.complete?s(r):r.onload=()=>{s(r)}});const i=new Zs({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||Am(t),...e.data});return eo(i,n,t)},unload(t){t.destroy(!0)}},xB=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],yG=xB.map(t=>`video/${t.substring(1)}`);function yB(t,e,n){n===void 0&&!e.startsWith("data:")?t.crossOrigin=SB(e):n!==!1&&(t.crossOrigin=typeof n=="string"?n:"anonymous")}function bB(t){return new Promise((e,n)=>{t.addEventListener("canplaythrough",r),t.addEventListener("error",i),t.load();function r(){s(),e()}function i(o){s(),n(o)}function s(){t.removeEventListener("canplaythrough",r),t.removeEventListener("error",i)}})}function SB(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const n=new URL(t,document.baseURI);return n.hostname!==e.hostname||n.port!==e.port||n.protocol!==e.protocol?"anonymous":""}const wB={name:"loadVideo",extension:{type:P.LoadParser,name:"loadVideo"},test(t){const e=na(t,yG),n=wr(t,xB);return e||n},async load(t,e,n){const r={...tc.defaultOptions,resolution:e.data?.resolution||Am(t),alphaMode:e.data?.alphaMode||await ly(),...e.data},i=document.createElement("video"),s={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(s).forEach(c=>{const h=s[c];h!==void 0&&i.setAttribute(c,h)}),r.muted===!0&&(i.muted=!0),yB(i,t,r.crossorigin);const o=document.createElement("source");let a;if(t.startsWith("data:"))a=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const c=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();a=tc.MIME_TYPES[c]||`video/${c}`}return o.src=t,a&&(o.type=a),new Promise(c=>{const h=async()=>{const f=new tc({...r,resource:i});i.removeEventListener("canplay",h),e.data.preload&&await bB(i),c(eo(f,n,t))};i.addEventListener("canplay",h),i.appendChild(o)})},unload(t){t.destroy(!0)}},a1={extension:{type:P.ResolveParser,name:"resolveTexture"},test:o1.test,parse:t=>({resolution:parseFloat(Js.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},CB={extension:{type:P.ResolveParser,priority:-2,name:"resolveJson"},test:t=>Js.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:a1.parse};class TB{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Js,this.loader=new hB,this.cache=We,this._backgroundLoader=new rB(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){de("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let s=e.manifest;typeof s=="string"&&(s=await this.load(s)),this.resolver.addManifest(s)}const n=e.texturePreference?.resolution??1,r=typeof n=="number"?[n]:n,i=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:r}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,n){this._initialized||await this.init();const r=Mc(e),i=hr(e).map(a=>{if(typeof a!="string"){const c=this.resolver.getAlias(a);return c.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,n);return r?o[i[0]]:o}addBundle(e,n){this.resolver.addBundle(e,n)}async loadBundle(e,n){this._initialized||await this.init();let r=!1;typeof e=="string"&&(r=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let a=0,c=0;const h=()=>{n?.(++a/c)},f=o.map(p=>{const v=i[p];return c+=Object.keys(v).length,this._mapLoadToResolve(v,h).then(_=>{s[p]=_})});return await Promise.all(f),r?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const n=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(n))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const n=this.resolver.resolveBundle(e);Object.values(n).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return We.get(e);const n={};for(let r=0;r<e.length;r++)n[r]=We.get(e[r]);return n}async _mapLoadToResolve(e,n){const r=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const i=await this.loader.load(r,n);this._backgroundLoader.active=!0;const s={};return r.forEach(o=>{const a=i[o.src],c=[o.src];o.alias&&c.push(...o.alias),c.forEach(h=>{s[h]=a}),We.set(c,a)}),s}async unload(e){this._initialized||await this.init();const n=hr(e).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(n);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=hr(e);const n=this.resolver.resolveBundle(e),r=Object.keys(n).map(i=>this._unloadFromResolved(n[i]));await Promise.all(r)}async _unloadFromResolved(e){const n=Object.values(e);n.forEach(r=>{We.remove(r.src)}),await this.loader.unload(n)}async _detectFormats(e){let n=[];e.preferredFormats&&(n=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?n=await r.add(n):e.skipDetections||(n=await r.remove(n));return n=n.filter((r,i)=>n.indexOf(r)===i),n}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(n=>{n.config&&Object.keys(n.config).filter(r=>r in e).forEach(r=>{n.config[r]=e[r]})})}}const H=new TB;Ne.handleByList(P.LoadParser,H.loader.parsers).handleByList(P.ResolveParser,H.resolver.parsers).handleByList(P.CacheParser,H.cache.parsers).handleByList(P.DetectionParser,H.detections);Ne.add(iB,oB,sB,cB,aB,uB,lB,fB,dB,mB,gB,o1,wB,nB,tB,a1,CB);const aT={loader:P.LoadParser,resolver:P.ResolveParser,cache:P.CacheParser,detection:P.DetectionParser};Ne.handle(P.Asset,t=>{const e=t.ref;Object.entries(aT).filter(([n])=>!!e[n]).forEach(([n,r])=>Ne.add(Object.assign(e[n],{extension:e[n].extension??r})))},t=>{const e=t.ref;Object.keys(aT).filter(n=>!!e[n]).forEach(n=>Ne.remove(e[n]))});const bG={extension:{type:P.DetectionParser,priority:3},test:async()=>!!(await uh()||ah()),add:async t=>[...t,"basis"],remove:async t=>t.filter(e=>e!=="basis")};class hh extends dt{constructor(e){super(e),this.uploadMethodId="compressed",this.resource=e.resource,this.mipLevelCount=this.resource.length}}let qf;function o2(){if(qf)return qf;const e=document.createElement("canvas").getContext("webgl");return e?(qf=[...e.getExtension("EXT_texture_compression_bptc")?["bc6h-rgb-ufloat","bc6h-rgb-float","bc7-rgba-unorm","bc7-rgba-unorm-srgb"]:[],...e.getExtension("WEBGL_compressed_texture_s3tc")?["bc1-rgba-unorm","bc2-rgba-unorm","bc3-rgba-unorm"]:[],...e.getExtension("WEBGL_compressed_texture_s3tc_srgb")?["bc1-rgba-unorm-srgb","bc2-rgba-unorm-srgb","bc3-rgba-unorm-srgb"]:[],...e.getExtension("EXT_texture_compression_rgtc")?["bc4-r-unorm","bc4-r-snorm","bc5-rg-unorm","bc5-rg-snorm"]:[],...e.getExtension("WEBGL_compressed_texture_etc")?["etc2-rgb8unorm","etc2-rgb8unorm-srgb","etc2-rgba8unorm","etc2-rgba8unorm-srgb","etc2-rgb8a1unorm","etc2-rgb8a1unorm-srgb","eac-r11unorm","eac-rg11unorm"]:[],...e.getExtension("WEBGL_compressed_texture_astc")?["astc-4x4-unorm","astc-4x4-unorm-srgb","astc-5x4-unorm","astc-5x4-unorm-srgb","astc-5x5-unorm","astc-5x5-unorm-srgb","astc-6x5-unorm","astc-6x5-unorm-srgb","astc-6x6-unorm","astc-6x6-unorm-srgb","astc-8x5-unorm","astc-8x5-unorm-srgb","astc-8x6-unorm","astc-8x6-unorm-srgb","astc-8x8-unorm","astc-8x8-unorm-srgb","astc-10x5-unorm","astc-10x5-unorm-srgb","astc-10x6-unorm","astc-10x6-unorm-srgb","astc-10x8-unorm","astc-10x8-unorm-srgb","astc-10x10-unorm","astc-10x10-unorm-srgb","astc-12x10-unorm","astc-12x10-unorm-srgb","astc-12x12-unorm","astc-12x12-unorm-srgb"]:[]],qf):[]}let Kf;async function a2(){if(Kf)return Kf;const t=await Ce.get().getNavigator().gpu.requestAdapter();return Kf=[...t.features.has("texture-compression-bc")?["bc1-rgba-unorm","bc1-rgba-unorm-srgb","bc2-rgba-unorm","bc2-rgba-unorm-srgb","bc3-rgba-unorm","bc3-rgba-unorm-srgb","bc4-r-unorm","bc4-r-snorm","bc5-rg-unorm","bc5-rg-snorm","bc6h-rgb-ufloat","bc6h-rgb-float","bc7-rgba-unorm","bc7-rgba-unorm-srgb"]:[],...t.features.has("texture-compression-etc2")?["etc2-rgb8unorm","etc2-rgb8unorm-srgb","etc2-rgb8a1unorm","etc2-rgb8a1unorm-srgb","etc2-rgba8unorm","etc2-rgba8unorm-srgb","eac-r11unorm","eac-r11snorm","eac-rg11unorm","eac-rg11snorm"]:[],...t.features.has("texture-compression-astc")?["astc-4x4-unorm","astc-4x4-unorm-srgb","astc-5x4-unorm","astc-5x4-unorm-srgb","astc-5x5-unorm","astc-5x5-unorm-srgb","astc-6x5-unorm","astc-6x5-unorm-srgb","astc-6x6-unorm","astc-6x6-unorm-srgb","astc-8x5-unorm","astc-8x5-unorm-srgb","astc-8x6-unorm","astc-8x6-unorm-srgb","astc-8x8-unorm","astc-8x8-unorm-srgb","astc-10x5-unorm","astc-10x5-unorm-srgb","astc-10x6-unorm","astc-10x6-unorm-srgb","astc-10x8-unorm","astc-10x8-unorm-srgb","astc-10x10-unorm","astc-10x10-unorm-srgb","astc-12x10-unorm","astc-12x10-unorm-srgb","astc-12x12-unorm","astc-12x12-unorm-srgb"]:[]],Kf}let Qf;async function u1(){return Qf!==void 0||(Qf=await(async()=>{const t=await uh(),e=ah();if(t&&e){const n=await a2(),r=o2();return n.filter(i=>r.includes(i))}else{if(t)return await a2();if(e)return o2()}return[]})()),Qf}const EB=["r8unorm","r8snorm","r8uint","r8sint","r16uint","r16sint","r16float","rg8unorm","rg8snorm","rg8uint","rg8sint","r32uint","r32sint","r32float","rg16uint","rg16sint","rg16float","rgba8unorm","rgba8unorm-srgb","rgba8snorm","rgba8uint","rgba8sint","bgra8unorm","bgra8unorm-srgb","rgb9e5ufloat","rgb10a2unorm","rg11b10ufloat","rg32uint","rg32sint","rg32float","rgba16uint","rgba16sint","rgba16float","rgba32uint","rgba32sint","rgba32float","stencil8","depth16unorm","depth24plus","depth24plus-stencil8","depth32float","depth32float-stencil8"];let Zf;async function fh(){if(Zf!==void 0)return Zf;const t=await u1();return Zf=[...EB,...t],Zf}const SG=`(function () {
    'use strict';

    function createLevelBuffers(basisTexture, basisTranscoderFormat) {
      const images = basisTexture.getNumImages();
      const levels = basisTexture.getNumLevels(0);
      const success = basisTexture.startTranscoding();
      if (!success) {
        throw new Error("startTranscoding failed");
      }
      const levelBuffers = [];
      for (let levelIndex = 0; levelIndex < levels; ++levelIndex) {
        for (let sliceIndex = 0; sliceIndex < images; ++sliceIndex) {
          const transcodeSize = basisTexture.getImageTranscodedSizeInBytes(sliceIndex, levelIndex, basisTranscoderFormat);
          const levelBuffer = new Uint8Array(transcodeSize);
          const success2 = basisTexture.transcodeImage(levelBuffer, sliceIndex, levelIndex, basisTranscoderFormat, 1, 0);
          if (!success2) {
            throw new Error("transcodeImage failed");
          }
          levelBuffers.push(levelBuffer);
        }
      }
      return levelBuffers;
    }

    const gpuFormatToBasisTranscoderFormatMap = {
      "bc3-rgba-unorm": 3,
      // cTFBC3_RGBA
      "bc7-rgba-unorm": 6,
      // cTFBC7_RGBA,
      "etc2-rgba8unorm": 1,
      // cTFETC2_RGBA,
      "astc-4x4-unorm": 10,
      // cTFASTC_4x4_RGBA,
      // Uncompressed
      rgba8unorm: 13,
      // cTFRGBA32,
      rgba4unorm: 16
      // cTFRGBA4444,
    };
    function gpuFormatToBasisTranscoderFormat(transcoderFormat) {
      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported transcoderFormat: \${transcoderFormat}\`);
    }

    const settings = {
      jsUrl: "basis/basis_transcoder.js",
      wasmUrl: "basis/basis_transcoder.wasm"
    };
    let basisTranscoderFormat;
    let basisTranscodedTextureFormat;
    let basisPromise;
    async function getBasis() {
      if (!basisPromise) {
        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;
        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;
        importScripts(absoluteJsUrl);
        basisPromise = new Promise((resolve) => {
          BASIS({
            locateFile: (_file) => absoluteWasmUrl
          }).then((module) => {
            module.initializeBasis();
            resolve(module.BasisFile);
          });
        });
      }
      return basisPromise;
    }
    async function fetchBasisTexture(url, BasisTexture) {
      const basisResponse = await fetch(url);
      if (basisResponse.ok) {
        const basisArrayBuffer = await basisResponse.arrayBuffer();
        return new BasisTexture(new Uint8Array(basisArrayBuffer));
      }
      throw new Error(\`Failed to load Basis texture: \${url}\`);
    }
    const preferredTranscodedFormat = [
      "bc7-rgba-unorm",
      "astc-4x4-unorm",
      "etc2-rgba8unorm",
      "bc3-rgba-unorm",
      "rgba8unorm"
    ];
    async function load(url) {
      const BasisTexture = await getBasis();
      const basisTexture = await fetchBasisTexture(url, BasisTexture);
      const levelBuffers = createLevelBuffers(basisTexture, basisTranscoderFormat);
      return {
        width: basisTexture.getImageWidth(0, 0),
        height: basisTexture.getImageHeight(0, 0),
        format: basisTranscodedTextureFormat,
        resource: levelBuffers,
        alphaMode: "no-premultiply-alpha"
      };
    }
    async function init(jsUrl, wasmUrl, supportedTextures) {
      if (jsUrl)
        settings.jsUrl = jsUrl;
      if (wasmUrl)
        settings.wasmUrl = wasmUrl;
      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];
      basisTranscoderFormat = gpuFormatToBasisTranscoderFormat(basisTranscodedTextureFormat);
      await getBasis();
    }
    const messageHandlers = {
      init: async (data) => {
        const { jsUrl, wasmUrl, supportedTextures } = data;
        await init(jsUrl, wasmUrl, supportedTextures);
      },
      load: async (data) => {
        try {
          const textureOptions = await load(data.url);
          return {
            type: "load",
            url: data.url,
            success: true,
            textureOptions,
            transferables: textureOptions.resource?.map((arr) => arr.buffer)
          };
        } catch (e) {
          throw e;
        }
      }
    };
    self.onmessage = async (messageEvent) => {
      const message = messageEvent.data;
      const response = await messageHandlers[message.type](message);
      if (response) {
        self.postMessage(response, response.transferables);
      }
    };

})();
`;let pu=null,AB=class{constructor(){pu||(pu=URL.createObjectURL(new Blob([SG],{type:"application/javascript"}))),this.worker=new Worker(pu)}};AB.revokeObjectURL=function(){pu&&(URL.revokeObjectURL(pu),pu=null)};const gp={jsUrl:"https://files.pixijs.download/transcoders/basis/basis_transcoder.js",wasmUrl:"https://files.pixijs.download/transcoders/basis/basis_transcoder.wasm"};function wG(t){Object.assign(gp,t)}let Rl;const PB={};function CG(t){return Rl||(Rl=new AB().worker,Rl.onmessage=e=>{const{success:n,url:r,textureOptions:i}=e.data;n||console.warn("Failed to load Basis texture",r),PB[r](i)},Rl.postMessage({type:"init",jsUrl:gp.jsUrl,wasmUrl:gp.wasmUrl,supportedTextures:t})),Rl}function RB(t,e){const n=CG(e);return new Promise(r=>{PB[t]=r,n.postMessage({type:"load",url:t})})}const TG={extension:{type:P.LoadParser,priority:In.High,name:"loadBasis"},name:"loadBasis",test(t){return wr(t,[".basis"])},async load(t,e,n){const r=await fh(),i=await RB(t,r),s=new hh(i);return eo(s,n,t)},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};function EG(t,e){const n=t.getNumImages(),r=t.getNumLevels(0);if(!t.startTranscoding())throw new Error("startTranscoding failed");const s=[];for(let o=0;o<r;++o)for(let a=0;a<n;++a){const c=t.getImageTranscodedSizeInBytes(a,o,e),h=new Uint8Array(c);if(!t.transcodeImage(h,a,o,e,1,0))throw new Error("transcodeImage failed");s.push(h)}return s}const AG={"bc3-rgba-unorm":3,"bc7-rgba-unorm":6,"etc2-rgba8unorm":1,"astc-4x4-unorm":10,rgba8unorm:13,rgba4unorm:16};function PG(t){const e=AG[t];if(e)return e;throw new Error(`Unsupported transcoderFormat: ${t}`)}const RG={MAGIC:0,SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19,PF_FLAGS:20,FOURCC:21,RGB_BITCOUNT:22,R_BIT_MASK:23,G_BIT_MASK:24,B_BIT_MASK:25,A_BIT_MASK:26},BG={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4};var l1=(t=>(t[t.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",t[t.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",t[t.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",t[t.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",t[t.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",t[t.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",t[t.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",t[t.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",t[t.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",t[t.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",t[t.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",t[t.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",t[t.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",t[t.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",t[t.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",t[t.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",t[t.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",t[t.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",t[t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",t[t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",t[t.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",t[t.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",t[t.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",t[t.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",t[t.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",t[t.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",t[t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",t[t.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",t[t.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",t[t.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",t[t.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",t[t.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",t[t.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",t[t.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",t[t.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",t[t.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",t[t.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",t[t.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",t[t.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",t[t.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",t[t.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",t[t.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",t[t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",t[t.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",t[t.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",t[t.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",t[t.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",t[t.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",t[t.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",t[t.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",t[t.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",t[t.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",t[t.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",t[t.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",t[t.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",t[t.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",t[t.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",t[t.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",t[t.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",t[t.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",t[t.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",t[t.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",t[t.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",t[t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",t[t.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",t[t.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",t[t.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",t[t.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",t[t.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",t[t.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",t[t.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",t[t.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",t[t.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",t[t.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",t[t.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",t[t.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",t[t.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",t[t.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",t[t.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",t[t.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",t[t.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",t[t.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",t[t.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",t[t.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",t[t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",t[t.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",t[t.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",t[t.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",t[t.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",t[t.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",t[t.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",t[t.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",t[t.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",t[t.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",t[t.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",t[t.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",t[t.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",t[t.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",t[t.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",t[t.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",t[t.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",t[t.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",t[t.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",t[t.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",t[t.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",t[t.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",t[t.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",t[t.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",t[t.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",t[t.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",t[t.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",t[t.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT",t))(l1||{}),c1=(t=>(t[t.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",t[t.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",t[t.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D",t))(c1||{});function It(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}var En=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.R8G8B8=20]="R8G8B8",t[t.A8R8G8B8=21]="A8R8G8B8",t[t.X8R8G8B8=22]="X8R8G8B8",t[t.R5G6B5=23]="R5G6B5",t[t.X1R5G5B5=24]="X1R5G5B5",t[t.A1R5G5B5=25]="A1R5G5B5",t[t.A4R4G4B4=26]="A4R4G4B4",t[t.R3G3B2=27]="R3G3B2",t[t.A8=28]="A8",t[t.A8R3G3B2=29]="A8R3G3B2",t[t.X4R4G4B4=30]="X4R4G4B4",t[t.A2B10G10R10=31]="A2B10G10R10",t[t.A8B8G8R8=32]="A8B8G8R8",t[t.X8B8G8R8=33]="X8B8G8R8",t[t.G16R16=34]="G16R16",t[t.A2R10G10B10=35]="A2R10G10B10",t[t.A16B16G16R16=36]="A16B16G16R16",t[t.A8P8=40]="A8P8",t[t.P8=41]="P8",t[t.L8=50]="L8",t[t.A8L8=51]="A8L8",t[t.A4L4=52]="A4L4",t[t.V8U8=60]="V8U8",t[t.L6V5U5=61]="L6V5U5",t[t.X8L8V8U8=62]="X8L8V8U8",t[t.Q8W8V8U8=63]="Q8W8V8U8",t[t.V16U16=64]="V16U16",t[t.A2W10V10U10=67]="A2W10V10U10",t[t.Q16W16V16U16=110]="Q16W16V16U16",t[t.R16F=111]="R16F",t[t.G16R16F=112]="G16R16F",t[t.A16B16G16R16F=113]="A16B16G16R16F",t[t.R32F=114]="R32F",t[t.G32R32F=115]="G32R32F",t[t.A32B32G32R32F=116]="A32B32G32R32F",t[t.UYVY=It("UYVY")]="UYVY",t[t.R8G8_B8G8=It("RGBG")]="R8G8_B8G8",t[t.YUY2=It("YUY2")]="YUY2",t[t.D3DFMT_G8R8_G8B8=It("GRGB")]="D3DFMT_G8R8_G8B8",t[t.DXT1=It("DXT1")]="DXT1",t[t.DXT2=It("DXT2")]="DXT2",t[t.DXT3=It("DXT3")]="DXT3",t[t.DXT4=It("DXT4")]="DXT4",t[t.DXT5=It("DXT5")]="DXT5",t[t.ATI1=It("ATI1")]="ATI1",t[t.AT1N=It("AT1N")]="AT1N",t[t.ATI2=It("ATI2")]="ATI2",t[t.AT2N=It("AT2N")]="AT2N",t[t.BC4U=It("BC4U")]="BC4U",t[t.BC4S=It("BC4S")]="BC4S",t[t.BC5U=It("BC5U")]="BC5U",t[t.BC5S=It("BC5S")]="BC5S",t[t.DX10=It("DX10")]="DX10",t))(En||{});const u2={[En.DXT1]:"bc1-rgba-unorm",[En.DXT2]:"bc2-rgba-unorm",[En.DXT3]:"bc2-rgba-unorm",[En.DXT4]:"bc3-rgba-unorm",[En.DXT5]:"bc3-rgba-unorm",[En.ATI1]:"bc4-r-unorm",[En.BC4U]:"bc4-r-unorm",[En.BC4S]:"bc4-r-snorm",[En.ATI2]:"bc5-rg-unorm",[En.BC5U]:"bc5-rg-unorm",[En.BC5S]:"bc5-rg-snorm",36:"rgba16uint",110:"rgba16sint",111:"r16float",112:"rg16float",113:"rgba16float",114:"r32float",115:"rg32float",116:"rgba32float"},An={70:"bc1-rgba-unorm",71:"bc1-rgba-unorm",72:"bc1-rgba-unorm-srgb",73:"bc2-rgba-unorm",74:"bc2-rgba-unorm",75:"bc2-rgba-unorm-srgb",76:"bc3-rgba-unorm",77:"bc3-rgba-unorm",78:"bc3-rgba-unorm-srgb",79:"bc4-r-unorm",80:"bc4-r-unorm",81:"bc4-r-snorm",82:"bc5-rg-unorm",83:"bc5-rg-unorm",84:"bc5-rg-snorm",94:"bc6h-rgb-ufloat",95:"bc6h-rgb-ufloat",96:"bc6h-rgb-float",97:"bc7-rgba-unorm",98:"bc7-rgba-unorm",99:"bc7-rgba-unorm-srgb",28:"rgba8unorm",29:"rgba8unorm-srgb",87:"bgra8unorm",91:"bgra8unorm-srgb",41:"r32float",49:"rg8unorm",56:"r16uint",61:"r8unorm",24:"rgb10a2unorm",11:"rgba16uint",13:"rgba16sint",10:"rgba16float",54:"r16float",34:"rg16float",16:"rg32float",2:"rgba32float"},fe={MAGIC_VALUE:542327876,MAGIC_SIZE:4,HEADER_SIZE:124,HEADER_DX10_SIZE:20,PIXEL_FORMAT_FLAGS:{ALPHAPIXELS:1,ALPHA:2,FOURCC:4,RGB:64,RGBA:65,YUV:512,LUMINANCE:131072,LUMINANCEA:131073},RESOURCE_MISC_TEXTURECUBE:4,HEADER_FIELDS:RG,HEADER_DX10_FIELDS:BG,DXGI_FORMAT:l1,D3D10_RESOURCE_DIMENSION:c1,D3DFMT:En},BB={"bc1-rgba-unorm":8,"bc1-rgba-unorm-srgb":8,"bc2-rgba-unorm":16,"bc2-rgba-unorm-srgb":16,"bc3-rgba-unorm":16,"bc3-rgba-unorm-srgb":16,"bc4-r-unorm":8,"bc4-r-snorm":8,"bc5-rg-unorm":16,"bc5-rg-snorm":16,"bc6h-rgb-ufloat":16,"bc6h-rgb-float":16,"bc7-rgba-unorm":16,"bc7-rgba-unorm-srgb":16};function MB(t,e){const{format:n,fourCC:r,width:i,height:s,dataOffset:o,mipmapCount:a}=DG(t);if(!e.includes(n))throw new Error(`Unsupported texture format: ${r} ${n}, supported: ${e}`);if(a<=1)return{format:n,width:i,height:s,resource:[new Uint8Array(t,o)],alphaMode:"no-premultiply-alpha"};const c=MG(n,i,s,o,a,t);return{format:n,width:i,height:s,resource:c,alphaMode:"no-premultiply-alpha"}}function MG(t,e,n,r,i,s){const o=[],a=BB[t];let c=e,h=n,f=r;for(let p=0;p<i;++p){const v=a?Math.max(4,c)/4*Math.max(4,h)/4*a:c*h*4,_=new Uint8Array(s,f,v);o.push(_),f+=v,c=Math.max(c>>1,1),h=Math.max(h>>1,1)}return o}function DG(t){const e=new Uint32Array(t,0,fe.HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT);if(e[fe.HEADER_FIELDS.MAGIC]!==fe.MAGIC_VALUE)throw new Error("Invalid magic number in DDS header");const n=e[fe.HEADER_FIELDS.HEIGHT],r=e[fe.HEADER_FIELDS.WIDTH],i=Math.max(1,e[fe.HEADER_FIELDS.MIPMAP_COUNT]),s=e[fe.HEADER_FIELDS.PF_FLAGS],o=e[fe.HEADER_FIELDS.FOURCC],a=OG(e,s,o,t),c=fe.MAGIC_SIZE+fe.HEADER_SIZE+(o===fe.D3DFMT.DX10?fe.HEADER_DX10_SIZE:0);return{format:a,fourCC:o,width:r,height:n,dataOffset:c,mipmapCount:i}}function OG(t,e,n,r){if(e&fe.PIXEL_FORMAT_FLAGS.FOURCC){if(n===fe.D3DFMT.DX10){const i=new Uint32Array(r,fe.MAGIC_SIZE+fe.HEADER_SIZE,fe.HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT);if(i[fe.HEADER_DX10_FIELDS.MISC_FLAG]===fe.RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(i[fe.HEADER_DX10_FIELDS.RESOURCE_DIMENSION]===fe.D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");const a=i[fe.HEADER_DX10_FIELDS.DXGI_FORMAT];if(a in An)return An[a];throw new Error(`DDSParser cannot parse texture data with DXGI format ${a}`)}if(n in u2)return u2[n];throw new Error(`DDSParser cannot parse texture data with fourCC format ${n}`)}if(e&fe.PIXEL_FORMAT_FLAGS.RGB||e&fe.PIXEL_FORMAT_FLAGS.RGBA)return kG(t);throw e&fe.PIXEL_FORMAT_FLAGS.YUV?new Error("DDSParser does not supported YUV uncompressed texture data."):e&fe.PIXEL_FORMAT_FLAGS.LUMINANCE||e&fe.PIXEL_FORMAT_FLAGS.LUMINANCEA?new Error("DDSParser does not support single-channel (lumninance) texture data!"):e&fe.PIXEL_FORMAT_FLAGS.ALPHA||e&fe.PIXEL_FORMAT_FLAGS.ALPHAPIXELS?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}function kG(t){const e=t[fe.HEADER_FIELDS.RGB_BITCOUNT],n=t[fe.HEADER_FIELDS.R_BIT_MASK],r=t[fe.HEADER_FIELDS.G_BIT_MASK],i=t[fe.HEADER_FIELDS.B_BIT_MASK],s=t[fe.HEADER_FIELDS.A_BIT_MASK];switch(e){case 32:if(n===255&&r===65280&&i===16711680&&s===4278190080)return An[fe.DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_UNORM];if(n===16711680&&r===65280&&i===255&&s===4278190080)return An[fe.DXGI_FORMAT.DXGI_FORMAT_B8G8R8A8_UNORM];if(n===1072693248&&r===1047552&&i===1023&&s===3221225472)return An[fe.DXGI_FORMAT.DXGI_FORMAT_R10G10B10A2_UNORM];if(n===65535&&r===4294901760&&i===0&&s===0)return An[fe.DXGI_FORMAT.DXGI_FORMAT_R16G16_UNORM];if(n===4294967295&&r===0&&i===0&&s===0)return An[fe.DXGI_FORMAT.DXGI_FORMAT_R32_FLOAT];break;case 24:break;case 16:if(n===31744&&r===992&&i===31&&s===32768)return An[fe.DXGI_FORMAT.DXGI_FORMAT_B5G5R5A1_UNORM];if(n===63488&&r===2016&&i===31&&s===0)return An[fe.DXGI_FORMAT.DXGI_FORMAT_B5G6R5_UNORM];if(n===3840&&r===240&&i===15&&s===61440)return An[fe.DXGI_FORMAT.DXGI_FORMAT_B4G4R4A4_UNORM];if(n===255&&r===0&&i===0&&s===65280)return An[fe.DXGI_FORMAT.DXGI_FORMAT_R8G8_UNORM];if(n===65535&&r===0&&i===0&&s===0)return An[fe.DXGI_FORMAT.DXGI_FORMAT_R16_UNORM];break;case 8:if(n===255&&r===0&&i===0&&s===0)return An[fe.DXGI_FORMAT.DXGI_FORMAT_R8_UNORM];break}throw new Error(`DDSParser does not support uncompressed texture with configuration:
                bitCount = ${e}, rBitMask = ${n}, gBitMask = ${r}, aBitMask = ${s}`)}const FG={extension:{type:P.LoadParser,priority:In.High,name:"loadDDS"},name:"loadDDS",test(t){return wr(t,[".dds"])},async load(t,e,n){const r=await fh(),s=await(await fetch(t)).arrayBuffer(),o=MB(s,r),a=new hh(o);return eo(a,n,t)},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};var DB=(t=>(t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGBA=6408]="RGBA",t[t.RGBA8UI=36220]="RGBA8UI",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGBA8I=36238]="RGBA8I",t[t.RGBA8=32856]="RGBA8",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(DB||{});const IG={33776:"bc1-rgba-unorm",33777:"bc1-rgba-unorm",33778:"bc2-rgba-unorm",33779:"bc3-rgba-unorm",35916:"bc1-rgba-unorm-srgb",35917:"bc1-rgba-unorm-srgb",35918:"bc2-rgba-unorm-srgb",35919:"bc3-rgba-unorm-srgb",36283:"bc4-r-unorm",36284:"bc4-r-snorm",36285:"bc5-rg-unorm",36286:"bc5-rg-snorm",37488:"eac-r11unorm",37490:"eac-rg11snorm",37492:"etc2-rgb8unorm",37496:"etc2-rgba8unorm",37493:"etc2-rgb8unorm-srgb",37497:"etc2-rgba8unorm-srgb",37494:"etc2-rgb8a1unorm",37495:"etc2-rgb8a1unorm-srgb",37808:"astc-4x4-unorm",37840:"astc-4x4-unorm-srgb",37809:"astc-5x4-unorm",37841:"astc-5x4-unorm-srgb",37810:"astc-5x5-unorm",37842:"astc-5x5-unorm-srgb",37811:"astc-6x5-unorm",37843:"astc-6x5-unorm-srgb",37812:"astc-6x6-unorm",37844:"astc-6x6-unorm-srgb",37813:"astc-8x5-unorm",37845:"astc-8x5-unorm-srgb",37814:"astc-8x6-unorm",37846:"astc-8x6-unorm-srgb",37815:"astc-8x8-unorm",37847:"astc-8x8-unorm-srgb",37816:"astc-10x5-unorm",37848:"astc-10x5-unorm-srgb",37817:"astc-10x6-unorm",37849:"astc-10x6-unorm-srgb",37818:"astc-10x8-unorm",37850:"astc-10x8-unorm-srgb",37819:"astc-10x10-unorm",37851:"astc-10x10-unorm-srgb",37820:"astc-12x10-unorm",37852:"astc-12x10-unorm-srgb",37821:"astc-12x12-unorm",37853:"astc-12x12-unorm-srgb",36492:"bc7-rgba-unorm",36493:"bc7-rgba-unorm-srgb",36494:"bc6h-rgb-float",36495:"bc6h-rgb-ufloat",35907:"rgba8unorm-srgb",36759:"rgba8snorm",36220:"rgba8uint",36238:"rgba8sint",6408:"rgba8unorm"},UG=[171,75,84,88,32,49,49,187,13,10,26,10],LG={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},NG=64,GG=67305985,zG={5121:1,5123:2,5124:4,5125:4,5126:4,36193:8},HG={6408:4,6407:3,33319:2,6403:1,6409:1,6410:2,6406:1},VG={32819:2,32820:2,33635:2},jG={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,36283:.5,36284:.5,36285:1,36286:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,37808:1,37840:1,37809:.8,37841:.8,37810:.64,37842:.64,37811:.53375,37843:.53375,37812:.445,37844:.445,37813:.4,37845:.4,37814:.33375,37846:.33375,37815:.25,37847:.25,37816:.32,37848:.32,37817:.26625,37849:.26625,37818:.2,37850:.2,37819:.16,37851:.16,37820:.13375,37852:.13375,37821:.11125,37853:.11125,36492:1,36493:1,36494:1,36495:1},mt={FILE_HEADER_SIZE:NG,FILE_IDENTIFIER:UG,FORMATS_TO_COMPONENTS:HG,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:jG,INTERNAL_FORMAT_TO_TEXTURE_FORMATS:IG,FIELDS:LG,TYPES_TO_BYTES_PER_COMPONENT:zG,TYPES_TO_BYTES_PER_PIXEL:VG,ENDIANNESS:GG};function OB(t,e){const n=new DataView(t);if(!YG(n))throw new Error("Invalid KTX identifier in header");const{littleEndian:r,glType:i,glFormat:s,glInternalFormat:o,pixelWidth:a,pixelHeight:c,numberOfMipmapLevels:h,offset:f}=XG(n),p=mt.INTERNAL_FORMAT_TO_TEXTURE_FORMATS[o];if(!p)throw new Error(`Unknown texture format ${o}`);if(!e.includes(p))throw new Error(`Unsupported texture format: ${p}, supportedFormats: ${e}`);const v=$G(i,s,o),_=WG(n,i,v,a,c,f,h,r);return{format:p,width:a,height:c,resource:_,alphaMode:"no-premultiply-alpha"}}function WG(t,e,n,r,i,s,o,a){const c=r+3&-4,h=i+3&-4;let f=r*i;e===0&&(f=c*h);let p=f*n,v=r,_=i,y=c,S=h,C=s;const b=new Array(o);for(let w=0;w<o;w++){const T=t.getUint32(C,a);let A=C+4;b[w]=new Uint8Array(t.buffer,A,p),A+=p,C+=T+4,C=C%4!==0?C+4-C%4:C,v=v>>1||1,_=_>>1||1,y=v+4-1&-4,S=_+4-1&-4,p=y*S*n}return b}function $G(t,e,n){let r=mt.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[n];if(t!==0&&(mt.TYPES_TO_BYTES_PER_COMPONENT[t]?r=mt.TYPES_TO_BYTES_PER_COMPONENT[t]*mt.FORMATS_TO_COMPONENTS[e]:r=mt.TYPES_TO_BYTES_PER_PIXEL[t]),r===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");return r}function XG(t){const e=t.getUint32(mt.FIELDS.ENDIANNESS,!0)===mt.ENDIANNESS,n=t.getUint32(mt.FIELDS.GL_TYPE,e),r=t.getUint32(mt.FIELDS.GL_FORMAT,e),i=t.getUint32(mt.FIELDS.GL_INTERNAL_FORMAT,e),s=t.getUint32(mt.FIELDS.PIXEL_WIDTH,e),o=t.getUint32(mt.FIELDS.PIXEL_HEIGHT,e)||1,a=t.getUint32(mt.FIELDS.PIXEL_DEPTH,e)||1,c=t.getUint32(mt.FIELDS.NUMBER_OF_ARRAY_ELEMENTS,e)||1,h=t.getUint32(mt.FIELDS.NUMBER_OF_FACES,e),f=t.getUint32(mt.FIELDS.NUMBER_OF_MIPMAP_LEVELS,e),p=t.getUint32(mt.FIELDS.BYTES_OF_KEY_VALUE_DATA,e);if(o===0||a!==1)throw new Error("Only 2D textures are supported");if(h!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(c!==1)throw new Error("WebGL does not support array textures");return{littleEndian:e,glType:n,glFormat:r,glInternalFormat:i,pixelWidth:s,pixelHeight:o,numberOfMipmapLevels:f,offset:mt.FILE_HEADER_SIZE+p}}function YG(t){for(let e=0;e<mt.FILE_IDENTIFIER.length;e++)if(t.getUint8(e)!==mt.FILE_IDENTIFIER[e])return!1;return!0}const qG={extension:{type:P.LoadParser,priority:In.High,name:"loadKTX"},name:"loadKTX",test(t){return wr(t,".ktx")},async load(t,e,n){const r=await fh(),s=await(await fetch(t)).arrayBuffer(),o=OB(s,r),a=new hh(o);return eo(a,n,t)},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}},KG=`(function () {
    'use strict';

    const converters = {
      rgb8unorm: {
        convertedFormat: "rgba8unorm",
        convertFunction: convertRGBtoRGBA
      },
      "rgb8unorm-srgb": {
        convertedFormat: "rgba8unorm-srgb",
        convertFunction: convertRGBtoRGBA
      }
    };
    function convertFormatIfRequired(textureOptions) {
      const format = textureOptions.format;
      if (converters[format]) {
        const convertFunction = converters[format].convertFunction;
        const levelBuffers = textureOptions.resource;
        for (let i = 0; i < levelBuffers.length; i++) {
          levelBuffers[i] = convertFunction(levelBuffers[i]);
        }
        textureOptions.format = converters[format].convertedFormat;
      }
    }
    function convertRGBtoRGBA(levelBuffer) {
      const pixelCount = levelBuffer.byteLength / 3;
      const levelBufferWithAlpha = new Uint32Array(pixelCount);
      for (let i = 0; i < pixelCount; ++i) {
        levelBufferWithAlpha[i] = levelBuffer[i * 3] + (levelBuffer[i * 3 + 1] << 8) + (levelBuffer[i * 3 + 2] << 16) + 4278190080;
      }
      return new Uint8Array(levelBufferWithAlpha.buffer);
    }

    function createLevelBuffersFromKTX(ktxTexture) {
      const levelBuffers = [];
      for (let i = 0; i < ktxTexture.numLevels; i++) {
        const imageData = ktxTexture.getImageData(i, 0, 0);
        const levelBuffer = new Uint8Array(imageData.byteLength);
        levelBuffer.set(imageData);
        levelBuffers.push(levelBuffer);
      }
      return levelBuffers;
    }

    const glFormatToGPUFormatMap = {
      6408: "rgba8unorm",
      32856: "bgra8unorm",
      //
      32857: "rgb10a2unorm",
      33189: "depth16unorm",
      33190: "depth24plus",
      33321: "r8unorm",
      33323: "rg8unorm",
      33325: "r16float",
      33326: "r32float",
      33327: "rg16float",
      33328: "rg32float",
      33329: "r8sint",
      33330: "r8uint",
      33331: "r16sint",
      33332: "r16uint",
      33333: "r32sint",
      33334: "r32uint",
      33335: "rg8sint",
      33336: "rg8uint",
      33337: "rg16sint",
      33338: "rg16uint",
      33339: "rg32sint",
      33340: "rg32uint",
      33778: "bc2-rgba-unorm",
      33779: "bc3-rgba-unorm",
      34836: "rgba32float",
      34842: "rgba16float",
      35056: "depth24plus-stencil8",
      35898: "rg11b10ufloat",
      35901: "rgb9e5ufloat",
      35907: "rgba8unorm-srgb",
      // bgra8unorm-srgb
      36012: "depth32float",
      36013: "depth32float-stencil8",
      36168: "stencil8",
      36208: "rgba32uint",
      36214: "rgba16uint",
      36220: "rgba8uint",
      36226: "rgba32sint",
      36232: "rgba16sint",
      36238: "rgba8sint",
      36492: "bc7-rgba-unorm",
      36756: "r8snorm",
      36757: "rg8snorm",
      36759: "rgba8snorm",
      37496: "etc2-rgba8unorm",
      37808: "astc-4x4-unorm"
    };
    function glFormatToGPUFormat(glInternalFormat) {
      const format = glFormatToGPUFormatMap[glInternalFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported glInternalFormat: \${glInternalFormat}\`);
    }

    const vkFormatToGPUFormatMap = {
      23: "rgb8unorm",
      // VK_FORMAT_R8G8B8_UNORM
      37: "rgba8unorm",
      // VK_FORMAT_R8G8B8A8_UNORM
      43: "rgba8unorm-srgb"
      // VK_FORMAT_R8G8B8A8_SRGB
      // TODO add more!
    };
    function vkFormatToGPUFormat(vkFormat) {
      const format = vkFormatToGPUFormatMap[vkFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported VkFormat: \${vkFormat}\`);
    }

    function getTextureFormatFromKTXTexture(ktxTexture) {
      if (ktxTexture.classId === 2) {
        return vkFormatToGPUFormat(ktxTexture.vkFormat);
      }
      return glFormatToGPUFormat(ktxTexture.glInternalformat);
    }

    const gpuFormatToBasisTranscoderFormatMap = {
      "bc3-rgba-unorm": "BC3_RGBA",
      "bc7-rgba-unorm": "BC7_M5_RGBA",
      "etc2-rgba8unorm": "ETC2_RGBA",
      "astc-4x4-unorm": "ASTC_4x4_RGBA",
      // Uncompressed
      rgba8unorm: "RGBA32",
      rg11b10ufloat: "R11F_G11F_B10F"
    };
    function gpuFormatToKTXBasisTranscoderFormat(transcoderFormat) {
      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported transcoderFormat: \${transcoderFormat}\`);
    }

    const settings = {
      jsUrl: "",
      wasmUrl: ""
    };
    let basisTranscoderFormat;
    let basisTranscodedTextureFormat;
    let ktxPromise;
    async function getKTX() {
      if (!ktxPromise) {
        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;
        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;
        importScripts(absoluteJsUrl);
        ktxPromise = new Promise((resolve) => {
          LIBKTX({
            locateFile: (_file) => absoluteWasmUrl
          }).then((libktx) => {
            resolve(libktx);
          });
        });
      }
      return ktxPromise;
    }
    async function fetchKTXTexture(url, ktx) {
      const ktx2Response = await fetch(url);
      if (ktx2Response.ok) {
        const ktx2ArrayBuffer = await ktx2Response.arrayBuffer();
        return new ktx.ktxTexture(new Uint8Array(ktx2ArrayBuffer));
      }
      throw new Error(\`Failed to load KTX(2) texture: \${url}\`);
    }
    const preferredTranscodedFormat = [
      "bc7-rgba-unorm",
      "astc-4x4-unorm",
      "etc2-rgba8unorm",
      "bc3-rgba-unorm",
      "rgba8unorm"
    ];
    async function load(url) {
      const ktx = await getKTX();
      const ktxTexture = await fetchKTXTexture(url, ktx);
      let format;
      if (ktxTexture.needsTranscoding) {
        format = basisTranscodedTextureFormat;
        const transcodeFormat = ktx.TranscodeTarget[basisTranscoderFormat];
        const result = ktxTexture.transcodeBasis(transcodeFormat, 0);
        if (result !== ktx.ErrorCode.SUCCESS) {
          throw new Error("Unable to transcode basis texture.");
        }
      } else {
        format = getTextureFormatFromKTXTexture(ktxTexture);
      }
      const levelBuffers = createLevelBuffersFromKTX(ktxTexture);
      const textureOptions = {
        width: ktxTexture.baseWidth,
        height: ktxTexture.baseHeight,
        format,
        mipLevelCount: ktxTexture.numLevels,
        resource: levelBuffers,
        alphaMode: "no-premultiply-alpha"
      };
      convertFormatIfRequired(textureOptions);
      return textureOptions;
    }
    async function init(jsUrl, wasmUrl, supportedTextures) {
      if (jsUrl)
        settings.jsUrl = jsUrl;
      if (wasmUrl)
        settings.wasmUrl = wasmUrl;
      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];
      basisTranscoderFormat = gpuFormatToKTXBasisTranscoderFormat(basisTranscodedTextureFormat);
      await getKTX();
    }
    const messageHandlers = {
      init: async (data) => {
        const { jsUrl, wasmUrl, supportedTextures } = data;
        await init(jsUrl, wasmUrl, supportedTextures);
      },
      load: async (data) => {
        try {
          const textureOptions = await load(data.url);
          return {
            type: "load",
            url: data.url,
            success: true,
            textureOptions,
            transferables: textureOptions.resource?.map((arr) => arr.buffer)
          };
        } catch (e) {
          throw e;
        }
      }
    };
    self.onmessage = async (messageEvent) => {
      const message = messageEvent.data;
      const response = await messageHandlers[message.type]?.(message);
      if (response) {
        self.postMessage(response, response.transferables);
      }
    };

})();
`;let mu=null;class kB{constructor(){mu||(mu=URL.createObjectURL(new Blob([KG],{type:"application/javascript"}))),this.worker=new Worker(mu)}}kB.revokeObjectURL=function(){mu&&(URL.revokeObjectURL(mu),mu=null)};const vp={jsUrl:"https://files.pixijs.download/transcoders/ktx/libktx.js",wasmUrl:"https://files.pixijs.download/transcoders/ktx/libktx.wasm"};function QG(t){Object.assign(vp,t)}let Bl;const FB={};function ZG(t){return Bl||(Bl=new kB().worker,Bl.onmessage=e=>{const{success:n,url:r,textureOptions:i}=e.data;n||console.warn("Failed to load KTX texture",r),FB[r](i)},Bl.postMessage({type:"init",jsUrl:vp.jsUrl,wasmUrl:vp.wasmUrl,supportedTextures:t})),Bl}function IB(t,e){const n=ZG(e);return new Promise(r=>{FB[t]=r,n.postMessage({type:"load",url:t})})}const JG={extension:{type:P.LoadParser,priority:In.High,name:"loadKTX2"},name:"loadKTX2",test(t){return wr(t,".ktx2")},async load(t,e,n){const r=await fh(),i=await IB(t,r),s=new hh(i);return eo(s,n,t)},async unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}},xv={rgb8unorm:{convertedFormat:"rgba8unorm",convertFunction:uT},"rgb8unorm-srgb":{convertedFormat:"rgba8unorm-srgb",convertFunction:uT}};function ez(t){const e=t.format;if(xv[e]){const n=xv[e].convertFunction,r=t.resource;for(let i=0;i<r.length;i++)r[i]=n(r[i]);t.format=xv[e].convertedFormat}}function uT(t){const e=t.byteLength/3,n=new Uint32Array(e);for(let r=0;r<e;++r)n[r]=t[r*3]+(t[r*3+1]<<8)+(t[r*3+2]<<16)+4278190080;return new Uint8Array(n.buffer)}function tz(t){const e=[];for(let n=0;n<t.numLevels;n++){const r=t.getImageData(n,0,0),i=new Uint8Array(r.byteLength);i.set(r),e.push(i)}return e}const nz={6408:"rgba8unorm",32856:"bgra8unorm",32857:"rgb10a2unorm",33189:"depth16unorm",33190:"depth24plus",33321:"r8unorm",33323:"rg8unorm",33325:"r16float",33326:"r32float",33327:"rg16float",33328:"rg32float",33329:"r8sint",33330:"r8uint",33331:"r16sint",33332:"r16uint",33333:"r32sint",33334:"r32uint",33335:"rg8sint",33336:"rg8uint",33337:"rg16sint",33338:"rg16uint",33339:"rg32sint",33340:"rg32uint",33778:"bc2-rgba-unorm",33779:"bc3-rgba-unorm",34836:"rgba32float",34842:"rgba16float",35056:"depth24plus-stencil8",35898:"rg11b10ufloat",35901:"rgb9e5ufloat",35907:"rgba8unorm-srgb",36012:"depth32float",36013:"depth32float-stencil8",36168:"stencil8",36208:"rgba32uint",36214:"rgba16uint",36220:"rgba8uint",36226:"rgba32sint",36232:"rgba16sint",36238:"rgba8sint",36492:"bc7-rgba-unorm",36756:"r8snorm",36757:"rg8snorm",36759:"rgba8snorm",37496:"etc2-rgba8unorm",37808:"astc-4x4-unorm"};function UB(t){const e=nz[t];if(e)return e;throw new Error(`Unsupported glInternalFormat: ${t}`)}const rz={23:"rgb8unorm",37:"rgba8unorm",43:"rgba8unorm-srgb"};function LB(t){const e=rz[t];if(e)return e;throw new Error(`Unsupported VkFormat: ${t}`)}function iz(t){return t.classId===2?LB(t.vkFormat):UB(t.glInternalformat)}const sz={"bc3-rgba-unorm":"BC3_RGBA","bc7-rgba-unorm":"BC7_M5_RGBA","etc2-rgba8unorm":"ETC2_RGBA","astc-4x4-unorm":"ASTC_4x4_RGBA",rgba8unorm:"RGBA32",rg11b10ufloat:"R11F_G11F_B10F"};function oz(t){const e=sz[t];if(e)return e;throw new Error(`Unsupported transcoderFormat: ${t}`)}const _p=["basis","bc7","bc6h","astc","etc2","bc5","bc4","bc3","bc2","bc1","eac"],az={extension:P.ResolveParser,test:t=>wr(t,[".ktx",".ktx2",".dds"]),parse:t=>{let e;const n=t.split(".");if(n.length>2){const r=n[n.length-2];_p.includes(r)&&(e=r)}else e=n[n.length-1];return{resolution:parseFloat(Js.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e,src:t}}};let Jf;const uz={extension:{type:P.DetectionParser,priority:2},test:async()=>!!(await uh()||ah()),add:async t=>{const e=await u1();return Jf=lz(e),[...Jf,...t]},remove:async t=>Jf?t.filter(e=>!(e in Jf)):t};function lz(t){const e=["basis"],n={};return t.forEach(r=>{const i=r.split("-")[0];i&&!n[i]&&(n[i]=!0,e.push(i))}),e.sort((r,i)=>{const s=_p.indexOf(r),o=_p.indexOf(i);return s===-1?1:o===-1?-1:s-o}),e}const cz=new Kt,l2=class{cull(e,n,r=!0){this._cullRecursive(e,n,r)}_cullRecursive(e,n,r=!0){if(e.cullable&&e.measurable&&e.includeInBuild){const i=e.cullArea??sh(e,r,cz);e.culled=i.x>=n.x+n.width||i.y>=n.y+n.height||i.x+i.width<=n.x||i.y+i.height<=n.y}else e.culled=!1;if(!(!e.cullableChildren||e.culled||!e.renderable||!e.measurable||!e.includeInBuild))for(let i=0;i<e.children.length;i++)this._cullRecursive(e.children[i],n,r)}};l2.shared=new l2;let NB=l2;class GB{static init(){this._renderRef=this.render.bind(this),this.render=()=>{NB.shared.cull(this.stage,this.renderer.screen),this.renderer.render({container:this.stage})}}static destroy(){this.render=this._renderRef}}GB.extension={priority:10,type:P.Application,name:"culler"};var to={},us={};function hz(t,e,n){if(n===void 0&&(n=Array.prototype),t&&typeof n.find=="function")return n.find.call(t,e);for(var r=0;r<t.length;r++)if(Object.prototype.hasOwnProperty.call(t,r)){var i=t[r];if(e.call(void 0,i,r,t))return i}}function h1(t,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(t):t}function fz(t,e){if(t===null||typeof t!="object")throw new TypeError("target is not an object");for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}var zB=h1({HTML:"text/html",isHTML:function(t){return t===zB.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),HB=h1({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(t){return t===HB.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});us.assign=fz;us.find=hz;us.freeze=h1;us.MIME_TYPE=zB;us.NAMESPACE=HB;var VB=us,vi=VB.find,zc=VB.NAMESPACE;function dz(t){return t!==""}function pz(t){return t?t.split(/[\t\n\f\r ]+/).filter(dz):[]}function mz(t,e){return t.hasOwnProperty(e)||(t[e]=!0),t}function lT(t){if(!t)return[];var e=pz(t);return Object.keys(e.reduce(mz,{}))}function gz(t){return function(e){return t&&t.indexOf(e)!==-1}}function dh(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function Un(t,e){var n=t.prototype;if(!(n instanceof e)){let r=function(){};r.prototype=e.prototype,r=new r,dh(n,r),t.prototype=n=r}n.constructor!=t&&(typeof t!="function"&&console.error("unknown Class:"+t),n.constructor=t)}var Ln={},Lr=Ln.ELEMENT_NODE=1,Bu=Ln.ATTRIBUTE_NODE=2,xp=Ln.TEXT_NODE=3,jB=Ln.CDATA_SECTION_NODE=4,WB=Ln.ENTITY_REFERENCE_NODE=5,vz=Ln.ENTITY_NODE=6,$B=Ln.PROCESSING_INSTRUCTION_NODE=7,XB=Ln.COMMENT_NODE=8,YB=Ln.DOCUMENT_NODE=9,qB=Ln.DOCUMENT_TYPE_NODE=10,is=Ln.DOCUMENT_FRAGMENT_NODE=11,_z=Ln.NOTATION_NODE=12,fn={},Ht={};fn.INDEX_SIZE_ERR=(Ht[1]="Index size error",1);fn.DOMSTRING_SIZE_ERR=(Ht[2]="DOMString size error",2);var Rn=fn.HIERARCHY_REQUEST_ERR=(Ht[3]="Hierarchy request error",3);fn.WRONG_DOCUMENT_ERR=(Ht[4]="Wrong document",4);fn.INVALID_CHARACTER_ERR=(Ht[5]="Invalid character",5);fn.NO_DATA_ALLOWED_ERR=(Ht[6]="No data allowed",6);fn.NO_MODIFICATION_ALLOWED_ERR=(Ht[7]="No modification allowed",7);var KB=fn.NOT_FOUND_ERR=(Ht[8]="Not found",8);fn.NOT_SUPPORTED_ERR=(Ht[9]="Not supported",9);var cT=fn.INUSE_ATTRIBUTE_ERR=(Ht[10]="Attribute in use",10);fn.INVALID_STATE_ERR=(Ht[11]="Invalid state",11);fn.SYNTAX_ERR=(Ht[12]="Syntax error",12);fn.INVALID_MODIFICATION_ERR=(Ht[13]="Invalid modification",13);fn.NAMESPACE_ERR=(Ht[14]="Invalid namespace",14);fn.INVALID_ACCESS_ERR=(Ht[15]="Invalid access",15);function bt(t,e){if(e instanceof Error)var n=e;else n=this,Error.call(this,Ht[t]),this.message=Ht[t],Error.captureStackTrace&&Error.captureStackTrace(this,bt);return n.code=t,e&&(this.message=this.message+": "+e),n}bt.prototype=Error.prototype;dh(fn,bt);function qi(){}qi.prototype={length:0,item:function(t){return t>=0&&t<this.length?this[t]:null},toString:function(t,e){for(var n=[],r=0;r<this.length;r++)tu(this[r],n,t,e);return n.join("")},filter:function(t){return Array.prototype.filter.call(this,t)},indexOf:function(t){return Array.prototype.indexOf.call(this,t)}};function Mu(t,e){this._node=t,this._refresh=e,f1(this)}function f1(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!==e){var n=t._refresh(t._node);if(uM(t,"length",n.length),!t.$$length||n.length<t.$$length)for(var r=n.length;r in t;r++)Object.prototype.hasOwnProperty.call(t,r)&&delete t[r];dh(n,t),t._inc=e}}Mu.prototype.item=function(t){return f1(this),this[t]||null};Un(Mu,qi);function yp(){}function QB(t,e){for(var n=t.length;n--;)if(t[n]===e)return n}function hT(t,e,n,r){if(r?e[QB(e,r)]=n:e[e.length++]=n,t){n.ownerElement=t;var i=t.ownerDocument;i&&(r&&eM(i,t,r),xz(i,t,n))}}function fT(t,e,n){var r=QB(e,n);if(r>=0){for(var i=e.length-1;r<i;)e[r]=e[++r];if(e.length=i,t){var s=t.ownerDocument;s&&(eM(s,t,n),n.ownerElement=null)}}else throw new bt(KB,new Error(t.tagName+"@"+n))}yp.prototype={length:0,item:qi.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var n=this[e];if(n.nodeName==t)return n}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new bt(cT);var n=this.getNamedItem(t.nodeName);return hT(this._ownerElement,this,t,n),n},setNamedItemNS:function(t){var e=t.ownerElement,n;if(e&&e!=this._ownerElement)throw new bt(cT);return n=this.getNamedItemNS(t.namespaceURI,t.localName),hT(this._ownerElement,this,t,n),n},removeNamedItem:function(t){var e=this.getNamedItem(t);return fT(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var n=this.getNamedItemNS(t,e);return fT(this._ownerElement,this,n),n},getNamedItemNS:function(t,e){for(var n=this.length;n--;){var r=this[n];if(r.localName==e&&r.namespaceURI==t)return r}return null}};function ZB(){}ZB.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,n){var r=new ph;if(r.implementation=this,r.childNodes=new qi,r.doctype=n||null,n&&r.appendChild(n),e){var i=r.createElementNS(t,e);r.appendChild(i)}return r},createDocumentType:function(t,e,n){var r=new Pm;return r.name=t,r.nodeName=t,r.publicId=e||"",r.systemId=n||"",r}};function Ve(){}Ve.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return bp(this,t,e)},replaceChild:function(t,e){bp(this,t,e,nM),e&&this.removeChild(e)},removeChild:function(t){return tM(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(t){return c2(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==xp&&t.nodeType==xp?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var n=e._nsMap;if(n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&n[r]===t)return r}e=e.nodeType==Bu?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var n=e._nsMap;if(n&&Object.prototype.hasOwnProperty.call(n,t))return n[t];e=e.nodeType==Bu?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){var e=this.lookupPrefix(t);return e==null}};function JB(t){return t=="<"&&"&lt;"||t==">"&&"&gt;"||t=="&"&&"&amp;"||t=='"'&&"&quot;"||"&#"+t.charCodeAt()+";"}dh(Ln,Ve);dh(Ln,Ve.prototype);function Hc(t,e){if(e(t))return!0;if(t=t.firstChild)do if(Hc(t,e))return!0;while(t=t.nextSibling)}function ph(){this.ownerDocument=this}function xz(t,e,n){t&&t._inc++;var r=n.namespaceURI;r===zc.XMLNS&&(e._nsMap[n.prefix?n.localName:""]=n.value)}function eM(t,e,n,r){t&&t._inc++;var i=n.namespaceURI;i===zc.XMLNS&&delete e._nsMap[n.prefix?n.localName:""]}function d1(t,e,n){if(t&&t._inc){t._inc++;var r=e.childNodes;if(n)r[r.length++]=n;else{for(var i=e.firstChild,s=0;i;)r[s++]=i,i=i.nextSibling;r.length=s,delete r[r.length]}}}function tM(t,e){var n=e.previousSibling,r=e.nextSibling;return n?n.nextSibling=r:t.firstChild=r,r?r.previousSibling=n:t.lastChild=n,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,d1(t.ownerDocument,t),e}function yz(t){return t&&(t.nodeType===Ve.DOCUMENT_NODE||t.nodeType===Ve.DOCUMENT_FRAGMENT_NODE||t.nodeType===Ve.ELEMENT_NODE)}function bz(t){return t&&(_i(t)||p1(t)||ss(t)||t.nodeType===Ve.DOCUMENT_FRAGMENT_NODE||t.nodeType===Ve.COMMENT_NODE||t.nodeType===Ve.PROCESSING_INSTRUCTION_NODE)}function ss(t){return t&&t.nodeType===Ve.DOCUMENT_TYPE_NODE}function _i(t){return t&&t.nodeType===Ve.ELEMENT_NODE}function p1(t){return t&&t.nodeType===Ve.TEXT_NODE}function dT(t,e){var n=t.childNodes||[];if(vi(n,_i)||ss(e))return!1;var r=vi(n,ss);return!(e&&r&&n.indexOf(r)>n.indexOf(e))}function pT(t,e){var n=t.childNodes||[];function r(s){return _i(s)&&s!==e}if(vi(n,r))return!1;var i=vi(n,ss);return!(e&&i&&n.indexOf(i)>n.indexOf(e))}function Sz(t,e,n){if(!yz(t))throw new bt(Rn,"Unexpected parent node type "+t.nodeType);if(n&&n.parentNode!==t)throw new bt(KB,"child not in parent");if(!bz(e)||ss(e)&&t.nodeType!==Ve.DOCUMENT_NODE)throw new bt(Rn,"Unexpected node type "+e.nodeType+" for parent node type "+t.nodeType)}function wz(t,e,n){var r=t.childNodes||[],i=e.childNodes||[];if(e.nodeType===Ve.DOCUMENT_FRAGMENT_NODE){var s=i.filter(_i);if(s.length>1||vi(i,p1))throw new bt(Rn,"More than one element or text in fragment");if(s.length===1&&!dT(t,n))throw new bt(Rn,"Element in fragment can not be inserted before doctype")}if(_i(e)&&!dT(t,n))throw new bt(Rn,"Only one element can be added and only after doctype");if(ss(e)){if(vi(r,ss))throw new bt(Rn,"Only one doctype is allowed");var o=vi(r,_i);if(n&&r.indexOf(o)<r.indexOf(n))throw new bt(Rn,"Doctype can only be inserted before an element");if(!n&&o)throw new bt(Rn,"Doctype can not be appended since element is present")}}function nM(t,e,n){var r=t.childNodes||[],i=e.childNodes||[];if(e.nodeType===Ve.DOCUMENT_FRAGMENT_NODE){var s=i.filter(_i);if(s.length>1||vi(i,p1))throw new bt(Rn,"More than one element or text in fragment");if(s.length===1&&!pT(t,n))throw new bt(Rn,"Element in fragment can not be inserted before doctype")}if(_i(e)&&!pT(t,n))throw new bt(Rn,"Only one element can be added and only after doctype");if(ss(e)){if(vi(r,function(c){return ss(c)&&c!==n}))throw new bt(Rn,"Only one doctype is allowed");var o=vi(r,_i);if(n&&r.indexOf(o)<r.indexOf(n))throw new bt(Rn,"Doctype can only be inserted before an element")}}function bp(t,e,n,r){Sz(t,e,n),t.nodeType===Ve.DOCUMENT_NODE&&(r||wz)(t,e,n);var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===is){var s=e.firstChild;if(s==null)return e;var o=e.lastChild}else s=o=e;var a=n?n.previousSibling:t.lastChild;s.previousSibling=a,o.nextSibling=n,a?a.nextSibling=s:t.firstChild=s,n==null?t.lastChild=o:n.previousSibling=o;do s.parentNode=t;while(s!==o&&(s=s.nextSibling));return d1(t.ownerDocument||t,t),e.nodeType==is&&(e.firstChild=e.lastChild=null),e}function Cz(t,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=t,e.previousSibling=t.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,t.lastChild=e,d1(t.ownerDocument,t,e),e}ph.prototype={nodeName:"#document",nodeType:YB,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==is){for(var n=t.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,e),n=r}return t}return bp(this,t,e),t.ownerDocument=this,this.documentElement===null&&t.nodeType===Lr&&(this.documentElement=t),t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),tM(this,t)},replaceChild:function(t,e){bp(this,t,e,nM),t.ownerDocument=this,e&&this.removeChild(e),_i(t)&&(this.documentElement=t)},importNode:function(t,e){return aM(this,t,e)},getElementById:function(t){var e=null;return Hc(this.documentElement,function(n){if(n.nodeType==Lr&&n.getAttribute("id")==t)return e=n,!0}),e},getElementsByClassName:function(t){var e=lT(t);return new Mu(this,function(n){var r=[];return e.length>0&&Hc(n.documentElement,function(i){if(i!==n&&i.nodeType===Lr){var s=i.getAttribute("class");if(s){var o=t===s;if(!o){var a=lT(s);o=e.every(gz(a))}o&&r.push(i)}}}),r})},createElement:function(t){var e=new Wo;e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new qi;var n=e.attributes=new yp;return n._ownerElement=e,e},createDocumentFragment:function(){var t=new Rm;return t.ownerDocument=this,t.childNodes=new qi,t},createTextNode:function(t){var e=new m1;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new g1;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new v1;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var n=new x1;return n.ownerDocument=this,n.tagName=n.nodeName=n.target=t,n.nodeValue=n.data=e,n},createAttribute:function(t){var e=new Sp;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new _1;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var n=new Wo,r=e.split(":"),i=n.attributes=new yp;return n.childNodes=new qi,n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.namespaceURI=t,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=e,i._ownerElement=n,n},createAttributeNS:function(t,e){var n=new Sp,r=e.split(":");return n.ownerDocument=this,n.nodeName=e,n.name=e,n.namespaceURI=t,n.specified=!0,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=e,n}};Un(ph,Ve);function Wo(){this._nsMap={}}Wo.prototype={nodeType:Lr,hasAttribute:function(t){return this.getAttributeNode(t)!=null},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var n=this.ownerDocument.createAttribute(t);n.value=n.nodeValue=""+e,this.setAttributeNode(n)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===is?this.insertBefore(t,null):Cz(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);n&&this.removeAttributeNode(n)},hasAttributeNS:function(t,e){return this.getAttributeNodeNS(t,e)!=null},getAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);return n&&n.value||""},setAttributeNS:function(t,e,n){var r=this.ownerDocument.createAttributeNS(t,e);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new Mu(this,function(e){var n=[];return Hc(e,function(r){r!==e&&r.nodeType==Lr&&(t==="*"||r.tagName==t)&&n.push(r)}),n})},getElementsByTagNameNS:function(t,e){return new Mu(this,function(n){var r=[];return Hc(n,function(i){i!==n&&i.nodeType===Lr&&(t==="*"||i.namespaceURI===t)&&(e==="*"||i.localName==e)&&r.push(i)}),r})}};ph.prototype.getElementsByTagName=Wo.prototype.getElementsByTagName;ph.prototype.getElementsByTagNameNS=Wo.prototype.getElementsByTagNameNS;Un(Wo,Ve);function Sp(){}Sp.prototype.nodeType=Bu;Un(Sp,Ve);function mh(){}mh.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(Ht[Rn])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,n){var r=this.data.substring(0,t),i=this.data.substring(t+e);n=r+n+i,this.nodeValue=this.data=n,this.length=n.length}};Un(mh,Ve);function m1(){}m1.prototype={nodeName:"#text",nodeType:xp,splitText:function(t){var e=this.data,n=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}};Un(m1,mh);function g1(){}g1.prototype={nodeName:"#comment",nodeType:XB};Un(g1,mh);function v1(){}v1.prototype={nodeName:"#cdata-section",nodeType:jB};Un(v1,mh);function Pm(){}Pm.prototype.nodeType=qB;Un(Pm,Ve);function rM(){}rM.prototype.nodeType=_z;Un(rM,Ve);function iM(){}iM.prototype.nodeType=vz;Un(iM,Ve);function _1(){}_1.prototype.nodeType=WB;Un(_1,Ve);function Rm(){}Rm.prototype.nodeName="#document-fragment";Rm.prototype.nodeType=is;Un(Rm,Ve);function x1(){}x1.prototype.nodeType=$B;Un(x1,Ve);function sM(){}sM.prototype.serializeToString=function(t,e,n){return oM.call(t,e,n)};Ve.prototype.toString=oM;function oM(t,e){var n=[],r=this.nodeType==9&&this.documentElement||this,i=r.prefix,s=r.namespaceURI;if(s&&i==null){var i=r.lookupPrefix(s);if(i==null)var o=[{namespace:s,prefix:null}]}return tu(this,n,t,e,o),n.join("")}function mT(t,e,n){var r=t.prefix||"",i=t.namespaceURI;if(!i||r==="xml"&&i===zc.XML||i===zc.XMLNS)return!1;for(var s=n.length;s--;){var o=n[s];if(o.prefix===r)return o.namespace!==i}return!0}function yv(t,e,n){t.push(" ",e,'="',n.replace(/[<>&"\t\n\r]/g,JB),'"')}function tu(t,e,n,r,i){if(i||(i=[]),r)if(t=r(t),t){if(typeof t=="string"){e.push(t);return}}else return;switch(t.nodeType){case Lr:var s=t.attributes,o=s.length,b=t.firstChild,a=t.tagName;n=zc.isHTML(t.namespaceURI)||n;var c=a;if(!n&&!t.prefix&&t.namespaceURI){for(var h,f=0;f<s.length;f++)if(s.item(f).name==="xmlns"){h=s.item(f).value;break}if(!h)for(var p=i.length-1;p>=0;p--){var v=i[p];if(v.prefix===""&&v.namespace===t.namespaceURI){h=v.namespace;break}}if(h!==t.namespaceURI)for(var p=i.length-1;p>=0;p--){var v=i[p];if(v.namespace===t.namespaceURI){v.prefix&&(c=v.prefix+":"+a);break}}}e.push("<",c);for(var _=0;_<o;_++){var y=s.item(_);y.prefix=="xmlns"?i.push({prefix:y.localName,namespace:y.value}):y.nodeName=="xmlns"&&i.push({prefix:"",namespace:y.value})}for(var _=0;_<o;_++){var y=s.item(_);if(mT(y,n,i)){var S=y.prefix||"",C=y.namespaceURI;yv(e,S?"xmlns:"+S:"xmlns",C),i.push({prefix:S,namespace:C})}tu(y,e,n,r,i)}if(a===c&&mT(t,n,i)){var S=t.prefix||"",C=t.namespaceURI;yv(e,S?"xmlns:"+S:"xmlns",C),i.push({prefix:S,namespace:C})}if(b||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(a)){if(e.push(">"),n&&/^script$/i.test(a))for(;b;)b.data?e.push(b.data):tu(b,e,n,r,i.slice()),b=b.nextSibling;else for(;b;)tu(b,e,n,r,i.slice()),b=b.nextSibling;e.push("</",c,">")}else e.push("/>");return;case YB:case is:for(var b=t.firstChild;b;)tu(b,e,n,r,i.slice()),b=b.nextSibling;return;case Bu:return yv(e,t.name,t.value);case xp:return e.push(t.data.replace(/[<&>]/g,JB));case jB:return e.push("<![CDATA[",t.data,"]]>");case XB:return e.push("<!--",t.data,"-->");case qB:var w=t.publicId,T=t.systemId;if(e.push("<!DOCTYPE ",t.name),w)e.push(" PUBLIC ",w),T&&T!="."&&e.push(" ",T),e.push(">");else if(T&&T!=".")e.push(" SYSTEM ",T,">");else{var A=t.internalSubset;A&&e.push(" [",A,"]"),e.push(">")}return;case $B:return e.push("<?",t.target," ",t.data,"?>");case WB:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function aM(t,e,n){var r;switch(e.nodeType){case Lr:r=e.cloneNode(!1),r.ownerDocument=t;case is:break;case Bu:n=!0;break}if(r||(r=e.cloneNode(!1)),r.ownerDocument=t,r.parentNode=null,n)for(var i=e.firstChild;i;)r.appendChild(aM(t,i,n)),i=i.nextSibling;return r}function c2(t,e,n){var r=new e.constructor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=e[i];typeof s!="object"&&s!=r[i]&&(r[i]=s)}switch(e.childNodes&&(r.childNodes=new qi),r.ownerDocument=t,r.nodeType){case Lr:var o=e.attributes,a=r.attributes=new yp,c=o.length;a._ownerElement=r;for(var h=0;h<c;h++)r.setAttributeNode(c2(t,o.item(h),!0));break;case Bu:n=!0}if(n)for(var f=e.firstChild;f;)r.appendChild(c2(t,f,n)),f=f.nextSibling;return r}function uM(t,e,n){t[e]=n}try{if(Object.defineProperty){let t=function(e){switch(e.nodeType){case Lr:case is:var n=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&n.push(t(e)),e=e.nextSibling;return n.join("");default:return e.nodeValue}};Object.defineProperty(Mu.prototype,"length",{get:function(){return f1(this),this.$$length}}),Object.defineProperty(Ve.prototype,"textContent",{get:function(){return t(this)},set:function(e){switch(this.nodeType){case Lr:case is:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),uM=function(e,n,r){e["$$"+n]=r}}}catch{}to.DocumentType=Pm;to.DOMException=bt;to.DOMImplementation=ZB;to.Element=Wo;to.Node=Ve;to.NodeList=qi;to.XMLSerializer=sM;var Bm={},lM={};(function(t){var e=us.freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),t.entityMap=t.HTML_ENTITIES})(lM);var y1={},Vc=us.NAMESPACE,h2=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,gT=new RegExp("[\\-\\.0-9"+h2.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),vT=new RegExp("^"+h2.source+gT.source+"*(?::"+h2.source+gT.source+"*)?$"),Ml=0,Ss=1,Aa=2,Dl=3,Pa=4,Ra=5,Ol=6,ed=7;function Du(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Du)}Du.prototype=new Error;Du.prototype.name=Du.name;function cM(){}cM.prototype={parse:function(t,e,n){var r=this.domBuilder;r.startDocument(),hM(e,e={}),Tz(t,e,n,r,this.errorHandler),r.endDocument()}};function Tz(t,e,n,r,i){function s(oe){if(oe>65535){oe-=65536;var Y=55296+(oe>>10),V=56320+(oe&1023);return String.fromCharCode(Y,V)}else return String.fromCharCode(oe)}function o(oe){var Y=oe.slice(1,-1);return Object.hasOwnProperty.call(n,Y)?n[Y]:Y.charAt(0)==="#"?s(parseInt(Y.substr(1).replace("x","0x"))):(i.error("entity not found:"+oe),oe)}function a(oe){if(oe>S){var Y=t.substring(S,oe).replace(/&#?\w+;/g,o);v&&c(S),r.characters(Y,0,oe-S),S=oe}}function c(oe,Y){for(;oe>=f&&(Y=p.exec(t));)h=Y.index,f=h+Y[0].length,v.lineNumber++;v.columnNumber=oe-h+1}for(var h=0,f=0,p=/.*(?:\r\n?|\n)|.*$/g,v=r.locator,_=[{currentNSMap:e}],y={},S=0;;){try{var C=t.indexOf("<",S);if(C<0){if(!t.substr(S).match(/^\s*$/)){var b=r.doc,w=b.createTextNode(t.substr(S));b.appendChild(w),r.currentElement=w}return}switch(C>S&&a(C),t.charAt(C+1)){case"/":var ie=t.indexOf(">",C+3),T=t.substring(C+2,ie).replace(/[ \t\n\r]+$/g,""),A=_.pop();ie<0?(T=t.substring(C+2).replace(/[\s<].*/,""),i.error("end tag name: "+T+" is not complete:"+A.tagName),ie=C+1+T.length):T.match(/\s</)&&(T=T.replace(/[\s<].*/,""),i.error("end tag name: "+T+" maybe not complete"),ie=C+1+T.length);var M=A.localNSMap,L=A.tagName==T,I=L||A.tagName&&A.tagName.toLowerCase()==T.toLowerCase();if(I){if(r.endElement(A.uri,A.localName,T),M)for(var N in M)Object.prototype.hasOwnProperty.call(M,N)&&r.endPrefixMapping(N);L||i.fatalError("end tag name: "+T+" is not match the current start tagName:"+A.tagName)}else _.push(A);ie++;break;case"?":v&&c(C),ie=Bz(t,C,r);break;case"!":v&&c(C),ie=Rz(t,C,r,i);break;default:v&&c(C);var k=new fM,G=_[_.length-1].currentNSMap,ie=Ez(t,C,k,G,o,i),Ze=k.length;if(!k.closed&&Pz(t,ie,k.tagName,y)&&(k.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),v&&Ze){for(var re=_T(v,{}),J=0;J<Ze;J++){var ye=k[J];c(ye.offset),ye.locator=_T(v,{})}r.locator=re,xT(k,r,G)&&_.push(k),r.locator=v}else xT(k,r,G)&&_.push(k);Vc.isHTML(k.uri)&&!k.closed?ie=Az(t,ie,k.tagName,o,r):ie++}}catch(oe){if(oe instanceof Du)throw oe;i.error("element parse error: "+oe),ie=-1}ie>S?S=ie:a(Math.max(C,S)+1)}}function _T(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function Ez(t,e,n,r,i,s){function o(v,_,y){n.attributeNames.hasOwnProperty(v)&&s.fatalError("Attribute "+v+" redefined"),n.addValue(v,_.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,i),y)}for(var a,c,h=++e,f=Ml;;){var p=t.charAt(h);switch(p){case"=":if(f===Ss)a=t.slice(e,h),f=Dl;else if(f===Aa)f=Dl;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(f===Dl||f===Ss)if(f===Ss&&(s.warning('attribute value must after "="'),a=t.slice(e,h)),e=h+1,h=t.indexOf(p,e),h>0)c=t.slice(e,h),o(a,c,e-1),f=Ra;else throw new Error("attribute value no end '"+p+"' match");else if(f==Pa)c=t.slice(e,h),o(a,c,e),s.warning('attribute "'+a+'" missed start quot('+p+")!!"),e=h+1,f=Ra;else throw new Error('attribute value must after "="');break;case"/":switch(f){case Ml:n.setTagName(t.slice(e,h));case Ra:case Ol:case ed:f=ed,n.closed=!0;case Pa:case Ss:break;case Aa:n.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),f==Ml&&n.setTagName(t.slice(e,h)),h;case">":switch(f){case Ml:n.setTagName(t.slice(e,h));case Ra:case Ol:case ed:break;case Pa:case Ss:c=t.slice(e,h),c.slice(-1)==="/"&&(n.closed=!0,c=c.slice(0,-1));case Aa:f===Aa&&(c=a),f==Pa?(s.warning('attribute "'+c+'" missed quot(")!'),o(a,c,e)):((!Vc.isHTML(r[""])||!c.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),o(c,c,e));break;case Dl:throw new Error("attribute value missed!!")}return h;case"":p=" ";default:if(p<=" ")switch(f){case Ml:n.setTagName(t.slice(e,h)),f=Ol;break;case Ss:a=t.slice(e,h),f=Aa;break;case Pa:var c=t.slice(e,h);s.warning('attribute "'+c+'" missed quot(")!!'),o(a,c,e);case Ra:f=Ol;break}else switch(f){case Aa:n.tagName,(!Vc.isHTML(r[""])||!a.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=h,f=Ss;break;case Ra:s.warning('attribute space is required"'+a+'"!!');case Ol:f=Ss,e=h;break;case Dl:f=Pa,e=h;break;case ed:throw new Error("elements closed character '/' and '>' must be connected to")}}h++}}function xT(t,e,n){for(var r=t.tagName,i=null,p=t.length;p--;){var s=t[p],o=s.qName,a=s.value,v=o.indexOf(":");if(v>0)var c=s.prefix=o.slice(0,v),h=o.slice(v+1),f=c==="xmlns"&&h;else h=o,c=null,f=o==="xmlns"&&"";s.localName=h,f!==!1&&(i==null&&(i={},hM(n,n={})),n[f]=i[f]=a,s.uri=Vc.XMLNS,e.startPrefixMapping(f,a))}for(var p=t.length;p--;){s=t[p];var c=s.prefix;c&&(c==="xml"&&(s.uri=Vc.XML),c!=="xmlns"&&(s.uri=n[c||""]))}var v=r.indexOf(":");v>0?(c=t.prefix=r.slice(0,v),h=t.localName=r.slice(v+1)):(c=null,h=t.localName=r);var _=t.uri=n[c||""];if(e.startElement(_,h,r,t),t.closed){if(e.endElement(_,h,r),i)for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&e.endPrefixMapping(c)}else return t.currentNSMap=n,t.localNSMap=i,!0}function Az(t,e,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var s=t.indexOf("</"+n+">",e),o=t.substring(e+1,s);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),s):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),s)}return e+1}function Pz(t,e,n,r){var i=r[n];return i==null&&(i=t.lastIndexOf("</"+n+">"),i<e&&(i=t.lastIndexOf("</"+n)),r[n]=i),i<e}function hM(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function Rz(t,e,n,r){var i=t.charAt(e+2);switch(i){case"-":if(t.charAt(e+3)==="-"){var s=t.indexOf("-->",e+4);return s>e?(n.comment(t,e+4,s-e-4),s+3):(r.error("Unclosed comment"),-1)}else return-1;default:if(t.substr(e+3,6)=="CDATA["){var s=t.indexOf("]]>",e+9);return n.startCDATA(),n.characters(t,e+9,s-e-9),n.endCDATA(),s+3}var o=Mz(t,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var c=o[1][0],h=!1,f=!1;a>3&&(/^public$/i.test(o[2][0])?(h=o[3][0],f=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(f=o[3][0]));var p=o[a-1];return n.startDTD(c,h,f),n.endDTD(),p.index+p[0].length}}return-1}function Bz(t,e,n){var r=t.indexOf("?>",e);if(r){var i=t.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return i?(i[0].length,n.processingInstruction(i[1],i[2]),r+2):-1}return-1}function fM(){this.attributeNames={}}fM.prototype={setTagName:function(t){if(!vT.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,n){if(!vT.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:n}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}};function Mz(t,e){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=e,i.exec(t);n=i.exec(t);)if(r.push(n),n[1])return r}y1.XMLReader=cM;y1.ParseError=Du;var Dz=us,Oz=to,yT=lM,dM=y1,kz=Oz.DOMImplementation,bT=Dz.NAMESPACE,Fz=dM.ParseError,Iz=dM.XMLReader;function pM(t){return t.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function mM(t){this.options=t||{locator:{}}}mM.prototype.parseFromString=function(t,e){var n=this.options,r=new Iz,i=n.domBuilder||new gh,s=n.errorHandler,o=n.locator,a=n.xmlns||{},c=/\/x?html?$/.test(e),h=c?yT.HTML_ENTITIES:yT.XML_ENTITIES;o&&i.setDocumentLocator(o),r.errorHandler=Uz(s,i,o),r.domBuilder=n.domBuilder||i,c&&(a[""]=bT.HTML),a.xml=a.xml||bT.XML;var f=n.normalizeLineEndings||pM;return t&&typeof t=="string"?r.parse(f(t),a,h):r.errorHandler.error("invalid doc source"),i.doc};function Uz(t,e,n){if(!t){if(e instanceof gh)return e;t=e}var r={},i=t instanceof Function;n=n||{};function s(o){var a=t[o];!a&&i&&(a=t.length==2?function(c){t(o,c)}:t),r[o]=a&&function(c){a("[xmldom "+o+"]	"+c+f2(n))}||function(){}}return s("warning"),s("error"),s("fatalError"),r}function gh(){this.cdata=!1}function Ba(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}gh.prototype={startDocument:function(){this.doc=new kz().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,n,r){var i=this.doc,s=i.createElementNS(t,n||e),o=r.length;td(this,s),this.currentElement=s,this.locator&&Ba(this.locator,s);for(var a=0;a<o;a++){var t=r.getURI(a),c=r.getValue(a),n=r.getQName(a),h=i.createAttributeNS(t,n);this.locator&&Ba(r.getLocator(a),h),h.value=h.nodeValue=c,s.setAttributeNode(h)}},endElement:function(t,e,n){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.doc.createProcessingInstruction(t,e);this.locator&&Ba(this.locator,n),td(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=ST.apply(this,arguments),t){if(this.cdata)var r=this.doc.createCDATASection(t);else var r=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(t)&&this.doc.appendChild(r),this.locator&&Ba(this.locator,r)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=ST.apply(this,arguments);var r=this.doc.createComment(t);this.locator&&Ba(this.locator,r),td(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(t,e,n);this.locator&&Ba(this.locator,i),td(this,i),this.doc.doctype=i}},warning:function(t){console.warn("[xmldom warning]	"+t,f2(this.locator))},error:function(t){console.error("[xmldom error]	"+t,f2(this.locator))},fatalError:function(t){throw new Fz(t,this.locator)}};function f2(t){if(t)return`
@`+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function ST(t,e,n){return typeof t=="string"?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){gh.prototype[t]=function(){return null}});function td(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}Bm.__DOMHandler=gh;Bm.normalizeLineEndings=pM;Bm.DOMParser=mM;var Lz=Bm.DOMParser;const Nz={createCanvas:(t,e)=>new OffscreenCanvas(t??0,e??0),getCanvasRenderingContext2D:()=>OffscreenCanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>globalThis.location.href,getFontFaceSet:()=>globalThis.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new Lz().parseFromString(t,"text/xml")};class Gz{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this._tickerAdded||!this.domElement||(at.system.add(this._tickerUpdate,this,rs.INTERACTION),this._tickerAdded=!0)}removeTickerListener(){this._tickerAdded&&(at.system.remove(this._tickerUpdate,this),this._tickerAdded=!1)}pointerMoved(){this._didMove=!0}_update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events._rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY,pointerType:e.pointerType,pointerId:e.pointerId}))}_tickerUpdate(e){this._deltaTime+=e.deltaTime,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this._update())}}const Hi=new Gz;class jc extends Nu{constructor(){super(...arguments),this.client=new ze,this.movement=new ze,this.offset=new ze,this.global=new ze,this.screen=new ze}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,n,r){return e.worldTransform.applyInverse(r||this.global,n)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,n,r,i,s,o,a,c,h,f,p,v,_,y,S){throw new Error("Method not implemented.")}}class ur extends jc{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class $o extends jc{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}$o.DOM_DELTA_PIXEL=0;$o.DOM_DELTA_LINE=1;$o.DOM_DELTA_PAGE=2;const zz=2048,Hz=new ze,kl=new ze;class gM{constructor(e){this.dispatch=new Mt,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,n){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:n,priority:0}),this.mappingTable[e].sort((r,i)=>r.priority-i.priority)}dispatchEvent(e,n){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,n),this.dispatch.emit(n||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const n=this.mappingTable[e.type];if(n)for(let r=0,i=n.length;r<i;r++)n[r].fn(e);else de(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,n){Hi.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[i](this.rootTarget,this.rootTarget.eventMode,Hz.set(e,n),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(e,n){if(!e.target)return;const r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=r.length-1;i<s;i++)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,n),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=r.length-2;i>=0;i--)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,n,r=this._allInteractiveElements){if(r.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(n)?n:[n];for(let s=r.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=r[s],this.notifyTarget(e,o)})}propagationPath(e){const n=[e];for(let r=0;r<zz&&e!==this.rootTarget&&e.parent;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");n.push(e.parent),e=e.parent}return n.reverse(),n}hitTestMoveRecursive(e,n,r,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||n==="dynamic")&&(Hi.pauseUpdate=!1),e.interactiveChildren&&e.children){const f=e.children;for(let p=f.length-1;p>=0;p--){const v=f[p],_=this.hitTestMoveRecursive(v,this._isInteractive(n)?n:v.eventMode,r,i,s,o||s(e,r));if(_){if(_.length>0&&!_[_.length-1].parent)continue;const y=e.isInteractive();(_.length>0||y)&&(y&&this._allInteractiveElements.push(e),_.push(e)),this._hitElements.length===0&&(this._hitElements=_),a=!0}}}const c=this._isInteractive(n),h=e.isInteractive();return h&&h&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:c&&!s(e,r)&&i(e,r)?h?[e]:[]:null}hitTestRecursive(e,n,r,i,s){if(this._interactivePrune(e)||s(e,r))return null;if((e.eventMode==="dynamic"||n==="dynamic")&&(Hi.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children,h=r;for(let f=c.length-1;f>=0;f--){const p=c[f],v=this.hitTestRecursive(p,this._isInteractive(n)?n:p.eventMode,h,i,s);if(v){if(v.length>0&&!v[v.length-1].parent)continue;const _=e.isInteractive();return(v.length>0||_)&&v.push(e),v}}}const o=this._isInteractive(n),a=e.isInteractive();return o&&i(e,r)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!e||!e.visible||!e.renderable||!e.includeInBuild||!e.measurable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren}hitPruneFn(e,n){if(e.hitArea&&(e.worldTransform.applyInverse(n,kl),!e.hitArea.contains(kl.x,kl.y)))return!0;if(e.effects&&e.effects.length)for(let r=0;r<e.effects.length;r++){const i=e.effects[r];if(i.containsPoint&&!i.containsPoint(n,this.hitTestFn))return!0}return!1}hitTestFn(e,n){return e.hitArea?!0:e?.containsPoint?(e.worldTransform.applyInverse(n,kl),e.containsPoint(kl)):!1}notifyTarget(e,n){if(!e.currentTarget.isInteractive())return;n=n??e.type;const r=`on${n}`;e.currentTarget[r]?.(e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${n}capture`:n;this._notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this._notifyListeners(e,n)}mapPointerDown(e){if(!(e instanceof ur)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerdown"),n.pointerType==="touch")this.dispatchEvent(n,"touchstart");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const i=n.button===2;this.dispatchEvent(n,i?"rightdown":"mousedown")}const r=this.trackingData(e.pointerId);r.pressTargetsByButton[e.button]=n.composedPath(),this.freeEvent(n)}mapPointerMove(e){if(!(e instanceof ur)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const n=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const r=n.pointerType==="mouse"||n.pointerType==="pen",i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(i.overTargets?.length>0&&s!==n.target){const c=e.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(e,c,s);if(this.dispatchEvent(h,"pointerout"),r&&this.dispatchEvent(h,"mouseout"),!n.composedPath().includes(s)){const f=this.createPointerEvent(e,"pointerleave",s);for(f.eventPhase=f.AT_TARGET;f.target&&!n.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),r&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(h)}if(s!==n.target){const c=e.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(n,c);this.dispatchEvent(h,"pointerover"),r&&this.dispatchEvent(h,"mouseover");let f=s?.parent;for(;f&&f!==this.rootTarget.parent&&f!==n.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const v=this.clonePointerEvent(n,"pointerenter");for(v.eventPhase=v.AT_TARGET;v.target&&v.target!==s&&v.target!==this.rootTarget.parent;)v.currentTarget=v.target,this.notifyTarget(v),r&&this.notifyTarget(v,"mouseenter"),v.target=v.target.parent;this.freeEvent(v)}this.freeEvent(h)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(n,"pointermove"),a&&o.push("globalpointermove"),n.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(n,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(n,"mousemove"),a&&o.push("globalmousemove"),this.cursor=n.target?.cursor),o.length>0&&this.all(n,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=n.composedPath(),this.freeEvent(n)}mapPointerOver(e){if(!(e instanceof ur)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId),r=this.createPointerEvent(e),i=r.pointerType==="mouse"||r.pointerType==="pen";this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),r.pointerType==="mouse"&&(this.cursor=r.target?.cursor);const s=this.clonePointerEvent(r,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;n.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof ur)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId);if(n.overTargets){const r=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(n.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),r&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;n.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof ur)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),r.pointerType==="touch")this.dispatchEvent(r,"touchend");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const a=r.button===2;this.dispatchEvent(r,a?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!r.composedPath().includes(s)){let a=s;for(;a&&!r.composedPath().includes(a);){if(r.currentTarget=a,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch")this.notifyTarget(r,"touchendoutside");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const c=r.button===2;this.notifyTarget(r,c?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(r,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:n});const c=i.clicksByButton[e.button];if(c.target===a.target&&n-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=a.target,c.timeStamp=n,a.detail=c.clickCount,a.pointerType==="mouse"){const h=a.button===2;this.dispatchEvent(a,h?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(r)}mapPointerUpOutside(e){if(!(e instanceof ur)){de("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId),r=this.findMountedTarget(n.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(r){let s=r;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete n.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof $o)){de("EventBoundary cannot map a non-wheel event as a wheel event");return}const n=this.createWheelEvent(e);this.dispatchEvent(n),this.freeEvent(n)}findMountedTarget(e){if(!e)return null;let n=e[0];for(let r=1;r<e.length&&e[r].parent===n;r++)n=e[r];return n}createPointerEvent(e,n,r){const i=this.allocateEvent(ur);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof n=="string"&&(i.type=n),i}createWheelEvent(e){const n=this.allocateEvent($o);return this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=this.hitTest(n.global.x,n.global.y),n}clonePointerEvent(e,n){const r=this.allocateEvent(ur);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=n??r.type,r}copyWheelData(e,n){n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ}copyPointerData(e,n){e instanceof ur&&n instanceof ur&&(n.pointerId=e.pointerId,n.width=e.width,n.height=e.height,n.isPrimary=e.isPrimary,n.pointerType=e.pointerType,n.pressure=e.pressure,n.tangentialPressure=e.tangentialPressure,n.tiltX=e.tiltX,n.tiltY=e.tiltY,n.twist=e.twist)}copyMouseData(e,n){e instanceof jc&&n instanceof jc&&(n.altKey=e.altKey,n.button=e.button,n.buttons=e.buttons,n.client.copyFrom(e.client),n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.movement.copyFrom(e.movement),n.screen.copyFrom(e.screen),n.shiftKey=e.shiftKey,n.global.copyFrom(e.global))}copyData(e,n){n.isTrusted=e.isTrusted,n.srcElement=e.srcElement,n.timeStamp=performance.now(),n.type=e.type,n.detail=e.detail,n.view=e.view,n.which=e.which,n.layer.copyFrom(e.layer),n.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const n=this.eventPool.get(e).pop()||new e(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=null,n.target=null,n}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const n=e.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(e)}_notifyListeners(e,n){const r=e.currentTarget._events[n];if(r)if("fn"in r)r.once&&e.currentTarget.removeListener(n,r.fn,void 0,!0),r.fn.call(r.context,e);else for(let i=0,s=r.length;i<s&&!e.propagationImmediatelyStopped;i++)r[i].once&&e.currentTarget.removeListener(n,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,e)}}const Vz=1,jz={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},b1=class d2{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new gM(null),Hi.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new ur(null),this._rootWheelEvent=new $o(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...d2.defaultEventFeatures},{set:(n,r,i)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),n[r]=i,!0)}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{canvas:n,resolution:r}=this.renderer;this.setTargetElement(n),this.resolution=r,d2._defaultEventMode=e.eventMode??"passive",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null,this._currentCursor=null}setCursor(e){e=e||"default";let n=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(n=!1),this._currentCursor===e)return;this._currentCursor=e;const r=this.cursorStyles[e];if(r)switch(typeof r){case"string":n&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":n&&Object.assign(this.domElement.style,r);break}else n&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this._rootPointerEvent}_onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const n=this._normalizeToPointerData(e);this.autoPreventDefault&&n[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,i=n.length;r<i;r++){const s=n[r],o=this._bootstrapEvent(this._rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}_onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Hi.pointerMoved();const n=this._normalizeToPointerData(e);for(let r=0,i=n.length;r<i;r++){const s=this._bootstrapEvent(this._rootPointerEvent,n[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}_onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let n=e.target;e.composedPath&&e.composedPath().length>0&&(n=e.composedPath()[0]);const r=n!==this.domElement?"outside":"",i=this._normalizeToPointerData(e);for(let s=0,o=i.length;s<o;s++){const a=this._bootstrapEvent(this._rootPointerEvent,i[s]);a.type+=r,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}_onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const n=this._normalizeToPointerData(e);for(let r=0,i=n.length;r<i;r++){const s=this._bootstrapEvent(this._rootPointerEvent,n[r]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const n=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(n)}setTargetElement(e){this._removeEvents(),this.domElement=e,Hi.domElement=e,this._addEvents()}_addEvents(){if(this._eventsAdded||!this.domElement)return;Hi.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this._onPointerMove,!0),this.domElement.addEventListener("pointerdown",this._onPointerDown,!0),this.domElement.addEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this._onPointerOverOut,!0),globalThis.addEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this._onPointerMove,!0),this.domElement.addEventListener("mousedown",this._onPointerDown,!0),this.domElement.addEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this._onPointerOverOut,!0),globalThis.addEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._onPointerDown,!0),this.domElement.addEventListener("touchend",this._onPointerUp,!0),this.domElement.addEventListener("touchmove",this._onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}_removeEvents(){if(!this._eventsAdded||!this.domElement)return;Hi.removeTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this._onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this._onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this._onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this._onPointerMove,!0),this.domElement.removeEventListener("mousedown",this._onPointerDown,!0),this.domElement.removeEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this._onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._onPointerDown,!0),this.domElement.removeEventListener("touchend",this._onPointerUp,!0),this.domElement.removeEventListener("touchmove",this._onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}mapPositionToPoint(e,n,r){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(n-i.left)*(this.domElement.width/i.width)*s,e.y=(r-i.top)*(this.domElement.height/i.height)*s}_normalizeToPointerData(e){const n=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){const s=e.changedTouches[r];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,n.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=Vz),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,n.push(r)}else n.push(e);return n}normalizeWheelEvent(e){const n=this._rootWheelEvent;return this._transferMouseData(n,e),n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ,n.deltaMode=e.deltaMode,this.mapPositionToPoint(n.screen,e.clientX,e.clientY),n.global.copyFrom(n.screen),n.offset.copyFrom(n.screen),n.nativeEvent=e,n.type=e.type,n}_bootstrapEvent(e,n){return e.originalEvent=null,e.nativeEvent=n,e.pointerId=n.pointerId,e.width=n.width,e.height=n.height,e.isPrimary=n.isPrimary,e.pointerType=n.pointerType,e.pressure=n.pressure,e.tangentialPressure=n.tangentialPressure,e.tiltX=n.tiltX,e.tiltY=n.tiltY,e.twist=n.twist,this._transferMouseData(e,n),this.mapPositionToPoint(e.screen,n.clientX,n.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=n.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=jz[e.type]||e.type),e}_transferMouseData(e,n){e.isTrusted=n.isTrusted,e.srcElement=n.srcElement,e.timeStamp=performance.now(),e.type=n.type,e.altKey=n.altKey,e.button=n.button,e.buttons=n.buttons,e.client.x=n.clientX,e.client.y=n.clientY,e.ctrlKey=n.ctrlKey,e.metaKey=n.metaKey,e.movement.x=n.movementX,e.movement.y=n.movementY,e.page.x=n.pageX,e.page.y=n.pageY,e.relatedTarget=null,e.shiftKey=n.shiftKey}};b1.extension={name:"events",type:[P.WebGLSystem,P.CanvasSystem,P.WebGPUSystem],priority:-1};b1.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let vM=b1;const Wz={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return this.eventMode==="dynamic"||this.eventMode==="static"},set interactive(t){this.eventMode=t?"static":"passive"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??vM.defaultEventMode},set eventMode(t){this._internalEventMode=t},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(t,e,n){const r=typeof n=="boolean"&&n||typeof n=="object"&&n.capture,i=typeof n=="object"?n.signal:void 0,s=typeof n=="object"?n.once===!0:!1,o=typeof e=="function"?void 0:e;t=r?`${t}capture`:t;const a=typeof e=="function"?e:e.handleEvent,c=this;i&&i.addEventListener("abort",()=>{c.off(t,a,o)}),s?c.once(t,a,o):c.on(t,a,o)},removeEventListener(t,e,n){const r=typeof n=="boolean"&&n||typeof n=="object"&&n.capture,i=typeof e=="function"?void 0:e;t=r?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof Nu))throw new Error("Container cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};var Mm=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,_M=`
in vec2 vTextureCoord;

out vec4 finalColor;

uniform float uAlpha;
uniform sampler2D uTexture;

void main()
{
    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;
}
`,p2=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct AlphaUniforms {
  uAlpha:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
 
    var sample = textureSample(uTexture, uSampler, uv);
    
    return sample * alphaUniforms.uAlpha;
}`;const xM=class yM extends le{constructor(e){e={...yM.defaultOptions,...e};const n=he.from({vertex:{source:p2,entryPoint:"mainVertex"},fragment:{source:p2,entryPoint:"mainFragment"}}),r=me.from({vertex:Mm,fragment:_M,name:"alpha-filter"}),{alpha:i,...s}=e,o=new Tt({uAlpha:{value:i,type:"f32"}});super({...s,gpuProgram:n,glProgram:r,resources:{alphaUniforms:o}})}get alpha(){return this.resources.alphaUniforms.uniforms.uAlpha}set alpha(e){this.resources.alphaUniforms.uniforms.uAlpha=e}};xM.defaultOptions={alpha:1};let bM=xM,$z=0;class SM{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1}createTexture(e,n,r){const i=new dt({...this.textureOptions,width:e,height:n,resolution:1,antialias:r,autoGarbageCollect:!0});return new X({source:i,label:`texturePool_${$z++}`})}getOptimalTexture(e,n,r=1,i){let s=Math.ceil(e*r-1e-6),o=Math.ceil(n*r-1e-6);s=Vo(s),o=Vo(o);const a=(s<<17)+(o<<1)+(i?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let c=this._texturePool[a].pop();return c||(c=this.createTexture(s,o,i)),c.source._resolution=r,c.source.width=s/r,c.source.height=o/r,c.source.pixelWidth=s,c.source.pixelHeight=o,c.frame.x=0,c.frame.y=0,c.frame.width=e,c.frame.height=n,c.updateUvs(),this._poolKeyHash[c.uid]=a,c}getSameSizeTexture(e,n=!1){const r=e.source;return this.getOptimalTexture(e.width,e.height,r._resolution,n)}returnTexture(e){const n=this._poolKeyHash[e.uid];this._texturePool[n].push(e)}clear(e){if(e=e!==!1,e)for(const n in this._texturePool){const r=this._texturePool[n];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this._texturePool={}}}const Ge=new SM,S1={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Xz=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join(`
`);function wM(t){const e=S1[t],n=e.length;let r=Xz,i="";const s="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<t;a++){let c=s.replace("%index%",a.toString());o=a,a>=n&&(o=t-a-1),c=c.replace("%value%",e[o].toString()),i+=c,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",t.toString()),r}const Yz=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function CM(t,e){const n=Math.ceil(t/2);let r=Yz,i="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(n-1)}.0`),i+=a,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",t.toString()),r=r.replace("%dimension%",e?"z":"w"),r}function TM(t,e){const n=CM(e,t),r=wM(e);return me.from({vertex:n,fragment:r,name:`blur-${t?"horizontal":"vertical"}-pass-filter`})}var EM=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function AM(t,e){const n=S1[e],r=n.length,i=[],s=[],o=[];for(let p=0;p<e;p++){i[p]=`@location(${p}) offset${p}: vec2<f32>,`,t?s[p]=`filteredCord + vec2(${p-r+1} * pixelStrength, 0.0),`:s[p]=`filteredCord + vec2(0.0, ${p-r+1} * pixelStrength),`;const v=p<r?p:e-p-1,_=n[v].toString();o[p]=`finalColor += textureSample(uTexture, uSampler, offset${p}) * ${_};`}const a=i.join(`
`),c=s.join(`
`),h=o.join(`
`),f=EM.replace("%blur-struct%",a).replace("%blur-vertex-out%",c).replace("%blur-fragment-in%",a).replace("%blur-sampling%",h).replace("%dimension%",t?"z":"w");return he.from({vertex:{source:f,entryPoint:"mainVertex"},fragment:{source:f,entryPoint:"mainFragment"}})}const PM=class RM extends le{constructor(e){e={...RM.defaultOptions,...e};const n=TM(e.horizontal,e.kernelSize),r=AM(e.horizontal,e.kernelSize);super({glProgram:n,gpuProgram:r,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...e}),this.horizontal=e.horizontal,this._quality=0,this.quality=e.quality,this.blur=e.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(e,n,r,i){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)e.applyFilter(this,n,r,i);else{const s=Ge.getSameSizeTexture(n);let o=n,a=s;this._state.blend=!1;const c=e.renderer.type===Fn.WEBGPU;for(let h=0;h<this.passes-1;h++){e.applyFilter(this,o,a,h===0?!0:c);const f=a;a=o,o=f}this._state.blend=!0,e.applyFilter(this,o,r,i),Ge.returnTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}};PM.defaultOptions={strength:8,quality:4,kernelSize:5};let gu=PM;class w1 extends le{constructor(...e){let n=e[0]??{};typeof n=="number"&&(q(ge,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),n={strength:n},e[1]!==void 0&&(n.quality=e[1]),e[2]!==void 0&&(n.resolution=e[2]||"inherit"),e[3]!==void 0&&(n.kernelSize=e[3])),n={...gu.defaultOptions,...n};const{strength:r,strengthX:i,strengthY:s,quality:o,...a}=n;super({...a,compatibleRenderers:Fn.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new gu({horizontal:!0,...n}),this.blurYFilter=new gu({horizontal:!1,...n}),this.quality=o,this.strengthX=i??r,this.strengthY=s??r,this.repeatEdgePixels=!1}apply(e,n,r,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=Ge.getSameSizeTexture(n);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(e,n,a,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,a,r,i),Ge.returnTexture(a)}else o?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,n,r,i)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(e,n,r,i))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get strengthX(){return this.blurXFilter.blur}set strengthX(e){this.blurXFilter.blur=e,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(e){this.blurYFilter.blur=e,this.updatePadding()}get blur(){return q("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(e){q("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=e}get blurX(){return q("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(e){q("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=e}get blurY(){return q("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(e){q("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}w1.defaultOptions={strength:8,quality:4,kernelSize:5};var BM=`
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uColorMatrix[20];
uniform float uAlpha;

uniform sampler2D uTexture;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * 0.2);
    float diff = (randomValue - 0.5) *  0.5;

    if (uAlpha == 0.0) {
        finalColor = color;
        return;
    }

    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    vec4 result;

    result.r = (uColorMatrix[0] * color.r);
        result.r += (uColorMatrix[1] * color.g);
        result.r += (uColorMatrix[2] * color.b);
        result.r += (uColorMatrix[3] * color.a);
        result.r += uColorMatrix[4];

    result.g = (uColorMatrix[5] * color.r);
        result.g += (uColorMatrix[6] * color.g);
        result.g += (uColorMatrix[7] * color.b);
        result.g += (uColorMatrix[8] * color.a);
        result.g += uColorMatrix[9];

    result.b = (uColorMatrix[10] * color.r);
       result.b += (uColorMatrix[11] * color.g);
       result.b += (uColorMatrix[12] * color.b);
       result.b += (uColorMatrix[13] * color.a);
       result.b += uColorMatrix[14];

    result.a = (uColorMatrix[15] * color.r);
       result.a += (uColorMatrix[16] * color.g);
       result.a += (uColorMatrix[17] * color.b);
       result.a += (uColorMatrix[18] * color.a);
       result.a += uColorMatrix[19];

    vec3 rgb = mix(color.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    finalColor = vec4(rgb, result.a);
}
`,m2=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct ColorMatrixUniforms {
  uColorMatrix:array<vec4<f32>, 5>,
  uAlpha:f32,
};


@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;
@group(1) @binding(0) var<uniform> colorMatrixUniforms : ColorMatrixUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
  };
  
fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
  );
}


@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
) -> @location(0) vec4<f32> {


  var c = textureSample(uTexture, uSampler, uv);
  
  if (colorMatrixUniforms.uAlpha == 0.0) {
    return c;
  }

 
    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.r /= c.a;
      c.g /= c.a;
      c.b /= c.a;
    }

    var cm = colorMatrixUniforms.uColorMatrix;


    var result = vec4<f32>(0.);

    result.r = (cm[0][0] * c.r);
    result.r += (cm[0][1] * c.g);
    result.r += (cm[0][2] * c.b);
    result.r += (cm[0][3] * c.a);
    result.r += cm[1][0];

    result.g = (cm[1][1] * c.r);
    result.g += (cm[1][2] * c.g);
    result.g += (cm[1][3] * c.b);
    result.g += (cm[2][0] * c.a);
    result.g += cm[2][1];

    result.b = (cm[2][2] * c.r);
    result.b += (cm[2][3] * c.g);
    result.b += (cm[3][0] * c.b);
    result.b += (cm[3][1] * c.a);
    result.b += cm[3][2];

    result.a = (cm[3][3] * c.r);
    result.a += (cm[4][0] * c.g);
    result.a += (cm[4][1] * c.b);
    result.a += (cm[4][2] * c.a);
    result.a += cm[4][3];

    var rgb = mix(c.rgb, result.rgb, colorMatrixUniforms.uAlpha);

    rgb.r *= result.a;
    rgb.g *= result.a;
    rgb.b *= result.a;

    return vec4(rgb, result.a);
}`;class MM extends le{constructor(e={}){const n=new Tt({uColorMatrix:{value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],type:"f32",size:20},uAlpha:{value:1,type:"f32"}}),r=he.from({vertex:{source:m2,entryPoint:"mainVertex"},fragment:{source:m2,entryPoint:"mainFragment"}}),i=me.from({vertex:Mm,fragment:BM,name:"color-matrix-filter"});super({...e,gpuProgram:r,glProgram:i,resources:{colorMatrixUniforms:n}}),this.alpha=1}_loadMatrix(e,n=!1){let r=e;n&&(this._multiply(r,this.matrix,e),r=this._colorMatrix(r)),this.resources.colorMatrixUniforms.uniforms.uColorMatrix=r,this.resources.colorMatrixUniforms.update()}_multiply(e,n,r){return e[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],e[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],e[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],e[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],e[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],e[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],e[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],e[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],e[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],e[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],e[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],e[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],e[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],e[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],e[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],e[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],e[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],e[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],e[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],e[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],e}_colorMatrix(e){const n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n}brightness(e,n){const r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)}tint(e,n){const[r,i,s]=ve.shared.setValue(e).toArray(),o=[r,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,n)}greyscale(e,n){const r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)}grayscale(e,n){this.greyscale(e,n)}blackAndWhite(e){const n=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(n,e)}hue(e,n){e=(e||0)/180*Math.PI;const r=Math.cos(e),i=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),c=r+(1-r)*o,h=o*(1-r)-a*i,f=o*(1-r)+a*i,p=o*(1-r)+a*i,v=r+o*(1-r),_=o*(1-r)-a*i,y=o*(1-r)-a*i,S=o*(1-r)+a*i,C=r+o*(1-r),b=[c,h,f,0,0,p,v,_,0,0,y,S,C,0,0,0,0,0,1,0];this._loadMatrix(b,n)}contrast(e,n){const r=(e||0)+1,i=-.5*(r-1),s=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(s,n)}saturate(e=0,n){const r=e*2/3+1,i=(r-1)*-.5,s=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(s,n)}desaturate(){this.saturate(-1)}negative(e){const n=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(n,e)}sepia(e){const n=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(n,e)}technicolor(e){const n=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(n,e)}polaroid(e){const n=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(n,e)}toBGR(e){const n=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(n,e)}kodachrome(e){const n=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(n,e)}browni(e){const n=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(n,e)}vintage(e){const n=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(n,e)}colorTone(e,n,r,i,s){e=e||.2,n=n||.15,r=r||16770432,i=i||3375104;const o=ve.shared,[a,c,h]=o.setValue(r).toArray(),[f,p,v]=o.setValue(i).toArray(),_=[.3,.59,.11,0,0,a,c,h,e,0,f,p,v,n,0,a-f,c-p,h-v,0,0];this._loadMatrix(_,s)}night(e,n){e=e||.1;const r=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(r,n)}predator(e,n){const r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,n)}lsd(e){const n=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(n,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.resources.colorMatrixUniforms.uniforms.uColorMatrix}set matrix(e){this.resources.colorMatrixUniforms.uniforms.uColorMatrix=e}get alpha(){return this.resources.colorMatrixUniforms.uniforms.uAlpha}set alpha(e){this.resources.colorMatrixUniforms.uniforms.uAlpha=e}}var DM=`
in vec2 vTextureCoord;
in vec2 vFilterUv;

out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;

uniform vec4 uInputClamp;
uniform highp vec4 uInputSize;
uniform mat2 uRotation;
uniform vec2 uScale;

void main()
{
    vec4 map = texture(uMapTexture, vFilterUv);
    
    vec2 offset = uInputSize.zw * (uRotation * (map.xy - 0.5)) * uScale; 

    finalColor = texture(uTexture, clamp(vTextureCoord + offset, uInputClamp.xy, uInputClamp.zw));
}
`,OM=`in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 vFilterUv;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

uniform mat3 uFilterMatrix;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( void )
{
  return ( uFilterMatrix * vec3( filterTextureCoord(), 1.0)  ).xy;
}


void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
    vFilterUv = getFilterCoord();
}
`,g2=`
struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct DisplacementUniforms {
  uFilterMatrix:mat3x3<f32>,
  uScale:vec2<f32>,
  uRotation:mat2x2<f32>
};



@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : DisplacementUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler : sampler;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{

  
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var map = textureSample(uMapTexture, uMapSampler, filterUv);

    var offset =  gfu.uInputSize.zw * (filterUniforms.uRotation * (map.xy - 0.5)) * filterUniforms.uScale; 
   
    return textureSample(uTexture, uSampler, clamp(uv + offset, gfu.uInputClamp.xy, gfu.uInputClamp.zw));
}`;class qz extends le{constructor(...e){let n=e[0];n instanceof br&&(e[1]&&q(ge,"DisplacementFilter now uses options object instead of params. {sprite, scale}"),n={sprite:n,scale:e[1]});const{sprite:r,scale:i,...s}=n;let o=i??20;typeof o=="number"&&(o=new ze(o,o));const a=new Tt({uFilterMatrix:{value:new ae,type:"mat3x3<f32>"},uScale:{value:o,type:"vec2<f32>"},uRotation:{value:new Float32Array([0,0,0,0]),type:"mat2x2<f32>"}}),c=me.from({vertex:OM,fragment:DM,name:"displacement-filter"}),h=he.from({vertex:{source:g2,entryPoint:"mainVertex"},fragment:{source:g2,entryPoint:"mainFragment"}}),f=r.texture.source;super({...s,gpuProgram:h,glProgram:c,resources:{filterUniforms:a,uMapTexture:f,uMapSampler:f.style}}),this._sprite=n.sprite,this._sprite.renderable=!1}apply(e,n,r,i){const s=this.resources.filterUniforms.uniforms;e.calculateSpriteMatrix(s.uFilterMatrix,this._sprite);const o=this._sprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),c=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&c!==0&&(s.uRotation[0]=o.a/a,s.uRotation[1]=o.b/a,s.uRotation[2]=o.c/c,s.uRotation[3]=o.d/c),this.resources.uMapTexture=this._sprite.texture.source,e.applyFilter(this,n,r,i)}get scale(){return this.resources.filterUniforms.uniforms.uScale}}var kM=`
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uTexture;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) *  uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    finalColor = color;
}
`,v2=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct NoiseUniforms {
  uNoise:f32,
  uSeed:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> noiseUniforms : NoiseUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

fn rand(co:vec2<f32>) -> f32
{
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}



@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var pixelPosition =  globalTextureCoord(position.xy);// / (getSize());//-  gfu.uOutputFrame.xy);
  
    
    var sample = textureSample(uTexture, uSampler, uv);
    var randomValue =  rand(pixelPosition.xy * noiseUniforms.uSeed);
    var diff = (randomValue - 0.5) * noiseUniforms.uNoise;
  
    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (sample.a > 0.0) {
      sample.r /= sample.a;
      sample.g /= sample.a;
      sample.b /= sample.a;
    }

    sample.r += diff;
    sample.g += diff;
    sample.b += diff;

    // Premultiply alpha again.
    sample.r *= sample.a;
    sample.g *= sample.a;
    sample.b *= sample.a;
    
    return sample;
}`;const FM=class IM extends le{constructor(e={}){e={...IM.defaultOptions,...e};const n=he.from({vertex:{source:v2,entryPoint:"mainVertex"},fragment:{source:v2,entryPoint:"mainFragment"}}),r=me.from({vertex:Mm,fragment:kM,name:"noise-filter"}),{noise:i,seed:s,...o}=e;super({...o,gpuProgram:n,glProgram:r,resources:{noiseUniforms:new Tt({uNoise:{value:1,type:"f32"},uSeed:{value:1,type:"f32"}})}}),this.noise=i,this.seed=s??Math.random()}get noise(){return this.resources.noiseUniforms.uniforms.uNoise}set noise(e){this.resources.noiseUniforms.uniforms.uNoise=e}get seed(){return this.resources.noiseUniforms.uniforms.uSeed}set seed(e){this.resources.noiseUniforms.uniforms.uSeed=e}};FM.defaultOptions={noise:.5};let Kz=FM;class UM{constructor(e){this._renderer=e}push(e,n,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:n,filterEffect:e})}pop(e,n,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}execute(e){e.action==="pushFilter"?this._renderer.filter.push(e):e.action==="popFilter"&&this._renderer.filter.pop()}destroy(){this._renderer=null}}UM.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"filter"};const Qz=new ae;function LM(t,e){return e.clear(),C1(t,e),e.isValid||e.set(0,0,0,0),t.renderGroup?e.applyMatrix(t.renderGroup.localTransform):e.applyMatrix(t.parentRenderGroup.worldTransform),e}function C1(t,e){if(t.localDisplayStatus!==7||!t.measurable)return;const n=!!t.effects.length;let r=e;if((t.renderGroup||n)&&(r=pi.get().clear()),t.boundsArea)e.addRect(t.boundsArea,t.worldTransform);else{if(t.renderPipeId){const s=t.bounds;r.addFrame(s.minX,s.minY,s.maxX,s.maxY,t.groupTransform)}const i=t.children;for(let s=0;s<i.length;s++)C1(i[s],r)}if(n){let i=!1;for(let s=0;s<t.effects.length;s++)t.effects[s].addBounds&&(i||(i=!0,r.applyMatrix(t.parentRenderGroup.worldTransform)),t.effects[s].addBounds(r,!0));i&&(r.applyMatrix(t.parentRenderGroup.worldTransform.copyTo(Qz).invert()),e.addBounds(r,t.relativeGroupTransform)),e.addBounds(r),pi.return(r)}else t.renderGroup&&(e.addBounds(r,t.relativeGroupTransform),pi.return(r))}function NM(t,e){e.clear();const n=e.matrix;for(let r=0;r<t.length;r++){const i=t[r];i.globalDisplayStatus<7||(e.matrix=i.worldTransform,i.addBounds(e))}return e.matrix=n,e}const Zz=new Gu({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),format:"float32x2",stride:2*4,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])});class GM{constructor(e){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new Tt({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new mi({}),this.renderer=e}get activeBackTexture(){return this._activeFilterData?.backTexture}push(e){const n=this.renderer,r=e.filterEffect.filters;this._filterStack[this._filterStackIndex]||(this._filterStack[this._filterStackIndex]=this._getFilterData());const i=this._filterStack[this._filterStackIndex];if(this._filterStackIndex++,r.length===0){i.skip=!0;return}const s=i.bounds;e.renderables?NM(e.renderables,s):e.filterEffect.filterArea?(s.clear(),s.addRect(e.filterEffect.filterArea),s.applyMatrix(e.container.worldTransform)):LM(e.container,s);const o=n.renderTarget.renderTarget.colorTexture.source;let a=1/0,c=0,h=!0,f=!1,p=!1;for(let _=0;_<r.length;_++){const y=r[_];if(a=Math.min(a,y.resolution==="inherit"?o._resolution:y.resolution),c+=y.padding,y.antialias==="off"?h=!1:y.antialias==="inherit"&&h&&(h=o.antialias),!!!(y.compatibleRenderers&n.type)){p=!1;break}if(y.blendRequired&&!(n.backBuffer?.useBackBuffer??!0)){de("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),p=!1;break}p=y.enabled||p,f=f||y.blendRequired}if(!p){i.skip=!0;return}const v=n.renderTarget.rootViewPort;if(s.scale(a).fitBounds(0,v.width,0,v.height).ceil().scale(1/a).pad(c|0),!s.isPositive){i.skip=!0;return}i.skip=!1,i.bounds=s,i.blendRequired=f,i.container=e.container,i.filterEffect=e.filterEffect,i.previousRenderSurface=n.renderTarget.renderSurface,i.inputTexture=Ge.getOptimalTexture(s.width,s.height,a,h),n.renderTarget.bind(i.inputTexture,!0),n.globalUniforms.push({offset:s})}pop(){const e=this.renderer;this._filterStackIndex--;const n=this._filterStack[this._filterStackIndex];if(n.skip)return;this._activeFilterData=n;const r=n.inputTexture,i=n.bounds;let s=X.EMPTY;if(e.renderTarget.finishRenderPass(),n.blendRequired){const a=this._filterStackIndex>0?this._filterStack[this._filterStackIndex-1].bounds:null,c=e.renderTarget.getRenderTarget(n.previousRenderSurface);s=this.getBackTexture(c,i,a)}n.backTexture=s;const o=n.filterEffect.filters;if(this._globalFilterBindGroup.setResource(r.source.style,2),this._globalFilterBindGroup.setResource(s.source,3),e.globalUniforms.pop(),o.length===1)o[0].apply(this,r,n.previousRenderSurface,!1),Ge.returnTexture(r);else{let a=n.inputTexture,c=Ge.getOptimalTexture(i.width,i.height,a.source._resolution,!1),h=0;for(h=0;h<o.length-1;++h){o[h].apply(this,a,c,!0);const p=a;a=c,c=p}o[h].apply(this,a,n.previousRenderSurface,!1),Ge.returnTexture(a),Ge.returnTexture(c)}n.blendRequired&&Ge.returnTexture(s)}getBackTexture(e,n,r){const i=e.colorTexture.source._resolution,s=Ge.getOptimalTexture(n.width,n.height,i,!1);let o=n.minX,a=n.minY;r&&(o-=r.minX,a-=r.minY),o=Math.floor(o*i),a=Math.floor(a*i);const c=Math.ceil(n.width*i),h=Math.ceil(n.height*i);return this.renderer.renderTarget.copyToTexture(e,s,{x:o,y:a},{width:c,height:h},{x:0,y:0}),s}applyFilter(e,n,r,i){const s=this.renderer,o=this._filterStack[this._filterStackIndex],a=o.bounds,c=ze.shared,f=o.previousRenderSurface===r;let p=this.renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution,v=this._filterStackIndex-1;for(;v>0&&this._filterStack[v].skip;)--v;v>0&&(p=this._filterStack[v].inputTexture.source._resolution);const _=this._filterGlobalUniforms,y=_.uniforms,S=y.uOutputFrame,C=y.uInputSize,b=y.uInputPixel,w=y.uInputClamp,T=y.uGlobalFrame,A=y.uOutputTexture;if(f){let I=this._filterStackIndex;for(;I>0;){I--;const N=this._filterStack[this._filterStackIndex-1];if(!N.skip){c.x=N.bounds.minX,c.y=N.bounds.minY;break}}S[0]=a.minX-c.x,S[1]=a.minY-c.y}else S[0]=0,S[1]=0;S[2]=n.frame.width,S[3]=n.frame.height,C[0]=n.source.width,C[1]=n.source.height,C[2]=1/C[0],C[3]=1/C[1],b[0]=n.source.pixelWidth,b[1]=n.source.pixelHeight,b[2]=1/b[0],b[3]=1/b[1],w[0]=.5*b[2],w[1]=.5*b[3],w[2]=n.frame.width*C[2]-.5*b[2],w[3]=n.frame.height*C[3]-.5*b[3];const M=this.renderer.renderTarget.rootRenderTarget.colorTexture;T[0]=c.x*p,T[1]=c.y*p,T[2]=M.source.width*p,T[3]=M.source.height*p;const L=this.renderer.renderTarget.getRenderTarget(r);if(s.renderTarget.bind(r,!!i),r instanceof X?(A[0]=r.frame.width,A[1]=r.frame.height):(A[0]=L.width,A[1]=L.height),A[2]=L.isRoot?-1:1,_.update(),s.renderPipes.uniformBatch){const I=s.renderPipes.uniformBatch.getUboResource(_);this._globalFilterBindGroup.setResource(I,0)}else this._globalFilterBindGroup.setResource(_,0);this._globalFilterBindGroup.setResource(n.source,1),this._globalFilterBindGroup.setResource(n.source.style,2),e.groups[0]=this._globalFilterBindGroup,s.encoder.draw({geometry:Zz,shader:e,state:e._state,topology:"triangle-list"}),s.type===Fn.WEBGL&&s.renderTarget.finishRenderPass()}_getFilterData(){return{skip:!1,inputTexture:null,bounds:new Kt,container:null,filterEffect:null,blendRequired:!1,previousRenderSurface:null}}calculateSpriteMatrix(e,n){const r=this._activeFilterData,i=e.set(r.inputTexture._source.width,0,0,r.inputTexture._source.height,r.bounds.minX,r.bounds.minY),s=n.worldTransform.copyTo(ae.shared);return s.invert(),i.prepend(s),i.scale(1/n.texture.frame.width,1/n.texture.frame.height),i.translate(n.anchor.x,n.anchor.y),i}}GM.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"filter"};var zM=`in vec2 vMaskCoord;
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform sampler2D uMaskTexture;

uniform float uAlpha;
uniform vec4 uMaskClamp;

out vec4 finalColor;

void main(void)
{
    float clip = step(3.5,
        step(uMaskClamp.x, vMaskCoord.x) +
        step(uMaskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, uMaskClamp.z) +
        step(vMaskCoord.y, uMaskClamp.w));

    // TODO look into why this is needed
    float npmAlpha = uAlpha; 
    vec4 original = texture(uTexture, vTextureCoord);
    vec4 masky = texture(uMaskTexture, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * uAlpha * clip);

    finalColor = original;
}
`,HM=`in vec2 aPosition;

out vec2 vTextureCoord;
out vec2 vMaskCoord;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;
uniform mat3 uFilterMatrix;

vec4 filterVertexPosition(  vec2 aPosition )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
       
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord(  vec2 aPosition )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( vec2 aPosition )
{
    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}   

void main(void)
{
    gl_Position = filterVertexPosition(aPosition);
    vTextureCoord = filterTextureCoord(aPosition);
    vMaskCoord = getFilterCoord(aPosition);
}
`,_2=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,  
};

struct MaskUniforms {
  uFilterMatrix:mat3x3<f32>,
  uMaskClamp:vec4<f32>,
  uAlpha:f32,
};


@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;
@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{

  
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var maskClamp = filterUniforms.uMaskClamp;

     var clip = step(3.5,
        step(maskClamp.x, filterUv.x) +
        step(maskClamp.y, filterUv.y) +
        step(filterUv.x, maskClamp.z) +
        step(filterUv.y, maskClamp.w));

    var mask = textureSample(uMaskTexture, uSampler, filterUv);
    var source = textureSample(uTexture, uSampler, uv);
    
    var npmAlpha = 0.0;

    var alphaMul = 1.0 - npmAlpha * (1.0 - mask.a);

    var a = (alphaMul * mask.r) * clip;

    return vec4(source.rgb, source.a) * a;
}`;class VM extends le{constructor(e){const{sprite:n,...r}=e,i=new ey(n.texture),s=new Tt({uFilterMatrix:{value:new ae,type:"mat3x3<f32>"},uMaskClamp:{value:i.uClampFrame,type:"vec4<f32>"},uAlpha:{value:1,type:"f32"}}),o=he.from({vertex:{source:_2,entryPoint:"mainVertex"},fragment:{source:_2,entryPoint:"mainFragment"}}),a=me.from({vertex:HM,fragment:zM,name:"mask-filter"});super({...r,gpuProgram:o,glProgram:a,resources:{filterUniforms:s,uMaskTexture:n.texture.source}}),this.sprite=n,this._textureMatrix=i}apply(e,n,r,i){this._textureMatrix.texture=this.sprite.texture,e.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix,this.sprite).prepend(this._textureMatrix.mapCoord),this.resources.uMaskTexture=this.sprite.texture.source,e.applyFilter(this,n,r,i)}}var Jz=`fn getLuminosity(c: vec3<f32>) -> f32 {
  return 0.3 * c.r + 0.59 * c.g + 0.11 * c.b;
}

fn setLuminosity(c: vec3<f32>, lum: f32) -> vec3<f32> {
  let d: f32 = lum - getLuminosity(c);
  let newColor: vec3<f32> = c.rgb + vec3<f32>(d, d, d);

  // clip back into legal range
  let newLum: f32 = getLuminosity(newColor);
  let cMin: f32 = min(newColor.r, min(newColor.g, newColor.b));
  let cMax: f32 = max(newColor.r, max(newColor.g, newColor.b));

  let t1: f32 = newLum / (newLum - cMin);
  let t2: f32 = (1.0 - newLum) / (cMax - newLum);

  let finalColor = mix(vec3<f32>(newLum, newLum, newLum), newColor, select(select(1.0, t2, cMax > 1.0), t1, cMin < 0.0));

  return finalColor;
}

fn getSaturation(c: vec3<f32>) -> f32 {
  return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
}

// Set saturation if color components are sorted in ascending order.
fn setSaturationMinMidMax(cSorted: vec3<f32>, s: f32) -> vec3<f32> {
  var result: vec3<f32>;
  if (cSorted.z > cSorted.x) {
    let newY = (((cSorted.y - cSorted.x) * s) / (cSorted.z - cSorted.x));
    result = vec3<f32>(0.0, newY, s);
  } else {
    result = vec3<f32>(0.0, 0.0, 0.0);
  }
  return vec3<f32>(result.x, result.y, result.z);
}

fn setSaturation(c: vec3<f32>, s: f32) -> vec3<f32> {
    var result: vec3<f32> = c;

    if (c.r <= c.g && c.r <= c.b) {
        if (c.g <= c.b) {
            result = setSaturationMinMidMax(result, s);
        } else {
            var temp: vec3<f32> = vec3<f32>(result.r, result.b, result.g);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.r, temp.b, temp.g);
        }
    } else if (c.g <= c.r && c.g <= c.b) {
        if (c.r <= c.b) {
            var temp: vec3<f32> = vec3<f32>(result.g, result.r, result.b);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.g, temp.r, temp.b);
        } else {
            var temp: vec3<f32> = vec3<f32>(result.g, result.b, result.r);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.g, temp.b, temp.r);
        }
    } else {
        if (c.r <= c.g) {
            var temp: vec3<f32> = vec3<f32>(result.b, result.r, result.g);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.b, temp.r, temp.g);
        } else {
            var temp: vec3<f32> = vec3<f32>(result.b, result.g, result.r);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.b, temp.g, temp.r);
        }
    }

    return result;
}`;function x2(t,e,n,r,i,s,o,a){const c=o-n,h=a-r,f=i-n,p=s-r,v=t-n,_=e-r,y=c*c+h*h,S=c*f+h*p,C=c*v+h*_,b=f*f+p*p,w=f*v+p*_,T=1/(y*b-S*S),A=(b*C-S*w)*T,M=(y*w-S*C)*T;return A>=0&&M>=0&&A+M<1}class T1{constructor(e=0,n=0,r=0,i=0,s=0,o=0){this.type="triangle",this.x=e,this.y=n,this.x2=r,this.y2=i,this.x3=s,this.y3=o}contains(e,n){const r=(this.x-this.x3)*(n-this.y3)-(this.y-this.y3)*(e-this.x3),i=(this.x2-this.x)*(n-this.y)-(this.y2-this.y)*(e-this.x);if(r<0!=i<0&&r!==0&&i!==0)return!1;const s=(this.x3-this.x2)*(n-this.y2)-(this.y3-this.y2)*(e-this.x2);return s===0||s<0==r+i<=0}strokeContains(e,n,r){const i=r/2,s=i*i,{x:o,x2:a,x3:c,y:h,y2:f,y3:p}=this;return nc(e,n,o,h,a,p)<=s||nc(e,n,a,f,c,p)<=s||nc(e,n,c,p,o,h)<=s}clone(){return new T1(this.x,this.y,this.x2,this.y2,this.x3,this.y3)}copyFrom(e){return this.x=e.x,this.y=e.y,this.x2=e.x2,this.y2=e.y2,this.x3=e.x3,this.y3=e.y3,this}copyTo(e){return e.copyFrom(this),e}getBounds(e){e=e||new Ke;const n=Math.min(this.x,this.x2,this.x3),r=Math.max(this.x,this.x2,this.x3),i=Math.min(this.y,this.y2,this.y3),s=Math.max(this.y,this.y2,this.y3);return e.x=n,e.y=i,e.width=r-n,e.height=s-i,e}}const jM=class WM{constructor(e){this._tick=()=>{this.timeout=setTimeout(this._processQueue,0)},this._processQueue=()=>{const{queue:n}=this;let r=0;for(;n.length&&r<WM.uploadsPerFrame;){const i=n.shift();this.uploadQueueItem(i),r++}n.length?at.system.addOnce(this._tick,this,rs.UTILITY):this._resolve()},this.renderer=e,this.queue=[],this.resolves=[]}getQueue(){return[...this.queue]}add(e){const n=Array.isArray(e)?e:[e];for(const r of n)r instanceof $e?this._addContainer(r):this.resolveQueueItem(r,this.queue);return this}_addContainer(e){this.resolveQueueItem(e,this.queue);for(const n of e.children)this._addContainer(n)}upload(e){return e&&this.add(e),new Promise(n=>{this.queue.length?(this.resolves.push(n),this.dedupeQueue(),at.system.addOnce(this._tick,this,rs.UTILITY)):n()})}dedupeQueue(){const e=Object.create(null);let n=0;for(let r=0;r<this.queue.length;r++){const i=this.queue[r];e[i.uid]||(e[i.uid]=!0,this.queue[n++]=i)}this.queue.length=n}_resolve(){const{resolves:e}=this,n=e.slice(0);e.length=0;for(const r of n)r()}};jM.uploadsPerFrame=4;let $M=jM;class $s extends ea{constructor(e){e instanceof mn&&(e={context:e});const{context:n,roundPixels:r,...i}=e||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",n?this._context=n:this._context=this._ownedContext=new mn,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=r??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(e){e.addBounds(this._context.bounds)}containsPoint(e){return this._context.containsPoint(e)}onViewUpdate(){if(this._didViewChangeTick++,this._didGraphicsUpdate=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||e?.context===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,n){return this.context[e](...n),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new $s(this._context.clone()):(this._ownedContext=null,new $s(this._context))}lineStyle(e,n,r){q(ge,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return e&&(i.width=e),n&&(i.color=n),r&&(i.alpha=r),this.context.strokeStyle=i,this}beginFill(e,n){q(ge,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return e&&(r.color=e),n&&(r.alpha=n),this.context.fillStyle=r,this}endFill(){q(ge,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==mn.defaultStrokeStyle.width||e.color!==mn.defaultStrokeStyle.color||e.alpha!==mn.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return q(ge,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return q(ge,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return q(ge,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return q(ge,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return q(ge,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return q(ge,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}const XM=class YM extends Gu{constructor(...e){let n=e[0]??{};n instanceof Float32Array&&(q(ge,"use new MeshGeometry({ positions, uvs, indices }) instead"),n={positions:n,uvs:e[1],indices:e[2]}),n={...YM.defaultOptions,...n};const r=n.positions||new Float32Array([0,0,1,0,1,1,0,1]),i=n.uvs||new Float32Array([0,0,1,0,1,1,0,1]),s=n.indices||new Uint32Array([0,1,2,0,2,3]),o=n.shrinkBuffersToFit,a=new Yn({data:r,label:"attribute-mesh-positions",shrinkToFit:o,usage:Re.VERTEX|Re.COPY_DST}),c=new Yn({data:i,label:"attribute-mesh-uvs",shrinkToFit:o,usage:Re.VERTEX|Re.COPY_DST}),h=new Yn({data:s,label:"index-mesh-buffer",shrinkToFit:o,usage:Re.INDEX|Re.COPY_DST});super({attributes:{aPosition:{buffer:a,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:c,format:"float32x2",stride:2*4,offset:0}},indexBuffer:h,topology:n.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(e){this.attributes.aPosition.buffer.data=e}get uvs(){return this.attributes.aUV.buffer.data}set uvs(e){this.attributes.aUV.buffer.data=e}get indices(){return this.indexBuffer.data}set indices(e){this.indexBuffer.data=e}};XM.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let no=XM;class Wu extends ea{constructor(...e){let n=e[0];n instanceof Gu&&(q(ge,"Mesh: use new Mesh({ geometry, shader }) instead"),n={geometry:n,shader:e[1]},e[3]&&(q(ge,"Mesh: drawMode argument has been removed, use geometry.topology instead"),n.geometry.topology=e[3]));const{geometry:r,shader:i,texture:s,roundPixels:o,state:a,...c}=n;super({label:"Mesh",...c}),this.renderPipeId="mesh",this._shader=null,this.allowChildren=!1,this.shader=i??null,this.texture=s??i?.texture??X.WHITE,this.state=a??jr.for2d(),this._geometry=r,this._geometry.on("update",this.onViewUpdate,this),this.roundPixels=o??!1}get material(){return q(ge,"mesh.material property has been removed, use mesh.shader instead"),this._shader}set shader(e){this._shader!==e&&(this._shader=e,this.onViewUpdate())}get shader(){return this._shader}set geometry(e){this._geometry!==e&&(this._geometry?.off("update",this.onViewUpdate,this),e.on("update",this.onViewUpdate,this),this._geometry=e,this.onViewUpdate())}get geometry(){return this._geometry}set texture(e){e||(e=X.EMPTY);const n=this._texture;n!==e&&(n&&n.dynamic&&n.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this.shader&&(this.shader.texture=e),this._texture=e,this.onViewUpdate())}get texture(){return this._texture}get batched(){return this._shader||this.state.data&12?!1:this._geometry instanceof no?this._geometry.batchMode==="auto"?this._geometry.positions.length/2<=100:this._geometry.batchMode==="batch":!1}get bounds(){return this._geometry.bounds}addBounds(e){e.addBounds(this.geometry.bounds)}containsPoint(e){const{x:n,y:r}=e;if(!this.bounds.containsPoint(n,r))return!1;const i=this.geometry.getBuffer("aPosition").data,s=this.geometry.topology==="triangle-strip"?3:1;if(this.geometry.getIndex()){const o=this.geometry.getIndex().data,a=o.length;for(let c=0;c+2<a;c+=s){const h=o[c]*2,f=o[c+1]*2,p=o[c+2]*2;if(x2(n,r,i[h],i[h+1],i[f],i[f+1],i[p],i[p+1]))return!0}}else{const o=i.length/2;for(let a=0;a+2<o;a+=s){const c=a*2,h=(a+1)*2,f=(a+2)*2;if(x2(n,r,i[c],i[c+1],i[h],i[h+1],i[f],i[f+1]))return!0}}return!1}onViewUpdate(){if(this._didViewChangeTick++,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(r)}this._geometry?.off("update",this.onViewUpdate,this),this._texture=null,this._geometry=null,this._shader=null}}class Wc extends br{constructor(...e){let n=e[0];Array.isArray(e[0])&&(n={textures:e[0],autoUpdate:e[1]});const{textures:r,autoUpdate:i,...s}=n,[o]=r;super({...s,texture:o instanceof X?o:o.texture}),this._textures=null,this._durations=null,this._autoUpdate=i??!0,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=r}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(at.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(at.shared.add(this.update,this,rs.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const n=e.deltaTime,r=this.animationSpeed*n,i=this.currentFrame;if(this._durations!==null){let s=this._currentTime%1*this._durations[this.currentFrame];for(s+=r/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];const o=Math.sign(this.animationSpeed*n);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this._updateTexture())}_updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this.texture=this._textures[e],this.updateAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const n=[];for(let r=0;r<e.length;++r)n.push(X.from(e[r]));return new Wc(n)}static fromImages(e){const n=[];for(let r=0;r<e.length;++r)n.push(X.from(e[r]));return new Wc(n)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof X)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let n=0;n<e.length;n++)this._textures.push(e[n].texture),this._durations.push(e[n].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(at.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(at.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class qM{constructor({matrix:e,observer:n}={}){this.dirty=!0,this._matrix=e??new ae,this.observer=n,this.position=new xt(this,0,0),this.scale=new xt(this,1,1),this.pivot=new xt(this,0,0),this.skew=new xt(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const e=this._matrix;return this.dirty&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this.dirty=!1),e}_onUpdate(e){this.dirty=!0,e===this.skew&&this.updateSkew(),this.observer?._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(e){e.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this.skew))}}const KM=class Rd extends ea{constructor(...e){let n=e[0]||{};n instanceof X&&(n={texture:n}),e.length>1&&(q(ge,"use new TilingSprite({ texture, width:100, height:100 }) instead"),n.width=e[1],n.height=e[2]),n={...Rd.defaultOptions,...n};const{texture:r,anchor:i,tilePosition:s,tileScale:o,tileRotation:a,width:c,height:h,applyAnchorToTexture:f,roundPixels:p,...v}=n??{};super({label:"TilingSprite",...v}),this.renderPipeId="tilingSprite",this.batched=!0,this.allowChildren=!1,this._anchor=new xt({_onUpdate:()=>{this.onViewUpdate()}}),this._applyAnchorToTexture=f,this.texture=r,this._width=c??r.width,this._height=h??r.height,this._tileTransform=new qM({observer:{_onUpdate:()=>this.onViewUpdate()}}),i&&(this.anchor=i),this.tilePosition=s,this.tileScale=o,this.tileRotation=a,this.roundPixels=p??!1}static from(e,n={}){return typeof e=="string"?new Rd({texture:We.get(e),...n}):new Rd({texture:e,...n})}get clampMargin(){return this._texture.textureMatrix.clampMargin}set clampMargin(e){this._texture.textureMatrix.clampMargin=e}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get tilePosition(){return this._tileTransform.position}set tilePosition(e){this._tileTransform.position.copyFrom(e)}get tileScale(){return this._tileTransform.scale}set tileScale(e){typeof e=="number"?this._tileTransform.scale.set(e):this._tileTransform.scale.copyFrom(e)}set tileRotation(e){this._tileTransform.rotation=e}get tileRotation(){return this._tileTransform.rotation}get tileTransform(){return this._tileTransform}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}set texture(e){e||(e=X.EMPTY);const n=this._texture;n!==e&&(n&&n.dynamic&&n.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}get texture(){return this._texture}set width(e){this._width=e,this.onViewUpdate()}get width(){return this._width}set height(e){this._height=e,this.onViewUpdate()}get height(){return this._height}setSize(e,n){typeof e=="object"&&(n=e.height??e.width,e=e.width),this._width=e,this._height=n??e,this.onViewUpdate()}getSize(e){return e||(e={}),e.width=this._width,e.height=this._height,e}_updateBounds(){const e=this._bounds,n=this._anchor,r=this._width,i=this._height;e.maxX=-n._x*r,e.minX=e.maxX+r,e.maxY=-n._y*i,e.minY=e.maxY+i}addBounds(e){const n=this.bounds;e.addFrame(n.minX,n.minY,n.maxX,n.maxY)}containsPoint(e){const n=this._width,r=this._height,i=-n*this._anchor._x;let s=0;return e.x>=i&&e.x<=i+n&&(s=-r*this._anchor._y,e.y>=s&&e.y<=s+r)}onViewUpdate(){if(this._boundsDirty=!0,this._didTilingSpriteUpdate=!0,this._didViewChangeTick++,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e=!1){if(super.destroy(e),this._anchor=null,this._tileTransform=null,this._bounds=null,typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(r)}this._texture=null}};KM.defaultOptions={texture:X.EMPTY,anchor:{x:0,y:0},tilePosition:{x:0,y:0},tileScale:{x:1,y:1},tileRotation:0,applyAnchorToTexture:!1};let QM=KM;class Dm extends ea{constructor(e,n){const{text:r,resolution:i,style:s,anchor:o,width:a,height:c,roundPixels:h,...f}=e;super({...f}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=n,this.text=r??"",this.style=s,this.resolution=i??null,this.allowChildren=!1,this._anchor=new xt({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=h??!1,a!==void 0&&(this.width=a),c!==void 0&&(this.height=c)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e=e||{},this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,n){typeof e=="object"?(n=e.height??e.width,e=e.width):n??(n=e),e!==void 0&&this._setWidth(e,this.bounds.width),n!==void 0&&this._setHeight(n,this.bounds.height)}addBounds(e){const n=this.bounds;e.addFrame(n.minX,n.minY,n.maxX,n.maxY)}containsPoint(e){const n=this.bounds.width,r=this.bounds.height,i=-n*this.anchor.x;let s=0;return e.x>=i&&e.x<=i+n&&(s=-r*this.anchor.y,e.y>=s&&e.y<=s+r)}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0,this._didTextUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}}function Om(t,e){let n=t[0]??{};return(typeof n=="string"||t[1])&&(q(ge,`use new ${e}({ text: "hi!", style }) instead`),n={text:n,style:t[1]}),n}class km extends Dm{constructor(...e){const n=Om(e,"Text");super(n,Qt),this.renderPipeId="text"}_updateBounds(){const e=this._bounds,n=this._anchor,r=Fr.measureText(this._text,this._style),{width:i,height:s}=r;e.minX=-n._x*i,e.maxX=e.minX+i,e.minY=-n._y*s,e.maxY=e.minY+s}}class ZM extends $M{resolveQueueItem(e,n){return e instanceof $e?this.resolveContainerQueueItem(e,n):e instanceof dt||e instanceof X?n.push(e.source):e instanceof mn&&n.push(e),null}resolveContainerQueueItem(e,n){e instanceof br||e instanceof QM||e instanceof Wu?n.push(e.texture.source):e instanceof km?n.push(e):e instanceof $s?n.push(e.context):e instanceof Wc&&e.textures.forEach(r=>{r.source?n.push(r.source):n.push(r.texture.source)})}resolveGraphicsContextQueueItem(e){this.renderer.graphicsContext.getContextRenderData(e);const{instructions:n}=e;for(const r of n)if(r.action==="texture"){const{image:i}=r.data;return i.source}else if(r.action==="fill"){const{texture:i}=r.data.style;return i.source}return null}}class JM extends Dm{constructor(...e){var n;const r=Om(e,"BitmapText");r.style??(r.style=r.style||{}),(n=r.style).fill??(n.fill=16777215),super(r,Qt),this.renderPipeId="bitmapText"}_updateBounds(){const e=this._bounds,n=this._anchor,r=Gc.measureText(this.text,this._style),i=r.scale,s=r.offsetY*i;let o=r.width*i,a=r.height*i;const c=this._style._stroke;c&&(o+=c.width,a+=c.width),e.minX=-n._x*o,e.maxX=e.minX+o,e.minY=-n._y*(a+s),e.maxY=e.minY+a}}function eD(t){const e=t._stroke,n=t._fill,i=[`div { ${[`color: ${ve.shared.setValue(n.color).toHex()}`,`font-size: ${t.fontSize}px`,`font-family: ${t.fontFamily}`,`font-weight: ${t.fontWeight}`,`font-style: ${t.fontStyle}`,`font-variant: ${t.fontVariant}`,`letter-spacing: ${t.letterSpacing}px`,`text-align: ${t.align}`,`padding: ${t.padding}px`,`white-space: ${t.whiteSpace==="pre"&&t.wordWrap?"pre-wrap":t.whiteSpace}`,...t.lineHeight?[`line-height: ${t.lineHeight}px`]:[],...t.wordWrap?[`word-wrap: ${t.breakWords?"break-all":"break-word"}`,`max-width: ${t.wordWrapWidth}px`]:[],...e?[nD(e)]:[],...t.dropShadow?[tD(t.dropShadow)]:[],...t.cssOverrides].join(";")} }`];return e9(t.tagStyles,i),i.join(" ")}function tD(t){const e=ve.shared.setValue(t.color).setAlpha(t.alpha).toHexa(),n=Math.round(Math.cos(t.angle)*t.distance),r=Math.round(Math.sin(t.angle)*t.distance),i=`${n}px ${r}px`;return t.blur>0?`text-shadow: ${i} ${t.blur}px ${e}`:`text-shadow: ${i} ${e}`}function nD(t){return[`-webkit-text-stroke-width: ${t.width}px`,`-webkit-text-stroke-color: ${ve.shared.setValue(t.color).toHex()}`,`text-stroke-width: ${t.width}px`,`text-stroke-color: ${ve.shared.setValue(t.color).toHex()}`,"paint-order: stroke"].join(";")}const wT={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},CT={fill:t=>`color: ${ve.shared.setValue(t).toHex()}`,breakWords:t=>`word-wrap: ${t?"break-all":"break-word"}`,stroke:nD,dropShadow:tD};function e9(t,e){for(const n in t){const r=t[n],i=[];for(const s in r)CT[s]?i.push(CT[s](r[s])):wT[s]&&i.push(wT[s].replace("{{VALUE}}",r[s]));e.push(`${n} { ${i.join(";")} }`)}}class Xo extends Qt{constructor(e={}){super(e),this._cssOverrides=[],this.cssOverrides??(this.cssOverrides=e.cssOverrides),this.tagStyles=e.tagStyles??{}}set cssOverrides(e){this._cssOverrides=e instanceof Array?e:[e],this.update()}get cssOverrides(){return this._cssOverrides}_generateKey(){return this._styleKey=e1(this)+this._cssOverrides.join("-"),this._styleKey}update(){this._cssStyle=null,super.update()}clone(){return new Xo({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow?{...this.dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides})}get cssStyle(){return this._cssStyle||(this._cssStyle=eD(this)),this._cssStyle}addOverride(...e){const n=e.filter(r=>!this.cssOverrides.includes(r));n.length>0&&(this.cssOverrides.push(...n),this.update())}removeOverride(...e){const n=e.filter(r=>this.cssOverrides.includes(r));n.length>0&&(this.cssOverrides=this.cssOverrides.filter(r=>!n.includes(r)),this.update())}set fill(e){typeof e!="string"&&typeof e!="number"&&de("[HTMLTextStyle] only color fill is not supported by HTMLText"),super.fill=e}set stroke(e){e&&typeof e!="string"&&typeof e!="number"&&de("[HTMLTextStyle] only color stroke is not supported by HTMLText"),super.stroke=e}}const y2="http://www.w3.org/2000/svg",b2="http://www.w3.org/1999/xhtml";class E1{constructor(){this.svgRoot=document.createElementNS(y2,"svg"),this.foreignObject=document.createElementNS(y2,"foreignObject"),this.domElement=document.createElementNS(b2,"div"),this.styleElement=document.createElementNS(b2,"style"),this.image=new Image;const{foreignObject:e,svgRoot:n,styleElement:r,domElement:i}=this;e.setAttribute("width","10000"),e.setAttribute("height","10000"),e.style.overflow="hidden",n.appendChild(e),e.appendChild(r),e.appendChild(i)}}let TT;function A1(t,e,n,r){r=r||TT||(TT=new E1);const{domElement:i,styleElement:s,svgRoot:o}=r;i.innerHTML=`<style>${e.cssStyle};</style><div style='padding:0'>${t}</div>`,i.setAttribute("style","transform-origin: top left; display: inline-block"),n&&(s.textContent=n),document.body.appendChild(o);const a=i.getBoundingClientRect();o.remove();const c=Fr.measureFont(e.fontStyle).descent,h=e.padding*2;return{width:a.width-h,height:a.height+c-h}}class rD extends Dm{constructor(...e){const n=Om(e,"HtmlText");super(n,Xo),this.renderPipeId="htmlText"}_updateBounds(){const e=this._bounds,n=this._anchor,r=A1(this.text,this._style),{width:i,height:s}=r;e.minX=-n._x*i,e.maxX=e.minX+i,e.minY=-n._y*s,e.maxY=e.minY+s}}class iD extends ZM{uploadQueueItem(e){e instanceof dt?this.uploadTextureSource(e):e instanceof km?this.uploadText(e):e instanceof rD?this.uploadHTMLText(e):e instanceof JM?this.uploadBitmapText(e):e instanceof mn&&this.uploadGraphicsContext(e)}uploadTextureSource(e){this.renderer.texture.initSource(e)}uploadText(e){this.renderer.renderPipes.text.initGpuText(e)}uploadBitmapText(e){this.renderer.renderPipes.bitmapText.initGpuText(e)}uploadHTMLText(e){this.renderer.renderPipes.htmlText.initGpuText(e)}uploadGraphicsContext(e){this.renderer.graphicsContext.getContextRenderData(e);const{instructions:n}=e;for(const r of n)if(r.action==="texture"){const{image:i}=r.data;this.uploadTextureSource(i.source)}else if(r.action==="fill"){const{texture:i}=r.data.style;this.uploadTextureSource(i.source)}return null}}class sD extends iD{destroy(){clearTimeout(this.timeout),this.renderer=null,this.queue=null,this.resolves=null}}sD.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"prepare"};class P1{constructor(){this._didUpload=!1,this._tempState=jr.for2d()}init(e){e.renderer.runners.contextChange.add(this)}contextChange(){this._didUpload=!1}start(e,n,r){const i=e.renderer;i.shader.bind(r,this._didUpload),i.shader.updateUniformGroup(i.globalUniforms.uniformGroup),i.geometry.bind(n,r.glProgram)}execute(e,n){const r=e.renderer;this._didUpload=!0,this._tempState.blendMode=n.blendMode,r.state.set(this._tempState);const i=n.textures.textures;for(let s=0;s<n.textures.count;s++)r.texture.bind(i[s],s);r.geometry.draw("triangle-list",n.size,n.start)}}P1.extension={type:[P.WebGLPipesAdaptor],name:"batch"};function t9(t){const e=[];let n=0;for(let r=0;r<t;r++)e[n]={texture:{sampleType:"float",viewDimension:"2d",multisampled:!1},binding:n,visibility:GPUShaderStage.FRAGMENT},n++,e[n]={sampler:{type:"filtering"},binding:n,visibility:GPUShaderStage.FRAGMENT},n++;return e}function n9(t){const e={};let n=0;for(let r=0;r<t;r++)e[`textureSource${r+1}`]=n++,e[`textureSampler${r+1}`]=n++;return e}const nd=jr.for2d();class R1{start(e,n,r){const i=e.renderer,s=i.encoder,o=r.gpuProgram;this._shader=r,this._geometry=n,s.setGeometry(n,o),nd.blendMode="normal",i.pipeline.getPipeline(n,o,nd);const a=i.globalUniforms.bindGroup;s.resetBindGroup(1),s.setBindGroup(0,a,o)}execute(e,n){const r=this._shader.gpuProgram,i=e.renderer,s=i.encoder;if(!n.bindGroup){const c=n.textures;n.bindGroup=vm(c.textures,c.count)}nd.blendMode=n.blendMode;const o=i.bindGroup.getBindGroup(n.bindGroup,r,1),a=i.pipeline.getPipeline(this._geometry,r,nd);n.bindGroup._touch(i.textureGC.count),s.setPipeline(a),s.renderPassEncoder.setBindGroup(1,o),s.renderPassEncoder.drawIndexed(n.size,1,n.start)}}R1.extension={type:[P.WebGPUPipesAdaptor],name:"batch"};const B1=class oD{constructor(e,n){this.state=jr.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=e,this._adaptor=n,this._adaptor.init?.(this)}static getBatcher(e){return new this._availableBatchers[e]}buildStart(e){let n=this._batchersByInstructionSet[e.uid];n||(n=this._batchersByInstructionSet[e.uid]=Object.create(null),n.default||(n.default=new wm)),this._activeBatches=n,this._activeBatch=this._activeBatches.default;for(const r in this._activeBatches)this._activeBatches[r].begin()}addToBatch(e,n){if(this._activeBatch.name!==e.batcherName){this._activeBatch.break(n);let r=this._activeBatches[e.batcherName];r||(r=this._activeBatches[e.batcherName]=oD.getBatcher(e.batcherName),r.begin()),this._activeBatch=r}this._activeBatch.add(e)}break(e){this._activeBatch.break(e)}buildEnd(e){this._activeBatch.break(e);const n=this._activeBatches;for(const r in n){const i=n[r],s=i.geometry;s.indexBuffer.setDataWithSize(i.indexBuffer,i.indexSize,!0),s.buffers[0].setDataWithSize(i.attributeBuffer.float32View,i.attributeSize,!1)}}upload(e){const n=this._batchersByInstructionSet[e.uid];for(const r in n){const i=n[r],s=i.geometry;i.dirty&&(i.dirty=!1,s.buffers[0].update(i.attributeSize*4))}}execute(e){if(e.action==="startBatch"){const n=e.batcher,r=n.geometry,i=n.shader;this._adaptor.start(this,r,i)}this._adaptor.execute(this,e)}destroy(){this.state=null,this.renderer=null,this._adaptor=null;for(const e in this._activeBatches)this._activeBatches[e].destroy();this._activeBatches=null}};B1.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"batch"};B1._availableBatchers=Object.create(null);let M1=B1;Ne.handleByMap(P.Batcher,M1._availableBatchers);Ne.add(wm);function r9(t){const e=t.split(/([\n{}])/g).map(i=>i.trim()).filter(i=>i.length);let n="";return e.map(i=>{let s=n+i;return i==="{"?n+="    ":i==="}"&&(n=n.substr(0,n.length-4),s=n+i),s}).join(`
`)}const vu={name:"local-uniform-bit",vertex:{header:`

            struct LocalUniforms {
                uTransformMatrix:mat3x3<f32>,
                uColor:vec4<f32>,
                uRound:f32,
            }

            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `}},aD={...vu,vertex:{...vu.vertex,header:vu.vertex.header.replace("group(1)","group(2)")}},Fm={name:"local-uniform-bit",vertex:{header:`

            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix = uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `}},uD={name:"texture-bit",vertex:{header:`

        struct TextureUniforms {
            uTextureMatrix:mat3x3<f32>,
        }

        @group(2) @binding(2) var<uniform> textureUniforms : TextureUniforms;
        `,main:`
            uv = (textureUniforms.uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
            @group(2) @binding(0) var uTexture: texture_2d<f32>;
            @group(2) @binding(1) var uSampler: sampler;

         
        `,main:`
            outColor = textureSample(uTexture, uSampler, vUV);
        `}},lD={name:"texture-bit",vertex:{header:`
            uniform mat3 uTextureMatrix;
        `,main:`
            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
        uniform sampler2D uTexture;

         
        `,main:`
            outColor = texture(uTexture, vUV);
        `}};function cD(t,e){const n=t.root,r=t.instructionSet;r.reset();const i=e.renderPipes?e:e.batch.renderer,s=i.renderPipes;s.batch.buildStart(r),s.blendMode.buildStart(),s.colorMask.buildStart(),n.sortableChildren&&n.sortChildren(),hD(n,r,i,!0),s.batch.buildEnd(r),s.blendMode.buildEnd(r)}function vh(t,e,n){const r=n.renderPipes?n:n.batch.renderer;t.globalDisplayStatus<7||!t.includeInBuild||(t.sortableChildren&&t.sortChildren(),t.isSimple?i9(t,e,r):hD(t,e,r,!1))}function i9(t,e,n){if(t.renderPipeId){const{renderPipes:r,renderableGC:i}=n;r.blendMode.setBlendMode(t,t.groupBlendMode,e),t.didViewUpdate=!1,r[t.renderPipeId].addRenderable(t,e),i.addRenderable(t,e)}if(!t.renderGroup){const r=t.children,i=r.length;for(let s=0;s<i;s++)vh(r[s],e,n)}}function hD(t,e,n,r){const{renderPipes:i,renderableGC:s}=n;if(!r&&t.renderGroup)i.renderGroup.addRenderGroup(t.renderGroup,e);else{for(let c=0;c<t.effects.length;c++){const h=t.effects[c];i[h.pipe].push(h,t,e)}const o=t.renderPipeId;o&&(i.blendMode.setBlendMode(t,t.groupBlendMode,e),t.didViewUpdate=!1,i[o].addRenderable(t,e),s.addRenderable(t,e));const a=t.children;if(a.length)for(let c=0;c<a.length;c++)vh(a[c],e,n);for(let c=t.effects.length-1;c>=0;c--){const h=t.effects[c];i[h.pipe].pop(h,t,e)}}}const s9=new Kt;class o9 extends Pc{constructor(){super(),this.filters=[new VM({sprite:new br(X.EMPTY),resolution:"inherit",antialias:"inherit"})]}get sprite(){return this.filters[0].sprite}set sprite(e){this.filters[0].sprite=e}}class D1{constructor(e){this._activeMaskStage=[],this._renderer=e}push(e,n,r){const i=this._renderer;if(i.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskBegin",mask:e,canBundle:!1,maskedContainer:n}),e.renderMaskToTexture){const s=e.mask;s.includeInBuild=!0,vh(s,r,i),s.includeInBuild=!1}i.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskEnd",mask:e,maskedContainer:n,canBundle:!1})}pop(e,n,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"popMaskEnd",mask:e,canBundle:!1})}execute(e){const n=this._renderer,r=e.mask.renderMaskToTexture;if(e.action==="pushMaskBegin"){const i=Ae.get(o9);if(r){e.mask.mask.measurable=!0;const s=sh(e.mask.mask,!0,s9);e.mask.mask.measurable=!1,s.ceil();const o=n.renderTarget.renderTarget.colorTexture.source,a=Ge.getOptimalTexture(s.width,s.height,o._resolution,o.antialias);n.renderTarget.push(a,!0),n.globalUniforms.push({offset:s,worldColor:4294967295});const c=i.sprite;c.texture=a,c.worldTransform.tx=s.minX,c.worldTransform.ty=s.minY,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer,filterTexture:a})}else i.sprite=e.mask.mask,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer})}else if(e.action==="pushMaskEnd"){const i=this._activeMaskStage[this._activeMaskStage.length-1];r&&(n.type===Fn.WEBGL&&n.renderTarget.finishRenderPass(),n.renderTarget.pop(),n.globalUniforms.pop()),n.filter.push({renderPipeId:"filter",action:"pushFilter",container:i.maskedContainer,filterEffect:i.filterEffect,canBundle:!1})}else if(e.action==="popMaskEnd"){n.filter.pop();const i=this._activeMaskStage.pop();r&&Ge.returnTexture(i.filterTexture),Ae.return(i.filterEffect)}}destroy(){this._renderer=null,this._activeMaskStage=null}}D1.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"alphaMask"};class O1{constructor(e){this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=e}buildStart(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}push(e,n,r){this._renderer.renderPipes.batch.break(r);const s=this._colorStack;s[this._colorStackIndex]=s[this._colorStackIndex-1]&e.mask;const o=this._colorStack[this._colorStackIndex];o!==this._currentColor&&(this._currentColor=o,r.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1})),this._colorStackIndex++}pop(e,n,r){this._renderer.renderPipes.batch.break(r);const s=this._colorStack;this._colorStackIndex--;const o=s[this._colorStackIndex-1];o!==this._currentColor&&(this._currentColor=o,r.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1}))}execute(e){this._renderer.colorMask.setMask(e.colorMask)}destroy(){this._colorStack=null}}O1.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"colorMask"};class a9{constructor(e){this.priority=0,this.pipe="scissorMask",this.mask=e,this.mask.renderable=!1,this.mask.measurable=!1}addBounds(e,n){am(this.mask,e,n)}addLocalBounds(e,n){um(this.mask,e,n)}containsPoint(e,n){const r=this.mask;return n(r,e)}reset(){this.mask.measurable=!0,this.mask=null}destroy(){this.reset()}}class k1{constructor(e){this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=e}push(e,n,r){var i;const s=e,o=this._renderer;o.renderPipes.batch.break(r),o.renderPipes.blendMode.setBlendMode(s.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"pushMaskBegin",mask:e,canBundle:!1});const a=s.mask;a.includeInBuild=!0,this._maskHash.has(s)||this._maskHash.set(s,{instructionsStart:0,instructionsLength:0});const c=this._maskHash.get(s);c.instructionsStart=r.instructionSize,vh(a,r,o),a.includeInBuild=!1,o.renderPipes.batch.break(r),r.add({renderPipeId:"stencilMask",action:"pushMaskEnd",mask:e,canBundle:!1});const h=r.instructionSize-c.instructionsStart-1;c.instructionsLength=h;const f=o.renderTarget.renderTarget.uid;(i=this._maskStackHash)[f]??(i[f]=0)}pop(e,n,r){const i=e,s=this._renderer;s.renderPipes.batch.break(r),s.renderPipes.blendMode.setBlendMode(i.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"popMaskBegin",canBundle:!1});const o=this._maskHash.get(e);for(let a=0;a<o.instructionsLength;a++)r.instructions[r.instructionSize++]=r.instructions[o.instructionsStart++];r.add({renderPipeId:"stencilMask",action:"popMaskEnd",canBundle:!1})}execute(e){var n;const r=this._renderer,i=r.renderTarget.renderTarget.uid;let s=(n=this._maskStackHash)[i]??(n[i]=0);e.action==="pushMaskBegin"?(r.renderTarget.ensureDepthStencil(),r.stencil.setStencilMode(Rt.RENDERING_MASK_ADD,s),s++,r.colorMask.setMask(0)):e.action==="pushMaskEnd"?(r.stencil.setStencilMode(Rt.MASK_ACTIVE,s),r.colorMask.setMask(15)):e.action==="popMaskBegin"?(r.colorMask.setMask(0),s!==0?r.stencil.setStencilMode(Rt.RENDERING_MASK_REMOVE,s):(r.renderTarget.clear(null,Bn.STENCIL),r.stencil.setStencilMode(Rt.DISABLED,s)),s--):e.action==="popMaskEnd"&&(r.stencil.setStencilMode(Rt.MASK_ACTIVE,s),r.colorMask.setMask(15)),this._maskStackHash[i]=s}destroy(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}}k1.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"stencilMask"};var ic=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(ic||{});class fD{constructor(e,n){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.type=n}}class F1{constructor(e){this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._renderer=e}destroy(){this._renderer=null,this._gl=null,this._gpuBuffers=null,this._boundBufferBases=null}contextChange(){this._gpuBuffers=Object.create(null),this._gl=this._renderer.gl}getGlBuffer(e){return this._gpuBuffers[e.uid]||this.createGLBuffer(e)}bind(e){const{_gl:n}=this,r=this.getGlBuffer(e);n.bindBuffer(r.type,r.buffer)}bindBufferBase(e,n){const{_gl:r}=this;if(this._boundBufferBases[n]!==e){const i=this.getGlBuffer(e);this._boundBufferBases[n]=e,r.bindBufferBase(r.UNIFORM_BUFFER,n,i.buffer)}}bindBufferRange(e,n,r){const{_gl:i}=this;r=r||0;const s=this.getGlBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,n||0,s.buffer,r*256,256)}updateBuffer(e){const{_gl:n}=this,r=this.getGlBuffer(e);if(e._updateID===r.updateID)return r;r.updateID=e._updateID,n.bindBuffer(r.type,r.buffer);const i=e.data;if(r.byteLength>=e.data.byteLength)n.bufferSubData(r.type,0,i,0,e._updateSize/i.BYTES_PER_ELEMENT);else{const s=e.descriptor.usage&Re.STATIC?n.STATIC_DRAW:n.DYNAMIC_DRAW;r.byteLength=i.byteLength,n.bufferData(r.type,i,s)}return r}destroyAll(){const e=this._gl;for(const n in this._gpuBuffers)e.deleteBuffer(this._gpuBuffers[n].buffer);this._gpuBuffers=Object.create(null)}onBufferDestroy(e,n){const r=this._gpuBuffers[e.uid],i=this._gl;n||i.deleteBuffer(r.buffer),this._gpuBuffers[e.uid]=null}createGLBuffer(e){const{_gl:n}=this;let r=ic.ARRAY_BUFFER;e.descriptor.usage&Re.INDEX?r=ic.ELEMENT_ARRAY_BUFFER:e.descriptor.usage&Re.UNIFORM&&(r=ic.UNIFORM_BUFFER);const i=new fD(n.createBuffer(),r);return this._gpuBuffers[e.uid]=i,e.on("destroy",this.onBufferDestroy,this),i}}F1.extension={type:[P.WebGLSystem],name:"buffer"};const I1=class dD{constructor(e){this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=e,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this._renderer.gl=e}init(e){e={...dD.defaultOptions,...e};let n=this.multiView=e.multiView;if(e.context&&n&&(de("Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together."),n=!1),n?this.canvas=Ce.get().createCanvas(this._renderer.canvas.width,this._renderer.canvas.height):this.canvas=this._renderer.view.canvas,e.context)this.initFromContext(e.context);else{const r=this._renderer.background.alpha<1,i=e.premultipliedAlpha??!0,s=e.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(e.preferWebGLVersion,{alpha:r,premultipliedAlpha:i,antialias:s,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference??"default"})}}ensureCanvasSize(e){if(!this.multiView){e!==this.canvas&&de("multiView is disabled, but targetCanvas is not the main canvas");return}const{canvas:n}=this;(n.width<e.width||n.height<e.height)&&(n.width=Math.max(e.width,e.width),n.height=Math.max(e.height,e.height))}initFromContext(e){this.gl=e,this.webGLVersion=e instanceof Ce.get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(e),this._renderer.runners.contextChange.emit(e);const n=this._renderer.view.canvas;n.addEventListener("webglcontextlost",this.handleContextLost,!1),n.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}createContext(e,n){let r;const i=this.canvas;if(e===2&&(r=i.getContext("webgl2",n)),!r&&(r=i.getContext("webgl",n),!r))throw new Error("This browser does not support WebGL. Try using the canvas renderer");this.gl=r,this.initFromContext(this.gl)}getExtensions(){const{gl:e}=this,n={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc"),rgtc:e.getExtension("EXT_texture_compression_rgtc"),loseContext:e.getExtension("WEBGL_lose_context")};if(this.webGLVersion===1)this.extensions={...n,drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear"),vertexAttribDivisorANGLE:e.getExtension("ANGLE_instanced_arrays"),srgb:e.getExtension("EXT_sRGB")};else{this.extensions={...n,colorBufferFloat:e.getExtension("EXT_color_buffer_float")};const r=e.getExtension("WEBGL_provoking_vertex");r&&r.provokingVertexWEBGL(r.FIRST_VERTEX_CONVENTION_WEBGL)}}handleContextLost(e){e.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext?.restoreContext()},0))}handleContextRestored(){this._renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this._renderer.view.canvas;this._renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext?.loseContext()}forceContextLoss(){this.extensions.loseContext?.loseContext(),this._contextLossForced=!0}validateContext(e){const n=e.getContextAttributes();n&&!n.stencil&&de("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=this.supports,i=this.webGLVersion===2,s=this.extensions;r.uint32Indices=i||!!s.uint32ElementIndex,r.uniformBufferObject=i,r.vertexArrayObject=i||!!s.vertexArrayObject,r.srgbTextures=i||!!s.srgb,r.nonPowOf2wrapping=i,r.nonPowOf2mipmaps=i,r.msaa=i,r.uint32Indices||de("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")}};I1.extension={type:[P.WebGLSystem],name:"context"};I1.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2,multiView:!1};let pD=I1;function U1(t,e){for(const n in t.attributes){const r=t.attributes[n],i=e[n];i?(r.format??(r.format=i.format),r.offset??(r.offset=i.offset),r.instance??(r.instance=i.instance)):de(`Attribute ${n} is not present in the shader, but is present in the geometry. Unable to infer attribute details.`)}u9(t)}function u9(t){const{buffers:e,attributes:n}=t,r={},i={};for(const s in e){const o=e[s];r[o.uid]=0,i[o.uid]=0}for(const s in n){const o=n[s];r[o.buffer.uid]+=Pu(o.format).stride}for(const s in n){const o=n[s];o.stride??(o.stride=r[o.buffer.uid]),o.start??(o.start=i[o.buffer.uid]),i[o.buffer.uid]+=Pu(o.format).stride}}var wp=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(wp||{}),L1=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(L1||{}),mD=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(mD||{}),Pe=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(Pe||{});const ET={uint8x2:Pe.UNSIGNED_BYTE,uint8x4:Pe.UNSIGNED_BYTE,sint8x2:Pe.BYTE,sint8x4:Pe.BYTE,unorm8x2:Pe.UNSIGNED_BYTE,unorm8x4:Pe.UNSIGNED_BYTE,snorm8x2:Pe.BYTE,snorm8x4:Pe.BYTE,uint16x2:Pe.UNSIGNED_SHORT,uint16x4:Pe.UNSIGNED_SHORT,sint16x2:Pe.SHORT,sint16x4:Pe.SHORT,unorm16x2:Pe.UNSIGNED_SHORT,unorm16x4:Pe.UNSIGNED_SHORT,snorm16x2:Pe.SHORT,snorm16x4:Pe.SHORT,float16x2:Pe.HALF_FLOAT,float16x4:Pe.HALF_FLOAT,float32:Pe.FLOAT,float32x2:Pe.FLOAT,float32x3:Pe.FLOAT,float32x4:Pe.FLOAT,uint32:Pe.UNSIGNED_INT,uint32x2:Pe.UNSIGNED_INT,uint32x3:Pe.UNSIGNED_INT,uint32x4:Pe.UNSIGNED_INT,sint32:Pe.INT,sint32x2:Pe.INT,sint32x3:Pe.INT,sint32x4:Pe.INT};function gD(t){return ET[t]??ET.float32}const l9={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5};class N1{constructor(e){this._geometryVaoHash=Object.create(null),this._renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0}contextChange(){const e=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");const n=this._renderer.context.extensions.vertexArrayObject;n&&(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i));const r=this._renderer.context.extensions.vertexAttribDivisorANGLE;r&&(e.drawArraysInstanced=(i,s,o,a)=>{r.drawArraysInstancedANGLE(i,s,o,a)},e.drawElementsInstanced=(i,s,o,a,c)=>{r.drawElementsInstancedANGLE(i,s,o,a,c)},e.vertexAttribDivisor=(i,s)=>r.vertexAttribDivisorANGLE(i,s)),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}bind(e,n){const r=this.gl;this._activeGeometry=e;const i=this.getVao(e,n);this._activeVao!==i&&(this._activeVao=i,r.bindVertexArray(i)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,n=this._renderer.buffer;for(let r=0;r<e.buffers.length;r++){const i=e.buffers[r];n.updateBuffer(i)}}checkCompatibility(e,n){const r=e.attributes,i=n._attributeData;for(const s in i)if(!r[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,n){const r=e.attributes,i=n._attributeData,s=["g",e.uid];for(const o in r)i[o]&&s.push(o,i[o].location);return s.join("-")}getVao(e,n){return this._geometryVaoHash[e.uid]?.[n._key]||this.initGeometryVao(e,n)}initGeometryVao(e,n,r=!0){const i=this._renderer.gl,s=this._renderer.buffer;this._renderer.shader._getProgramData(n),this.checkCompatibility(e,n);const o=this.getSignature(e,n);this._geometryVaoHash[e.uid]||(this._geometryVaoHash[e.uid]=Object.create(null),e.on("destroy",this.onGeometryDestroy,this));const a=this._geometryVaoHash[e.uid];let c=a[o];if(c)return a[n._key]=c,c;U1(e,n._attributeData);const h=e.buffers;c=i.createVertexArray(),i.bindVertexArray(c);for(let f=0;f<h.length;f++){const p=h[f];s.bind(p)}return this.activateVao(e,n),a[n._key]=c,a[o]=c,i.bindVertexArray(null),c}onGeometryDestroy(e,n){const r=this._geometryVaoHash[e.uid],i=this.gl;if(r){if(n)for(const s in r)this._activeVao!==r[s]&&this.unbind(),i.deleteVertexArray(r[s]);this._geometryVaoHash[e.uid]=null}}destroyAll(e=!1){const n=this.gl;for(const r in this._geometryVaoHash){if(e)for(const i in this._geometryVaoHash[r]){const s=this._geometryVaoHash[r];this._activeVao!==s&&this.unbind(),n.deleteVertexArray(s[i])}this._geometryVaoHash[r]=null}}activateVao(e,n){const r=this._renderer.gl,i=this._renderer.buffer,s=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);let o=null;for(const a in s){const c=s[a],h=c.buffer,f=i.getGlBuffer(h),p=n._attributeData[a];if(p){o!==f&&(i.bind(h),o=f);const v=p.location;r.enableVertexAttribArray(v);const _=Pu(c.format),y=gD(c.format);if(p.format?.substring(1,4)==="int"?r.vertexAttribIPointer(v,_.size,y,c.stride,c.offset):r.vertexAttribPointer(v,_.size,y,_.normalised,c.stride,c.offset),c.instance)if(this.hasInstance){const S=c.divisor??1;r.vertexAttribDivisor(v,S)}else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,n,r,i){const{gl:s}=this._renderer,o=this._activeGeometry,a=l9[o.topology||e];if(i||(i=o.instanceCount),o.indexBuffer){const c=o.indexBuffer.data.BYTES_PER_ELEMENT,h=c===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;i>1?s.drawElementsInstanced(a,n||o.indexBuffer.data.length,h,(r||0)*c,i):s.drawElements(a,n||o.indexBuffer.data.length,h,(r||0)*c)}else i>1?s.drawArraysInstanced(a,r||0,n||o.getSize(),i):s.drawArrays(a,r||0,n||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null}}N1.extension={type:[P.WebGLSystem],name:"geometry"};const c9=new Gu({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),G1=class vD{constructor(e){this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=e}init(e={}){const{useBackBuffer:n,antialias:r}={...vD.defaultOptions,...e};this.useBackBuffer=n,this._antialias=r,this._renderer.context.supports.msaa||(de("antialiasing, is not supported on when using the back buffer"),this._antialias=!1),this._state=jr.for2d();const i=new me({vertex:`
                attribute vec2 aPosition;
                out vec2 vUv;

                void main() {
                    gl_Position = vec4(aPosition, 0.0, 1.0);

                    vUv = (aPosition + 1.0) / 2.0;

                    // flip dem UVs
                    vUv.y = 1.0 - vUv.y;
                }`,fragment:`
                in vec2 vUv;
                out vec4 finalColor;

                uniform sampler2D uTexture;

                void main() {
                    finalColor = texture(uTexture, vUv);
                }`,name:"big-triangle"});this._bigTriangleShader=new Sr({glProgram:i,resources:{uTexture:X.WHITE.source}})}renderStart(e){const n=this._renderer.renderTarget.getRenderTarget(e.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!n.isRoot,this._useBackBufferThisRender){const r=this._renderer.renderTarget.getRenderTarget(e.target);this._targetTexture=r.colorTexture,e.target=this._getBackBufferTexture(r.colorTexture)}}renderEnd(){this._presentBackBuffer()}_presentBackBuffer(){const e=this._renderer;e.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(e.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,e.encoder.draw({geometry:c9,shader:this._bigTriangleShader,state:this._state}))}_getBackBufferTexture(e){return this._backBufferTexture=this._backBufferTexture||new X({source:new dt({width:e.width,height:e.height,resolution:e._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(e.width,e.height,e._resolution),this._backBufferTexture}destroy(){this._backBufferTexture&&(this._backBufferTexture.destroy(),this._backBufferTexture=null)}};G1.extension={type:[P.WebGLSystem],name:"backBuffer",priority:1};G1.defaultOptions={useBackBuffer:!1};let _D=G1;class z1{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.gl.colorMask(!!(e&8),!!(e&4),!!(e&2),!!(e&1)))}}z1.extension={type:[P.WebGLSystem],name:"colorMask"};class H1{constructor(e){this.commandFinished=Promise.resolve(),this._renderer=e}setGeometry(e,n){this._renderer.geometry.bind(e,n.glProgram)}finishRenderPass(){}draw(e){const n=this._renderer,{geometry:r,shader:i,state:s,skipSync:o,topology:a,size:c,start:h,instanceCount:f}=e;n.shader.bind(i,o),n.geometry.bind(r,n.shader._activeProgram),s&&n.state.set(s),n.geometry.draw(a,c,h,f??r.instanceCount)}destroy(){this._renderer=null}}H1.extension={type:[P.WebGLSystem],name:"encoder"};class xD{constructor(){this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}}const ro=[];ro[Rt.NONE]=void 0;ro[Rt.DISABLED]={stencilWriteMask:0,stencilReadMask:0};ro[Rt.RENDERING_MASK_ADD]={stencilFront:{compare:"equal",passOp:"increment-clamp"},stencilBack:{compare:"equal",passOp:"increment-clamp"}};ro[Rt.RENDERING_MASK_REMOVE]={stencilFront:{compare:"equal",passOp:"decrement-clamp"},stencilBack:{compare:"equal",passOp:"decrement-clamp"}};ro[Rt.MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"equal",passOp:"keep"},stencilBack:{compare:"equal",passOp:"keep"}};class V1{constructor(e){this._stencilCache={enabled:!1,stencilReference:0,stencilMode:Rt.NONE},this._renderTargetStencilState=Object.create(null),e.renderTarget.onRenderTargetChange.add(this)}contextChange(e){this._gl=e,this._comparisonFuncMapping={always:e.ALWAYS,never:e.NEVER,equal:e.EQUAL,"not-equal":e.NOTEQUAL,less:e.LESS,"less-equal":e.LEQUAL,greater:e.GREATER,"greater-equal":e.GEQUAL},this._stencilOpsMapping={keep:e.KEEP,zero:e.ZERO,replace:e.REPLACE,invert:e.INVERT,"increment-clamp":e.INCR,"decrement-clamp":e.DECR,"increment-wrap":e.INCR_WRAP,"decrement-wrap":e.DECR_WRAP},this._stencilCache.enabled=!1,this._stencilCache.stencilMode=Rt.NONE,this._stencilCache.stencilReference=0}onRenderTargetChange(e){if(this._activeRenderTarget===e)return;this._activeRenderTarget=e;let n=this._renderTargetStencilState[e.uid];n||(n=this._renderTargetStencilState[e.uid]={stencilMode:Rt.DISABLED,stencilReference:0}),this.setStencilMode(n.stencilMode,n.stencilReference)}setStencilMode(e,n){const r=this._renderTargetStencilState[this._activeRenderTarget.uid],i=this._gl,s=ro[e],o=this._stencilCache;if(r.stencilMode=e,r.stencilReference=n,e===Rt.DISABLED){this._stencilCache.enabled&&(this._stencilCache.enabled=!1,i.disable(i.STENCIL_TEST));return}this._stencilCache.enabled||(this._stencilCache.enabled=!0,i.enable(i.STENCIL_TEST)),(e!==o.stencilMode||o.stencilReference!==n)&&(o.stencilMode=e,o.stencilReference=n,i.stencilFunc(this._comparisonFuncMapping[s.stencilBack.compare],n,255),i.stencilOp(i.KEEP,i.KEEP,this._stencilOpsMapping[s.stencilBack.passOp]))}}V1.extension={type:[P.WebGLSystem],name:"stencil"};class j1{constructor(e){this._syncFunctionHash=Object.create(null),this._adaptor=e,this._systemCheck()}_systemCheck(){if(!Fy())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}ensureUniformGroup(e){const n=this.getUniformGroupData(e);e.buffer||(e.buffer=new Yn({data:new Float32Array(n.layout.size/4),usage:Re.UNIFORM|Re.COPY_DST}))}getUniformGroupData(e){return this._syncFunctionHash[e._signature]||this._initUniformGroup(e)}_initUniformGroup(e){const n=e._signature;let r=this._syncFunctionHash[n];if(!r){const i=Object.keys(e.uniformStructures).map(a=>e.uniformStructures[a]),s=this._adaptor.createUboElements(i),o=this._generateUboSync(s.uboElements);r=this._syncFunctionHash[n]={layout:s,syncFunction:o}}return this._syncFunctionHash[n]}_generateUboSync(e){return this._adaptor.generateUboSync(e)}syncUniformGroup(e,n,r){const i=this.getUniformGroupData(e);return e.buffer||(e.buffer=new Yn({data:new Float32Array(i.layout.size/4),usage:Re.UNIFORM|Re.COPY_DST})),n||(n=e.buffer.data),r||(r=0),i.syncFunction(e.uniforms,n,r),!0}updateUniformGroup(e){if(e.isStatic&&!e._dirtyId)return!1;e._dirtyId=0;const n=this.syncUniformGroup(e);return e.buffer.update(),n}destroy(){this._syncFunctionHash=null}}const W1={f32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"mat2x2<f32>":16*2,"mat3x3<f32>":16*3,"mat4x4<f32>":16*4};function yD(t){const e=t.map(s=>({data:s,offset:0,size:0}));let n=0,r=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(n=W1[o.data.type],!n)throw new Error(`Unknown type ${o.data.type}`);if(o.data.size>1&&(n=Math.max(n,16)*o.data.size),o.size=n,r%n!==0&&r<16){const a=r%n%16;r+=a,i+=a}r+n>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=n,r=n):(o.offset=i,r+=n,i+=n)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}const Os=[{type:"mat3x3<f32>",test:t=>t.value.a!==void 0,ubo:`
            var matrix = uv[name].toArray(true);
            data[offset] = matrix[0];
            data[offset + 1] = matrix[1];
            data[offset + 2] = matrix[2];
            data[offset + 4] = matrix[3];
            data[offset + 5] = matrix[4];
            data[offset + 6] = matrix[5];
            data[offset + 8] = matrix[6];
            data[offset + 9] = matrix[7];
            data[offset + 10] = matrix[8];
        `,uniform:`
            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));
        `},{type:"vec4<f32>",test:t=>t.type==="vec4<f32>"&&t.size===1&&t.value.width!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
            data[offset + 2] = v.width;
            data[offset + 3] = v.height;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {
                cv[0] = v.x;
                cv[1] = v.y;
                cv[2] = v.width;
                cv[3] = v.height;
                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);
            }
        `},{type:"vec2<f32>",test:t=>t.type==="vec2<f32>"&&t.size===1&&t.value.x!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y) {
                cv[0] = v.x;
                cv[1] = v.y;
                gl.uniform2f(ud[name].location, v.x, v.y);
            }
        `},{type:"vec4<f32>",test:t=>t.type==="vec4<f32>"&&t.size===1&&t.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
            data[offset + 3] = v.alpha;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                cv[3] = v.alpha;
                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);
            }
        `},{type:"vec3<f32>",test:t=>t.type==="vec3<f32>"&&t.size===1&&t.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);
            }
        `}];function $1(t,e,n,r){const i=[`
        var v = null;
        var v2 = null;
        var t = 0;
        var index = 0;
        var name = null;
        var arrayOffset = null;
    `];let s=0;for(let a=0;a<t.length;a++){const c=t[a],h=c.data.name;let f=!1,p=0;for(let v=0;v<Os.length;v++)if(Os[v].test(c.data)){p=c.offset/4,i.push(`name = "${h}";`,`offset += ${p-s};`,Os[v][e]||Os[v].ubo),f=!0;break}if(!f)if(c.data.size>1)p=c.offset/4,i.push(n(c,p-s));else{const v=r[c.data.type];p=c.offset/4,i.push(`
                    v = uv.${h};
                    offset += ${p-s};
                    ${v};
                `)}s=p}const o=i.join(`
`);return new Function("uv","data","offset",o)}function Ma(t,e){return`
        for (let i = 0; i < ${t*e}; i++) {
            data[offset + (((i / ${t})|0) * 4) + (i % ${t})] = v[i];
        }
    `}const X1={f32:`
        data[offset] = v;`,i32:`
        data[offset] = v;`,"vec2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];`,"vec3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];`,"vec4<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];`,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 4] = v[2];
        data[offset + 5] = v[3];`,"mat3x3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];
        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];`,"mat4x4<f32>":`
        for (let i = 0; i < 16; i++) {
            data[offset + i] = v[i];
        }`,"mat3x2<f32>":Ma(3,2),"mat4x2<f32>":Ma(4,2),"mat2x3<f32>":Ma(2,3),"mat4x3<f32>":Ma(4,3),"mat2x4<f32>":Ma(2,4),"mat3x4<f32>":Ma(3,4)},bD={...X1,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];
    `};function SD(t,e){const n=Math.max(W1[t.data.type]/16,1),r=t.data.value.length/t.data.size,i=(4-r%4)%4;return`
        v = uv.${t.data.name};
        offset += ${e};

        arrayOffset = offset;

        t = 0;

        for(var i=0; i < ${t.data.size*n}; i++)
        {
            for(var j = 0; j < ${r}; j++)
            {
                data[arrayOffset++] = v[t++];
            }
            ${i!==0?`arrayOffset += ${i};`:""}
        }
    `}function wD(t){return $1(t,"uboStd40",SD,X1)}class Y1 extends j1{constructor(){super({createUboElements:yD,generateUboSync:wD})}}Y1.extension={type:[P.WebGLSystem],name:"ubo"};class CD{constructor(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Ke}init(e,n){this._renderer=e,this._renderTargetSystem=n,e.runners.contextChange.add(this)}contextChange(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Ke}copyToTexture(e,n,r,i,s){const o=this._renderTargetSystem,a=this._renderer,c=o.getGpuRenderTarget(e),h=a.gl;return this.finishRenderPass(e),h.bindFramebuffer(h.FRAMEBUFFER,c.resolveTargetFramebuffer),a.texture.bind(n,0),h.copyTexSubImage2D(h.TEXTURE_2D,0,s.x,s.y,r.x,r.y,i.width,i.height),n}startRenderPass(e,n=!0,r,i){const s=this._renderTargetSystem,o=e.colorTexture,a=s.getGpuRenderTarget(e);let c=i.y;e.isRoot&&(c=o.pixelHeight-i.height),e.colorTextures.forEach(p=>{this._renderer.texture.unbind(p)});const h=this._renderer.gl;h.bindFramebuffer(h.FRAMEBUFFER,a.framebuffer);const f=this._viewPortCache;(f.x!==i.x||f.y!==c||f.width!==i.width||f.height!==i.height)&&(f.x=i.x,f.y=c,f.width=i.width,f.height=i.height,h.viewport(i.x,c,i.width,i.height)),!a.depthStencilRenderBuffer&&(e.stencil||e.depth)&&this._initStencil(a),this.clear(e,n,r)}finishRenderPass(e){const r=this._renderTargetSystem.getGpuRenderTarget(e);if(!r.msaa)return;const i=this._renderer.gl;i.bindFramebuffer(i.FRAMEBUFFER,r.resolveTargetFramebuffer),i.bindFramebuffer(i.READ_FRAMEBUFFER,r.framebuffer),i.blitFramebuffer(0,0,r.width,r.height,0,0,r.width,r.height,i.COLOR_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)}initGpuRenderTarget(e){const r=this._renderer.gl,i=new xD,s=e.colorTexture;return ns.test(s.resource)?(this._renderer.context.ensureCanvasSize(e.colorTexture.resource),i.framebuffer=null,i):(this._initColor(e,i),r.bindFramebuffer(r.FRAMEBUFFER,null),i)}destroyGpuRenderTarget(e){const n=this._renderer.gl;e.framebuffer&&(n.deleteFramebuffer(e.framebuffer),e.framebuffer=null),e.resolveTargetFramebuffer&&(n.deleteFramebuffer(e.resolveTargetFramebuffer),e.resolveTargetFramebuffer=null),e.depthStencilRenderBuffer&&(n.deleteRenderbuffer(e.depthStencilRenderBuffer),e.depthStencilRenderBuffer=null),e.msaaRenderBuffer.forEach(r=>{n.deleteRenderbuffer(r)}),e.msaaRenderBuffer=null}clear(e,n,r){if(!n)return;const i=this._renderTargetSystem;typeof n=="boolean"&&(n=n?Bn.ALL:Bn.NONE);const s=this._renderer.gl;if(n&Bn.COLOR){r??(r=i.defaultClearColor);const o=this._clearColorCache,a=r;(o[0]!==a[0]||o[1]!==a[1]||o[2]!==a[2]||o[3]!==a[3])&&(o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],s.clearColor(a[0],a[1],a[2],a[3]))}s.clear(n)}resizeGpuRenderTarget(e){if(e.isRoot)return;const r=this._renderTargetSystem.getGpuRenderTarget(e);this._resizeColor(e,r),(e.stencil||e.depth)&&this._resizeStencil(r)}_initColor(e,n){const r=this._renderer,i=r.gl,s=i.createFramebuffer();if(n.resolveTargetFramebuffer=s,i.bindFramebuffer(i.FRAMEBUFFER,s),n.width=e.colorTexture.source.pixelWidth,n.height=e.colorTexture.source.pixelHeight,e.colorTextures.forEach((o,a)=>{const c=o.source;c.antialias&&(r.context.supports.msaa?n.msaa=!0:de("[RenderTexture] Antialiasing on textures is not supported in WebGL1")),r.texture.bindSource(c,0);const f=r.texture.getGlSource(c).texture;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+a,3553,f,0)}),n.msaa){const o=i.createFramebuffer();n.framebuffer=o,i.bindFramebuffer(i.FRAMEBUFFER,o),e.colorTextures.forEach((a,c)=>{const h=i.createRenderbuffer();n.msaaRenderBuffer[c]=h})}else n.framebuffer=s;this._resizeColor(e,n)}_resizeColor(e,n){const r=e.colorTexture.source;if(n.width=r.pixelWidth,n.height=r.pixelHeight,e.colorTextures.forEach((i,s)=>{s!==0&&i.source.resize(r.width,r.height,r._resolution)}),n.msaa){const i=this._renderer,s=i.gl,o=n.framebuffer;s.bindFramebuffer(s.FRAMEBUFFER,o),e.colorTextures.forEach((a,c)=>{const h=a.source;i.texture.bindSource(h,0);const p=i.texture.getGlSource(h).internalFormat,v=n.msaaRenderBuffer[c];s.bindRenderbuffer(s.RENDERBUFFER,v),s.renderbufferStorageMultisample(s.RENDERBUFFER,4,p,h.pixelWidth,h.pixelHeight),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+c,s.RENDERBUFFER,v)})}}_initStencil(e){if(e.framebuffer===null)return;const n=this._renderer.gl,r=n.createRenderbuffer();e.depthStencilRenderBuffer=r,n.bindRenderbuffer(n.RENDERBUFFER,r),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,r),this._resizeStencil(e)}_resizeStencil(e){const n=this._renderer.gl;n.bindRenderbuffer(n.RENDERBUFFER,e.depthStencilRenderBuffer),e.msaa?n.renderbufferStorageMultisample(n.RENDERBUFFER,4,n.DEPTH24_STENCIL8,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,this._renderer.context.webGLVersion===2?n.DEPTH24_STENCIL8:n.DEPTH_STENCIL,e.width,e.height)}postrender(e){if(this._renderer.context.multiView&&ns.test(e.colorTexture.resource)){const n=this._renderer.context.canvas,r=e.colorTexture;r.context2D.drawImage(n,0,r.pixelHeight-n.height)}}}function TD(t,e,n,r,i,s){const o=s?1:-1;return t.identity(),t.a=1/r*2,t.d=o*(1/i*2),t.tx=-1-e*t.a,t.ty=-o-n*t.d,t}const Fa=new Map;function q1(t,e){if(!Fa.has(t)){const n=new X({source:new ns({resource:t,...e})}),r=()=>{Fa.get(t)===n&&Fa.delete(t)};n.once("destroy",r),n.source.once("destroy",r),Fa.set(t,n)}return Fa.get(t)}function h9(t){return Fa.has(t)}function ED(t){const e=t.colorTexture.source.resource;return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement&&document.body.contains(e)}const AD=class PD{constructor(e={}){if(this.uid=ot("renderTarget"),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,e={...PD.defaultOptions,...e},this.stencil=e.stencil,this.depth=e.depth,this.isRoot=e.isRoot,typeof e.colorTextures=="number"){this._managedColorTextures=!0;for(let n=0;n<e.colorTextures;n++)this.colorTextures.push(new dt({width:e.width,height:e.height,resolution:e.resolution,antialias:e.antialias}))}else{this.colorTextures=[...e.colorTextures.map(r=>r.source)];const n=this.colorTexture.source;this.resize(n.width,n.height,n._resolution)}this.colorTexture.source.on("resize",this.onSourceResize,this),(e.depthStencilTexture||this.stencil)&&(e.depthStencilTexture instanceof X||e.depthStencilTexture instanceof dt?this.depthStencilTexture=e.depthStencilTexture.source:this.ensureDepthStencilTexture())}get size(){const e=this._size;return e[0]=this.pixelWidth,e[1]=this.pixelHeight,e}get width(){return this.colorTexture.source.width}get height(){return this.colorTexture.source.height}get pixelWidth(){return this.colorTexture.source.pixelWidth}get pixelHeight(){return this.colorTexture.source.pixelHeight}get resolution(){return this.colorTexture.source._resolution}get colorTexture(){return this.colorTextures[0]}onSourceResize(e){this.resize(e.width,e.height,e._resolution,!0)}ensureDepthStencilTexture(){this.depthStencilTexture||(this.depthStencilTexture=new dt({width:this.width,height:this.height,resolution:this.resolution,format:"depth24plus-stencil8",autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1}))}resize(e,n,r=this.resolution,i=!1){this.dirtyId++,this.colorTextures.forEach((s,o)=>{i&&o===0||s.source.resize(e,n,r)}),this.depthStencilTexture&&this.depthStencilTexture.source.resize(e,n,r)}destroy(){this.colorTexture.source.off("resize",this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach(e=>{e.destroy()}),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}};AD.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};let Cp=AD;class K1{constructor(e){this.rootViewPort=new Ke,this.viewport=new Ke,this.onRenderTargetChange=new Uy("onRenderTargetChange"),this.projectionMatrix=new ae,this.defaultClearColor=[0,0,0,0],this._renderSurfaceToRenderTargetHash=new Map,this._gpuRenderTargetHash=Object.create(null),this._renderTargetStack=[],this._renderer=e}finishRenderPass(){this.adaptor.finishRenderPass(this.renderTarget)}renderStart({target:e,clear:n,clearColor:r,frame:i}){this._renderTargetStack.length=0,this.push(e,n,r,i),this.rootViewPort.copyFrom(this.viewport),this.rootRenderTarget=this.renderTarget,this.renderingToScreen=ED(this.rootRenderTarget)}postrender(){this.adaptor.postrender?.(this.rootRenderTarget)}bind(e,n=!0,r,i){const s=this.getRenderTarget(e),o=this.renderTarget!==s;this.renderTarget=s,this.renderSurface=e;const a=this.getGpuRenderTarget(s);(s.pixelWidth!==a.width||s.pixelHeight!==a.height)&&(this.adaptor.resizeGpuRenderTarget(s),a.width=s.pixelWidth,a.height=s.pixelHeight);const c=s.colorTexture,h=this.viewport,f=c.pixelWidth,p=c.pixelHeight;if(!i&&e instanceof X&&(i=e.frame),i){const v=c._resolution;h.x=i.x*v+.5|0,h.y=i.y*v+.5|0,h.width=i.width*v+.5|0,h.height=i.height*v+.5|0}else h.x=0,h.y=0,h.width=f,h.height=p;return TD(this.projectionMatrix,0,0,h.width/c.resolution,h.height/c.resolution,!s.isRoot),this.adaptor.startRenderPass(s,n,r,h),o&&this.onRenderTargetChange.emit(s),s}clear(e,n=Bn.ALL,r){n&&(e&&(e=this.getRenderTarget(e)),this.adaptor.clear(e||this.renderTarget,n,r,this.viewport))}contextChange(){this._gpuRenderTargetHash=Object.create(null)}push(e,n=Bn.ALL,r,i){const s=this.bind(e,n,r,i);return this._renderTargetStack.push({renderTarget:s,frame:i}),s}pop(){this._renderTargetStack.pop();const e=this._renderTargetStack[this._renderTargetStack.length-1];this.bind(e.renderTarget,!1,null,e.frame)}getRenderTarget(e){return e.isTexture&&(e=e.source),this._renderSurfaceToRenderTargetHash.get(e)??this._initRenderTarget(e)}copyToTexture(e,n,r,i,s){r.x<0&&(i.width+=r.x,s.x-=r.x,r.x=0),r.y<0&&(i.height+=r.y,s.y-=r.y,r.y=0);const{pixelWidth:o,pixelHeight:a}=e;return i.width=Math.min(i.width,o-r.x),i.height=Math.min(i.height,a-r.y),this.adaptor.copyToTexture(e,n,r,i,s)}ensureDepthStencil(){this.renderTarget.stencil||(this.renderTarget.stencil=!0,this.adaptor.startRenderPass(this.renderTarget,!1,null,this.viewport))}destroy(){this._renderer=null,this._renderSurfaceToRenderTargetHash.forEach((e,n)=>{e!==n&&e.destroy()}),this._renderSurfaceToRenderTargetHash.clear(),this._gpuRenderTargetHash=Object.create(null)}_initRenderTarget(e){let n=null;return ns.test(e)&&(e=q1(e).source),e instanceof Cp?n=e:e instanceof dt&&(n=new Cp({colorTextures:[e]}),ns.test(e.source.resource)&&(n.isRoot=!0),e.once("destroy",()=>{n.destroy(),this._renderSurfaceToRenderTargetHash.delete(e);const r=this._gpuRenderTargetHash[n.uid];r&&(this._gpuRenderTargetHash[n.uid]=null,this.adaptor.destroyGpuRenderTarget(r))})),this._renderSurfaceToRenderTargetHash.set(e,n),n}getGpuRenderTarget(e){return this._gpuRenderTargetHash[e.uid]||(this._gpuRenderTargetHash[e.uid]=this.adaptor.initGpuRenderTarget(e))}}class Q1 extends K1{constructor(e){super(e),this.adaptor=new CD,this.adaptor.init(e,this)}}Q1.extension={type:[P.WebGLSystem],name:"renderTarget"};class Im extends Mt{constructor({buffer:e,offset:n,size:r}){super(),this.uid=ot("buffer"),this._resourceType="bufferResource",this._touched=0,this._resourceId=ot("resource"),this._bufferResource=!0,this.destroyed=!1,this.buffer=e,this.offset=n|0,this.size=r,this.buffer.on("change",this.onBufferChange,this)}onBufferChange(){this._resourceId=ot("resource"),this.emit("change",this)}destroy(e=!1){this.destroyed=!0,e&&this.buffer.destroy(),this.emit("change",this),this.buffer=null}}function RD(t,e){const n=[],r=[`
        var g = s.groups;
        var sS = r.shader;
        var p = s.glProgram;
        var ugS = r.uniformGroup;
        var resources;
    `];let i=!1,s=0,o=0;const a=e._getProgramData(t.glProgram);for(const h in t.groups){const f=t.groups[h];n.push(`
            resources = g[${h}].resources;
        `);for(const p in f.resources){const v=f.resources[p];if(v instanceof Tt)v.ubo?n.push(`
                        sS.bindUniformBlock(
                            resources[${p}],
                            sS._uniformBindMap[${h}[${p}],
                            ${s++}
                        );
                    `):n.push(`
                        ugS.updateUniformGroup(resources[${p}], p, sD);
                    `);else if(v instanceof Im)n.push(`
                    sS.bindUniformBlock(
                        resources[${p}],
                        sS._uniformBindMap[${h}[${p}],
                        ${s++}
                    );
                `);else if(v instanceof dt){const _=t._uniformBindMap[h][p],y=a.uniformData[_];y&&(i||(i=!0,r.push(`
                        var tS = r.texture;
                        `)),e._gl.uniform1i(y.location,o),n.push(`
                        tS.bind(resources[${p}], ${o});
                    `),o++)}}}const c=[...r,...n].join(`
`);return new Function("r","s","sD",c)}class f9{}class BD{constructor(e,n){this.program=e,this.uniformData=n,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}}function S2(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function bv(t){const e=new Array(t);for(let n=0;n<e.length;n++)e[n]=!1;return e}function Z1(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return bv(2*e);case"bvec3":return bv(3*e);case"bvec4":return bv(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}let rd=null;const AT={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},d9={float:"float32",vec2:"float32x2",vec3:"float32x3",vec4:"float32x4",int:"sint32",ivec2:"sint32x2",ivec3:"sint32x3",ivec4:"sint32x4",uint:"uint32",uvec2:"uint32x2",uvec3:"uint32x3",uvec4:"uint32x4",bool:"uint32",bvec2:"uint32x2",bvec3:"uint32x3",bvec4:"uint32x4"};function J1(t,e){if(!rd){const n=Object.keys(AT);rd={};for(let r=0;r<n.length;++r){const i=n[r];rd[t[i]]=AT[i]}}return rd[e]}function MD(t,e){const n=J1(t,e);return d9[n]||"float32"}function DD(t,e,n=!1){const r={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let o=0;o<i;o++){const a=e.getActiveAttrib(t,o);if(a.name.startsWith("gl_"))continue;const c=MD(e,a.type);r[a.name]={location:0,format:c,stride:Pu(c).stride,offset:0,instance:!1,start:0}}const s=Object.keys(r);if(n){s.sort((o,a)=>o>a?1:-1);for(let o=0;o<s.length;o++)r[s[o]].location=o,e.bindAttribLocation(t,o,s[o]);e.linkProgram(t)}else for(let o=0;o<s.length;o++)r[s[o]].location=e.getAttribLocation(t,s[o]);return r}function OD(t,e){if(!e.ACTIVE_UNIFORM_BLOCKS)return{};const n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORM_BLOCKS);for(let i=0;i<r;i++){const s=e.getActiveUniformBlockName(t,i),o=e.getUniformBlockIndex(t,s),a=e.getActiveUniformBlockParameter(t,i,e.UNIFORM_BLOCK_DATA_SIZE);n[s]={name:s,index:o,size:a}}return n}function kD(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),c=J1(e,s.type);n[o]={name:o,index:i,type:c,size:s.size,isArray:a,value:Z1(c,s.size)}}return n}function PT(t,e){const n=t.getShaderSource(e).split(`
`).map((h,f)=>`${f}: ${h}`),r=t.getShaderInfoLog(e),i=r.split(`
`),s={},o=i.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!s[h]?(s[h]=!0,!0):!1),a=[""];o.forEach(h=>{n[h-1]=`%c${n[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=n.join(`
`);a[0]=c,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function FD(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||PT(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||PT(t,r),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}function ID(t,e){const n=S2(t,t.VERTEX_SHADER,e.vertex),r=S2(t,t.FRAGMENT_SHADER,e.fragment),i=t.createProgram();t.attachShader(i,n),t.attachShader(i,r);const s=e.transformFeedbackVaryings;s&&(typeof t.transformFeedbackVaryings!="function"?de("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||FD(t,i,n,r),e._attributeData=DD(i,t,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertex)),e._uniformData=kD(i,t),e._uniformBlockData=OD(i,t),t.deleteShader(n),t.deleteShader(r);const o={};for(const c in e._uniformData){const h=e._uniformData[c];o[c]={location:t.getUniformLocation(i,c),value:Z1(h.type,h.size)}}return new BD(i,o)}const id={textureCount:0,blockIndex:0};class eb{constructor(e){this._activeProgram=null,this._programDataHash=Object.create(null),this._nextIndex=0,this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=e}contextChange(e){this._gl=e,this._maxBindings=e.MAX_UNIFORM_BUFFER_BINDINGS?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0,this._programDataHash=Object.create(null),this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._activeProgram=null,this.maxTextures=ta()}bind(e,n){if(this._setProgram(e.glProgram),n)return;id.textureCount=0,id.blockIndex=0;let r=this._shaderSyncFunctions[e.glProgram._key];r||(r=this._shaderSyncFunctions[e.glProgram._key]=this._generateShaderSync(e,this)),r(this._renderer,e,id)}updateUniformGroup(e){this._renderer.uniformGroup.updateUniformGroup(e,this._activeProgram,id)}bindUniformBlock(e,n,r=0){const i=this._renderer.buffer,s=this._getProgramData(this._activeProgram),o=e._bufferResource;o&&this._renderer.ubo.updateUniformGroup(e),i.updateBuffer(e.buffer);let a=this._boundUniformsIdsToIndexHash[e.uid];if(a===void 0){const f=this._nextIndex++%this._maxBindings,p=this._boundIndexToUniformsHash[f];p&&(this._boundUniformsIdsToIndexHash[p.uid]=void 0),a=this._boundUniformsIdsToIndexHash[e.uid]=f,this._boundIndexToUniformsHash[f]=e,o?i.bindBufferRange(e.buffer,f,e.offset):i.bindBufferBase(e.buffer,f)}const c=this._gl,h=this._activeProgram._uniformBlockData[n].index;s.uniformBlockBindings[r]!==a&&(s.uniformBlockBindings[r]=a,c.uniformBlockBinding(s.program,h,a))}_setProgram(e){if(this._activeProgram===e)return;this._activeProgram=e;const n=this._getProgramData(e);this._gl.useProgram(n.program)}_getProgramData(e){return this._programDataHash[e._key]||this._createProgramData(e)}_createProgramData(e){const n=e._key;return this._programDataHash[n]=ID(this._gl,e),this._programDataHash[n]}destroy(){for(const e of Object.keys(this._programDataHash))this._programDataHash[e].destroy(),this._programDataHash[e]=null;this._programDataHash=null,this._boundUniformsIdsToIndexHash=null}_generateShaderSync(e,n){return RD(e,n)}}eb.extension={type:[P.WebGLSystem],name:"shader"};const UD={f32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1f(location, v);
        }`,"vec2<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2f(location, v[0], v[1]);
        }`,"vec3<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3f(location, v[0], v[1], v[2]);
        }`,"vec4<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4f(location, v[0], v[1], v[2], v[3]);
        }`,i32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,u32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1ui(location, v);
        }`,"vec2<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2ui(location, v[0], v[1]);
        }`,"vec3<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3ui(location, v[0], v[1], v[2]);
        }`,"vec4<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
        }`,bool:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,"mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);"},LD={f32:"gl.uniform1fv(location, v);","vec2<f32>":"gl.uniform2fv(location, v);","vec3<f32>":"gl.uniform3fv(location, v);","vec4<f32>":"gl.uniform4fv(location, v);","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);",i32:"gl.uniform1iv(location, v);","vec2<i32>":"gl.uniform2iv(location, v);","vec3<i32>":"gl.uniform3iv(location, v);","vec4<i32>":"gl.uniform4iv(location, v);",u32:"gl.uniform1iv(location, v);","vec2<u32>":"gl.uniform2iv(location, v);","vec3<u32>":"gl.uniform3iv(location, v);","vec4<u32>":"gl.uniform4iv(location, v);",bool:"gl.uniform1iv(location, v);","vec2<bool>":"gl.uniform2iv(location, v);","vec3<bool>":"gl.uniform3iv(location, v);","vec4<bool>":"gl.uniform4iv(location, v);"};function ND(t,e){const n=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
        var name = null;
    `];for(const r in t.uniforms){if(!e[r]){t.uniforms[r]instanceof Tt?t.uniforms[r].ubo?n.push(`
                        renderer.shader.bindUniformBlock(uv.${r}, "${r}");
                    `):n.push(`
                        renderer.shader.updateUniformGroup(uv.${r});
                    `):t.uniforms[r]instanceof Im&&n.push(`
                        renderer.shader.bindBufferResource(uv.${r}, "${r}");
                    `);continue}const i=t.uniformStructures[r];let s=!1;for(let o=0;o<Os.length;o++){const a=Os[o];if(i.type===a.type&&a.test(i)){n.push(`name = "${r}";`,Os[o].uniform),s=!0;break}}if(!s){const a=(i.size===1?UD:LD)[i.type].replace("location",`ud["${r}"].location`);n.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${a};`)}}return new Function("ud","uv","renderer","syncData",n.join(`
`))}class tb{constructor(e){this._cache={},this._uniformGroupSyncHash={},this._renderer=e,this.gl=null,this._cache={}}contextChange(e){this.gl=e}updateUniformGroup(e,n,r){const i=this._renderer.shader._getProgramData(n);(!e.isStatic||e._dirtyId!==i.uniformDirtyGroups[e.uid])&&(i.uniformDirtyGroups[e.uid]=e._dirtyId,this._getUniformSyncFunction(e,n)(i.uniformData,e.uniforms,this._renderer,r))}_getUniformSyncFunction(e,n){return this._uniformGroupSyncHash[e._signature]?.[n._key]||this._createUniformSyncFunction(e,n)}_createUniformSyncFunction(e,n){const r=this._uniformGroupSyncHash[e._signature]||(this._uniformGroupSyncHash[e._signature]={}),i=this._getSignature(e,n._uniformData,"u");return this._cache[i]||(this._cache[i]=this._generateUniformsSync(e,n._uniformData)),r[n._key]=this._cache[i],r[n._key]}_generateUniformsSync(e,n){return ND(e,n)}_getSignature(e,n,r){const i=e.uniforms,s=[`${r}-`];for(const o in i)s.push(o),n[o]&&s.push(n[o].type);return s.join("-")}destroy(){this._renderer=null,this._cache=null}}tb.extension={type:[P.WebGLSystem],name:"uniformGroup"};function p9(t){return t=t.replaceAll("texture2D","texture").replaceAll("gl_FragColor","finalColor").replaceAll("varying","in"),t=`
        out vec4 finalColor;
    ${t}
    `,t}const m9={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function g9(t){return m9[t]}function GD(t){const e={};if(e.normal=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e.add=[t.ONE,t.ONE],e.multiply=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e.screen=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e.none=[0,0],e["normal-npm"]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e["add-npm"]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e["screen-npm"]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e.erase=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],!(t instanceof Ce.get().getWebGLRenderingContext()))e.min=[t.ONE,t.ONE,t.ONE,t.ONE,t.MIN,t.MIN],e.max=[t.ONE,t.ONE,t.ONE,t.ONE,t.MAX,t.MAX];else{const r=t.getExtension("EXT_blend_minmax");r&&(e.min=[t.ONE,t.ONE,t.ONE,t.ONE,r.MIN_EXT,r.MIN_EXT],e.max=[t.ONE,t.ONE,t.ONE,t.ONE,r.MAX_EXT,r.MAX_EXT])}return e}const v9=0,_9=1,x9=2,y9=3,b9=4,S9=5,zD=class w2{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode="none",this._blendEq=!1,this.map=[],this.map[v9]=this.setBlend,this.map[_9]=this.setOffset,this.map[x9]=this.setCullFace,this.map[y9]=this.setDepthTest,this.map[b9]=this.setFrontFace,this.map[S9]=this.setDepthMask,this.checks=[],this.defaultState=jr.for2d()}contextChange(e){this.gl=e,this.blendModesMap=GD(e),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let n=this.stateId^e.data,r=0;for(;n;)n&1&&this.map[r].call(this,!!(e.data&1<<r)),n=n>>1,r++;this.stateId=e.data}for(let n=0;n<this.checks.length;n++)this.checks[n](this,e)}forceState(e){e=e||this.defaultState;for(let n=0;n<this.map.length;n++)this.map[n].call(this,!!(e.data&1<<n));for(let n=0;n<this.checks.length;n++)this.checks[n](this,e);this.stateId=e.data}setBlend(e){this._updateCheck(w2._checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this._updateCheck(w2._checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(this.blendModesMap[e]||(e="normal"),e===this.blendMode)return;this.blendMode=e;const n=this.blendModesMap[e],r=this.gl;n.length===2?r.blendFunc(n[0],n[1]):r.blendFuncSeparate(n[0],n[1],n[2],n[3]),n.length===6?(this._blendEq=!0,r.blendEquationSeparate(n[4],n[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,n){this.gl.polygonOffset(e,n)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode="",this.setBlendMode("normal")}_updateCheck(e,n){const r=this.checks.indexOf(e);n&&r===-1?this.checks.push(e):!n&&r!==-1&&this.checks.splice(r,1)}static _checkBlendMode(e,n){e.setBlendMode(n.blendMode)}static _checkPolygonOffset(e,n){e.setPolygonOffset(1,n.polygonOffset)}destroy(){this.gl=null,this.checks.length=0}};zD.extension={type:[P.WebGLSystem],name:"state"};let HD=zD;class VD{constructor(e){this.target=L1.TEXTURE_2D,this.texture=e,this.width=-1,this.height=-1,this.type=Pe.UNSIGNED_BYTE,this.internalFormat=wp.RGBA,this.format=wp.RGBA,this.samplerType=0}}const jD={id:"buffer",upload(t,e,n){e.width===t.width||e.height===t.height?n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,e.format,e.type,t.resource):n.texImage2D(e.target,0,e.internalFormat,t.width,t.height,0,e.format,e.type,t.resource),e.width=t.width,e.height=t.height}},w9={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},WD={id:"compressed",upload(t,e,n){n.pixelStorei(n.UNPACK_ALIGNMENT,4);let r=t.pixelWidth,i=t.pixelHeight;const s=!!w9[t.format];for(let o=0;o<t.resource.length;o++){const a=t.resource[o];s?n.compressedTexImage2D(n.TEXTURE_2D,o,e.internalFormat,r,i,0,a):n.texImage2D(n.TEXTURE_2D,o,e.internalFormat,r,i,0,e.format,e.type,a),r=Math.max(r>>1,1),i=Math.max(i>>1,1)}}},nb={id:"image",upload(t,e,n,r){const i=t.alphaMode==="premultiply-alpha-on-upload";n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i);const s=e.width,o=e.height,a=t.pixelWidth,c=t.pixelHeight,h=t.resourceWidth,f=t.resourceHeight;h<a||f<c?((s!==a||o!==c)&&n.texImage2D(e.target,0,e.internalFormat,a,c,0,e.format,e.type,null),r===2?n.texSubImage2D(n.TEXTURE_2D,0,0,0,h,f,e.format,e.type,t.resource):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,t.resource)):s===a||o===c?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,t.resource):r===2?n.texImage2D(e.target,0,e.internalFormat,a,c,0,e.format,e.type,t.resource):n.texImage2D(e.target,0,e.internalFormat,e.format,e.type,t.resource),e.width=a,e.height=c}},$D={id:"video",upload(t,e,n,r){if(!t.isValid){n.texImage2D(e.target,0,e.internalFormat,1,1,0,e.format,e.type,null);return}nb.upload(t,e,n,r)}},C2={linear:9729,nearest:9728},XD={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},Bd={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},YD={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519};function T2(t,e,n,r,i,s,o,a){const c=s;if(!a||t.addressModeU!=="repeat"||t.addressModeV!=="repeat"||t.addressModeW!=="repeat"){const h=Bd[o?"clamp-to-edge":t.addressModeU],f=Bd[o?"clamp-to-edge":t.addressModeV],p=Bd[o?"clamp-to-edge":t.addressModeW];e[i](c,e.TEXTURE_WRAP_S,h),e[i](c,e.TEXTURE_WRAP_T,f),e.TEXTURE_WRAP_R&&e[i](c,e.TEXTURE_WRAP_R,p)}if((!a||t.magFilter!=="linear")&&e[i](c,e.TEXTURE_MAG_FILTER,C2[t.magFilter]),n){if(!a||t.mipmapFilter!=="linear"){const h=XD[t.minFilter][t.mipmapFilter];e[i](c,e.TEXTURE_MIN_FILTER,h)}}else e[i](c,e.TEXTURE_MIN_FILTER,C2[t.minFilter]);if(r&&t.maxAnisotropy>1){const h=Math.min(t.maxAnisotropy,e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));e[i](c,r.TEXTURE_MAX_ANISOTROPY_EXT,h)}t.compare&&e[i](c,e.TEXTURE_COMPARE_FUNC,YD[t.compare])}function qD(t){return{r8unorm:t.RED,r8snorm:t.RED,r8uint:t.RED,r8sint:t.RED,r16uint:t.RED,r16sint:t.RED,r16float:t.RED,rg8unorm:t.RG,rg8snorm:t.RG,rg8uint:t.RG,rg8sint:t.RG,r32uint:t.RED,r32sint:t.RED,r32float:t.RED,rg16uint:t.RG,rg16sint:t.RG,rg16float:t.RG,rgba8unorm:t.RGBA,"rgba8unorm-srgb":t.RGBA,rgba8snorm:t.RGBA,rgba8uint:t.RGBA,rgba8sint:t.RGBA,bgra8unorm:t.RGBA,"bgra8unorm-srgb":t.RGBA,rgb9e5ufloat:t.RGB,rgb10a2unorm:t.RGBA,rg11b10ufloat:t.RGB,rg32uint:t.RG,rg32sint:t.RG,rg32float:t.RG,rgba16uint:t.RGBA,rgba16sint:t.RGBA,rgba16float:t.RGBA,rgba32uint:t.RGBA,rgba32sint:t.RGBA,rgba32float:t.RGBA,stencil8:t.STENCIL_INDEX8,depth16unorm:t.DEPTH_COMPONENT,depth24plus:t.DEPTH_COMPONENT,"depth24plus-stencil8":t.DEPTH_STENCIL,depth32float:t.DEPTH_COMPONENT,"depth32float-stencil8":t.DEPTH_STENCIL}}function KD(t,e){let n={},r=t.RGBA;return t instanceof Ce.get().getWebGLRenderingContext()?e.srgb&&(n={"rgba8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT}):(n={"rgba8unorm-srgb":t.SRGB8_ALPHA8,"bgra8unorm-srgb":t.SRGB8_ALPHA8},r=t.RGBA8),{r8unorm:t.R8,r8snorm:t.R8_SNORM,r8uint:t.R8UI,r8sint:t.R8I,r16uint:t.R16UI,r16sint:t.R16I,r16float:t.R16F,rg8unorm:t.RG8,rg8snorm:t.RG8_SNORM,rg8uint:t.RG8UI,rg8sint:t.RG8I,r32uint:t.R32UI,r32sint:t.R32I,r32float:t.R32F,rg16uint:t.RG16UI,rg16sint:t.RG16I,rg16float:t.RG16F,rgba8unorm:t.RGBA,...n,rgba8snorm:t.RGBA8_SNORM,rgba8uint:t.RGBA8UI,rgba8sint:t.RGBA8I,bgra8unorm:r,rgb9e5ufloat:t.RGB9_E5,rgb10a2unorm:t.RGB10_A2,rg11b10ufloat:t.R11F_G11F_B10F,rg32uint:t.RG32UI,rg32sint:t.RG32I,rg32float:t.RG32F,rgba16uint:t.RGBA16UI,rgba16sint:t.RGBA16I,rgba16float:t.RGBA16F,rgba32uint:t.RGBA32UI,rgba32sint:t.RGBA32I,rgba32float:t.RGBA32F,stencil8:t.STENCIL_INDEX8,depth16unorm:t.DEPTH_COMPONENT16,depth24plus:t.DEPTH_COMPONENT24,"depth24plus-stencil8":t.DEPTH24_STENCIL8,depth32float:t.DEPTH_COMPONENT32F,"depth32float-stencil8":t.DEPTH32F_STENCIL8,...e.s3tc?{"bc1-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{},...e.s3tc_sRGB?{"bc1-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{},...e.rgtc?{"bc4-r-unorm":e.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":e.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":e.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":e.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{},...e.bptc?{"bc6h-rgb-float":e.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":e.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":e.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":e.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{},...e.etc?{"etc2-rgb8unorm":e.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":e.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":e.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":e.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":e.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":e.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":e.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":e.etc.COMPRESSED_SIGNED_RG11_EAC}:{},...e.astc?{"astc-4x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{}}}function QD(t){return{r8unorm:t.UNSIGNED_BYTE,r8snorm:t.BYTE,r8uint:t.UNSIGNED_BYTE,r8sint:t.BYTE,r16uint:t.UNSIGNED_SHORT,r16sint:t.SHORT,r16float:t.HALF_FLOAT,rg8unorm:t.UNSIGNED_BYTE,rg8snorm:t.BYTE,rg8uint:t.UNSIGNED_BYTE,rg8sint:t.BYTE,r32uint:t.UNSIGNED_INT,r32sint:t.INT,r32float:t.FLOAT,rg16uint:t.UNSIGNED_SHORT,rg16sint:t.SHORT,rg16float:t.HALF_FLOAT,rgba8unorm:t.UNSIGNED_BYTE,"rgba8unorm-srgb":t.UNSIGNED_BYTE,rgba8snorm:t.BYTE,rgba8uint:t.UNSIGNED_BYTE,rgba8sint:t.BYTE,bgra8unorm:t.UNSIGNED_BYTE,"bgra8unorm-srgb":t.UNSIGNED_BYTE,rgb9e5ufloat:t.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:t.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:t.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:t.UNSIGNED_INT,rg32sint:t.INT,rg32float:t.FLOAT,rgba16uint:t.UNSIGNED_SHORT,rgba16sint:t.SHORT,rgba16float:t.HALF_FLOAT,rgba32uint:t.UNSIGNED_INT,rgba32sint:t.INT,rgba32float:t.FLOAT,stencil8:t.UNSIGNED_BYTE,depth16unorm:t.UNSIGNED_SHORT,depth24plus:t.UNSIGNED_INT,"depth24plus-stencil8":t.UNSIGNED_INT_24_8,depth32float:t.FLOAT,"depth32float-stencil8":t.FLOAT_32_UNSIGNED_INT_24_8_REV}}function C9(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let n=0;n<e;n+=4){const r=t[n+3];if(r!==0){const i=255.001/r;t[n]=t[n]*i+.5,t[n+1]=t[n+1]*i+.5,t[n+2]=t[n+2]*i+.5}}}const T9=4;class rb{constructor(e){this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:nb,buffer:jD,video:$D,compressed:WD},this._useSeparateSamplers=!1,this._renderer=e}contextChange(e){this._gl=e,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=KD(e,this._renderer.context.extensions),this._mapFormatToType=QD(e),this._mapFormatToFormat=qD(e)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null);for(let n=0;n<16;n++)this.bind(X.EMPTY,n)}initSource(e){this.bind(e)}bind(e,n=0){const r=e.source;e?(this.bindSource(r,n),this._useSeparateSamplers&&this._bindSampler(r.style,n)):(this.bindSource(null,n),this._useSeparateSamplers&&this._bindSampler(null,n))}bindSource(e,n=0){const r=this._gl;if(e._touched=this._renderer.textureGC.count,this._boundTextures[n]!==e){this._boundTextures[n]=e,this._activateLocation(n),e=e||X.EMPTY.source;const i=this.getGlSource(e);r.bindTexture(i.target,i.texture)}}_bindSampler(e,n=0){const r=this._gl;if(!e){this._boundSamplers[n]=null,r.bindSampler(n,null);return}const i=this._getGlSampler(e);this._boundSamplers[n]!==i&&(this._boundSamplers[n]=i,r.bindSampler(n,i))}unbind(e){const n=e.source,r=this._boundTextures,i=this._gl;for(let s=0;s<r.length;s++)if(r[s]===n){this._activateLocation(s);const o=this.getGlSource(n);i.bindTexture(o.target,null),r[s]=null}}_activateLocation(e){this._activeTextureLocation!==e&&(this._activeTextureLocation=e,this._gl.activeTexture(this._gl.TEXTURE0+e))}_initSource(e){const n=this._gl,r=new VD(n.createTexture());if(r.type=this._mapFormatToType[e.format],r.internalFormat=this._mapFormatToInternalFormat[e.format],r.format=this._mapFormatToFormat[e.format],e.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||e.isPowerOfTwo)){const i=Math.max(e.width,e.height);e.mipLevelCount=Math.floor(Math.log2(i))+1}return this._glTextures[e.uid]=r,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceUpdate,this),e.on("styleChange",this.onStyleChange,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),this.updateStyle(e,!1),r}onStyleChange(e){this.updateStyle(e,!1)}updateStyle(e,n){const r=this._gl,i=this.getGlSource(e);r.bindTexture(r.TEXTURE_2D,i.texture),this._boundTextures[this._activeTextureLocation]=e,T2(e.style,r,e.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"texParameteri",r.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!e.isPowerOfTwo,n)}onSourceUnload(e){const n=this._glTextures[e.uid];n&&(this.unbind(e),this._glTextures[e.uid]=null,this._gl.deleteTexture(n.texture))}onSourceUpdate(e){const n=this._gl,r=this.getGlSource(e);n.bindTexture(n.TEXTURE_2D,r.texture),this._boundTextures[this._activeTextureLocation]=e,this._uploads[e.uploadMethodId]?this._uploads[e.uploadMethodId].upload(e,r,n,this._renderer.context.webGLVersion):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.pixelWidth,e.pixelHeight,0,n.RGBA,n.UNSIGNED_BYTE,null),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e,!1)}onUpdateMipmaps(e,n=!0){n&&this.bindSource(e,0);const r=this.getGlSource(e);this._gl.generateMipmap(r.target)}onSourceDestroy(e){e.off("destroy",this.onSourceDestroy,this),e.off("update",this.onSourceUpdate,this),e.off("resize",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("styleChange",this.onStyleChange,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}_initSampler(e){const n=this._gl,r=this._gl.createSampler();return this._glSamplers[e._resourceId]=r,T2(e,n,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"samplerParameteri",r,!1,!0),this._glSamplers[e._resourceId]}_getGlSampler(e){return this._glSamplers[e._resourceId]||this._initSampler(e)}getGlSource(e){return this._glTextures[e.uid]||this._initSource(e)}generateCanvas(e){const{pixels:n,width:r,height:i}=this.getPixels(e),s=Ce.get().createCanvas();s.width=r,s.height=i;const o=s.getContext("2d");if(o){const a=o.createImageData(r,i);a.data.set(n),o.putImageData(a,0,0)}return s}getPixels(e){const n=e.source.resolution,r=e.frame,i=Math.max(Math.round(r.width*n),1),s=Math.max(Math.round(r.height*n),1),o=new Uint8Array(T9*i*s),a=this._renderer,c=a.renderTarget.getRenderTarget(e),h=a.renderTarget.getGpuRenderTarget(c),f=a.gl;return f.bindFramebuffer(f.FRAMEBUFFER,h.resolveTargetFramebuffer),f.readPixels(Math.round(r.x*n),Math.round(r.y*n),i,s,f.RGBA,f.UNSIGNED_BYTE,o),{pixels:new Uint8ClampedArray(o.buffer),width:i,height:s}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null,this._renderer=null}}rb.extension={type:[P.WebGLSystem],name:"texture"};class ib{init(){const e=new Tt({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uRound:{value:0,type:"f32"}}),n=ta(),r=Hu({name:"graphics",bits:[xm,bm(n),Fm,ju]});this.shader=new Sr({glProgram:r,resources:{localUniforms:e,batchSamplers:Sm(n)}})}execute(e,n){const r=n.context,i=r.customShader||this.shader,s=e.renderer,o=s.graphicsContext,{batcher:a,instructions:c}=o.getContextRenderData(r);i.groups[0]=s.globalUniforms.bindGroup,s.state.set(e.state),s.shader.bind(i),s.geometry.bind(a.geometry,i.glProgram);const h=c.instructions;for(let f=0;f<c.instructionSize;f++){const p=h[f];if(p.size){for(let v=0;v<p.textures.count;v++)s.texture.bind(p.textures.textures[v],v);s.geometry.draw("triangle-list",p.size,p.start)}}}destroy(){this.shader.destroy(!0),this.shader=null}}ib.extension={type:[P.WebGLPipesAdaptor],name:"graphics"};class sb{init(){const e=Hu({name:"mesh",bits:[Fm,lD,ju]});this._shader=new Sr({glProgram:e,resources:{uTexture:X.EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new ae}}}})}execute(e,n){const r=e.renderer;let i=n._shader;if(i){if(!i.glProgram){de("Mesh shader has no glProgram",n.shader);return}}else{i=this._shader;const s=n.texture,o=s.source;i.resources.uTexture=o,i.resources.uSampler=o.style,i.resources.textureUniforms.uniforms.uTextureMatrix=s.textureMatrix.mapCoord}i.groups[100]=r.globalUniforms.bindGroup,i.groups[101]=e.localUniformsBindGroup,r.encoder.draw({geometry:n._geometry,shader:i,state:n.state})}destroy(){this._shader.destroy(!0),this._shader=null}}sb.extension={type:[P.WebGLPipesAdaptor],name:"mesh"};class ob{constructor(e){this._renderer=e}addRenderable(e,n){this._renderer.renderPipes.batch.break(n),n.add(e)}execute(e){e.isRenderable&&e.render(this._renderer)}destroy(){this._renderer=null}}ob.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"customRender"};function ab(t,e){const n=t.instructionSet,r=n.instructions;for(let i=0;i<n.instructionSize;i++){const s=r[i];e[s.renderPipeId].execute(s)}}class ub{constructor(e){this._renderer=e}addRenderGroup(e,n){this._renderer.renderPipes.batch.break(n),n.add(e)}execute(e){e.isRenderable&&(this._renderer.globalUniforms.push({worldTransformMatrix:e.worldTransform,worldColor:e.worldColorAlpha}),ab(e,this._renderer.renderPipes),this._renderer.globalUniforms.pop())}destroy(){this._renderer=null}}ub.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"renderGroup"};function Um(t,e){e||(e=0);for(let n=e;n<t.length&&t[n];n++)t[n]=null}function lb(t,e=[]){e.push(t);for(let n=0;n<t.renderGroupChildren.length;n++)lb(t.renderGroupChildren[n],e);return e}function cb(t,e,n){const r=t>>16&255,i=t>>8&255,s=t&255,o=e>>16&255,a=e>>8&255,c=e&255,h=r+(o-r)*n,f=i+(a-i)*n,p=s+(c-s)*n;return(h<<16)+(f<<8)+p}const _u=16777215;function hb(t,e){return t===_u||e===_u?t+e-_u:cb(t,e,.5)}function E9(t,e,n){const r=(n>>24&255)/255,i=e*r*255,s=((t&255)<<16)+(t&65280)+(t>>16&255),o=n&16777215;let a;return s===_u||o===_u?a=s+o-_u:a=cb(s,o,.5),a+(i<<24)}const A9=new $e,RT=cu|Bc|om;function fb(t,e=!1){ZD(t);const n=t.childrenToUpdate,r=t.updateTick++;for(const i in n){const s=Number(i),o=n[i],a=o.list,c=o.index;for(let h=0;h<c;h++){const f=a[h];f.parentRenderGroup===t&&f.relativeRenderGroupDepth===s&&db(f,r,0)}Um(a,c),o.index=0}if(e)for(let i=0;i<t.renderGroupChildren.length;i++)fb(t.renderGroupChildren[i],e)}function ZD(t){const e=t.root;let n;if(t.renderGroupParent){const r=t.renderGroupParent;t.worldTransform.appendFrom(e.relativeGroupTransform,r.worldTransform),t.worldColor=hb(e.groupColor,r.worldColor),n=e.groupAlpha*r.worldAlpha}else t.worldTransform.copyFrom(e.localTransform),t.worldColor=e.localColor,n=e.localAlpha;n=n<0?0:n>1?1:n,t.worldAlpha=n,t.worldColorAlpha=t.worldColor+((n*255|0)<<24)}function db(t,e,n){if(e===t.updateTick)return;t.updateTick=e,t.didChange=!1;const r=t.localTransform;t.updateLocalTransform();const i=t.parent;if(i&&!i.renderGroup?(n=n|t._updateFlags,t.relativeGroupTransform.appendFrom(r,i.relativeGroupTransform),n&RT&&BT(t,i,n)):(n=t._updateFlags,t.relativeGroupTransform.copyFrom(r),n&RT&&BT(t,A9,n)),!t.renderGroup){const s=t.children,o=s.length;for(let c=0;c<o;c++)db(s[c],e,n);const a=t.parentRenderGroup;t.renderPipeId&&!a.structureDidChange&&a.updateRenderable(t)}}function BT(t,e,n){if(n&Bc){t.groupColor=hb(t.localColor,e.groupColor);let r=t.localAlpha*e.groupAlpha;r=r<0?0:r>1?1:r,t.groupAlpha=r,t.groupColorAlpha=t.groupColor+((r*255|0)<<24)}n&om&&(t.groupBlendMode=t.localBlendMode==="inherit"?e.groupBlendMode:t.localBlendMode),n&cu&&(t.globalDisplayStatus=t.localDisplayStatus&e.globalDisplayStatus),t._updateFlags=0}function JD(t,e){const{list:n,index:r}=t.childrenRenderablesToUpdate;let i=!1;for(let s=0;s<r;s++){const o=n[s];if(i=e[o.renderPipeId].validateRenderable(o),i)break}return t.structureDidChange=i,i}const P9=new ae;class pb{constructor(e){this._renderer=e}render({container:e,transform:n}){e.isRenderGroup=!0;const r=e.parent,i=e.renderGroup.renderGroupParent;e.parent=null,e.renderGroup.renderGroupParent=null;const s=this._renderer,o=lb(e.renderGroup,[]);let a=P9;n&&(a=a.copyFrom(e.renderGroup.localTransform),e.renderGroup.localTransform.copyFrom(n));const c=s.renderPipes;for(let h=0;h<o.length;h++){const f=o[h];f.runOnRender(),f.instructionSet.renderPipes=c,f.structureDidChange?Um(f.childrenRenderablesToUpdate.list,0):JD(f,c),fb(f),f.structureDidChange?(f.structureDidChange=!1,cD(f,s)):R9(f),f.childrenRenderablesToUpdate.index=0,s.renderPipes.batch.upload(f.instructionSet)}s.globalUniforms.start({worldTransformMatrix:n?e.renderGroup.localTransform:e.renderGroup.worldTransform,worldColor:e.renderGroup.worldColorAlpha}),ab(e.renderGroup,c),c.uniformBatch&&c.uniformBatch.renderEnd(),n&&e.renderGroup.localTransform.copyFrom(a),e.parent=r,e.renderGroup.renderGroupParent=i}destroy(){this._renderer=null}}pb.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"renderGroup"};function R9(t){const{list:e,index:n}=t.childrenRenderablesToUpdate;for(let r=0;r<n;r++){const i=e[r];i.didViewUpdate&&t.updateRenderable(i)}Um(e,n)}class Lm{constructor(){this.batcherName="default",this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null}get blendMode(){return this.renderable.groupBlendMode}get color(){return this.renderable.groupColorAlpha}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}}class mb{constructor(e){this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}addRenderable(e,n){const r=this._getGpuSprite(e);e._didSpriteUpdate&&this._updateBatchableSprite(e,r),this._renderer.renderPipes.batch.addToBatch(r,n)}updateRenderable(e){const n=this._gpuSpriteHash[e.uid];e._didSpriteUpdate&&this._updateBatchableSprite(e,n),n._batcher.updateElement(n)}validateRenderable(e){const n=e._texture,r=this._getGpuSprite(e);return r.texture._source!==n._source?!r._batcher.checkAndUpdateTexture(r,n):!1}destroyRenderable(e){const n=this._gpuSpriteHash[e.uid];Ae.return(n),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_updateBatchableSprite(e,n){e._didSpriteUpdate=!1,n.bounds=e.bounds,n.texture=e._texture}_getGpuSprite(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const n=Ae.get(Lm);return n.renderable=e,n.transform=e.groupTransform,n.texture=e._texture,n.bounds=e.bounds,n.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuSpriteHash[e.uid]=n,e._didSpriteUpdate=!1,e.on("destroyed",this._destroyRenderableBound),n}destroy(){for(const e in this._gpuSpriteHash)Ae.return(this._gpuSpriteHash[e]);this._gpuSpriteHash=null,this._renderer=null}}mb.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"sprite"};const gb=class eO{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new ve(0),this.color=this._backgroundColor,this.alpha=1}init(e){e={...eO.defaultOptions,...e},this.clearBeforeRender=e.clearBeforeRender,this.color=e.background||e.backgroundColor||this._backgroundColor,this.alpha=e.backgroundAlpha,this._backgroundColor.setAlpha(e.backgroundAlpha)}get color(){return this._backgroundColor}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get colorRgba(){return this._backgroundColor.toArray()}destroy(){}};gb.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"background",priority:0};gb.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};let tO=gb;const sc={};Ne.handle(P.BlendMode,t=>{if(!t.name)throw new Error("BlendMode extension must have a name property");sc[t.name]=t.ref},t=>{delete sc[t.name]});class vb{constructor(e){this._isAdvanced=!1,this._filterHash=Object.create(null),this._renderer=e}setBlendMode(e,n,r){if(this._activeBlendMode===n){this._isAdvanced&&this._renderableList.push(e);return}this._activeBlendMode=n,this._isAdvanced&&this._endAdvancedBlendMode(r),this._isAdvanced=!!sc[n],this._isAdvanced&&(this._beginAdvancedBlendMode(r),this._renderableList.push(e))}_beginAdvancedBlendMode(e){this._renderer.renderPipes.batch.break(e);const n=this._activeBlendMode;if(!sc[n]){de(`Unable to assign BlendMode: '${n}'. You may want to include: import 'pixi.js/advanced-blend-modes'`);return}let r=this._filterHash[n];r||(r=this._filterHash[n]=new Pc,r.filters=[new sc[n]]);const i={renderPipeId:"filter",action:"pushFilter",renderables:[],filterEffect:r,canBundle:!1};this._renderableList=i.renderables,e.add(i)}_endAdvancedBlendMode(e){this._renderableList=null,this._renderer.renderPipes.batch.break(e),e.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}buildStart(){this._isAdvanced=!1}buildEnd(e){this._isAdvanced&&this._endAdvancedBlendMode(e)}destroy(){this._renderer=null,this._renderableList=null;for(const e in this._filterHash)this._filterHash[e].destroy();this._filterHash=null}}vb.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"blendMode"};const Sv={png:"image/png",jpg:"image/jpeg",webp:"image/webp"},_b=class nO{constructor(e){this._renderer=e}_normalizeOptions(e,n={}){return e instanceof $e||e instanceof X?{target:e,...n}:{...n,...e}}async image(e){const n=new Image;return n.src=await this.base64(e),n}async base64(e){e=this._normalizeOptions(e,nO.defaultImageOptions);const{format:n,quality:r}=e,i=this.canvas(e);if(i.toBlob!==void 0)return new Promise((s,o)=>{i.toBlob(a=>{if(!a){o(new Error("ICanvas.toBlob failed!"));return}const c=new FileReader;c.onload=()=>s(c.result),c.onerror=o,c.readAsDataURL(a)},Sv[n],r)});if(i.toDataURL!==void 0)return i.toDataURL(Sv[n],r);if(i.convertToBlob!==void 0){const s=await i.convertToBlob({type:Sv[n],quality:r});return new Promise((o,a)=>{const c=new FileReader;c.onload=()=>o(c.result),c.onerror=a,c.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e){e=this._normalizeOptions(e);const n=e.target,r=this._renderer;if(n instanceof X)return r.texture.generateCanvas(n);const i=r.textureGenerator.generateTexture(e),s=r.texture.generateCanvas(i);return i.destroy(),s}pixels(e){e=this._normalizeOptions(e);const n=e.target,r=this._renderer,i=n instanceof X?n:r.textureGenerator.generateTexture(e),s=r.texture.getPixels(i);return n instanceof $e&&i.destroy(),s}texture(e){return e=this._normalizeOptions(e),e.target instanceof X?e.target:this._renderer.textureGenerator.generateTexture(e)}download(e){e=this._normalizeOptions(e);const n=this.canvas(e),r=document.createElement("a");r.download=e.filename??"image.png",r.href=n.toDataURL("image/png"),document.body.appendChild(r),r.click(),document.body.removeChild(r)}log(e){const n=e.width??200;e=this._normalizeOptions(e);const r=this.canvas(e),i=r.toDataURL();console.log(`[Pixi Texture] ${r.width}px ${r.height}px`);const s=["font-size: 1px;",`padding: ${n}px 300px;`,`background: url(${i}) no-repeat;`,"background-size: contain;"].join(" ");console.log("%c ",s)}destroy(){this._renderer=null}};_b.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"extract"};_b.defaultImageOptions={format:"png",quality:1};let rO=_b;class Nm extends X{static create(e){return new Nm({source:new dt(e)})}resize(e,n,r){return this.source.resize(e,n,r),this}}const B9=new Ke,M9=new Kt,D9=[0,0,0,0];class xb{constructor(e){this._renderer=e}generateTexture(e){e instanceof $e&&(e={target:e,frame:void 0,textureSourceOptions:{},resolution:void 0});const n=e.resolution||this._renderer.resolution,r=e.antialias||this._renderer.view.antialias,i=e.target;let s=e.clearColor;s?s=Array.isArray(s)&&s.length===4?s:ve.shared.setValue(s).toArray():s=D9;const o=e.frame?.copyTo(B9)||sm(i,M9).rectangle;o.width=Math.max(o.width,1/n)|0,o.height=Math.max(o.height,1/n)|0;const a=Nm.create({...e.textureSourceOptions,width:o.width,height:o.height,resolution:n,antialias:r}),c=ae.shared.translate(-o.x,-o.y);return this._renderer.render({container:i,transform:c,target:a,clearColor:s}),a.source.updateMipmaps(),a}destroy(){this._renderer=null}}xb.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"textureGenerator"};function O9(t,e,n,r){n[r++]=(t>>16&255)/255,n[r++]=(t>>8&255)/255,n[r++]=(t&255)/255,n[r++]=e}function _h(t,e,n){const r=(t>>24&255)/255;e[n++]=(t&255)/255*r,e[n++]=(t>>8&255)/255*r,e[n++]=(t>>16&255)/255*r,e[n++]=r}class yb{constructor(e){this._stackIndex=0,this._globalUniformDataStack=[],this._uniformsPool=[],this._activeUniforms=[],this._bindGroupPool=[],this._activeBindGroups=[],this._renderer=e}reset(){this._stackIndex=0;for(let e=0;e<this._activeUniforms.length;e++)this._uniformsPool.push(this._activeUniforms[e]);for(let e=0;e<this._activeBindGroups.length;e++)this._bindGroupPool.push(this._activeBindGroups[e]);this._activeUniforms.length=0,this._activeBindGroups.length=0}start(e){this.reset(),this.push(e)}bind({size:e,projectionMatrix:n,worldTransformMatrix:r,worldColor:i,offset:s}){const o=this._renderer.renderTarget.renderTarget,a=this._stackIndex?this._globalUniformDataStack[this._stackIndex-1]:{projectionData:o,worldTransformMatrix:new ae,worldColor:4294967295,offset:new ze},c={projectionMatrix:n||this._renderer.renderTarget.projectionMatrix,resolution:e||o.size,worldTransformMatrix:r||a.worldTransformMatrix,worldColor:i||a.worldColor,offset:s||a.offset,bindGroup:null},h=this._uniformsPool.pop()||this._createUniforms();this._activeUniforms.push(h);const f=h.uniforms;f.uProjectionMatrix=c.projectionMatrix,f.uResolution=c.resolution,f.uWorldTransformMatrix.copyFrom(c.worldTransformMatrix),f.uWorldTransformMatrix.tx-=c.offset.x,f.uWorldTransformMatrix.ty-=c.offset.y,_h(c.worldColor,f.uWorldColorAlpha,0),h.update();let p;this._renderer.renderPipes.uniformBatch?p=this._renderer.renderPipes.uniformBatch.getUniformBindGroup(h,!1):(p=this._bindGroupPool.pop()||new mi,this._activeBindGroups.push(p),p.setResource(h,0)),c.bindGroup=p,this._currentGlobalUniformData=c}push(e){this.bind(e),this._globalUniformDataStack[this._stackIndex++]=this._currentGlobalUniformData}pop(){this._currentGlobalUniformData=this._globalUniformDataStack[--this._stackIndex-1],this._renderer.type===Fn.WEBGL&&this._currentGlobalUniformData.bindGroup.resources[0].update()}get bindGroup(){return this._currentGlobalUniformData.bindGroup}get uniformGroup(){return this._currentGlobalUniformData.bindGroup.resources[0]}_createUniforms(){return new Tt({uProjectionMatrix:{value:new ae,type:"mat3x3<f32>"},uWorldTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uWorldColorAlpha:{value:new Float32Array(4),type:"vec4<f32>"},uResolution:{value:[0,0],type:"vec2<f32>"}},{isStatic:!0})}destroy(){this._renderer=null}}yb.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"globalUniforms"};let k9=1;class bb{constructor(){this._tasks=[]}init(){at.system.add(this._update,this)}repeat(e,n){const r=k9++;return this._tasks.push({func:e,duration:n,start:performance.now(),last:performance.now(),repeat:!0,id:r}),r}cancel(e){for(let n=0;n<this._tasks.length;n++)if(this._tasks[n].id===e){this._tasks.splice(n,1);return}}_update(){const e=performance.now();for(let n=0;n<this._tasks.length;n++){const r=this._tasks[n];if(e-r.last>=r.duration){const i=e-r.start;r.func(i),r.last=e}}}destroy(){at.system.remove(this._update,this),this._tasks.length=0}}bb.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"scheduler",priority:0};let MT=!1;function iO(t){if(!MT){if(Ce.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`%c  %c  %c  %c  %c PixiJS %c v${Fc} (${t}) http://www.pixijs.com/

`,"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];globalThis.console.log(...e)}else globalThis.console&&globalThis.console.log(`PixiJS ${Fc} - ${t} - http://www.pixijs.com/`);MT=!0}}class Gm{constructor(e){this._renderer=e}init(e){if(e.hello){let n=this._renderer.name;this._renderer.type===Fn.WEBGL&&(n+=` ${this._renderer.context.webGLVersion}`),iO(n)}}}Gm.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"hello",priority:-2};Gm.defaultOptions={hello:!1};const Sb=class sO{constructor(e){this._managedRenderables=[],this._renderer=e}init(e){e={...sO.defaultOptions,...e},this.maxUnusedTime=e.renderableGCMaxUnusedTime,this._frequency=e.renderableGCFrequency,this.enabled=e.renderableGCActive}get enabled(){return!!this._handler}set enabled(e){this.enabled!==e&&(e?this._handler=this._renderer.scheduler.repeat(()=>this.run(),this._frequency):this._renderer.scheduler.cancel(this._handler))}prerender(){this._now=performance.now()}addRenderable(e,n){this.enabled&&(e._lastUsed=this._now,e._lastInstructionTick===-1&&(this._managedRenderables.push(e),e.once("destroyed",this._removeRenderable,this)),e._lastInstructionTick=n.tick)}run(){const e=performance.now(),n=this._managedRenderables,r=this._renderer.renderPipes;let i=0;for(let s=0;s<n.length;s++){const o=n[s];if(o===null){i++;continue}const c=(o.renderGroup??o.parentRenderGroup)?.instructionSet?.tick??-1;o._lastInstructionTick!==c&&e-o._lastUsed>this.maxUnusedTime?(o.destroyed||r[o.renderPipeId].destroyRenderable(o),o._lastInstructionTick=-1,i++,o.off("destroyed",this._removeRenderable,this)):n[s-i]=o}n.length=n.length-i}destroy(){this.enabled=!1,this._renderer=null,this._managedRenderables.length=0}_removeRenderable(e){const n=this._managedRenderables.indexOf(e);n>=0&&(e.off("destroyed",this._removeRenderable,this),this._managedRenderables[n]=null)}};Sb.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"renderableGC"};Sb.defaultOptions={renderableGCActive:!0,renderableGCMaxUnusedTime:6e4,renderableGCFrequency:3e4};let oO=Sb;const wb=class aO{constructor(e){this._renderer=e,this.count=0,this.checkCount=0}init(e){e={...aO.defaultOptions,...e},this.checkCountMax=e.textureGCCheckCountMax,this.maxIdle=e.textureGCAMaxIdle??e.textureGCMaxIdle,this.active=e.textureGCActive}postrender(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this._renderer.texture.managedTextures;for(let n=0;n<e.length;n++){const r=e[n];r.autoGarbageCollect&&r.resource&&r._touched>-1&&this.count-r._touched>this.maxIdle&&(r._touched=-1,r.unload())}}destroy(){this._renderer=null}};wb.extension={type:[P.WebGLSystem,P.WebGPUSystem],name:"textureGC"};wb.defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:60*60,textureGCCheckCountMax:600};let uO=wb;const Cb=class lO{get autoDensity(){return this.texture.source.autoDensity}set autoDensity(e){this.texture.source.autoDensity=e}get resolution(){return this.texture.source._resolution}set resolution(e){this.texture.source.resize(this.texture.source.width,this.texture.source.height,e)}init(e){e={...lO.defaultOptions,...e},e.view&&(q(ge,"ViewSystem.view has been renamed to ViewSystem.canvas"),e.canvas=e.view),this.screen=new Ke(0,0,e.width,e.height),this.canvas=e.canvas||Ce.get().createCanvas(),this.antialias=!!e.antialias,this.texture=q1(this.canvas,e),this.renderTarget=new Cp({colorTextures:[this.texture],depth:!!e.depth,isRoot:!0}),this.texture.source.transparent=e.backgroundAlpha<1,this.resolution=e.resolution}resize(e,n,r){this.texture.source.resize(e,n,r),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}destroy(e=!1){(typeof e=="boolean"?e:!!e?.removeView)&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}};Cb.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"view",priority:0};Cb.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};let Tb=Cb;const Eb=[tO,yb,Gm,Tb,pb,uO,xb,rO,Ny,oO,bb],Ab=[vb,M1,mb,ub,D1,k1,O1,ob],F9=[...Eb,Y1,_D,pD,F1,rb,Q1,N1,tb,eb,H1,HD,V1,z1],I9=[...Ab],U9=[P1,sb,ib],cO=[],hO=[],fO=[];Ne.handleByNamedList(P.WebGLSystem,cO);Ne.handleByNamedList(P.WebGLPipes,hO);Ne.handleByNamedList(P.WebGLPipesAdaptor,fO);Ne.add(...F9,...I9,...U9);class dO extends oh{constructor(){const e={name:"webgl",type:Fn.WEBGL,systems:cO,renderPipes:hO,renderPipeAdaptors:fO};super(e)}}const L9=Object.freeze(Object.defineProperty({__proto__:null,WebGLRenderer:dO},Symbol.toStringTag,{value:"Module"}));class Pb{constructor(e){this._hash=Object.create(null),this._renderer=e}contextChange(e){this._gpu=e}getBindGroup(e,n,r){return e._updateKey(),this._hash[e._key]||this._createBindGroup(e,n,r)}_createBindGroup(e,n,r){const i=this._gpu.device,s=n.layout[r],o=[],a=this._renderer;for(const f in s){const p=e.resources[f]??e.resources[s[f]];let v;if(p._resourceType==="uniformGroup"){const _=p;a.ubo.updateUniformGroup(_);const y=_.buffer;v={buffer:a.buffer.getGPUBuffer(y),offset:0,size:y.descriptor.size}}else if(p._resourceType==="buffer"){const _=p;v={buffer:a.buffer.getGPUBuffer(_),offset:0,size:_.descriptor.size}}else if(p._resourceType==="bufferResource"){const _=p;v={buffer:a.buffer.getGPUBuffer(_.buffer),offset:_.offset,size:_.size}}else if(p._resourceType==="textureSampler"){const _=p;v=a.texture.getGpuSampler(_)}else if(p._resourceType==="textureSource"){const _=p;v=a.texture.getGpuSource(_).createView({})}o.push({binding:s[f],resource:v})}const c=a.shader.getProgramData(n).bindGroups[r],h=i.createBindGroup({layout:c,entries:o});return this._hash[e._key]=h,h}destroy(){for(const e of Object.keys(this._hash))this._hash[e]=null;this._hash=null,this._renderer=null}}Pb.extension={type:[P.WebGPUSystem],name:"bindGroup"};class Rb{constructor(){this._gpuBuffers=Object.create(null),this._managedBuffers=[]}contextChange(e){this._gpu=e}getGPUBuffer(e){return this._gpuBuffers[e.uid]||this.createGPUBuffer(e)}updateBuffer(e){const n=this._gpuBuffers[e.uid]||this.createGPUBuffer(e),r=e.data;return e._updateID&&r&&(e._updateID=0,this._gpu.device.queue.writeBuffer(n,0,r.buffer,0,(e._updateSize||r.byteLength)+3&-4)),n}destroyAll(){for(const e in this._gpuBuffers)this._gpuBuffers[e].destroy();this._gpuBuffers={}}createGPUBuffer(e){this._gpuBuffers[e.uid]||(e.on("update",this.updateBuffer,this),e.on("change",this.onBufferChange,this),e.on("destroy",this.onBufferDestroy,this),this._managedBuffers.push(e));const n=this._gpu.device.createBuffer(e.descriptor);return e._updateID=0,e.data&&(mp(e.data.buffer,n.getMappedRange()),n.unmap()),this._gpuBuffers[e.uid]=n,n}onBufferChange(e){this._gpuBuffers[e.uid].destroy(),e._updateID=0,this._gpuBuffers[e.uid]=this.createGPUBuffer(e)}onBufferDestroy(e){this._managedBuffers.splice(this._managedBuffers.indexOf(e),1),this._destroyBuffer(e)}destroy(){this._managedBuffers.forEach(e=>this._destroyBuffer(e)),this._managedBuffers=null,this._gpuBuffers=null}_destroyBuffer(e){this._gpuBuffers[e.uid].destroy(),e.off("update",this.updateBuffer,this),e.off("change",this.onBufferChange,this),e.off("destroy",this.onBufferDestroy,this),this._gpuBuffers[e.uid]=null}}Rb.extension={type:[P.WebGPUSystem],name:"buffer"};function N9(t,e){const n=t.descriptor.size,r=e.gpu.device,i=new Yn({data:new Float32Array(24e5),usage:Re.MAP_READ|Re.COPY_DST}),s=e.buffer.createGPUBuffer(i),o=r.createCommandEncoder();o.copyBufferToBuffer(e.buffer.getGPUBuffer(t),0,s,0,n),r.queue.submit([o.finish()]),s.mapAsync(GPUMapMode.READ,0,n).then(()=>{s.getMappedRange(0,n),s.unmap()})}class pO{constructor({minUniformOffsetAlignment:e}){this._minUniformOffsetAlignment=256,this.byteIndex=0,this._minUniformOffsetAlignment=e,this.data=new Float32Array(65535)}clear(){this.byteIndex=0}addEmptyGroup(e){if(e>this._minUniformOffsetAlignment/4)throw new Error(`UniformBufferBatch: array is too large: ${e*4}`);const n=this.byteIndex;let r=n+e*4;if(r=Math.ceil(r/this._minUniformOffsetAlignment)*this._minUniformOffsetAlignment,r>this.data.length*4)throw new Error("UniformBufferBatch: ubo batch got too big");return this.byteIndex=r,n}addGroup(e){const n=this.addEmptyGroup(e.length);for(let r=0;r<e.length;r++)this.data[n/4+r]=e[r];return n}destroy(){this._buffer.destroy(),this._buffer=null,this.data=null}}class Bb{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.pipeline.setColorMask(e))}destroy(){this._renderer=null,this._colorMaskCache=null}}Bb.extension={type:[P.WebGPUSystem],name:"colorMask"};class zm{constructor(e){this._renderer=e}async init(e){return this._initPromise?this._initPromise:(this._initPromise=this._createDeviceAndAdaptor(e).then(n=>{this.gpu=n,this._renderer.runners.contextChange.emit(this.gpu)}),this._initPromise)}contextChange(e){this._renderer.gpu=e}async _createDeviceAndAdaptor(e){const n=await Ce.get().getNavigator().gpu.requestAdapter({powerPreference:e.powerPreference,forceFallbackAdapter:e.forceFallbackAdapter}),r=["texture-compression-bc","texture-compression-astc","texture-compression-etc2"].filter(s=>n.features.has(s)),i=await n.requestDevice({requiredFeatures:r});return{adapter:n,device:i}}destroy(){this.gpu=null,this._renderer=null}}zm.extension={type:[P.WebGPUSystem],name:"device"};zm.defaultOptions={powerPreference:void 0,forceFallbackAdapter:!1};class Mb{constructor(e){this._boundBindGroup=Object.create(null),this._boundVertexBuffer=Object.create(null),this._renderer=e}renderStart(){this.commandFinished=new Promise(e=>{this._resolveCommandFinished=e}),this.commandEncoder=this._renderer.gpu.device.createCommandEncoder()}beginRenderPass(e){this.endRenderPass(),this._clearCache(),this.renderPassEncoder=this.commandEncoder.beginRenderPass(e.descriptor)}endRenderPass(){this.renderPassEncoder&&this.renderPassEncoder.end(),this.renderPassEncoder=null}setViewport(e){this.renderPassEncoder.setViewport(e.x,e.y,e.width,e.height,0,1)}setPipelineFromGeometryProgramAndState(e,n,r,i){const s=this._renderer.pipeline.getPipeline(e,n,r,i);this.setPipeline(s)}setPipeline(e){this._boundPipeline!==e&&(this._boundPipeline=e,this.renderPassEncoder.setPipeline(e))}_setVertexBuffer(e,n){this._boundVertexBuffer[e]!==n&&(this._boundVertexBuffer[e]=n,this.renderPassEncoder.setVertexBuffer(e,this._renderer.buffer.updateBuffer(n)))}_setIndexBuffer(e){if(this._boundIndexBuffer===e)return;this._boundIndexBuffer=e;const n=e.data.BYTES_PER_ELEMENT===2?"uint16":"uint32";this.renderPassEncoder.setIndexBuffer(this._renderer.buffer.updateBuffer(e),n)}resetBindGroup(e){this._boundBindGroup[e]=null}setBindGroup(e,n,r){if(this._boundBindGroup[e]===n)return;this._boundBindGroup[e]=n,n._touch(this._renderer.textureGC.count);const i=this._renderer.bindGroup.getBindGroup(n,r,e);this.renderPassEncoder.setBindGroup(e,i)}setGeometry(e,n){const r=this._renderer.pipeline.getBufferNamesToBind(e,n);for(const i in r)this._setVertexBuffer(i,e.attributes[r[i]].buffer);e.indexBuffer&&this._setIndexBuffer(e.indexBuffer)}_setShaderBindGroups(e,n){for(const r in e.groups){const i=e.groups[r];n||this._syncBindGroup(i),this.setBindGroup(r,i,e.gpuProgram)}}_syncBindGroup(e){for(const n in e.resources){const r=e.resources[n];r.isUniformGroup&&this._renderer.ubo.updateUniformGroup(r)}}draw(e){const{geometry:n,shader:r,state:i,topology:s,size:o,start:a,instanceCount:c,skipSync:h}=e;this.setPipelineFromGeometryProgramAndState(n,r.gpuProgram,i,s),this.setGeometry(n,r.gpuProgram),this._setShaderBindGroups(r,h),n.indexBuffer?this.renderPassEncoder.drawIndexed(o||n.indexBuffer.data.length,c||n.instanceCount,a||0):this.renderPassEncoder.draw(o||n.getSize(),c||n.instanceCount,a||0)}finishRenderPass(){this.renderPassEncoder&&(this.renderPassEncoder.end(),this.renderPassEncoder=null)}postrender(){this.finishRenderPass(),this._gpu.device.queue.submit([this.commandEncoder.finish()]),this._resolveCommandFinished(),this.commandEncoder=null}restoreRenderPass(){const e=this._renderer.renderTarget.adaptor.getDescriptor(this._renderer.renderTarget.renderTarget,!1,[0,0,0,1]);this.renderPassEncoder=this.commandEncoder.beginRenderPass(e);const n=this._boundPipeline,r={...this._boundVertexBuffer},i=this._boundIndexBuffer,s={...this._boundBindGroup};this._clearCache();const o=this._renderer.renderTarget.viewport;this.renderPassEncoder.setViewport(o.x,o.y,o.width,o.height,0,1),this.setPipeline(n);for(const a in r)this._setVertexBuffer(a,r[a]);for(const a in s)this.setBindGroup(a,s[a],null);this._setIndexBuffer(i)}_clearCache(){for(let e=0;e<16;e++)this._boundBindGroup[e]=null,this._boundVertexBuffer[e]=null;this._boundIndexBuffer=null,this._boundPipeline=null}destroy(){this._renderer=null,this._gpu=null,this._boundBindGroup=null,this._boundVertexBuffer=null,this._boundIndexBuffer=null,this._boundPipeline=null}contextChange(e){this._gpu=e}}Mb.extension={type:[P.WebGPUSystem],name:"encoder",priority:1};class Db{constructor(e){this._renderTargetStencilState=Object.create(null),this._renderer=e,e.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(e){let n=this._renderTargetStencilState[e.uid];n||(n=this._renderTargetStencilState[e.uid]={stencilMode:Rt.DISABLED,stencilReference:0}),this._activeRenderTarget=e,this.setStencilMode(n.stencilMode,n.stencilReference)}setStencilMode(e,n){const r=this._renderTargetStencilState[this._activeRenderTarget.uid];r.stencilMode=e,r.stencilReference=n;const i=this._renderer;i.pipeline.setStencilMode(e),i.encoder.renderPassEncoder.setStencilReference(n)}destroy(){this._renderer.renderTarget.onRenderTargetChange.remove(this),this._renderer=null,this._activeRenderTarget=null,this._renderTargetStencilState=null}}Db.extension={type:[P.WebGPUSystem],name:"stencil"};const oc={i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},f16:{align:2,size:2},"vec2<i32>":{align:8,size:8},"vec2<u32>":{align:8,size:8},"vec2<f32>":{align:8,size:8},"vec2<f16>":{align:4,size:4},"vec3<i32>":{align:16,size:12},"vec3<u32>":{align:16,size:12},"vec3<f32>":{align:16,size:12},"vec3<f16>":{align:8,size:6},"vec4<i32>":{align:16,size:16},"vec4<u32>":{align:16,size:16},"vec4<f32>":{align:16,size:16},"vec4<f16>":{align:8,size:8},"mat2x2<f32>":{align:8,size:16},"mat2x2<f16>":{align:4,size:8},"mat3x2<f32>":{align:8,size:24},"mat3x2<f16>":{align:4,size:12},"mat4x2<f32>":{align:8,size:32},"mat4x2<f16>":{align:4,size:16},"mat2x3<f32>":{align:16,size:32},"mat2x3<f16>":{align:8,size:16},"mat3x3<f32>":{align:16,size:48},"mat3x3<f16>":{align:8,size:24},"mat4x3<f32>":{align:16,size:64},"mat4x3<f16>":{align:8,size:32},"mat2x4<f32>":{align:16,size:32},"mat2x4<f16>":{align:8,size:16},"mat3x4<f32>":{align:16,size:48},"mat3x4<f16>":{align:8,size:24},"mat4x4<f32>":{align:16,size:64},"mat4x4<f16>":{align:8,size:32}};function mO(t){const e=t.map(r=>({data:r,offset:0,size:0}));let n=0;for(let r=0;r<e.length;r++){const i=e[r];let s=oc[i.data.type].size;const o=oc[i.data.type].align;if(!oc[i.data.type])throw new Error(`[Pixi.js] WebGPU UniformBuffer: Unknown type ${i.data.type}`);i.data.size>1&&(s=Math.max(s,o)*i.data.size),n=Math.ceil(n/o)*o,i.size=s,i.offset=n,n+=s}return n=Math.ceil(n/16)*16,{uboElements:e,size:n}}function gO(t,e){const{size:n,align:r}=oc[t.data.type],i=(r-n)/4;return`
         v = uv.${t.data.name};
         ${e!==0?`offset += ${e};`:""}

         arrayOffset = offset;

         t = 0;

         for(var i=0; i < ${t.data.size*(n/4)}; i++)
         {
             for(var j = 0; j < ${n/4}; j++)
             {
                 data[arrayOffset++] = v[t++];
             }
             ${i!==0?`arrayOffset += ${i};`:""}
         }
     `}function vO(t){return $1(t,"uboWgsl",gO,bD)}class Ob extends j1{constructor(){super({createUboElements:mO,generateUboSync:vO})}}Ob.extension={type:[P.WebGPUSystem],name:"ubo"};const ws=128;class kb{constructor(e){this._bindGroupHash=Object.create(null),this._buffers=[],this._bindGroups=[],this._bufferResources=[],this._renderer=e,this._batchBuffer=new pO({minUniformOffsetAlignment:ws});const n=256/ws;for(let r=0;r<n;r++){let i=Re.UNIFORM|Re.COPY_DST;r===0&&(i|=Re.COPY_SRC),this._buffers.push(new Yn({data:this._batchBuffer.data,usage:i}))}}renderEnd(){this._uploadBindGroups(),this._resetBindGroups()}_resetBindGroups(){for(const e in this._bindGroupHash)this._bindGroupHash[e]=null;this._batchBuffer.clear()}getUniformBindGroup(e,n){if(!n&&this._bindGroupHash[e.uid])return this._bindGroupHash[e.uid];this._renderer.ubo.ensureUniformGroup(e);const r=e.buffer.data,i=this._batchBuffer.addEmptyGroup(r.length);return this._renderer.ubo.syncUniformGroup(e,this._batchBuffer.data,i/4),this._bindGroupHash[e.uid]=this._getBindGroup(i/ws),this._bindGroupHash[e.uid]}getUboResource(e){this._renderer.ubo.updateUniformGroup(e);const n=e.buffer.data,r=this._batchBuffer.addGroup(n);return this._getBufferResource(r/ws)}getArrayBindGroup(e){const n=this._batchBuffer.addGroup(e);return this._getBindGroup(n/ws)}getArrayBufferResource(e){const r=this._batchBuffer.addGroup(e)/ws;return this._getBufferResource(r)}_getBufferResource(e){if(!this._bufferResources[e]){const n=this._buffers[e%2];this._bufferResources[e]=new Im({buffer:n,offset:(e/2|0)*256,size:ws})}return this._bufferResources[e]}_getBindGroup(e){if(!this._bindGroups[e]){const n=new mi({0:this._getBufferResource(e)});this._bindGroups[e]=n}return this._bindGroups[e]}_uploadBindGroups(){const e=this._renderer.buffer,n=this._buffers[0];n.update(this._batchBuffer.byteIndex),e.updateBuffer(n);const r=this._renderer.gpu.device.createCommandEncoder();for(let i=1;i<this._buffers.length;i++){const s=this._buffers[i];r.copyBufferToBuffer(e.getGPUBuffer(n),ws,e.getGPUBuffer(s),0,this._batchBuffer.byteIndex)}this._renderer.gpu.device.queue.submit([r.finish()])}destroy(){for(let e=0;e<this._bindGroups.length;e++)this._bindGroups[e].destroy();this._bindGroups=null,this._bindGroupHash=null;for(let e=0;e<this._buffers.length;e++)this._buffers[e].destroy();this._buffers=null;for(let e=0;e<this._bufferResources.length;e++)this._bufferResources[e].destroy();this._bufferResources=null,this._batchBuffer.destroy(),this._bindGroupHash=null,this._renderer=null}}kb.extension={type:[P.WebGPUPipes],name:"uniformBatch"};const G9={"point-list":0,"line-list":1,"line-strip":2,"triangle-list":3,"triangle-strip":4};function z9(t,e,n,r,i){return t<<24|e<<16|n<<10|r<<5|i}function H9(t,e,n,r){return n<<6|t<<3|r<<1|e}class Fb{constructor(e){this._moduleCache=Object.create(null),this._bufferLayoutsCache=Object.create(null),this._bindingNamesCache=Object.create(null),this._pipeCache=Object.create(null),this._pipeStateCaches=Object.create(null),this._colorMask=15,this._multisampleCount=1,this._renderer=e}contextChange(e){this._gpu=e,this.setStencilMode(Rt.DISABLED),this._updatePipeHash()}setMultisampleCount(e){this._multisampleCount!==e&&(this._multisampleCount=e,this._updatePipeHash())}setRenderTarget(e){this._multisampleCount=e.msaaSamples,this._depthStencilAttachment=e.descriptor.depthStencilAttachment?1:0,this._updatePipeHash()}setColorMask(e){this._colorMask!==e&&(this._colorMask=e,this._updatePipeHash())}setStencilMode(e){this._stencilMode!==e&&(this._stencilMode=e,this._stencilState=ro[e],this._updatePipeHash())}setPipeline(e,n,r,i){const s=this.getPipeline(e,n,r);i.setPipeline(s)}getPipeline(e,n,r,i){e._layoutKey||(U1(e,n.attributeData),this._generateBufferKey(e)),i=i||e.topology;const s=z9(e._layoutKey,n._layoutKey,r.data,r._blendModeId,G9[i]);return this._pipeCache[s]?this._pipeCache[s]:(this._pipeCache[s]=this._createPipeline(e,n,r,i),this._pipeCache[s])}_createPipeline(e,n,r,i){const s=this._gpu.device,o=this._createVertexBufferLayouts(e,n),a=this._renderer.state.getColorTargets(r);a[0].writeMask=this._stencilMode===Rt.RENDERING_MASK_ADD?0:this._colorMask;const c=this._renderer.shader.getProgramData(n).pipeline,h={vertex:{module:this._getModule(n.vertex.source),entryPoint:n.vertex.entryPoint,buffers:o},fragment:{module:this._getModule(n.fragment.source),entryPoint:n.fragment.entryPoint,targets:a},primitive:{topology:i,cullMode:r.cullMode},layout:c,multisample:{count:this._multisampleCount},label:"PIXI Pipeline"};return this._depthStencilAttachment&&(h.depthStencil={...this._stencilState,format:"depth24plus-stencil8",depthWriteEnabled:r.depthTest,depthCompare:r.depthTest?"less":"always"}),s.createRenderPipeline(h)}_getModule(e){return this._moduleCache[e]||this._createModule(e)}_createModule(e){const n=this._gpu.device;return this._moduleCache[e]=n.createShaderModule({code:e}),this._moduleCache[e]}_generateBufferKey(e){const n=[];let r=0;const i=Object.keys(e.attributes).sort();for(let o=0;o<i.length;o++){const a=e.attributes[i[o]];n[r++]=a.offset,n[r++]=a.format,n[r++]=a.stride,n[r++]=a.instance}const s=n.join("|");return e._layoutKey=Au(s,"geometry"),e._layoutKey}_generateAttributeLocationsKey(e){const n=[];let r=0;const i=Object.keys(e.attributeData).sort();for(let o=0;o<i.length;o++){const a=e.attributeData[i[o]];n[r++]=a.location}const s=n.join("|");return e._attributeLocationsKey=Au(s,"programAttributes"),e._attributeLocationsKey}getBufferNamesToBind(e,n){const r=e._layoutKey<<16|n._attributeLocationsKey;if(this._bindingNamesCache[r])return this._bindingNamesCache[r];const i=this._createVertexBufferLayouts(e,n),s=Object.create(null),o=n.attributeData;for(let a=0;a<i.length;a++)for(const c in o)if(o[c].location===a){s[a]=c;break}return this._bindingNamesCache[r]=s,s}_createVertexBufferLayouts(e,n){n._attributeLocationsKey||this._generateAttributeLocationsKey(n);const r=e._layoutKey<<16|n._attributeLocationsKey;if(this._bufferLayoutsCache[r])return this._bufferLayoutsCache[r];const i=[];return e.buffers.forEach(s=>{const o={arrayStride:0,stepMode:"vertex",attributes:[]},a=o.attributes;for(const c in n.attributeData){const h=e.attributes[c];(h.divisor??1)!==1&&de(`Attribute ${c} has an invalid divisor value of '${h.divisor}'. WebGPU only supports a divisor value of 1`),h.buffer===s&&(o.arrayStride=h.stride,o.stepMode=h.instance?"instance":"vertex",a.push({shaderLocation:n.attributeData[c].location,offset:h.offset,format:h.format}))}a.length&&i.push(o)}),this._bufferLayoutsCache[r]=i,i}_updatePipeHash(){const e=H9(this._stencilMode,this._multisampleCount,this._colorMask,this._depthStencilAttachment);this._pipeStateCaches[e]||(this._pipeStateCaches[e]=Object.create(null)),this._pipeCache=this._pipeStateCaches[e]}destroy(){this._renderer=null,this._bufferLayoutsCache=null}}Fb.extension={type:[P.WebGPUSystem],name:"pipeline"};class _O{constructor(){this.contexts=[],this.msaaTextures=[],this.msaaSamples=1}}class xO{init(e,n){this._renderer=e,this._renderTargetSystem=n}copyToTexture(e,n,r,i,s){const o=this._renderer,a=this._getGpuColorTexture(e),c=o.texture.getGpuSource(n.source);return o.encoder.commandEncoder.copyTextureToTexture({texture:a,origin:r},{texture:c,origin:s},i),n}startRenderPass(e,n=!0,r,i){const o=this._renderTargetSystem.getGpuRenderTarget(e),a=this.getDescriptor(e,n,r);o.descriptor=a,this._renderer.pipeline.setRenderTarget(o),this._renderer.encoder.beginRenderPass(o),this._renderer.encoder.setViewport(i)}finishRenderPass(){this._renderer.encoder.endRenderPass()}_getGpuColorTexture(e){const n=this._renderTargetSystem.getGpuRenderTarget(e);return n.contexts[0]?n.contexts[0].getCurrentTexture():this._renderer.texture.getGpuSource(e.colorTextures[0].source)}getDescriptor(e,n,r){typeof n=="boolean"&&(n=n?Bn.ALL:Bn.NONE);const i=this._renderTargetSystem,s=i.getGpuRenderTarget(e),o=e.colorTextures.map((h,f)=>{const p=s.contexts[f];let v,_;p?v=p.getCurrentTexture().createView():v=this._renderer.texture.getGpuSource(h).createView({mipLevelCount:1}),s.msaaTextures[f]&&(_=v,v=this._renderer.texture.getTextureView(s.msaaTextures[f]));const y=n&Bn.COLOR?"clear":"load";return r??(r=i.defaultClearColor),{view:v,resolveTarget:_,clearValue:r,storeOp:"store",loadOp:y}});let a;if((e.stencil||e.depth)&&!e.depthStencilTexture&&(e.ensureDepthStencilTexture(),e.depthStencilTexture.source.sampleCount=s.msaa?4:1),e.depthStencilTexture){const h=n&Bn.STENCIL?"clear":"load",f=n&Bn.DEPTH?"clear":"load";a={view:this._renderer.texture.getGpuSource(e.depthStencilTexture.source).createView(),stencilStoreOp:"store",stencilLoadOp:h,depthClearValue:1,depthLoadOp:f,depthStoreOp:"store"}}return{colorAttachments:o,depthStencilAttachment:a}}clear(e,n=!0,r,i){if(!n)return;const{gpu:s,encoder:o}=this._renderer,a=s.device;if(o.commandEncoder===null){const h=a.createCommandEncoder(),f=this.getDescriptor(e,n,r),p=h.beginRenderPass(f);p.setViewport(i.x,i.y,i.width,i.height,0,1),p.end();const v=h.finish();a.queue.submit([v])}else this.startRenderPass(e,n,r,i)}initGpuRenderTarget(e){e.isRoot=!0;const n=new _O;return e.colorTextures.forEach((r,i)=>{if(ns.test(r.resource)){const s=r.resource.getContext("webgpu"),o=r.transparent?"premultiplied":"opaque";try{s.configure({device:this._renderer.gpu.device,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,format:"bgra8unorm",alphaMode:o})}catch(a){console.error(a)}n.contexts[i]=s}if(n.msaa=r.source.antialias,r.source.antialias){const s=new dt({width:0,height:0,sampleCount:4});n.msaaTextures[i]=s}}),n.msaa&&(n.msaaSamples=4,e.depthStencilTexture&&(e.depthStencilTexture.source.sampleCount=4)),n}destroyGpuRenderTarget(e){e.contexts.forEach(n=>{n.unconfigure()}),e.msaaTextures.forEach(n=>{n.destroy()}),e.msaaTextures.length=0,e.contexts.length=0}ensureDepthStencilTexture(e){const n=this._renderTargetSystem.getGpuRenderTarget(e);e.depthStencilTexture&&n.msaa&&(e.depthStencilTexture.source.sampleCount=4)}resizeGpuRenderTarget(e){const n=this._renderTargetSystem.getGpuRenderTarget(e);n.width=e.width,n.height=e.height,n.msaa&&e.colorTextures.forEach((r,i)=>{n.msaaTextures[i]?.resize(r.source.width,r.source.height,r.source._resolution)})}}class Ib extends K1{constructor(e){super(e),this.adaptor=new xO,this.adaptor.init(e,this)}}Ib.extension={type:[P.WebGPUSystem],name:"renderTarget"};class Ub{constructor(){this._gpuProgramData=Object.create(null)}contextChange(e){this._gpu=e,this.maxTextures=e.device.limits.maxSampledTexturesPerShaderStage}getProgramData(e){return this._gpuProgramData[e._layoutKey]||this._createGPUProgramData(e)}_createGPUProgramData(e){const n=this._gpu.device,r=e.gpuLayout.map(s=>n.createBindGroupLayout({entries:s})),i={bindGroupLayouts:r};return this._gpuProgramData[e._layoutKey]={bindGroups:r,pipeline:n.createPipelineLayout(i)},this._gpuProgramData[e._layoutKey]}destroy(){this._gpu=null,this._gpuProgramData=null}}Ub.extension={type:[P.WebGPUSystem],name:"shader"};const vn={};vn.normal={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}};vn.add={alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one",operation:"add"}};vn.multiply={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"dst",dstFactor:"one-minus-src-alpha",operation:"add"}};vn.screen={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}};vn.overlay={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}};vn.none={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"zero",operation:"add"}};vn["normal-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}};vn["add-npm"]={alpha:{srcFactor:"one",dstFactor:"one",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"}};vn["screen-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src",operation:"add"}};vn.erase={alpha:{srcFactor:"zero",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"one-minus-src",operation:"add"}};vn.min={alpha:{srcFactor:"one",dstFactor:"one",operation:"min"},color:{srcFactor:"one",dstFactor:"one",operation:"min"}};vn.max={alpha:{srcFactor:"one",dstFactor:"one",operation:"max"},color:{srcFactor:"one",dstFactor:"one",operation:"max"}};class Lb{constructor(){this.defaultState=new jr,this.defaultState.blend=!0}contextChange(e){this.gpu=e}getColorTargets(e){return[{format:"bgra8unorm",writeMask:0,blend:vn[e.blendMode]||vn.normal}]}destroy(){this.gpu=null}}Lb.extension={type:[P.WebGPUSystem],name:"state"};const yO={type:"image",upload(t,e,n){const r=t.resource,i=(t.pixelWidth|0)*(t.pixelHeight|0),s=r.byteLength/i;n.device.queue.writeTexture({texture:e},r,{offset:0,rowsPerImage:t.pixelHeight,bytesPerRow:t.pixelHeight*s},{width:t.pixelWidth,height:t.pixelHeight,depthOrArrayLayers:1})}},Nb={"bc1-rgba-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"bc2-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc3-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc7-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"etc1-rgb-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"etc2-rgba8unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"astc-4x4-unorm":{blockBytes:16,blockWidth:4,blockHeight:4}},V9={blockBytes:4,blockWidth:1,blockHeight:1},bO={type:"compressed",upload(t,e,n){let r=t.pixelWidth,i=t.pixelHeight;const s=Nb[t.format]||V9;for(let o=0;o<t.resource.length;o++){const a=t.resource[o],c=Math.ceil(r/s.blockWidth)*s.blockBytes;n.device.queue.writeTexture({texture:e,mipLevel:o},a,{offset:0,bytesPerRow:c},{width:Math.ceil(r/s.blockWidth)*s.blockWidth,height:Math.ceil(i/s.blockHeight)*s.blockHeight,depthOrArrayLayers:1}),r=Math.max(r>>1,1),i=Math.max(i>>1,1)}}},Gb={type:"image",upload(t,e,n){const r=t.resource;if(!r)return;const i=Math.min(e.width,t.resourceWidth||t.pixelWidth),s=Math.min(e.height,t.resourceHeight||t.pixelHeight),o=t.alphaMode==="premultiply-alpha-on-upload";n.device.queue.copyExternalImageToTexture({source:r},{texture:e,premultipliedAlpha:o},{width:i,height:s})}},SO={type:"video",upload(t,e,n){Gb.upload(t,e,n)}};class wO{constructor(e){this.device=e,this.sampler=e.createSampler({minFilter:"linear"}),this.pipelines={}}_getMipmapPipeline(e){let n=this.pipelines[e];return n||(this.mipmapShaderModule||(this.mipmapShaderModule=this.device.createShaderModule({code:`
                        var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(
                        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));

                        struct VertexOutput {
                        @builtin(position) position : vec4<f32>,
                        @location(0) texCoord : vec2<f32>,
                        };

                        @vertex
                        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {
                        var output : VertexOutput;
                        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);
                        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);
                        return output;
                        }

                        @group(0) @binding(0) var imgSampler : sampler;
                        @group(0) @binding(1) var img : texture_2d<f32>;

                        @fragment
                        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {
                        return textureSample(img, imgSampler, texCoord);
                        }
                    `})),n=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.mipmapShaderModule,entryPoint:"vertexMain"},fragment:{module:this.mipmapShaderModule,entryPoint:"fragmentMain",targets:[{format:e}]}}),this.pipelines[e]=n),n}generateMipmap(e){const n=this._getMipmapPipeline(e.format);if(e.dimension==="3d"||e.dimension==="1d")throw new Error("Generating mipmaps for non-2d textures is currently unsupported!");let r=e;const i=e.depthOrArrayLayers||1,s=e.usage&GPUTextureUsage.RENDER_ATTACHMENT;if(!s){const c={size:{width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:i},format:e.format,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT,mipLevelCount:e.mipLevelCount-1};r=this.device.createTexture(c)}const o=this.device.createCommandEncoder({}),a=n.getBindGroupLayout(0);for(let c=0;c<i;++c){let h=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:"2d",baseArrayLayer:c,arrayLayerCount:1}),f=s?1:0;for(let p=1;p<e.mipLevelCount;++p){const v=r.createView({baseMipLevel:f++,mipLevelCount:1,dimension:"2d",baseArrayLayer:c,arrayLayerCount:1}),_=o.beginRenderPass({colorAttachments:[{view:v,storeOp:"store",loadOp:"clear",clearValue:{r:0,g:0,b:0,a:0}}]}),y=this.device.createBindGroup({layout:a,entries:[{binding:0,resource:this.sampler},{binding:1,resource:h}]});_.setPipeline(n),_.setBindGroup(0,y),_.draw(3,1,0,0),_.end(),h=v}}if(!s){const c={width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:i};for(let h=1;h<e.mipLevelCount;++h)o.copyTextureToTexture({texture:r,mipLevel:h-1},{texture:e,mipLevel:h},c),c.width=Math.ceil(c.width/2),c.height=Math.ceil(c.height/2)}return this.device.queue.submit([o.finish()]),s||r.destroy(),e}}class zb{constructor(e){this.managedTextures=[],this._gpuSources=Object.create(null),this._gpuSamplers=Object.create(null),this._bindGroupHash=Object.create(null),this._textureViewHash=Object.create(null),this._uploads={image:Gb,buffer:yO,video:SO,compressed:bO},this._renderer=e}contextChange(e){this._gpu=e}initSource(e){if(e.autoGenerateMipmaps){const c=Math.max(e.pixelWidth,e.pixelHeight);e.mipLevelCount=Math.floor(Math.log2(c))+1}let n=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST;e.uploadMethodId!=="compressed"&&(n|=GPUTextureUsage.RENDER_ATTACHMENT,n|=GPUTextureUsage.COPY_SRC);const r=Nb[e.format]||{blockBytes:4,blockWidth:1,blockHeight:1},i=Math.ceil(e.pixelWidth/r.blockWidth)*r.blockWidth,s=Math.ceil(e.pixelHeight/r.blockHeight)*r.blockHeight,o={label:e.label,size:{width:i,height:s},format:e.format,sampleCount:e.sampleCount,mipLevelCount:e.mipLevelCount,dimension:e.dimension,usage:n},a=this._gpu.device.createTexture(o);return this._gpuSources[e.uid]=a,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceResize,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),a}onSourceUpdate(e){const n=this.getGpuSource(e);n&&(this._uploads[e.uploadMethodId]&&this._uploads[e.uploadMethodId].upload(e,n,this._gpu),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e))}onSourceUnload(e){const n=this._gpuSources[e.uid];n&&(this._gpuSources[e.uid]=null,n.destroy())}onUpdateMipmaps(e){this._mipmapGenerator||(this._mipmapGenerator=new wO(this._gpu.device));const n=this.getGpuSource(e);this._mipmapGenerator.generateMipmap(n)}onSourceDestroy(e){e.off("update",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("destroy",this.onSourceDestroy,this),e.off("resize",this.onSourceResize,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}onSourceResize(e){const n=this._gpuSources[e.uid];n?(n.width!==e.pixelWidth||n.height!==e.pixelHeight)&&(this._textureViewHash[e.uid]=null,this._bindGroupHash[e.uid]=null,this.onSourceUnload(e),this.initSource(e)):this.initSource(e)}_initSampler(e){return this._gpuSamplers[e._resourceId]=this._gpu.device.createSampler(e),this._gpuSamplers[e._resourceId]}getGpuSampler(e){return this._gpuSamplers[e._resourceId]||this._initSampler(e)}getGpuSource(e){return this._gpuSources[e.uid]||this.initSource(e)}getTextureBindGroup(e){return this._bindGroupHash[e.uid]??this._createTextureBindGroup(e)}_createTextureBindGroup(e){const n=e.source;return this._bindGroupHash[e.uid]=new mi({0:n,1:n.style,2:new Tt({uTextureMatrix:{type:"mat3x3<f32>",value:e.textureMatrix.mapCoord}})}),this._bindGroupHash[e.uid]}getTextureView(e){const n=e.source;return this._textureViewHash[n.uid]??this._createTextureView(n)}_createTextureView(e){return this._textureViewHash[e.uid]=this.getGpuSource(e).createView(),this._textureViewHash[e.uid]}generateCanvas(e){const n=this._renderer,r=n.gpu.device.createCommandEncoder(),i=Ce.get().createCanvas();i.width=e.source.pixelWidth,i.height=e.source.pixelHeight;const s=i.getContext("webgpu");return s.configure({device:n.gpu.device,usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC,format:Ce.get().getNavigator().gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),r.copyTextureToTexture({texture:n.texture.getGpuSource(e.source),origin:{x:0,y:0}},{texture:s.getCurrentTexture()},{width:i.width,height:i.height}),n.gpu.device.queue.submit([r.finish()]),i}getPixels(e){const n=this.generateCanvas(e),r=gi.getOptimalCanvasAndContext(n.width,n.height),i=r.context;i.drawImage(n,0,0);const{width:s,height:o}=n,a=i.getImageData(0,0,s,o),c=new Uint8ClampedArray(a.data.buffer);return gi.returnCanvasAndContext(r),{pixels:c,width:s,height:o}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null;for(const e of Object.keys(this._bindGroupHash)){const n=Number(e);this._bindGroupHash[n]?.destroy(),this._bindGroupHash[n]=null}this._gpu=null,this._mipmapGenerator=null,this._gpuSources=null,this._bindGroupHash=null,this._textureViewHash=null,this._gpuSamplers=null}}zb.extension={type:[P.WebGPUSystem],name:"texture"};class Hb{init(){const e=new Tt({uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),n=zu({name:"graphics",bits:[_m,ym(ta()),aD,Vu]});this.shader=new Sr({gpuProgram:n,resources:{localUniforms:e}})}execute(e,n){const r=n.context,i=r.customShader||this.shader,s=e.renderer,o=s.graphicsContext,{batcher:a,instructions:c}=o.getContextRenderData(r),h=s.encoder;h.setPipelineFromGeometryProgramAndState(a.geometry,i.gpuProgram,e.state),h.setGeometry(a.geometry,i.gpuProgram);const f=s.globalUniforms.bindGroup;h.setBindGroup(0,f,i.gpuProgram);const p=s.renderPipes.uniformBatch.getUniformBindGroup(i.resources.localUniforms,!0);h.setBindGroup(2,p,i.gpuProgram);const v=c.instructions;for(let _=0;_<c.instructionSize;_++){const y=v[_];if(i.groups[1]=y.bindGroup,!y.gpuBindGroup){const S=y.textures;y.bindGroup=vm(S.textures,S.count),y.gpuBindGroup=s.bindGroup.getBindGroup(y.bindGroup,i.gpuProgram,1)}h.setBindGroup(1,y.bindGroup,i.gpuProgram),h.renderPassEncoder.drawIndexed(y.size,1,y.start)}}destroy(){this.shader.destroy(!0),this.shader=null}}Hb.extension={type:[P.WebGPUPipesAdaptor],name:"graphics"};class Vb{init(){const e=zu({name:"mesh",bits:[vu,uD,Vu]});this._shader=new Sr({gpuProgram:e,resources:{uTexture:X.EMPTY._source,uSampler:X.EMPTY._source.style,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new ae}}}})}execute(e,n){const r=e.renderer;let i=n._shader;if(!i)i=this._shader,i.groups[2]=r.texture.getTextureBindGroup(n.texture);else if(!i.gpuProgram){de("Mesh shader has no gpuProgram",n.shader);return}const s=i.gpuProgram;if(s.autoAssignGlobalUniforms&&(i.groups[0]=r.globalUniforms.bindGroup),s.autoAssignLocalUniforms){const o=e.localUniforms;i.groups[1]=r.renderPipes.uniformBatch.getUniformBindGroup(o,!0)}r.encoder.draw({geometry:n._geometry,shader:i,state:n.state})}destroy(){this._shader.destroy(!0),this._shader=null}}Vb.extension={type:[P.WebGPUPipesAdaptor],name:"mesh"};const j9=[...Eb,Ob,Mb,zm,Rb,zb,Ib,Ub,Lb,Fb,Bb,Db,Pb],W9=[...Ab,kb],$9=[R1,Vb,Hb],CO=[],TO=[],EO=[];Ne.handleByNamedList(P.WebGPUSystem,CO);Ne.handleByNamedList(P.WebGPUPipes,TO);Ne.handleByNamedList(P.WebGPUPipesAdaptor,EO);Ne.add(...j9,...W9,...$9);class AO extends oh{constructor(){const e={name:"webgpu",type:Fn.WEBGPU,systems:CO,renderPipes:TO,renderPipeAdaptors:EO};super(e)}}const X9=Object.freeze(Object.defineProperty({__proto__:null,WebGPURenderer:AO},Symbol.toStringTag,{value:"Module"})),DT={POINTS:"point-list",LINES:"line-list",LINE_STRIP:"line-strip",TRIANGLES:"triangle-list",TRIANGLE_STRIP:"triangle-strip"},Y9=new Proxy(DT,{get(t,e){return q(ge,`DRAW_MODES.${e} is deprecated, use '${DT[e]}' instead`),t[e]}}),q9=new Ke(0,0,1,1);function K9(t,e,n){n||(n=q9);const r=e.pixelWidth,i=e.pixelHeight;return t.x=n.x*r|0,t.y=n.y*i|0,t.width=n.width*r|0,t.height=n.height*i|0,t}var PO=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(PO||{}),Tp=(t=>(t.CLAMP="clamp-to-edge",t.REPEAT="repeat",t.MIRRORED_REPEAT="mirror-repeat",t))(Tp||{});const Q9=new Proxy(Tp,{get(t,e){return q(ge,`DRAW_MODES.${e} is deprecated, use '${Tp[e]}' instead`),t[e]}});var Ep=(t=>(t.NEAREST="nearest",t.LINEAR="linear",t))(Ep||{});const Z9=new Proxy(Ep,{get(t,e){return q(ge,`DRAW_MODES.${e} is deprecated, use '${Ep[e]}' instead`),t[e]}});class J9{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,n,r){const i=n.width,s=n.height;if(r){const o=e.width/2/i,a=e.height/2/s,c=e.x/i+o,h=e.y/s+a;r=we.add(r,we.NW),this.x0=c+o*we.uX(r),this.y0=h+a*we.uY(r),r=we.add(r,2),this.x1=c+o*we.uX(r),this.y1=h+a*we.uY(r),r=we.add(r,2),this.x2=c+o*we.uX(r),this.y2=h+a*we.uY(r),r=we.add(r,2),this.x3=c+o*we.uX(r),this.y3=h+a*we.uY(r)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[pixi.js/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}let e7=0;function t7(){return e7++}function n7(t){const e=t.toString(),n=e.indexOf("{"),r=e.lastIndexOf("}");if(n===-1||r===-1)throw new Error("getFunctionBody: No body found in function definition");return e.slice(n+1,r).trim()}class r7 extends $e{constructor(e){typeof e=="function"&&(e={render:e});const{render:n,...r}=e;super({label:"RenderContainer",...r}),this.batched=!1,this._lastUsed=0,this._lastInstructionTick=-1,this.bounds=new Kt,this.canBundle=!1,this.renderPipeId="customRender",n&&(this.render=n),this.containsPoint=e.containsPoint??(()=>!1),this.addBounds=e.addBounds??(()=>!1)}render(e){}}function i7(t,e){const n=e._scale,r=e._pivot,i=e._position,s=n._x,o=n._y,a=r._x,c=r._y;t.a=e._cx*s,t.b=e._sx*s,t.c=e._cy*o,t.d=e._sy*o,t.tx=i._x-(a*t.a+c*t.c),t.ty=i._y-(a*t.b+c*t.d)}function s7(t,e,n){const r=t.a,i=t.b,s=t.c,o=t.d,a=t.tx,c=t.ty,h=e.a,f=e.b,p=e.c,v=e.d;n.a=r*h+i*p,n.b=r*f+i*v,n.c=s*h+o*p,n.d=s*f+o*v,n.tx=a*h+c*p+e.tx,n.ty=a*f+c*v+e.ty}class RO{constructor(e,n){this.state=jr.for2d(),this._graphicsBatchesHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=e,this._adaptor=n,this._adaptor.init()}validateRenderable(e){const n=e.context,r=!!this._graphicsBatchesHash[e.uid],i=this.renderer.graphicsContext.updateGpuContext(n);return!!(i.isBatchable||r!==i.isBatchable)}addRenderable(e,n){const r=this.renderer.graphicsContext.updateGpuContext(e.context);e._didGraphicsUpdate&&(e._didGraphicsUpdate=!1,this._rebuild(e)),r.isBatchable?this._addToBatcher(e,n):(this.renderer.renderPipes.batch.break(n),n.add(e))}updateRenderable(e){const n=this._graphicsBatchesHash[e.uid];if(n)for(let r=0;r<n.length;r++){const i=n[r];i._batcher.updateElement(i)}}destroyRenderable(e){this._graphicsBatchesHash[e.uid]&&this._removeBatchForRenderable(e.uid),e.off("destroyed",this._destroyRenderableBound)}execute(e){if(!e.isRenderable)return;const n=this.renderer,r=e.context;if(!n.graphicsContext.getGpuContext(r).batches.length)return;const s=r.customShader||this._adaptor.shader;this.state.blendMode=e.groupBlendMode;const o=s.resources.localUniforms.uniforms;o.uTransformMatrix=e.groupTransform,o.uRound=n._roundPixels|e._roundPixels,_h(e.groupColorAlpha,o.uColor,0),this._adaptor.execute(this,e)}_rebuild(e){const n=!!this._graphicsBatchesHash[e.uid],r=this.renderer.graphicsContext.updateGpuContext(e.context);n&&this._removeBatchForRenderable(e.uid),r.isBatchable&&this._initBatchesForRenderable(e),e.batched=r.isBatchable}_addToBatcher(e,n){const r=this.renderer.renderPipes.batch,i=this._getBatchesForRenderable(e);for(let s=0;s<i.length;s++){const o=i[s];r.addToBatch(o,n)}}_getBatchesForRenderable(e){return this._graphicsBatchesHash[e.uid]||this._initBatchesForRenderable(e)}_initBatchesForRenderable(e){const n=e.context,r=this.renderer.graphicsContext.getGpuContext(n),i=this.renderer._roundPixels|e._roundPixels,s=r.batches.map(o=>{const a=Ae.get(Tm);return o.copyTo(a),a.renderable=e,a.roundPixels=i,a});return this._graphicsBatchesHash[e.uid]===void 0&&e.on("destroyed",this._destroyRenderableBound),this._graphicsBatchesHash[e.uid]=s,s}_removeBatchForRenderable(e){this._graphicsBatchesHash[e].forEach(n=>{Ae.return(n)}),this._graphicsBatchesHash[e]=null}destroy(){this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null;for(const e in this._graphicsBatchesHash)this._removeBatchForRenderable(e);this._graphicsBatchesHash=null}}RO.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"graphics"};const o7={rectangle:Xy,polygon:$y,triangle:Yy,circle:Yi,ellipse:Yi,roundedRectangle:Yi};function a7(t){t instanceof Ws&&(t={path:t,textureMatrix:null,out:null});const e=[],n=[],r=[],i=t.path.shapePath,s=t.textureMatrix;i.shapePrimitives.forEach(({shape:c,transform:h})=>{const f=r.length,p=e.length/2,v=[],_=o7[c.type];_.build(c,v),h&&Cm(v,h),_.triangulate(v,e,2,p,r,f);const y=n.length/2;s?(h&&s.append(h.clone().invert()),Vy(e,2,p,n,y,2,e.length/2-p,s)):jy(n,y,2,e.length/2-p)});const o=t.out;return o?(o.positions=new Float32Array(e),o.uvs=new Float32Array(n),o.indices=new Uint32Array(r),o):new no({positions:new Float32Array(e),uvs:new Float32Array(n),indices:new Uint32Array(r)})}const BO=class MO extends no{constructor(...e){super({});let n=e[0]??{};typeof n=="number"&&(q(ge,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),n={width:n,height:e[1],verticesX:e[2],verticesY:e[3]}),this.build(n)}build(e){e={...MO.defaultOptions,...e},this.verticesX=this.verticesX??e.verticesX,this.verticesY=this.verticesY??e.verticesY,this.width=this.width??e.width,this.height=this.height??e.height;const n=this.verticesX*this.verticesY,r=[],i=[],s=[],o=this.verticesX-1,a=this.verticesY-1,c=this.width/o,h=this.height/a;for(let p=0;p<n;p++){const v=p%this.verticesX,_=p/this.verticesX|0;r.push(v*c,_*h),i.push(v/o,_/a)}const f=o*a;for(let p=0;p<f;p++){const v=p%o,_=p/o|0,y=_*this.verticesX+v,S=_*this.verticesX+v+1,C=(_+1)*this.verticesX+v,b=(_+1)*this.verticesX+v+1;s.push(y,S,C,S,b,C)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint32Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};BO.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let Hm=BO;function DO(t,e,n,r){const i=n.buffers[0],s=i.data,{verticesX:o,verticesY:a}=n,c=t/(o-1),h=e/(a-1);let f=0;const p=r[0],v=r[1],_=r[2],y=r[3],S=r[4],C=r[5],b=r[6],w=r[7],T=r[8];for(let A=0;A<s.length;A+=2){const M=f%o*c,L=(f/o|0)*h,I=p*M+v*L+_,N=y*M+S*L+C,k=b*M+w*L+T;s[A]=I/k,s[A+1]=N/k,f++}i.update()}function OO(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],f=e[8];return t[0]=o*f-a*h,t[1]=i*h-r*f,t[2]=r*a-i*o,t[3]=a*c-s*f,t[4]=n*f-i*c,t[5]=i*s-n*a,t[6]=s*h-o*c,t[7]=r*c-n*h,t[8]=n*o-r*s,t}function kO(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],h=e[6],f=e[7],p=e[8],v=n[0],_=n[1],y=n[2],S=n[3],C=n[4],b=n[5],w=n[6],T=n[7],A=n[8];return t[0]=v*r+_*o+y*h,t[1]=v*i+_*a+y*f,t[2]=v*s+_*c+y*p,t[3]=S*r+C*o+b*h,t[4]=S*i+C*a+b*f,t[5]=S*s+C*c+b*p,t[6]=w*r+T*o+A*h,t[7]=w*i+T*a+A*f,t[8]=w*s+T*c+A*p,t}function u7(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r+e[1]*i+e[2]*s,t[1]=e[3]*r+e[4]*i+e[5]*s,t[2]=e[6]*r+e[7]*i+e[8]*s,t}const l7=[0,0,0,0,0,0,0,0,0],c7=[0,0,0],sd=[0,0,0];function OT(t,e,n,r,i,s,o,a,c){const h=l7;h[0]=e,h[1]=r,h[2]=s,h[3]=n,h[4]=i,h[5]=o,h[6]=1,h[7]=1,h[8]=1;const f=OO(t,h);sd[0]=a,sd[1]=c,sd[2]=1;const p=u7(c7,f,sd),v=t;return t[0]=p[0],t[1]=0,t[2]=0,t[3]=0,t[4]=p[1],t[5]=0,t[6]=0,t[7]=0,t[8]=p[2],kO(t,v,h)}const h7=[0,0,0,0,0,0,0,0,0],f7=[0,0,0,0,0,0,0,0,0];function FO(t,e,n,r,i,s,o,a,c,h,f,p,v,_,y,S,C){const b=OT(h7,e,n,s,o,h,f,_,y),w=OT(f7,r,i,a,c,p,v,S,C);return kO(t,OO(b,b),w)}class IO extends Hm{constructor(e){super(e),this._projectionMatrix=[0,0,0,0,0,0,0,0,0];const{width:n,height:r}=e;this.corners=[0,0,n,0,n,r,0,r]}setCorners(e,n,r,i,s,o,a,c){const h=this.corners;h[0]=e,h[1]=n,h[2]=r,h[3]=i,h[4]=s,h[5]=o,h[6]=a,h[7]=c,this.updateProjection()}updateProjection(){const{width:e,height:n}=this,r=this.corners,i=FO(this._projectionMatrix,0,0,r[0],r[1],e,0,r[2],r[3],e,n,r[4],r[5],0,n,r[6],r[7]);DO(e,n,this,i)}}const UO=class LO extends Wu{constructor(e){e={...LO.defaultOptions,...e};const{texture:n,verticesX:r,verticesY:i,...s}=e,o=new IO(Si({width:n.width,height:n.height,verticesX:r,verticesY:i}));super(Si({...s,geometry:o})),this._texture=n,this.geometry.setCorners(e.x0,e.y0,e.x1,e.y1,e.x2,e.y2,e.x3,e.y3)}textureUpdated(){const e=this.geometry;if(!e)return;const{width:n,height:r}=this.texture;(e.width!==n||e.height!==r)&&(e.width=n,e.height=r,e.updateProjection())}set texture(e){this._texture!==e&&(super.texture=e,this.textureUpdated())}get texture(){return this._texture}setCorners(e,n,r,i,s,o,a,c){this.geometry.setCorners(e,n,r,i,s,o,a,c)}};UO.defaultOptions={texture:X.WHITE,verticesX:10,verticesY:10,x0:0,y0:0,x1:100,y1:0,x2:100,y2:100,x3:0,y3:100};let d7=UO;class p7 extends Wu{constructor(e){const{texture:n,verticesX:r,verticesY:i,...s}=e,o=new Hm(Si({width:n.width,height:n.height,verticesX:r,verticesY:i}));super(Si({...s,geometry:o,texture:n})),this.texture=n,this.autoResize=!0}textureUpdated(){const e=this.geometry,{width:n,height:r}=this.texture;this.autoResize&&(e.width!==n||e.height!==r)&&(e.width=n,e.height=r,e.build({}))}set texture(e){this._texture?.off("update",this.textureUpdated,this),super.texture=e,e.on("update",this.textureUpdated,this),this.textureUpdated()}get texture(){return this._texture}destroy(e){this.texture.off("update",this.textureUpdated,this),super.destroy(e)}}const NO=class GO extends no{constructor(e){const{width:n,points:r,textureScale:i}={...GO.defaultOptions,...e};super({positions:new Float32Array(r.length*4),uvs:new Float32Array(r.length*4),indices:new Uint32Array((r.length-1)*6)}),this.points=r,this._width=n,this.textureScale=i,this._build()}get width(){return this._width}_build(){const e=this.points;if(!e)return;const n=this.getBuffer("aPosition"),r=this.getBuffer("aUV"),i=this.getIndex();if(e.length<1)return;n.data.length/4!==e.length&&(n.data=new Float32Array(e.length*4),r.data=new Float32Array(e.length*4),i.data=new Uint16Array((e.length-1)*6));const s=r.data,o=i.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;let a=0,c=e[0];const h=this._width*this.textureScale,f=e.length;for(let v=0;v<f;v++){const _=v*4;if(this.textureScale>0){const y=c.x-e[v].x,S=c.y-e[v].y,C=Math.sqrt(y*y+S*S);c=e[v],a+=C/h}else a=v/(f-1);s[_]=a,s[_+1]=0,s[_+2]=a,s[_+3]=1}let p=0;for(let v=0;v<f-1;v++){const _=v*2;o[p++]=_,o[p++]=_+1,o[p++]=_+2,o[p++]=_+2,o[p++]=_+1,o[p++]=_+3}r.update(),i.update(),this.updateVertices()}updateVertices(){const e=this.points;if(e.length<1)return;let n=e[0],r,i=0,s=0;const o=this.buffers[0].data,a=e.length,c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let h=0;h<a;h++){const f=e[h],p=h*4;h<e.length-1?r=e[h+1]:r=f,s=-(r.x-n.x),i=r.y-n.y;const v=Math.sqrt(i*i+s*s);v<1e-6?(i=0,s=0):(i/=v,s/=v,i*=c,s*=c),o[p]=f.x+i,o[p+1]=f.y+s,o[p+2]=f.x-i,o[p+3]=f.y-s,n=f}this.buffers[0].update()}update(){this.textureScale>0?this._build():this.updateVertices()}};NO.defaultOptions={width:200,points:[],textureScale:0};let zO=NO;const HO=class VO extends Wu{constructor(e){const{texture:n,points:r,textureScale:i,...s}={...VO.defaultOptions,...e},o=new zO(Si({width:n.height,points:r,textureScale:i}));i>0&&(n.source.style.addressMode="repeat"),super(Si({...s,texture:n,geometry:o})),this.autoUpdate=!0,this.onRender=this._render}_render(){const e=this.geometry;(this.autoUpdate||e._width!==this.texture.height)&&(e._width=this.texture.height,e.update())}};HO.defaultOptions={textureScale:0};let m7=HO;class g7 extends Wu{constructor(e){const{texture:n,vertices:r,uvs:i,indices:s,topology:o,...a}=e,c=new no(Si({positions:r,uvs:i,indices:s,topology:o}));super(Si({...a,texture:n,geometry:c})),this.autoUpdate=!0,this.onRender=this._render}get vertices(){return this.geometry.getBuffer("aPosition").data}set vertices(e){this.geometry.getBuffer("aPosition").data=e}_render(){this.autoUpdate&&this.geometry.getBuffer("aPosition").update()}}class Vm{constructor(){this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get uvs(){const n=this.geometry.getBuffer("aUV"),r=n.data;let i=r;const s=this.texture.textureMatrix;return s.isSimple||(i=this._transformedUvs,(this._textureMatrixUpdateId!==s._updateID||this._uvUpdateId!==n._updateID)&&((!i||i.length<r.length)&&(i=this._transformedUvs=new Float32Array(r.length)),this._textureMatrixUpdateId=s._updateID,this._uvUpdateId=n._updateID,s.multiplyUvs(r,i))),i}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}function v7(t,e){const{width:n,height:r}=t.frame;return e.scale(1/n,1/r),e}class jO{constructor(e,n){this.localUniforms=new Tt({uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new mi({0:this.localUniforms}),this._meshDataHash=Object.create(null),this._gpuBatchableMeshHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=e,this._adaptor=n,this._adaptor.init()}validateRenderable(e){const n=this._getMeshData(e),r=n.batched,i=e.batched;if(n.batched=i,r!==i)return!0;if(i){const s=e._geometry;if(s.indices.length!==n.indexSize||s.positions.length!==n.vertexSize)return n.indexSize=s.indices.length,n.vertexSize=s.positions.length,!0;const o=this._getBatchableMesh(e),a=e.texture;if(o.texture._source!==a._source&&o.texture._source!==a._source)return!o._batcher.checkAndUpdateTexture(o,a)}return!1}addRenderable(e,n){const r=this.renderer.renderPipes.batch,{batched:i}=this._getMeshData(e);if(i){const s=this._getBatchableMesh(e);s.texture=e._texture,s.geometry=e._geometry,r.addToBatch(s,n)}else r.break(n),n.add(e)}updateRenderable(e){if(e.batched){const n=this._gpuBatchableMeshHash[e.uid];n.texture=e._texture,n.geometry=e._geometry,n._batcher.updateElement(n)}}destroyRenderable(e){this._meshDataHash[e.uid]=null;const n=this._gpuBatchableMeshHash[e.uid];n&&(Ae.return(n),this._gpuBatchableMeshHash[e.uid]=null),e.off("destroyed",this._destroyRenderableBound)}execute(e){if(!e.isRenderable)return;e.state.blendMode=Ic(e.groupBlendMode,e.texture._source);const n=this.localUniforms;n.uniforms.uTransformMatrix=e.groupTransform,n.uniforms.uRound=this.renderer._roundPixels|e._roundPixels,n.update(),_h(e.groupColorAlpha,n.uniforms.uColor,0),this._adaptor.execute(this,e)}_getMeshData(e){return this._meshDataHash[e.uid]||this._initMeshData(e)}_initMeshData(e){return this._meshDataHash[e.uid]={batched:e.batched,indexSize:e._geometry.indices?.length,vertexSize:e._geometry.positions?.length},e.on("destroyed",this._destroyRenderableBound),this._meshDataHash[e.uid]}_getBatchableMesh(e){return this._gpuBatchableMeshHash[e.uid]||this._initBatchableMesh(e)}_initBatchableMesh(e){const n=Ae.get(Vm);return n.renderable=e,n.texture=e._texture,n.transform=e.groupTransform,n.roundPixels=this.renderer._roundPixels|e._roundPixels,this._gpuBatchableMeshHash[e.uid]=n,n}destroy(){for(const e in this._gpuBatchableMeshHash)this._gpuBatchableMeshHash[e]&&Ae.return(this._gpuBatchableMeshHash[e]);this._gpuBatchableMeshHash=null,this._meshDataHash=null,this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}jO.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"mesh"};const WO=class $O extends Hm{constructor(e={}){e={...$O.defaultOptions,...e},super({width:e.width,height:e.height,verticesX:4,verticesY:4}),this.update(e)}update(e){this.width=e.width??this.width,this.height=e.height??this.height,this._originalWidth=e.originalWidth??this._originalWidth,this._originalHeight=e.originalHeight??this._originalHeight,this._leftWidth=e.leftWidth??this._leftWidth,this._rightWidth=e.rightWidth??this._rightWidth,this._topHeight=e.topHeight??this._topHeight,this._bottomHeight=e.bottomHeight??this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){const e=this.positions,n=this._leftWidth+this._rightWidth,r=this.width>n?1:this.width/n,i=this._topHeight+this._bottomHeight,s=this.height>i?1:this.height/i,o=Math.min(r,s);e[9]=e[11]=e[13]=e[15]=this._topHeight*o,e[17]=e[19]=e[21]=e[23]=this.height-this._bottomHeight*o,e[25]=e[27]=e[29]=e[31]=this.height,e[2]=e[10]=e[18]=e[26]=this._leftWidth*o,e[4]=e[12]=e[20]=e[28]=this.width-this._rightWidth*o,e[6]=e[14]=e[22]=e[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){const e=this.uvs;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1;const n=1/this._originalWidth,r=1/this._originalHeight;e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.getBuffer("aUV").update()}};WO.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let Es=WO;const XO=class YO extends ea{constructor(e){e instanceof X&&(e={texture:e});const{width:n,height:r,leftWidth:i,rightWidth:s,topHeight:o,bottomHeight:a,texture:c,roundPixels:h,...f}=e;super({label:"NineSliceSprite",...f}),this.renderPipeId="nineSliceSprite",this.batched=!0,this._didSpriteUpdate=!0,this._leftWidth=i??c?.defaultBorders?.left??Es.defaultOptions.leftWidth,this._topHeight=o??c?.defaultBorders?.top??Es.defaultOptions.topHeight,this._rightWidth=s??c?.defaultBorders?.right??Es.defaultOptions.rightWidth,this._bottomHeight=a??c?.defaultBorders?.bottom??Es.defaultOptions.bottomHeight,this.bounds.maxX=this._width=n??c.width??Es.defaultOptions.width,this.bounds.maxY=this._height=r??c.height??Es.defaultOptions.height,this.allowChildren=!1,this.texture=c??YO.defaultOptions.texture,this.roundPixels=h??!1}get bounds(){return this._bounds}get width(){return this._width}set width(e){this.bounds.maxX=this._width=e,this.onViewUpdate()}get height(){return this._height}set height(e){this.bounds.maxY=this._height=e,this.onViewUpdate()}setSize(e,n){typeof e=="object"&&(n=e.height??e.width,e=e.width),this.bounds.maxX=this._width=e,this.bounds.maxY=this._height=n??e,this.onViewUpdate()}getSize(e){return e||(e={}),e.width=this._width,e.height=this._height,e}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this.onViewUpdate()}get texture(){return this._texture}set texture(e){e||(e=X.EMPTY);const n=this._texture;n!==e&&(n&&n.dynamic&&n.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}onViewUpdate(){if(this._didViewChangeTick++,this._didSpriteUpdate=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}addBounds(e){const n=this.bounds;e.addFrame(n.minX,n.minY,n.maxX,n.maxY)}destroy(e){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(r)}this._texture=null}};XO.defaultOptions={texture:X.EMPTY};let jb=XO;class _7 extends jb{constructor(...e){let n=e[0];n instanceof X&&(q(ge,"NineSlicePlane now uses the options object {texture, leftWidth, rightWidth, topHeight, bottomHeight}"),n={texture:n,leftWidth:e[1],topHeight:e[2],rightWidth:e[3],bottomHeight:e[4]}),q(ge,"NineSlicePlane is deprecated. Use NineSliceSprite instead."),super(n)}}class qO{constructor(e){this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}addRenderable(e,n){const r=this._getGpuSprite(e);e._didSpriteUpdate&&this._updateBatchableSprite(e,r),this._renderer.renderPipes.batch.addToBatch(r,n)}updateRenderable(e){const n=this._gpuSpriteHash[e.uid];e._didSpriteUpdate&&this._updateBatchableSprite(e,n),n._batcher.updateElement(n)}validateRenderable(e){const n=e._texture,r=this._getGpuSprite(e);return r.texture._source!==n._source?!r._batcher.checkAndUpdateTexture(r,n):!1}destroyRenderable(e){const n=this._gpuSpriteHash[e.uid];Ae.return(n.geometry),Ae.return(n),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_updateBatchableSprite(e,n){e._didSpriteUpdate=!1,n.geometry.update(e),n.texture=e._texture}_getGpuSprite(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const n=Ae.get(Vm);return n.geometry=Ae.get(Es),n.renderable=e,n.transform=e.groupTransform,n.texture=e._texture,n.roundPixels=this._renderer._roundPixels|e._roundPixels,e._didSpriteUpdate=!0,this._gpuSpriteHash[e.uid]=n,e.on("destroyed",this._destroyRenderableBound),n}destroy(){for(const e in this._gpuSpriteHash)this._gpuSpriteHash[e].geometry.destroy();this._gpuSpriteHash=null,this._renderer=null}}qO.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"nineSliceSprite"};const KO={name:"tiling-bit",vertex:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`
            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;

            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;
        `},fragment:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`

            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);
            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;
            var unclamped = coord;
            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);

            var bias = 0.;

            if(unclamped.x == coord.x && unclamped.y == coord.y)
            {
                bias = -32.;
            } 

            outColor = textureSampleBias(uTexture, uSampler, coord, bias);
        `}},QO={name:"tiling-bit",vertex:{header:`
            uniform mat3 uTextureTransform;
            uniform vec4 uSizeAnchor;
        
        `,main:`
            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;

            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;
        `},fragment:{header:`
            uniform sampler2D uTexture;
            uniform mat3 uMapCoord;
            uniform vec4 uClampFrame;
            uniform vec2 uClampOffset;
        `,main:`

        vec2 coord = vUV + ceil(uClampOffset - vUV);
        coord = (uMapCoord * vec3(coord, 1.0)).xy;
        vec2 unclamped = coord;
        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);
        
        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0
    
        `}};let wv,Cv;class ZO extends Sr{constructor(){wv??(wv=zu({name:"tiling-sprite-shader",bits:[vu,KO,Vu]})),Cv??(Cv=Hu({name:"tiling-sprite-shader",bits:[Fm,QO,ju]}));const e=new Tt({uMapCoord:{value:new ae,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new ae,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}});super({glProgram:Cv,gpuProgram:wv,resources:{localUniforms:new Tt({uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:e,uTexture:X.EMPTY.source,uSampler:X.EMPTY.source.style}})}updateUniforms(e,n,r,i,s,o){const a=this.resources.tilingUniforms,c=o.width,h=o.height,f=o.textureMatrix,p=a.uniforms.uTextureTransform;p.set(r.a*c/e,r.b*c/n,r.c*h/e,r.d*h/n,r.tx/e,r.ty/n),p.invert(),a.uniforms.uMapCoord=f.mapCoord,a.uniforms.uClampFrame=f.uClampFrame,a.uniforms.uClampOffset=f.uClampOffset,a.uniforms.uTextureTransform=p,a.uniforms.uSizeAnchor[0]=e,a.uniforms.uSizeAnchor[1]=n,a.uniforms.uSizeAnchor[2]=i,a.uniforms.uSizeAnchor[3]=s,o&&(this.resources.uTexture=o.source,this.resources.uSampler=o.source.style)}}class JO extends no{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}}function ek(t,e){const n=t.anchor.x,r=t.anchor.y;e[0]=-n*t.width,e[1]=-r*t.height,e[2]=(1-n)*t.width,e[3]=-r*t.height,e[4]=(1-n)*t.width,e[5]=(1-r)*t.height,e[6]=-n*t.width,e[7]=(1-r)*t.height}function tk(t,e,n,r){let i=0;const s=t.length/(e||2),o=r.a,a=r.b,c=r.c,h=r.d,f=r.tx,p=r.ty;for(n*=e;i<s;){const v=t[n],_=t[n+1];t[n]=o*v+c*_+f,t[n+1]=a*v+h*_+p,n+=e,i++}}function nk(t,e){const n=t.texture,r=n.frame.width,i=n.frame.height;let s=0,o=0;t._applyAnchorToTexture&&(s=t.anchor.x,o=t.anchor.y),e[0]=e[6]=-s,e[2]=e[4]=1-s,e[1]=e[3]=-o,e[5]=e[7]=1-o;const a=ae.shared;a.copyFrom(t._tileTransform.matrix),a.tx/=t.width,a.ty/=t.height,a.invert(),a.scale(t.width/r,t.height/i),tk(e,2,0,a)}const od=new JO;class rk{constructor(e){this._state=jr.default2d,this._tilingSpriteDataHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}validateRenderable(e){const n=this._getTilingSpriteData(e),r=n.canBatch;this._updateCanBatch(e);const i=n.canBatch;if(i&&i===r){const{batchableMesh:s}=n;if(s&&s.texture._source!==e.texture._source)return!s._batcher.checkAndUpdateTexture(s,e.texture)}return r!==i}addRenderable(e,n){const r=this._renderer.renderPipes.batch;this._updateCanBatch(e);const i=this._getTilingSpriteData(e),{geometry:s,canBatch:o}=i;if(o){i.batchableMesh||(i.batchableMesh=new Vm);const a=i.batchableMesh;e._didTilingSpriteUpdate&&(e._didTilingSpriteUpdate=!1,this._updateBatchableMesh(e),a.geometry=s,a.renderable=e,a.transform=e.groupTransform,a.texture=e._texture),a.roundPixels=this._renderer._roundPixels|e._roundPixels,r.addToBatch(a,n)}else r.break(n),i.shader||(i.shader=new ZO),this.updateRenderable(e),n.add(e)}execute(e){const{shader:n}=this._tilingSpriteDataHash[e.uid];n.groups[0]=this._renderer.globalUniforms.bindGroup;const r=n.resources.localUniforms.uniforms;r.uTransformMatrix=e.groupTransform,r.uRound=this._renderer._roundPixels|e._roundPixels,_h(e.groupColorAlpha,r.uColor,0),this._state.blendMode=Ic(e.groupBlendMode,e.texture._source),this._renderer.encoder.draw({geometry:od,shader:n,state:this._state})}updateRenderable(e){const n=this._getTilingSpriteData(e),{canBatch:r}=n;if(r){const{batchableMesh:i}=n;e._didTilingSpriteUpdate&&this._updateBatchableMesh(e),i._batcher.updateElement(i)}else if(e._didTilingSpriteUpdate){const{shader:i}=n;i.updateUniforms(e.width,e.height,e._tileTransform.matrix,e.anchor.x,e.anchor.y,e.texture)}e._didTilingSpriteUpdate=!1}destroyRenderable(e){const n=this._getTilingSpriteData(e);n.batchableMesh=null,n.shader?.destroy(),this._tilingSpriteDataHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}_getTilingSpriteData(e){return this._tilingSpriteDataHash[e.uid]||this._initTilingSpriteData(e)}_initTilingSpriteData(e){const n=new no({indices:od.indices,positions:od.positions.slice(),uvs:od.uvs.slice()});return this._tilingSpriteDataHash[e.uid]={canBatch:!0,renderable:e,geometry:n},e.on("destroyed",this._destroyRenderableBound),this._tilingSpriteDataHash[e.uid]}_updateBatchableMesh(e){const n=this._getTilingSpriteData(e),{geometry:r}=n,i=e.texture.source.style;i.addressMode!=="repeat"&&(i.addressMode="repeat",i.update()),nk(e,r.uvs),ek(e,r.positions)}destroy(){for(const e in this._tilingSpriteDataHash)this.destroyRenderable(this._tilingSpriteDataHash[e].renderable);this._tilingSpriteDataHash=null,this._renderer=null}_updateCanBatch(e){const n=this._getTilingSpriteData(e),r=e.texture;let i=!0;return this._renderer.type===Fn.WEBGL&&(i=this._renderer.context.supports.nonPowOf2wrapping),n.canBatch=r.textureMatrix.isSimple&&(i||r.source.isPowerOfTwo),n.canBatch}}rk.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"tilingSprite"};const ik={name:"local-uniform-msdf-bit",vertex:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32,
                uRound:f32,
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `},fragment:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
         `,main:` 
            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));
        `}},sk={name:"local-uniform-msdf-bit",vertex:{header:`
            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix *= uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `},fragment:{header:`
            uniform float uDistance;
         `,main:` 
            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));
        `}},ok={name:"msdf-bit",fragment:{header:`
            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {
                
                // MSDF
                var median = msdfColor.r + msdfColor.g + msdfColor.b -
                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));
            
                // SDF
                median = min(median, msdfColor.a);

                var screenPxDistance = distance * (median - 0.5);
                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));
                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);
                var coverage: f32 = pow(shapeColor.a * alpha, gamma);

                return coverage;
             
            }
        `}},ak={name:"msdf-bit",fragment:{header:`
            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {
                
                // MSDF
                float median = msdfColor.r + msdfColor.g + msdfColor.b -
                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));
               
                // SDF
                median = min(median, msdfColor.a);
            
                float screenPxDistance = distance * (median - 0.5);
                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
           
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));
                float gamma = mix(1.0, 1.0 / 2.2, luma);
                float coverage = pow(shapeColor.a * alpha, gamma);  
              
                return coverage;
            }
        `}};let Tv,Ev;class uk extends Sr{constructor(){const e=new Tt({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new ae,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}}),n=ta();Tv??(Tv=zu({name:"sdf-shader",bits:[_m,ym(n),ik,ok,Vu]})),Ev??(Ev=Hu({name:"sdf-shader",bits:[xm,bm(n),sk,ak,ju]})),super({glProgram:Ev,gpuProgram:Tv,resources:{localUniforms:e,batchSamplers:Sm(n)}})}}class lk{constructor(e){this._gpuBitmapText={},this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e}validateRenderable(e){const n=this._getGpuBitmapText(e);return e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,n)),this._renderer.renderPipes.graphics.validateRenderable(n)}addRenderable(e,n){const r=this._getGpuBitmapText(e);kT(e,r),e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,r)),this._renderer.renderPipes.graphics.addRenderable(r,n),r.context.customShader&&this._updateDistanceField(e)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableByUid(e.uid)}_destroyRenderableByUid(e){const n=this._gpuBitmapText[e].context;n.customShader&&(Ae.return(n.customShader),n.customShader=null),Ae.return(this._gpuBitmapText[e]),this._gpuBitmapText[e]=null}updateRenderable(e){const n=this._getGpuBitmapText(e);kT(e,n),this._renderer.renderPipes.graphics.updateRenderable(n),n.context.customShader&&this._updateDistanceField(e)}_updateContext(e,n){const{context:r}=n,i=Gc.getFont(e.text,e._style);r.clear(),i.distanceField.type!=="none"&&(r.customShader||(r.customShader=Ae.get(uk)));const s=Array.from(e.text),o=e._style;let a=i.baseLineOffset;const c=r1(s,o,i,!0);let h=0;const f=o.padding,p=c.scale;let v=c.width,_=c.height+c.offsetY;o._stroke&&(v+=o._stroke.width/p,_+=o._stroke.width/p),r.translate(-e._anchor._x*v-f,-e._anchor._y*_-f).scale(p,p);const y=i.applyFillAsTint?o._fill.color:16777215;for(let S=0;S<c.lines.length;S++){const C=c.lines[S];for(let b=0;b<C.charPositions.length;b++){const w=s[h++],T=i.chars[w];T?.texture&&r.texture(T.texture,y||"black",Math.round(C.charPositions[b]+T.xOffset),Math.round(a+T.yOffset))}a+=i.lineHeight}}_getGpuBitmapText(e){return this._gpuBitmapText[e.uid]||this.initGpuText(e)}initGpuText(e){const n=Ae.get($s);return this._gpuBitmapText[e.uid]=n,this._updateContext(e,n),e.on("destroyed",this._destroyRenderableBound),this._gpuBitmapText[e.uid]}_updateDistanceField(e){const n=this._getGpuBitmapText(e).context,r=e._style.fontFamily,i=We.get(`${r}-bitmap`),{a:s,b:o,c:a,d:c}=e.groupTransform,h=Math.sqrt(s*s+o*o),f=Math.sqrt(a*a+c*c),p=(Math.abs(h)+Math.abs(f))/2,v=i.baseRenderedFontSize/e._style.fontSize,_=p*i.distanceField.range*(1/v);n.customShader.resources.localUniforms.uniforms.uDistance=_}destroy(){for(const e in this._gpuBitmapText)this._destroyRenderableByUid(e);this._gpuBitmapText=null,this._renderer=null}}lk.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"bitmapText"};function kT(t,e){e.groupTransform=t.groupTransform,e.groupColorAlpha=t.groupColorAlpha,e.groupColor=t.groupColor,e.groupBlendMode=t.groupBlendMode,e.globalDisplayStatus=t.globalDisplayStatus,e.groupTransform=t.groupTransform,e.localDisplayStatus=t.localDisplayStatus,e.groupAlpha=t.groupAlpha,e._roundPixels=t._roundPixels}class ck{constructor(e){this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.runners.resolutionChange.add(this)}resolutionChange(){for(const e in this._gpuText){const n=this._gpuText[e];if(!n)continue;const r=n.batchableSprite.renderable;r._autoResolution&&(r._resolution=this._renderer.resolution,r.onViewUpdate())}}validateRenderable(e){const n=this._getGpuText(e),r=e._getKey();return n.textureNeedsUploading?(n.textureNeedsUploading=!1,!0):n.currentKey!==r}addRenderable(e,n){const i=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(i,n)}updateRenderable(e){const r=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),r._batcher.updateElement(r)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}_destroyRenderableById(e){const n=this._gpuText[e];this._renderer.htmlText.decreaseReferenceCount(n.currentKey),Ae.return(n.batchableSprite),this._gpuText[e]=null}_updateText(e){const n=e._getKey(),r=this._getGpuText(e),i=r.batchableSprite;r.currentKey!==n&&this._updateGpuText(e).catch(o=>{console.error(o)}),e._didTextUpdate=!1;const s=e._style.padding;Ac(i.bounds,e._anchor,i.texture,s)}async _updateGpuText(e){e._didTextUpdate=!1;const n=this._getGpuText(e);if(n.generatingTexture)return;const r=e._getKey();this._renderer.htmlText.decreaseReferenceCount(n.currentKey),n.generatingTexture=!0,n.currentKey=r;const i=e.resolution??this._renderer.resolution,s=await this._renderer.htmlText.getManagedTexture(e.text,i,e._style,e._getKey()),o=n.batchableSprite;o.texture=n.texture=s,n.generatingTexture=!1,n.textureNeedsUploading=!0,e.onViewUpdate();const a=e._style.padding;Ac(o.bounds,e._anchor,o.texture,a)}_getGpuText(e){return this._gpuText[e.uid]||this.initGpuText(e)}initGpuText(e){const n={texture:X.EMPTY,currentKey:"--",batchableSprite:Ae.get(Lm),textureNeedsUploading:!1,generatingTexture:!1},r=n.batchableSprite;return r.renderable=e,r.transform=e.groupTransform,r.texture=X.EMPTY,r.bounds={minX:0,maxX:1,minY:0,maxY:0},r.roundPixels=this._renderer._roundPixels|e._roundPixels,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._gpuText[e.uid]=n,e.on("destroyed",this._destroyRenderableBound),n}destroy(){for(const e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}ck.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"htmlText"};function hk(){const{userAgent:t}=Ce.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}const x7=new Kt;function Wb(t,e,n,r){const i=x7;i.minX=0,i.minY=0,i.maxX=t.width/r|0,i.maxY=t.height/r|0;const s=Ge.getOptimalTexture(i.width,i.height,r,!1);return s.source.uploadMethodId="image",s.source.resource=t,s.source.alphaMode="premultiply-alpha-on-upload",s.frame.width=e/r,s.frame.height=n/r,s.source.emit("update",s.source),s.updateUvs(),s}function fk(t,e){const n=e.fontFamily,r=[],i={},s=/font-family:([^;"\s]+)/g,o=t.match(s);function a(c){i[c]||(r.push(c),i[c]=!0)}if(Array.isArray(n))for(let c=0;c<n.length;c++)a(n[c]);else a(n);o&&o.forEach(c=>{const h=c.split(":")[1].trim();a(h)});for(const c in e.tagStyles){const h=e.tagStyles[c].fontFamily;a(h)}return r}async function dk(t){const n=await(await Ce.get().fetch(t)).blob(),r=new FileReader;return await new Promise((s,o)=>{r.onloadend=()=>s(r.result),r.onerror=o,r.readAsDataURL(n)})}async function E2(t,e){const n=await dk(e);return`@font-face {
        font-family: "${t.fontFamily}";
        src: url('${n}');
        font-weight: ${t.fontWeight};
        font-style: ${t.fontStyle};
    }`}const Hl=new Map;async function pk(t,e,n){const r=t.filter(i=>We.has(`${i}-and-url`)).map((i,s)=>{if(!Hl.has(i)){const{url:o}=We.get(`${i}-and-url`);s===0?Hl.set(i,E2({fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:i},o)):Hl.set(i,E2({fontWeight:n.fontWeight,fontStyle:n.fontStyle,fontFamily:i},o))}return Hl.get(i)});return(await Promise.all(r)).join(`
`)}function mk(t,e,n,r,i){const{domElement:s,styleElement:o,svgRoot:a}=i;s.innerHTML=`<style>${e.cssStyle}</style><div style='padding:0;'>${t}</div>`,s.setAttribute("style",`transform: scale(${n});transform-origin: top left; display: inline-block`),o.textContent=r;const{width:c,height:h}=i.image;return a.setAttribute("width",c.toString()),a.setAttribute("height",h.toString()),new XMLSerializer().serializeToString(a)}function gk(t,e){const n=gi.getOptimalCanvasAndContext(t.width,t.height,e),{context:r}=n;return r.clearRect(0,0,t.width,t.height),r.drawImage(t,0,0),gi.returnCanvasAndContext(n),n.canvas}function vk(t,e,n){return new Promise(async r=>{n&&await new Promise(i=>setTimeout(i,100)),t.onload=()=>{r()},t.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(e)}`,t.crossOrigin="anonymous"})}class $b{constructor(e){this._activeTextures={},this._renderer=e,this._createCanvas=e.type===Fn.WEBGPU}getTexture(e){return this._buildTexturePromise(e.text,e.resolution,e.style)}getManagedTexture(e,n,r,i){if(this._activeTextures[i])return this._increaseReferenceCount(i),this._activeTextures[i].promise;const s=this._buildTexturePromise(e,n,r).then(o=>(this._activeTextures[i].texture=o,o));return this._activeTextures[i]={texture:null,promise:s,usageCount:1},s}async _buildTexturePromise(e,n,r){const i=Ae.get(E1),s=fk(e,r),o=await pk(s,r,Xo.defaultTextStyle),a=A1(e,r,o,i),c=Math.ceil(Math.ceil(Math.max(1,a.width)+r.padding*2)*n),h=Math.ceil(Math.ceil(Math.max(1,a.height)+r.padding*2)*n),f=i.image,p=2;f.width=(c|0)+p,f.height=(h|0)+p;const v=mk(e,r,n,o,i);await vk(f,v,hk()&&s.length>0);let _=f;this._createCanvas&&(_=gk(f,n));const y=Wb(_,f.width-p,f.height-p,n);return this._createCanvas&&this._renderer.texture.initSource(y.source),Ae.return(i),y}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}decreaseReferenceCount(e){const n=this._activeTextures[e];n&&(n.usageCount--,n.usageCount===0&&(n.texture?this._cleanUp(n):n.promise.then(r=>{n.texture=r,this._cleanUp(n)}).catch(()=>{de("HTMLTextSystem: Failed to clean texture")}),this._activeTextures[e]=null))}_cleanUp(e){Ge.returnTexture(e.texture),e.texture.source.resource=null,e.texture.source.uploadMethodId="unknown"}getReferenceCount(e){return this._activeTextures[e].usageCount}destroy(){this._activeTextures=null}}$b.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"htmlText"};$b.defaultFontOptions={fontFamily:"Arial",fontStyle:"normal",fontWeight:"normal"};class _k{constructor(e){this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=e,this._renderer.runners.resolutionChange.add(this)}resolutionChange(){for(const e in this._gpuText){const n=this._gpuText[e];if(!n)continue;const r=n.batchableSprite.renderable;r._autoResolution&&(r._resolution=this._renderer.resolution,r.onViewUpdate())}}validateRenderable(e){const n=this._getGpuText(e),r=e._getKey();if(n.currentKey!==r){const{width:i,height:s}=this._renderer.canvasText.getTextureSize(e.text,e.resolution,e._style);return!(this._renderer.canvasText.getReferenceCount(n.currentKey)===1&&i===n.texture._source.width&&s===n.texture._source.height)}return!1}addRenderable(e,n){const i=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(i,n)}updateRenderable(e){const r=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),r._batcher.updateElement(r)}destroyRenderable(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}_destroyRenderableById(e){const n=this._gpuText[e];this._renderer.canvasText.decreaseReferenceCount(n.currentKey),Ae.return(n.batchableSprite),this._gpuText[e]=null}_updateText(e){const n=e._getKey(),r=this._getGpuText(e),i=r.batchableSprite;r.currentKey!==n&&this._updateGpuText(e),e._didTextUpdate=!1;const s=e._style.padding;Ac(i.bounds,e._anchor,i.texture,s)}_updateGpuText(e){const n=this._getGpuText(e),r=n.batchableSprite;n.texture&&this._renderer.canvasText.decreaseReferenceCount(n.currentKey),n.texture=r.texture=this._renderer.canvasText.getManagedTexture(e),n.currentKey=e._getKey(),r.texture=n.texture}_getGpuText(e){return this._gpuText[e.uid]||this.initGpuText(e)}initGpuText(e){const n={texture:null,currentKey:"--",batchableSprite:Ae.get(Lm)};return n.batchableSprite.renderable=e,n.batchableSprite.transform=e.groupTransform,n.batchableSprite.bounds={minX:0,maxX:1,minY:0,maxY:0},n.batchableSprite.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuText[e.uid]=n,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._updateText(e),e.on("destroyed",this._destroyRenderableBound),n}destroy(){for(const e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}_k.extension={type:[P.WebGLPipes,P.WebGPUPipes,P.CanvasPipes],name:"text"};function FT(t,e,n){for(let r=0,i=4*n*e;r<e;++r,i+=4)if(t[i+3]!==0)return!1;return!0}function IT(t,e,n,r,i){const s=4*e;for(let o=r,a=r*s+4*n;o<=i;++o,a+=s)if(t[a+3]!==0)return!1;return!0}function xk(t,e=1){const{width:n,height:r}=t,i=t.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const o=i.getImageData(0,0,n,r).data;let a=0,c=0,h=n-1,f=r-1;for(;c<r&&FT(o,n,c);)++c;if(c===r)return Ke.EMPTY;for(;FT(o,n,f);)--f;for(;IT(o,n,a,c,f);)++a;for(;IT(o,n,h,c,f);)--h;return++h,++f,new Ke(a/e,c/e,(h-a)/e,(f-c)/e)}class yk{constructor(e){this._activeTextures={},this._renderer=e}getTextureSize(e,n,r){const i=Fr.measureText(e||" ",r);let s=Math.ceil(Math.ceil(Math.max(1,i.width)+r.padding*2)*n),o=Math.ceil(Math.ceil(Math.max(1,i.height)+r.padding*2)*n);return s=Math.ceil(s-1e-6),o=Math.ceil(o-1e-6),s=Vo(s),o=Vo(o),{width:s,height:o}}getTexture(e,n,r,i){typeof e=="string"&&(q("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),e={text:e,style:r,resolution:n}),e.style instanceof Qt||(e.style=new Qt(e.style));const{texture:s,canvasAndContext:o}=this.createTextureAndCanvas(e);return this._renderer.texture.initSource(s._source),gi.returnCanvasAndContext(o),s}createTextureAndCanvas(e){const{text:n,style:r}=e,i=e.resolution??this._renderer.resolution,s=Fr.measureText(n||" ",r),o=Math.ceil(Math.ceil(Math.max(1,s.width)+r.padding*2)*i),a=Math.ceil(Math.ceil(Math.max(1,s.height)+r.padding*2)*i),c=gi.getOptimalCanvasAndContext(o,a),{canvas:h}=c;this.renderTextToCanvas(n,r,i,c);const f=Wb(h,o,a,i);if(r.trim){const p=xk(h,i);f.frame.copyFrom(p),f.updateUvs()}return{texture:f,canvasAndContext:c}}getManagedTexture(e){e._resolution=e._autoResolution?this._renderer.resolution:e.resolution;const n=e._getKey();if(this._activeTextures[n])return this._increaseReferenceCount(n),this._activeTextures[n].texture;const{texture:r,canvasAndContext:i}=this.createTextureAndCanvas(e);return this._activeTextures[n]={canvasAndContext:i,texture:r,usageCount:1},r}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}decreaseReferenceCount(e){const n=this._activeTextures[e];if(n.usageCount--,n.usageCount===0){gi.returnCanvasAndContext(n.canvasAndContext),Ge.returnTexture(n.texture);const r=n.texture.source;r.resource=null,r.uploadMethodId="unknown",r.alphaMode="no-premultiply-alpha",this._activeTextures[e]=null}}getReferenceCount(e){return this._activeTextures[e].usageCount}renderTextToCanvas(e,n,r,i){const{canvas:s,context:o}=i,a=Lc(n),c=Fr.measureText(e||" ",n),h=c.lines,f=c.lineHeight,p=c.lineWidths,v=c.maxLineWidth,_=c.fontProperties,y=s.height;o.resetTransform(),o.scale(r,r);const S=n.padding*2;if(o.clearRect(0,0,c.width+4+S,c.height+4+S),n._stroke?.width){const T=n._stroke;o.lineWidth=T.width,o.miterLimit=T.miterLimit,o.lineJoin=T.join,o.lineCap=T.cap}o.font=a;let C,b;const w=n.dropShadow?2:1;for(let T=0;T<w;++T){const A=n.dropShadow&&T===0,M=A?Math.ceil(Math.max(1,y)+n.padding*2):0,L=M*r;if(A){o.fillStyle="black",o.strokeStyle="black";const k=n.dropShadow,G=k.color,ie=k.alpha;o.shadowColor=ve.shared.setValue(G).setAlpha(ie).toRgbaString();const Ze=k.blur*r,re=k.distance*r;o.shadowBlur=Ze,o.shadowOffsetX=Math.cos(k.angle)*re,o.shadowOffsetY=Math.sin(k.angle)*re+L}else o.globalAlpha=n._fill?.alpha??1,o.fillStyle=n._fill?Nc(n._fill,o):null,n._stroke?.width&&(o.strokeStyle=Nc(n._stroke,o)),o.shadowColor="black";let I=(f-_.fontSize)/2;f-_.fontSize<0&&(I=0);const N=n._stroke?.width??0;for(let k=0;k<h.length;k++)C=N/2,b=N/2+k*f+_.ascent+I,n.align==="right"?C+=v-p[k]:n.align==="center"&&(C+=(v-p[k])/2),n._stroke?.width&&this._drawLetterSpacing(h[k],n,i,C+n.padding,b+n.padding-M,!0),n._fill!==void 0&&this._drawLetterSpacing(h[k],n,i,C+n.padding,b+n.padding-M)}}_drawLetterSpacing(e,n,r,i,s,o=!1){const{context:a}=r,c=n.letterSpacing;let h=!1;if(Fr.experimentalLetterSpacingSupported&&(Fr.experimentalLetterSpacing?(a.letterSpacing=`${c}px`,a.textLetterSpacing=`${c}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),c===0||h){o?a.strokeText(e,i,s):a.fillText(e,i,s);return}let f=i;const p=Fr.graphemeSegmenter(e);let v=a.measureText(e).width,_=0;for(let y=0;y<p.length;++y){const S=p[y];o?a.strokeText(S,f,s):a.fillText(S,f,s);let C="";for(let b=y+1;b<p.length;++b)C+=p[b];_=a.measureText(C).width,f+=v-_+c,v=_}}destroy(){this._activeTextures=null}}yk.extension={type:[P.WebGLSystem,P.WebGPUSystem,P.CanvasSystem],name:"canvasText"};function y7(t,e){return e instanceof Qt||e instanceof Xo?e:t==="html"?new Xo(e):new Qt(e)}async function b7(t,e,n=200){const r=await e.extract.base64(t);await e.encoder.commandFinished;const i=n;console.log(`logging texture ${t.source.width}px ${t.source.height}px`);const s=["font-size: 1px;",`padding: ${i}px 300px;`,`background: url(${r}) no-repeat;`,"background-size: contain;"].join(" ");console.log("%c ",s)}const S7=["#000080","#228B22","#8B0000","#4169E1","#008080","#800000","#9400D3","#FF8C00","#556B2F","#8B008B"];let w7=0;function bk(t,e=0,n={color:"#000000"}){t.renderGroup&&(n.color=S7[w7++]);let r="";for(let o=0;o<e;o++)r+="    ";let i=t.label;!i&&t instanceof br&&(i=`sprite:${t.texture.label}`);let s=`%c ${r}|- ${i} (worldX:${t.worldTransform.tx}, relativeRenderX:${t.relativeGroupTransform.tx}, renderX:${t.groupTransform.tx}, localX:${t.x})`;t.renderGroup&&(s+=" (RenderGroup)"),t.filters&&(s+="(*filters)"),console.log(s,`color:${n.color}; font-weight:bold;`),e++;for(let o=0;o<t.children.length;o++){const a=t.children[o];bk(a,e,{...n})}}function Sk(t,e=0,n={index:0,color:"#000000"}){let r="";for(let s=0;s<e;s++)r+="    ";const i=`%c ${r}- ${n.index}: ${t.root.label} worldX:${t.worldTransform.tx}`;console.log(i,`color:${n.color}; font-weight:bold;`),e++;for(let s=0;s<t.renderGroupChildren.length;s++){const o=t.renderGroupChildren[s];Sk(o,e,{...n,index:s})}}Ne.add(VP,jP);const C7=Object.freeze(Object.defineProperty({__proto__:null,AbstractBitmapFont:zy,AbstractRenderer:oh,AbstractText:Dm,AccessibilitySystem:B4,AlphaFilter:bM,AlphaMask:oy,AlphaMaskPipe:D1,AnimatedSprite:Wc,Application:Gy,ApplicationInitHook:Ly,Assets:H,AssetsClass:TB,BLEND_TO_NPM:hR,BUFFER_TYPE:ic,BackgroundLoader:rB,BackgroundSystem:tO,Batch:dR,BatchGeometry:_R,BatchTextureArray:fR,BatchableGraphics:Tm,BatchableMesh:Vm,BatchableSprite:Lm,Batcher:gR,BatcherPipe:M1,BigPool:Ae,BindGroup:mi,BindGroupSystem:Pb,BitmapFont:i1,BitmapFontManager:Gc,BitmapText:JM,BitmapTextPipe:lk,BlendModeFilter:vt,BlendModePipe:vb,BlurFilter:w1,BlurFilterPass:gu,Bounds:Kt,BrowserAdapter:_4,Buffer:Yn,BufferImageSource:rm,BufferResource:Im,BufferUsage:Re,CLEAR:Bn,Cache:We,CanvasPool:gi,CanvasPoolClass:ZR,CanvasSource:ns,CanvasTextMetrics:Fr,CanvasTextPipe:_k,CanvasTextSystem:yk,Circle:pm,Color:ve,ColorBlend:dy,ColorBurnBlend:py,ColorDodgeBlend:my,ColorMask:ay,ColorMaskPipe:O1,ColorMatrixFilter:MM,CompressedSource:hh,Container:$e,Culler:NB,CullerPlugin:GB,CustomRenderPipe:ob,D3D10_RESOURCE_DIMENSION:c1,D3DFMT:En,DATA_URI:iN,DDS:fe,DEG_TO_RAD:Ho,DEPRECATED_SCALE_MODES:Ep,DEPRECATED_WRAP_MODES:Tp,DOMAdapter:Ce,DRAW_MODES:Y9,DXGI_FORMAT:l1,DXGI_TO_TEXTURE_FORMAT:An,DarkenBlend:gy,DefaultBatcher:wm,DefaultShader:MR,DifferenceBlend:vy,DisplacementFilter:qz,DivideBlend:_y,DynamicBitmapFont:t2,Ellipse:mm,EventBoundary:gM,EventEmitter:Mt,EventSystem:vM,EventsTicker:Hi,ExclusionBlend:xy,ExtensionType:P,ExtractSystem:rO,FOURCC_TO_TEXTURE_FORMAT:u2,FederatedContainer:Wz,FederatedEvent:Nu,FederatedMouseEvent:jc,FederatedPointerEvent:ur,FederatedWheelEvent:$o,FillGradient:Ru,FillPattern:lh,Filter:le,FilterEffect:Pc,FilterPipe:UM,FilterSystem:GM,FontStylePromiseCache:Hl,GAUSSIAN_VALUES:S1,GL_FORMATS:wp,GL_INTERNAL_FORMAT:DB,GL_TARGETS:L1,GL_TYPES:Pe,GL_WRAP_MODES:mD,GenerateTextureSystem:xb,Geometry:Gu,GlBackBufferSystem:_D,GlBatchAdaptor:P1,GlBuffer:fD,GlBufferSystem:F1,GlColorMaskSystem:z1,GlContextSystem:pD,GlEncoderSystem:H1,GlGeometrySystem:N1,GlGraphicsAdaptor:ib,GlMeshAdaptor:sb,GlProgram:me,GlProgramData:BD,GlRenderTarget:xD,GlRenderTargetAdaptor:CD,GlRenderTargetSystem:Q1,GlShaderSystem:eb,GlStateSystem:HD,GlStencilSystem:V1,GlTexture:VD,GlTextureSystem:rb,GlUboSystem:Y1,GlUniformGroupSystem:tb,GlobalUniformSystem:yb,GpuBatchAdaptor:R1,GpuBlendModesToPixi:vn,GpuBufferSystem:Rb,GpuColorMaskSystem:Bb,GpuDeviceSystem:zm,GpuEncoderSystem:Mb,GpuGraphicsAdaptor:Hb,GpuGraphicsContext:zR,GpuMeshAdapter:Vb,GpuMipmapGenerator:wO,GpuProgram:he,GpuReadBuffer:N9,GpuRenderTarget:_O,GpuRenderTargetAdaptor:xO,GpuRenderTargetSystem:Ib,GpuShaderSystem:Ub,GpuStateSystem:Lb,GpuStencilModesToPixi:ro,GpuStencilSystem:Db,GpuTextureSystem:zb,GpuUboSystem:Ob,GpuUniformBatchPipe:kb,Graphics:$s,GraphicsContext:mn,GraphicsContextRenderData:HR,GraphicsContextSystem:Ky,GraphicsPath:Ws,GraphicsPipe:RO,HTMLText:rD,HTMLTextPipe:ck,HTMLTextRenderData:E1,HTMLTextStyle:Xo,HTMLTextSystem:$b,HardLightBlend:yy,HardMixBlend:by,HelloSystem:Gm,IGLUniformData:f9,ImageSource:Zs,InstructionSet:iy,KTX:mt,LightenBlend:Sy,LinearBurnBlend:wy,LinearDodgeBlend:Cy,LinearLightBlend:Ty,Loader:hB,LoaderParserPriority:In,LuminosityBlend:Ey,MSAA_QUALITY:PO,MaskEffectManager:dp,MaskEffectManagerClass:a4,MaskFilter:VM,Matrix:ae,Mesh:Wu,MeshGeometry:no,MeshPipe:jO,MeshPlane:p7,MeshRope:m7,MeshSimple:g7,NOOP:Jx,NegationBlend:Ay,NineSliceGeometry:Es,NineSlicePlane:_7,NineSliceSprite:jb,NineSliceSpritePipe:qO,NoiseFilter:Kz,ObservablePoint:xt,OverlayBlend:Py,PI_2:$P,PerspectiveMesh:d7,PerspectivePlaneGeometry:IO,PinLightBlend:Ry,PipelineSystem:Fb,PlaneGeometry:Hm,Point:ze,Polygon:hu,Pool:im,PoolGroupClass:s4,PrepareBase:$M,PrepareQueue:ZM,PrepareSystem:sD,PrepareUpload:iD,QuadGeometry:JO,RAD_TO_DEG:XP,Rectangle:Ke,RenderContainer:r7,RenderGroup:g4,RenderGroupPipe:ub,RenderGroupSystem:pb,RenderTarget:Cp,RenderTargetSystem:K1,RenderTexture:Nm,RenderableGCSystem:oO,RendererInitHook:Ny,RendererType:Fn,ResizePlugin:sR,Resolver:Js,RopeGeometry:zO,RoundedRectangle:gm,SCALE_MODES:Z9,STENCIL_MODES:Rt,SVGParser:qR,SVGToGraphicsPath:uR,SaturationBlend:By,SchedulerSystem:bb,ScissorMask:a9,SdfShader:uk,Shader:Sr,ShaderStage:Ja,ShapePath:YR,SharedRenderPipes:Ab,SharedSystems:Eb,SoftLightBlend:My,Sprite:br,SpritePipe:mb,Spritesheet:F_,State:jr,StencilMask:uy,StencilMaskPipe:k1,SubtractBlend:Dy,SystemRunner:Uy,TEXTURE_FORMAT_BLOCK_SIZE:BB,Text:km,TextStyle:Qt,Texture:X,TextureGCSystem:uO,TextureMatrix:ey,TexturePool:Ge,TexturePoolClass:SM,TextureSource:dt,TextureStyle:ZP,TextureUvs:J9,Ticker:at,TickerListener:Td,TickerPlugin:oR,TilingSprite:QM,TilingSpritePipe:rk,TilingSpriteShader:ZO,Transform:qM,Triangle:T1,UNIFORM_TO_ARRAY_SETTERS:LD,UNIFORM_TO_SINGLE_SETTERS:UD,UNIFORM_TYPES_MAP:H4,UNIFORM_TYPES_VALUES:fy,UPDATE_BLEND:om,UPDATE_COLOR:Bc,UPDATE_PRIORITY:rs,UPDATE_TRANSFORM:x6,UPDATE_VISIBLE:cu,UboBatch:pO,UboSystem:j1,UniformGroup:Tt,VERSION:Fc,VideoSource:tc,ViewContainer:ea,ViewSystem:Tb,ViewableBuffer:W_,VividLightBlend:Oy,WGSL_ALIGN_SIZE_DATA:oc,WGSL_TO_STD40_SIZE:W1,WRAP_MODES:Q9,WebGLRenderer:dO,WebGPURenderer:AO,WebWorkerAdapter:Nz,WorkerManager:s2,_getGlobalBounds:ny,_getGlobalBoundsRecursive:C1,accessibilityTarget:F6,addBits:X_,addMaskBounds:am,addMaskLocalBounds:um,addProgramDefines:D4,alphaFrag:_M,alphaWgsl:p2,applyMatrix:tk,applyProjectiveTransformationToPlane:DO,applyStyleParams:T2,assignWithIgnore:v4,autoDetectEnvironment:G6,autoDetectRenderer:rR,autoDetectSource:S6,basisTranscoderUrls:gp,bitmapFontCachePlugin:tB,bitmapFontTextParser:Pd,bitmapFontXMLParser:n2,bitmapFontXMLStringParser:r2,blendTemplateFrag:Y4,blendTemplateVert:q4,blendTemplateWgsl:K4,blockDataMap:Nb,blurTemplateWgsl:EM,boundsPool:pi,browserExt:VP,buildAdaptiveBezier:Qy,buildAdaptiveQuadratic:VR,buildArc:Zy,buildArcTo:jR,buildArcToSvg:WR,buildCircle:Yi,buildContextBatches:GR,buildEllipse:FR,buildGeometryFromPath:a7,buildInstructions:cD,buildLine:NR,buildPolygon:$y,buildRectangle:Xy,buildRoundedRectangle:IR,buildSimpleUvs:jy,buildTriangle:Yy,buildUvs:Vy,cacheTextureArray:iB,calculateProjection:TD,checkChildrenDidChange:ry,checkDataUrl:na,checkExtension:wr,checkMaxIfStatementsInShader:lR,childrenHelperMixin:o4,clearList:Um,closePointEps:UR,collectAllRenderables:vh,collectRenderGroups:lb,color32BitToUniform:_h,colorBit:_m,colorBitGl:xm,colorMatrixFilterFrag:BM,colorMatrixFilterWgsl:m2,colorToUniform:O9,compareModeToGlCompare:YD,compileHighShader:bR,compileHighShaderGl:SR,compileHighShaderGlProgram:Hu,compileHighShaderGpuProgram:zu,compileHooks:Y_,compileInputs:q_,compileOutputs:yR,compileShader:S2,compute2DProjection:FO,convertFormatIfRequired:ez,convertToList:hr,copySearchParams:pp,createIdFromString:Au,createLevelBuffers:EG,createLevelBuffersFromKTX:tz,createStringVariations:C4,createTexture:eo,createUboElementsSTD40:yD,createUboElementsWGSL:mO,createUboSyncFunction:$1,createUboSyncFunctionSTD40:wD,createUboSyncFunctionWGSL:vO,crossOrigin:yB,cullingMixin:i4,curveEps:Q_,defaultFilterVert:Mm,defaultValue:Z1,definedProps:Si,deprecation:q,detectAvif:sB,detectBasis:bG,detectCompressed:uz,detectDefaults:oB,detectMp4:aB,detectOgv:uB,detectVideoAlphaMode:ly,detectWebm:lB,detectWebp:cB,determineCrossOrigin:SB,displacementFrag:DM,displacementVert:OM,displacementWgsl:g2,earcut:eR,effectsMixin:u4,ensureAttributes:U1,ensureIsBuffer:Hy,ensureOptions:Om,ensurePrecision:O4,ensureTextStyle:y7,executeInstructions:ab,extensions:Ne,extractAttributesFromGlProgram:DD,extractAttributesFromGpuProgram:L4,extractFontFamilies:fk,extractStructAndGroups:Ed,fastCopy:mp,findHooksRx:xR,findMixin:l4,fontStringFromTextStyle:Lc,formatShader:r9,fragmentGPUTemplate:ER,fragmentGlTemplate:PR,generateArraySyncSTD40:SD,generateArraySyncWGSL:gO,generateBlurFragSource:wM,generateBlurGlProgram:TM,generateBlurProgram:AM,generateBlurVertSource:CM,generateGPULayout:t9,generateGpuLayoutGroups:N4,generateLayout:n9,generateLayoutHash:G4,generateProgram:ID,generateShaderSyncCode:RD,generateTextStyleKey:e1,generateTextureBatchBit:ym,generateTextureBatchBitGl:bm,generateUID:t7,generateUniformsSync:ND,getAdjustedBlendModeBlend:Ic,getAttributeInfoFromFormat:Pu,getBatchSamplersUniformGroup:Sm,getBitmapTextLayout:r1,getCanvasBoundingBox:xk,getCanvasFillStyle:Nc,getCanvasTexture:q1,getDefaultUniformValue:V4,getFastGlobalBounds:LM,getFontCss:pk,getFontFamilyName:pB,getGeometryBounds:vR,getGlTypeFromFormat:gD,getGlobalBounds:sh,getGlobalRenderableBounds:NM,getLocalBounds:sm,getMatrixRelativeToParent:sy,getMaxFragmentPrecision:M4,getMaxTexturesPerBatch:ta,getOrientationOfPoints:LR,getParent:h4,getPo2TextureFromSource:Wb,getResolutionOfUrl:Am,getSVGUrl:mk,getSupportedCompressedTextureFormats:u1,getSupportedGPUCompressedTextureFormats:a2,getSupportedGlCompressedTextureFormats:o2,getSupportedTextureFormats:fh,getTemporaryCanvasFromImage:gk,getTestContext:hy,getTextureBatchBindGroup:vm,getTextureDefaultMatrix:v7,getTextureFormatFromKTXTexture:iz,getUboData:OD,getUniformData:kD,getUrlExtension:T4,glFormatToGPUFormat:UB,glUploadBufferImageResource:jD,glUploadCompressedTextureResource:WD,glUploadImageResource:nb,glUploadVideoResource:$D,globalUniformsBit:RR,globalUniformsBitGl:BR,globalUniformsUBOBitGl:bN,gpuFormatToBasisTranscoderFormat:PG,gpuFormatToKTXBasisTranscoderFormat:oz,gpuUploadBufferImageResource:yO,gpuUploadCompressedTextureResource:bO,gpuUploadImageResource:Gb,gpuUploadVideoResource:SO,groupD8:we,hasCachedCanvasTexture:h9,hslWgsl:Jz,hslgl:cm,hslgpu:hm,injectBits:K_,insertVersion:k4,isMobile:R4,isPow2:M_,isRenderingToScreen:ED,isSafari:hk,isSingleItem:Mc,isWebGLSupported:ah,isWebGPUSupported:uh,ktxTranscoderUrls:vp,loadBasis:TG,loadBasisOnWorker:RB,loadBitmapFont:nB,loadDDS:FG,loadEnvironmentExtensions:ky,loadFontAsBase64:dk,loadFontCSS:E2,loadImageBitmap:_B,loadJson:fB,loadKTX:qG,loadKTX2:JG,loadKTX2onWorker:IB,loadSVGImage:vk,loadSvg:gB,loadTextures:o1,loadTxt:dB,loadVideoTextures:wB,loadWebFont:mB,localUniformBit:vu,localUniformBitGl:Fm,localUniformBitGroup2:aD,localUniformMSDFBit:ik,localUniformMSDFBitGl:sk,log2:s6,logDebugTexture:b7,logProgramError:FD,logRenderGroupScene:Sk,logScene:bk,mSDFBit:ok,mSDFBitGl:ak,mapFormatToGlFormat:qD,mapFormatToGlInternalFormat:KD,mapFormatToGlType:QD,mapGlToVertexFormat:MD,mapSize:g9,mapType:J1,mapWebGLBlendModesToPixi:GD,maskFrag:zM,maskVert:HM,maskWgsl:_2,matrixPool:di,measureHtmlText:A1,measureMixin:f4,migrateFragmentFromV7toV8:p9,mipmapScaleModeToGlFilter:XD,mixColors:hb,mixHexColors:cb,mixStandardAnd32BitColors:E9,multiplyHexColors:kR,nextPow2:Vo,noiseFrag:kM,noiseWgsl:v2,nonCompressedFormats:EB,normalizeExtensionPriority:Nl,nssvg:y2,nsxhtml:b2,onRenderMixin:d4,parseDDS:MB,parseFunctionBody:n7,parseKTX:OB,path:zt,pointInTriangle:x2,preloadVideo:bB,removeItems:ty,removeStructAndGroupDuplicates:z4,resetUids:i6,resolveCharacters:n1,resolveCompressedTextureUrl:az,resolveJsonUrl:CB,resolveTextureUrl:a1,resourceToTexture:b4,roundPixelsBit:Vu,roundPixelsBitGl:ju,roundedShapeArc:$R,roundedShapeQuadraticCurve:XR,sayHello:iO,scaleModeToGlFilter:C2,setBasisTranscoderPath:wG,setKTXTranscoderPath:QG,setPositions:ek,setProgramName:F4,setUvs:nk,shapeBuilders:ch,sortMixin:p4,spritesheetAsset:P4,squaredDistanceToLineSegment:nc,stripVersion:I4,testImageFormat:s1,testVideoFormat:Em,textStyleToCSS:eD,textureBit:uD,textureBitGl:lD,textureFrom:S4,tilingBit:KO,tilingBitGl:QO,toFillStyle:Ds,toLocalGlobalMixin:m4,toStrokeStyle:Uc,transformVertices:Cm,triangulateWithHoles:Wy,uboSyncFunctionsSTD40:X1,uboSyncFunctionsWGSL:bD,uid:ot,uniformParsers:Os,unpremultiplyAlpha:C9,unsafeEvalSupported:Fy,updateLocalTransform:i7,updateQuadBounds:Ac,updateRenderGroupTransform:ZD,updateRenderGroupTransforms:fb,updateTransformAndChildren:db,updateTransformBackwards:Rc,updateWorldTransform:s7,v8_0_0:ge,v8_3_4:qP,validFormats:_p,validateRenderables:JD,vertexGPUTemplate:TR,vertexGlTemplate:AR,viewportFromFrame:K9,vkFormatToGPUFormat:LB,warn:de,webworkerExt:jP,wrapModeToGlAddress:Bd},Symbol.toStringTag,{value:"Module"}));var wk={exports:{}},ra={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ra.ConcurrentRoot=1;ra.ContinuousEventPriority=4;ra.DefaultEventPriority=16;ra.DiscreteEventPriority=1;ra.IdleEventPriority=536870912;ra.LegacyRoot=0;wk.exports=ra;var Vl=wk.exports;const Ck=Le.createContext({}),T7=Ck.Provider;Ck.Consumer;function Tk(t,e){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyDescriptor(n,e);return!(typeof r>"u"||r.set)}function UT(t,...e){}function Ek(t,e={}){const n=t;return n.__pixireact=Object.assign({filters:[],parent:null,root:null,type:""},e),n}var Ak={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E7=function(e){var n={},r=Le,i=HE,s=Object.assign;function o(u){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+u,d=1;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+u+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),h=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),A=Symbol.for("react.offscreen"),M=Symbol.iterator;function L(u){return u===null||typeof u!="object"?null:(u=M&&u[M]||u["@@iterator"],typeof u=="function"?u:null)}function I(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case f:return"Fragment";case h:return"Portal";case v:return"Profiler";case p:return"StrictMode";case C:return"Suspense";case b:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case y:return(u.displayName||"Context")+".Consumer";case _:return(u._context.displayName||"Context")+".Provider";case S:var l=u.render;return u=u.displayName,u||(u=l.displayName||l.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case w:return l=u.displayName||null,l!==null?l:I(u.type)||"Memo";case T:l=u._payload,u=u._init;try{return I(u(l))}catch{}}return null}function N(u){var l=u.type;switch(u.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=l.render,u=u.displayName||u.name||"",l.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(l);case 8:return l===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function k(u){var l=u,d=u;if(u.alternate)for(;l.return;)l=l.return;else{u=l;do l=u,l.flags&4098&&(d=l.return),u=l.return;while(u)}return l.tag===3?d:null}function G(u){if(k(u)!==u)throw Error(o(188))}function ie(u){var l=u.alternate;if(!l){if(l=k(u),l===null)throw Error(o(188));return l!==u?null:u}for(var d=u,m=l;;){var g=d.return;if(g===null)break;var x=g.alternate;if(x===null){if(m=g.return,m!==null){d=m;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===d)return G(g),u;if(x===m)return G(g),l;x=x.sibling}throw Error(o(188))}if(d.return!==m.return)d=g,m=x;else{for(var E=!1,R=g.child;R;){if(R===d){E=!0,d=g,m=x;break}if(R===m){E=!0,m=g,d=x;break}R=R.sibling}if(!E){for(R=x.child;R;){if(R===d){E=!0,d=x,m=g;break}if(R===m){E=!0,m=x,d=g;break}R=R.sibling}if(!E)throw Error(o(189))}}if(d.alternate!==m)throw Error(o(190))}if(d.tag!==3)throw Error(o(188));return d.stateNode.current===d?u:l}function Ze(u){return u=ie(u),u!==null?re(u):null}function re(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var l=re(u);if(l!==null)return l;u=u.sibling}return null}function J(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){if(u.tag!==4){var l=J(u);if(l!==null)return l}u=u.sibling}return null}var ye=Array.isArray,oe=e.getPublicInstance,Y=e.getRootHostContext,V=e.getChildHostContext,z=e.prepareForCommit,W=e.resetAfterCommit,je=e.createInstance,ce=e.appendInitialChild,Zt=e.finalizeInitialChildren,Jt=e.prepareUpdate,Nn=e.shouldSetTextContent,en=e.createTextInstance,Xr=e.scheduleTimeout,la=e.cancelTimeout,Ci=e.noTimeout,so=e.isPrimaryRenderer,tn=e.supportsMutation,Ti=e.supportsPersistence,Vt=e.supportsHydration,Ku=e.getInstanceFromNode,Ei=e.preparePortalMount,Ai=e.getCurrentEventPriority,Pi=e.detachDeletedInstance,Ri=e.supportsMicrotasks,tg=e.scheduleMicrotask,cs=e.supportsTestSelectors,ng=e.findFiberRoot,fS=e.getBoundingRect,Q5=e.getTextContent,Qu=e.isHiddenSubtree,Z5=e.matchAccessibilityRole,J5=e.setFocusIfFocusable,eI=e.setupIntersectionObserver,tI=e.appendChild,nI=e.appendChildToContainer,rI=e.commitTextUpdate,iI=e.commitMount,sI=e.commitUpdate,oI=e.insertBefore,aI=e.insertInContainerBefore,uI=e.removeChild,lI=e.removeChildFromContainer,dS=e.resetTextContent,cI=e.hideInstance,hI=e.hideTextInstance,fI=e.unhideInstance,dI=e.unhideTextInstance,pI=e.clearContainer,mI=e.cloneInstance,pS=e.createContainerChildSet,mS=e.appendChildToContainerChildSet,gI=e.finalizeContainerChildren,rg=e.replaceContainerChildren,gS=e.cloneHiddenInstance,vS=e.cloneHiddenTextInstance,vI=e.canHydrateInstance,_I=e.canHydrateTextInstance,xI=e.canHydrateSuspenseInstance,_S=e.isSuspenseInstancePending,ig=e.isSuspenseInstanceFallback,yI=e.getSuspenseInstanceFallbackErrorDetails,bI=e.registerSuspenseInstanceRetry,Th=e.getNextHydratableSibling,SI=e.getFirstHydratableChild,wI=e.getFirstHydratableChildWithinContainer,CI=e.getFirstHydratableChildWithinSuspenseInstance,TI=e.hydrateInstance,EI=e.hydrateTextInstance,AI=e.hydrateSuspenseInstance,PI=e.getNextHydratableInstanceAfterSuspenseInstance,RI=e.commitHydratedContainer,BI=e.commitHydratedSuspenseInstance,MI=e.clearSuspenseBoundary,DI=e.clearSuspenseBoundaryFromContainer,OI=e.shouldDeleteUnhydratedTailInstances,kI=e.didNotMatchHydratedContainerTextInstance,FI=e.didNotMatchHydratedTextInstance,sg;function Zu(u){if(sg===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);sg=l&&l[1]||""}return`
`+sg+u}var og=!1;function ag(u,l){if(!u||og)return"";og=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch($){var m=$}Reflect.construct(u,[],l)}else{try{l.call()}catch($){m=$}u.call(l.prototype)}else{try{throw Error()}catch($){m=$}u()}}catch($){if($&&m&&typeof $.stack=="string"){for(var g=$.stack.split(`
`),x=m.stack.split(`
`),E=g.length-1,R=x.length-1;1<=E&&0<=R&&g[E]!==x[R];)R--;for(;1<=E&&0<=R;E--,R--)if(g[E]!==x[R]){if(E!==1||R!==1)do if(E--,R--,0>R||g[E]!==x[R]){var F=`
`+g[E].replace(" at new "," at ");return u.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",u.displayName)),F}while(1<=E&&0<=R);break}}}finally{og=!1,Error.prepareStackTrace=d}return(u=u?u.displayName||u.name:"")?Zu(u):""}var II=Object.prototype.hasOwnProperty,ug=[],ca=-1;function hs(u){return{current:u}}function Je(u){0>ca||(u.current=ug[ca],ug[ca]=null,ca--)}function Ye(u,l){ca++,ug[ca]=u.current,u.current=l}var fs={},nn=hs(fs),yn=hs(!1),oo=fs;function ha(u,l){var d=u.type.contextTypes;if(!d)return fs;var m=u.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var g={},x;for(x in d)g[x]=l[x];return m&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=l,u.__reactInternalMemoizedMaskedChildContext=g),g}function bn(u){return u=u.childContextTypes,u!=null}function Eh(){Je(yn),Je(nn)}function xS(u,l,d){if(nn.current!==fs)throw Error(o(168));Ye(nn,l),Ye(yn,d)}function yS(u,l,d){var m=u.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var g in m)if(!(g in l))throw Error(o(108,N(u)||"Unknown",g));return s({},d,m)}function Ah(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||fs,oo=nn.current,Ye(nn,u),Ye(yn,yn.current),!0}function bS(u,l,d){var m=u.stateNode;if(!m)throw Error(o(169));d?(u=yS(u,l,oo),m.__reactInternalMemoizedMergedChildContext=u,Je(yn),Je(nn),Ye(nn,u)):Je(yn),Ye(yn,d)}var Cr=Math.clz32?Math.clz32:NI,UI=Math.log,LI=Math.LN2;function NI(u){return u>>>=0,u===0?32:31-(UI(u)/LI|0)|0}var Ph=64,Rh=4194304;function Ju(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function Bh(u,l){var d=u.pendingLanes;if(d===0)return 0;var m=0,g=u.suspendedLanes,x=u.pingedLanes,E=d&268435455;if(E!==0){var R=E&~g;R!==0?m=Ju(R):(x&=E,x!==0&&(m=Ju(x)))}else E=d&~g,E!==0?m=Ju(E):x!==0&&(m=Ju(x));if(m===0)return 0;if(l!==0&&l!==m&&!(l&g)&&(g=m&-m,x=l&-l,g>=x||g===16&&(x&4194240)!==0))return l;if(m&4&&(m|=d&16),l=u.entangledLanes,l!==0)for(u=u.entanglements,l&=m;0<l;)d=31-Cr(l),g=1<<d,m|=u[d],l&=~g;return m}function GI(u,l){switch(u){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zI(u,l){for(var d=u.suspendedLanes,m=u.pingedLanes,g=u.expirationTimes,x=u.pendingLanes;0<x;){var E=31-Cr(x),R=1<<E,F=g[E];F===-1?(!(R&d)||R&m)&&(g[E]=GI(R,l)):F<=l&&(u.expiredLanes|=R),x&=~R}}function lg(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function SS(){var u=Ph;return Ph<<=1,!(Ph&4194240)&&(Ph=64),u}function cg(u){for(var l=[],d=0;31>d;d++)l.push(u);return l}function el(u,l,d){u.pendingLanes|=l,l!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,l=31-Cr(l),u[l]=d}function HI(u,l){var d=u.pendingLanes&~l;u.pendingLanes=l,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=l,u.mutableReadLanes&=l,u.entangledLanes&=l,l=u.entanglements;var m=u.eventTimes;for(u=u.expirationTimes;0<d;){var g=31-Cr(d),x=1<<g;l[g]=0,m[g]=-1,u[g]=-1,d&=~x}}function hg(u,l){var d=u.entangledLanes|=l;for(u=u.entanglements;d;){var m=31-Cr(d),g=1<<m;g&l|u[m]&l&&(u[m]|=l),d&=~g}}var ke=0;function wS(u){return u&=-u,1<u?4<u?u&268435455?16:536870912:4:1}var fg=i.unstable_scheduleCallback,CS=i.unstable_cancelCallback,VI=i.unstable_shouldYield,jI=i.unstable_requestPaint,Dt=i.unstable_now,dg=i.unstable_ImmediatePriority,WI=i.unstable_UserBlockingPriority,pg=i.unstable_NormalPriority,$I=i.unstable_IdlePriority,Mh=null,Yr=null;function XI(u){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(Mh,u,void 0,(u.current.flags&128)===128)}catch{}}function YI(u,l){return u===l&&(u!==0||1/u===1/l)||u!==u&&l!==l}var Tr=typeof Object.is=="function"?Object.is:YI,Bi=null,Dh=!1,mg=!1;function TS(u){Bi===null?Bi=[u]:Bi.push(u)}function qI(u){Dh=!0,TS(u)}function qr(){if(!mg&&Bi!==null){mg=!0;var u=0,l=ke;try{var d=Bi;for(ke=1;u<d.length;u++){var m=d[u];do m=m(!0);while(m!==null)}Bi=null,Dh=!1}catch(g){throw Bi!==null&&(Bi=Bi.slice(u+1)),fg(dg,qr),g}finally{ke=l,mg=!1}}return null}var fa=[],da=0,Oh=null,kh=0,er=[],tr=0,ao=null,Mi=1,Di="";function uo(u,l){fa[da++]=kh,fa[da++]=Oh,Oh=u,kh=l}function ES(u,l,d){er[tr++]=Mi,er[tr++]=Di,er[tr++]=ao,ao=u;var m=Mi;u=Di;var g=32-Cr(m)-1;m&=~(1<<g),d+=1;var x=32-Cr(l)+g;if(30<x){var E=g-g%5;x=(m&(1<<E)-1).toString(32),m>>=E,g-=E,Mi=1<<32-Cr(l)+g|d<<g|m,Di=x+u}else Mi=1<<x|d<<g|m,Di=u}function gg(u){u.return!==null&&(uo(u,1),ES(u,1,0))}function vg(u){for(;u===Oh;)Oh=fa[--da],fa[da]=null,kh=fa[--da],fa[da]=null;for(;u===ao;)ao=er[--tr],er[tr]=null,Di=er[--tr],er[tr]=null,Mi=er[--tr],er[tr]=null}var Gn=null,nr=null,rt=!1,tl=!1,Er=null;function AS(u,l){var d=ar(5,null,null,0);d.elementType="DELETED",d.stateNode=l,d.return=u,l=u.deletions,l===null?(u.deletions=[d],u.flags|=16):l.push(d)}function PS(u,l){switch(u.tag){case 5:return l=vI(l,u.type,u.pendingProps),l!==null?(u.stateNode=l,Gn=u,nr=SI(l),!0):!1;case 6:return l=_I(l,u.pendingProps),l!==null?(u.stateNode=l,Gn=u,nr=null,!0):!1;case 13:if(l=xI(l),l!==null){var d=ao!==null?{id:Mi,overflow:Di}:null;return u.memoizedState={dehydrated:l,treeContext:d,retryLane:1073741824},d=ar(18,null,null,0),d.stateNode=l,d.return=u,u.child=d,Gn=u,nr=null,!0}return!1;default:return!1}}function _g(u){return(u.mode&1)!==0&&(u.flags&128)===0}function xg(u){if(rt){var l=nr;if(l){var d=l;if(!PS(u,l)){if(_g(u))throw Error(o(418));l=Th(d);var m=Gn;l&&PS(u,l)?AS(m,d):(u.flags=u.flags&-4097|2,rt=!1,Gn=u)}}else{if(_g(u))throw Error(o(418));u.flags=u.flags&-4097|2,rt=!1,Gn=u}}}function RS(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;Gn=u}function Fh(u){if(!Vt||u!==Gn)return!1;if(!rt)return RS(u),rt=!0,!1;if(u.tag!==3&&(u.tag!==5||OI(u.type)&&!Nn(u.type,u.memoizedProps))){var l=nr;if(l){if(_g(u))throw BS(),Error(o(418));for(;l;)AS(u,l),l=Th(l)}}if(RS(u),u.tag===13){if(!Vt)throw Error(o(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(o(317));nr=PI(u)}else nr=Gn?Th(u.stateNode):null;return!0}function BS(){for(var u=nr;u;)u=Th(u)}function pa(){Vt&&(nr=Gn=null,tl=rt=!1)}function yg(u){Er===null?Er=[u]:Er.push(u)}var KI=a.ReactCurrentBatchConfig;function Ih(u,l){if(Tr(u,l))return!0;if(typeof u!="object"||u===null||typeof l!="object"||l===null)return!1;var d=Object.keys(u),m=Object.keys(l);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var g=d[m];if(!II.call(l,g)||!Tr(u[g],l[g]))return!1}return!0}function QI(u){switch(u.tag){case 5:return Zu(u.type);case 16:return Zu("Lazy");case 13:return Zu("Suspense");case 19:return Zu("SuspenseList");case 0:case 2:case 15:return u=ag(u.type,!1),u;case 11:return u=ag(u.type.render,!1),u;case 1:return u=ag(u.type,!0),u;default:return""}}function nl(u,l,d){if(u=d.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(o(309));var m=d.stateNode}if(!m)throw Error(o(147,u));var g=m,x=""+u;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===x?l.ref:(l=function(E){var R=g.refs;E===null?delete R[x]:R[x]=E},l._stringRef=x,l)}if(typeof u!="string")throw Error(o(284));if(!d._owner)throw Error(o(290,u))}return u}function Uh(u,l){throw u=Object.prototype.toString.call(l),Error(o(31,u==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":u))}function MS(u){var l=u._init;return l(u._payload)}function DS(u){function l(O,B){if(u){var U=O.deletions;U===null?(O.deletions=[B],O.flags|=16):U.push(B)}}function d(O,B){if(!u)return null;for(;B!==null;)l(O,B),B=B.sibling;return null}function m(O,B){for(O=new Map;B!==null;)B.key!==null?O.set(B.key,B):O.set(B.index,B),B=B.sibling;return O}function g(O,B){return O=xs(O,B),O.index=0,O.sibling=null,O}function x(O,B,U){return O.index=U,u?(U=O.alternate,U!==null?(U=U.index,U<B?(O.flags|=2,B):U):(O.flags|=2,B)):(O.flags|=1048576,B)}function E(O){return u&&O.alternate===null&&(O.flags|=2),O}function R(O,B,U,Z){return B===null||B.tag!==6?(B=m0(U,O.mode,Z),B.return=O,B):(B=g(B,U),B.return=O,B)}function F(O,B,U,Z){var ue=U.type;return ue===f?ne(O,B,U.props.children,Z,U.key):B!==null&&(B.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===T&&MS(ue)===B.type)?(Z=g(B,U.props),Z.ref=nl(O,B,U),Z.return=O,Z):(Z=mf(U.type,U.key,U.props,null,O.mode,Z),Z.ref=nl(O,B,U),Z.return=O,Z)}function $(O,B,U,Z){return B===null||B.tag!==4||B.stateNode.containerInfo!==U.containerInfo||B.stateNode.implementation!==U.implementation?(B=g0(U,O.mode,Z),B.return=O,B):(B=g(B,U.children||[]),B.return=O,B)}function ne(O,B,U,Z,ue){return B===null||B.tag!==7?(B=go(U,O.mode,Z,ue),B.return=O,B):(B=g(B,U),B.return=O,B)}function _e(O,B,U){if(typeof B=="string"&&B!==""||typeof B=="number")return B=m0(""+B,O.mode,U),B.return=O,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case c:return U=mf(B.type,B.key,B.props,null,O.mode,U),U.ref=nl(O,null,B),U.return=O,U;case h:return B=g0(B,O.mode,U),B.return=O,B;case T:var Z=B._init;return _e(O,Z(B._payload),U)}if(ye(B)||L(B))return B=go(B,O.mode,U,null),B.return=O,B;Uh(O,B)}return null}function Q(O,B,U,Z){var ue=B!==null?B.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return ue!==null?null:R(O,B,""+U,Z);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case c:return U.key===ue?F(O,B,U,Z):null;case h:return U.key===ue?$(O,B,U,Z):null;case T:return ue=U._init,Q(O,B,ue(U._payload),Z)}if(ye(U)||L(U))return ue!==null?null:ne(O,B,U,Z,null);Uh(O,U)}return null}function et(O,B,U,Z,ue){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return O=O.get(U)||null,R(B,O,""+Z,ue);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case c:return O=O.get(Z.key===null?U:Z.key)||null,F(B,O,Z,ue);case h:return O=O.get(Z.key===null?U:Z.key)||null,$(B,O,Z,ue);case T:var be=Z._init;return et(O,B,U,be(Z._payload),ue)}if(ye(Z)||L(Z))return O=O.get(U)||null,ne(B,O,Z,ue,null);Uh(B,Z)}return null}function Xe(O,B,U,Z){for(var ue=null,be=null,xe=B,Fe=B=0,Ft=null;xe!==null&&Fe<U.length;Fe++){xe.index>Fe?(Ft=xe,xe=null):Ft=xe.sibling;var Ie=Q(O,xe,U[Fe],Z);if(Ie===null){xe===null&&(xe=Ft);break}u&&xe&&Ie.alternate===null&&l(O,xe),B=x(Ie,B,Fe),be===null?ue=Ie:be.sibling=Ie,be=Ie,xe=Ft}if(Fe===U.length)return d(O,xe),rt&&uo(O,Fe),ue;if(xe===null){for(;Fe<U.length;Fe++)xe=_e(O,U[Fe],Z),xe!==null&&(B=x(xe,B,Fe),be===null?ue=xe:be.sibling=xe,be=xe);return rt&&uo(O,Fe),ue}for(xe=m(O,xe);Fe<U.length;Fe++)Ft=et(xe,O,Fe,U[Fe],Z),Ft!==null&&(u&&Ft.alternate!==null&&xe.delete(Ft.key===null?Fe:Ft.key),B=x(Ft,B,Fe),be===null?ue=Ft:be.sibling=Ft,be=Ft);return u&&xe.forEach(function(ys){return l(O,ys)}),rt&&uo(O,Fe),ue}function Tn(O,B,U,Z){var ue=L(U);if(typeof ue!="function")throw Error(o(150));if(U=ue.call(U),U==null)throw Error(o(151));for(var be=ue=null,xe=B,Fe=B=0,Ft=null,Ie=U.next();xe!==null&&!Ie.done;Fe++,Ie=U.next()){xe.index>Fe?(Ft=xe,xe=null):Ft=xe.sibling;var ys=Q(O,xe,Ie.value,Z);if(ys===null){xe===null&&(xe=Ft);break}u&&xe&&ys.alternate===null&&l(O,xe),B=x(ys,B,Fe),be===null?ue=ys:be.sibling=ys,be=ys,xe=Ft}if(Ie.done)return d(O,xe),rt&&uo(O,Fe),ue;if(xe===null){for(;!Ie.done;Fe++,Ie=U.next())Ie=_e(O,Ie.value,Z),Ie!==null&&(B=x(Ie,B,Fe),be===null?ue=Ie:be.sibling=Ie,be=Ie);return rt&&uo(O,Fe),ue}for(xe=m(O,xe);!Ie.done;Fe++,Ie=U.next())Ie=et(xe,O,Fe,Ie.value,Z),Ie!==null&&(u&&Ie.alternate!==null&&xe.delete(Ie.key===null?Fe:Ie.key),B=x(Ie,B,Fe),be===null?ue=Ie:be.sibling=Ie,be=Ie);return u&&xe.forEach(function(AU){return l(O,AU)}),rt&&uo(O,Fe),ue}function Ii(O,B,U,Z){if(typeof U=="object"&&U!==null&&U.type===f&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case c:e:{for(var ue=U.key,be=B;be!==null;){if(be.key===ue){if(ue=U.type,ue===f){if(be.tag===7){d(O,be.sibling),B=g(be,U.props.children),B.return=O,O=B;break e}}else if(be.elementType===ue||typeof ue=="object"&&ue!==null&&ue.$$typeof===T&&MS(ue)===be.type){d(O,be.sibling),B=g(be,U.props),B.ref=nl(O,be,U),B.return=O,O=B;break e}d(O,be);break}else l(O,be);be=be.sibling}U.type===f?(B=go(U.props.children,O.mode,Z,U.key),B.return=O,O=B):(Z=mf(U.type,U.key,U.props,null,O.mode,Z),Z.ref=nl(O,B,U),Z.return=O,O=Z)}return E(O);case h:e:{for(be=U.key;B!==null;){if(B.key===be)if(B.tag===4&&B.stateNode.containerInfo===U.containerInfo&&B.stateNode.implementation===U.implementation){d(O,B.sibling),B=g(B,U.children||[]),B.return=O,O=B;break e}else{d(O,B);break}else l(O,B);B=B.sibling}B=g0(U,O.mode,Z),B.return=O,O=B}return E(O);case T:return be=U._init,Ii(O,B,be(U._payload),Z)}if(ye(U))return Xe(O,B,U,Z);if(L(U))return Tn(O,B,U,Z);Uh(O,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,B!==null&&B.tag===6?(d(O,B.sibling),B=g(B,U),B.return=O,O=B):(d(O,B),B=m0(U,O.mode,Z),B.return=O,O=B),E(O)):d(O,B)}return Ii}var ma=DS(!0),OS=DS(!1),Lh=hs(null),Nh=null,ga=null,bg=null;function Sg(){bg=ga=Nh=null}function kS(u,l,d){so?(Ye(Lh,l._currentValue),l._currentValue=d):(Ye(Lh,l._currentValue2),l._currentValue2=d)}function wg(u){var l=Lh.current;Je(Lh),so?u._currentValue=l:u._currentValue2=l}function Cg(u,l,d){for(;u!==null;){var m=u.alternate;if((u.childLanes&l)!==l?(u.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),u===d)break;u=u.return}}function va(u,l){Nh=u,bg=ga=null,u=u.dependencies,u!==null&&u.firstContext!==null&&(u.lanes&l&&(Sn=!0),u.firstContext=null)}function rr(u){var l=so?u._currentValue:u._currentValue2;if(bg!==u)if(u={context:u,memoizedValue:l,next:null},ga===null){if(Nh===null)throw Error(o(308));ga=u,Nh.dependencies={lanes:0,firstContext:u}}else ga=ga.next=u;return l}var lo=null;function Tg(u){lo===null?lo=[u]:lo.push(u)}function FS(u,l,d,m){var g=l.interleaved;return g===null?(d.next=d,Tg(l)):(d.next=g.next,g.next=d),l.interleaved=d,Kr(u,m)}function Kr(u,l){u.lanes|=l;var d=u.alternate;for(d!==null&&(d.lanes|=l),d=u,u=u.return;u!==null;)u.childLanes|=l,d=u.alternate,d!==null&&(d.childLanes|=l),d=u,u=u.return;return d.tag===3?d.stateNode:null}var ds=!1;function Eg(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IS(u,l){u=u.updateQueue,l.updateQueue===u&&(l.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Oi(u,l){return{eventTime:u,lane:l,tag:0,payload:null,callback:null,next:null}}function ps(u,l,d){var m=u.updateQueue;if(m===null)return null;if(m=m.shared,Se&2){var g=m.pending;return g===null?l.next=l:(l.next=g.next,g.next=l),m.pending=l,Kr(u,d)}return g=m.interleaved,g===null?(l.next=l,Tg(m)):(l.next=g.next,g.next=l),m.interleaved=l,Kr(u,d)}function Gh(u,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194240)!==0)){var m=l.lanes;m&=u.pendingLanes,d|=m,l.lanes=d,hg(u,d)}}function US(u,l){var d=u.updateQueue,m=u.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var g=null,x=null;if(d=d.firstBaseUpdate,d!==null){do{var E={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};x===null?g=x=E:x=x.next=E,d=d.next}while(d!==null);x===null?g=x=l:x=x.next=l}else g=x=l;d={baseState:m.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:m.shared,effects:m.effects},u.updateQueue=d;return}u=d.lastBaseUpdate,u===null?d.firstBaseUpdate=l:u.next=l,d.lastBaseUpdate=l}function zh(u,l,d,m){var g=u.updateQueue;ds=!1;var x=g.firstBaseUpdate,E=g.lastBaseUpdate,R=g.shared.pending;if(R!==null){g.shared.pending=null;var F=R,$=F.next;F.next=null,E===null?x=$:E.next=$,E=F;var ne=u.alternate;ne!==null&&(ne=ne.updateQueue,R=ne.lastBaseUpdate,R!==E&&(R===null?ne.firstBaseUpdate=$:R.next=$,ne.lastBaseUpdate=F))}if(x!==null){var _e=g.baseState;E=0,ne=$=F=null,R=x;do{var Q=R.lane,et=R.eventTime;if((m&Q)===Q){ne!==null&&(ne=ne.next={eventTime:et,lane:0,tag:R.tag,payload:R.payload,callback:R.callback,next:null});e:{var Xe=u,Tn=R;switch(Q=l,et=d,Tn.tag){case 1:if(Xe=Tn.payload,typeof Xe=="function"){_e=Xe.call(et,_e,Q);break e}_e=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Tn.payload,Q=typeof Xe=="function"?Xe.call(et,_e,Q):Xe,Q==null)break e;_e=s({},_e,Q);break e;case 2:ds=!0}}R.callback!==null&&R.lane!==0&&(u.flags|=64,Q=g.effects,Q===null?g.effects=[R]:Q.push(R))}else et={eventTime:et,lane:Q,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ne===null?($=ne=et,F=_e):ne=ne.next=et,E|=Q;if(R=R.next,R===null){if(R=g.shared.pending,R===null)break;Q=R,R=Q.next,Q.next=null,g.lastBaseUpdate=Q,g.shared.pending=null}}while(!0);if(ne===null&&(F=_e),g.baseState=F,g.firstBaseUpdate=$,g.lastBaseUpdate=ne,l=g.shared.interleaved,l!==null){g=l;do E|=g.lane,g=g.next;while(g!==l)}else x===null&&(g.shared.lanes=0);ho|=E,u.lanes=E,u.memoizedState=_e}}function LS(u,l,d){if(u=l.effects,l.effects=null,u!==null)for(l=0;l<u.length;l++){var m=u[l],g=m.callback;if(g!==null){if(m.callback=null,m=d,typeof g!="function")throw Error(o(191,g));g.call(m)}}}var rl={},ir=hs(rl),il=hs(rl),_a=hs(rl);function Qr(u){if(u===rl)throw Error(o(174));return u}function Ag(u,l){Ye(_a,l),Ye(il,u),Ye(ir,rl),u=Y(l),Je(ir),Ye(ir,u)}function xa(){Je(ir),Je(il),Je(_a)}function NS(u){var l=Qr(_a.current),d=Qr(ir.current);l=V(d,u.type,l),d!==l&&(Ye(il,u),Ye(ir,l))}function Pg(u){il.current===u&&(Je(ir),Je(il))}var ut=hs(0);function Hh(u){for(var l=u;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||_S(d)||ig(d)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break;for(;l.sibling===null;){if(l.return===null||l.return===u)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Rg=[];function Bg(){for(var u=0;u<Rg.length;u++){var l=Rg[u];so?l._workInProgressVersionPrimary=null:l._workInProgressVersionSecondary=null}Rg.length=0}var Vh=a.ReactCurrentDispatcher,Mg=a.ReactCurrentBatchConfig,co=0,lt=null,Et=null,Ot=null,jh=!1,sl=!1,ol=0,ZI=0;function rn(){throw Error(o(321))}function Dg(u,l){if(l===null)return!1;for(var d=0;d<l.length&&d<u.length;d++)if(!Tr(u[d],l[d]))return!1;return!0}function Og(u,l,d,m,g,x){if(co=x,lt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Vh.current=u===null||u.memoizedState===null?nU:rU,u=d(m,g),sl){x=0;do{if(sl=!1,ol=0,25<=x)throw Error(o(301));x+=1,Ot=Et=null,l.updateQueue=null,Vh.current=iU,u=d(m,g)}while(sl)}if(Vh.current=Xh,l=Et!==null&&Et.next!==null,co=0,Ot=Et=lt=null,jh=!1,l)throw Error(o(300));return u}function kg(){var u=ol!==0;return ol=0,u}function Zr(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?lt.memoizedState=Ot=u:Ot=Ot.next=u,Ot}function sr(){if(Et===null){var u=lt.alternate;u=u!==null?u.memoizedState:null}else u=Et.next;var l=Ot===null?lt.memoizedState:Ot.next;if(l!==null)Ot=l,Et=u;else{if(u===null)throw Error(o(310));Et=u,u={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Ot===null?lt.memoizedState=Ot=u:Ot=Ot.next=u}return Ot}function al(u,l){return typeof l=="function"?l(u):l}function Fg(u){var l=sr(),d=l.queue;if(d===null)throw Error(o(311));d.lastRenderedReducer=u;var m=Et,g=m.baseQueue,x=d.pending;if(x!==null){if(g!==null){var E=g.next;g.next=x.next,x.next=E}m.baseQueue=g=x,d.pending=null}if(g!==null){x=g.next,m=m.baseState;var R=E=null,F=null,$=x;do{var ne=$.lane;if((co&ne)===ne)F!==null&&(F=F.next={lane:0,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),m=$.hasEagerState?$.eagerState:u(m,$.action);else{var _e={lane:ne,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null};F===null?(R=F=_e,E=m):F=F.next=_e,lt.lanes|=ne,ho|=ne}$=$.next}while($!==null&&$!==x);F===null?E=m:F.next=R,Tr(m,l.memoizedState)||(Sn=!0),l.memoizedState=m,l.baseState=E,l.baseQueue=F,d.lastRenderedState=m}if(u=d.interleaved,u!==null){g=u;do x=g.lane,lt.lanes|=x,ho|=x,g=g.next;while(g!==u)}else g===null&&(d.lanes=0);return[l.memoizedState,d.dispatch]}function Ig(u){var l=sr(),d=l.queue;if(d===null)throw Error(o(311));d.lastRenderedReducer=u;var m=d.dispatch,g=d.pending,x=l.memoizedState;if(g!==null){d.pending=null;var E=g=g.next;do x=u(x,E.action),E=E.next;while(E!==g);Tr(x,l.memoizedState)||(Sn=!0),l.memoizedState=x,l.baseQueue===null&&(l.baseState=x),d.lastRenderedState=x}return[x,m]}function GS(){}function zS(u,l){var d=lt,m=sr(),g=l(),x=!Tr(m.memoizedState,g);if(x&&(m.memoizedState=g,Sn=!0),m=m.queue,Ug(jS.bind(null,d,m,u),[u]),m.getSnapshot!==l||x||Ot!==null&&Ot.memoizedState.tag&1){if(d.flags|=2048,ul(9,VS.bind(null,d,m,g,l),void 0,null),kt===null)throw Error(o(349));co&30||HS(d,l,g)}return g}function HS(u,l,d){u.flags|=16384,u={getSnapshot:l,value:d},l=lt.updateQueue,l===null?(l={lastEffect:null,stores:null},lt.updateQueue=l,l.stores=[u]):(d=l.stores,d===null?l.stores=[u]:d.push(u))}function VS(u,l,d,m){l.value=d,l.getSnapshot=m,WS(l)&&$S(u)}function jS(u,l,d){return d(function(){WS(l)&&$S(u)})}function WS(u){var l=u.getSnapshot;u=u.value;try{var d=l();return!Tr(u,d)}catch{return!0}}function $S(u){var l=Kr(u,1);l!==null&&or(l,u,1,-1)}function XS(u){var l=Zr();return typeof u=="function"&&(u=u()),l.memoizedState=l.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:al,lastRenderedState:u},l.queue=u,u=u.dispatch=tU.bind(null,lt,u),[l.memoizedState,u]}function ul(u,l,d,m){return u={tag:u,create:l,destroy:d,deps:m,next:null},l=lt.updateQueue,l===null?(l={lastEffect:null,stores:null},lt.updateQueue=l,l.lastEffect=u.next=u):(d=l.lastEffect,d===null?l.lastEffect=u.next=u:(m=d.next,d.next=u,u.next=m,l.lastEffect=u)),u}function YS(){return sr().memoizedState}function Wh(u,l,d,m){var g=Zr();lt.flags|=u,g.memoizedState=ul(1|l,d,void 0,m===void 0?null:m)}function $h(u,l,d,m){var g=sr();m=m===void 0?null:m;var x=void 0;if(Et!==null){var E=Et.memoizedState;if(x=E.destroy,m!==null&&Dg(m,E.deps)){g.memoizedState=ul(l,d,x,m);return}}lt.flags|=u,g.memoizedState=ul(1|l,d,x,m)}function qS(u,l){return Wh(8390656,8,u,l)}function Ug(u,l){return $h(2048,8,u,l)}function KS(u,l){return $h(4,2,u,l)}function QS(u,l){return $h(4,4,u,l)}function ZS(u,l){if(typeof l=="function")return u=u(),l(u),function(){l(null)};if(l!=null)return u=u(),l.current=u,function(){l.current=null}}function JS(u,l,d){return d=d!=null?d.concat([u]):null,$h(4,4,ZS.bind(null,l,u),d)}function Lg(){}function e3(u,l){var d=sr();l=l===void 0?null:l;var m=d.memoizedState;return m!==null&&l!==null&&Dg(l,m[1])?m[0]:(d.memoizedState=[u,l],u)}function t3(u,l){var d=sr();l=l===void 0?null:l;var m=d.memoizedState;return m!==null&&l!==null&&Dg(l,m[1])?m[0]:(u=u(),d.memoizedState=[u,l],u)}function n3(u,l,d){return co&21?(Tr(d,l)||(d=SS(),lt.lanes|=d,ho|=d,u.baseState=!0),l):(u.baseState&&(u.baseState=!1,Sn=!0),u.memoizedState=d)}function JI(u,l){var d=ke;ke=d!==0&&4>d?d:4,u(!0);var m=Mg.transition;Mg.transition={};try{u(!1),l()}finally{ke=d,Mg.transition=m}}function r3(){return sr().memoizedState}function eU(u,l,d){var m=vs(u);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},i3(u))s3(l,d);else if(d=FS(u,l,d,m),d!==null){var g=an();or(d,u,m,g),o3(d,l,m)}}function tU(u,l,d){var m=vs(u),g={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(i3(u))s3(l,g);else{var x=u.alternate;if(u.lanes===0&&(x===null||x.lanes===0)&&(x=l.lastRenderedReducer,x!==null))try{var E=l.lastRenderedState,R=x(E,d);if(g.hasEagerState=!0,g.eagerState=R,Tr(R,E)){var F=l.interleaved;F===null?(g.next=g,Tg(l)):(g.next=F.next,F.next=g),l.interleaved=g;return}}catch{}finally{}d=FS(u,l,g,m),d!==null&&(g=an(),or(d,u,m,g),o3(d,l,m))}}function i3(u){var l=u.alternate;return u===lt||l!==null&&l===lt}function s3(u,l){sl=jh=!0;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}function o3(u,l,d){if(d&4194240){var m=l.lanes;m&=u.pendingLanes,d|=m,l.lanes=d,hg(u,d)}}var Xh={readContext:rr,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},nU={readContext:rr,useCallback:function(u,l){return Zr().memoizedState=[u,l===void 0?null:l],u},useContext:rr,useEffect:qS,useImperativeHandle:function(u,l,d){return d=d!=null?d.concat([u]):null,Wh(4194308,4,ZS.bind(null,l,u),d)},useLayoutEffect:function(u,l){return Wh(4194308,4,u,l)},useInsertionEffect:function(u,l){return Wh(4,2,u,l)},useMemo:function(u,l){var d=Zr();return l=l===void 0?null:l,u=u(),d.memoizedState=[u,l],u},useReducer:function(u,l,d){var m=Zr();return l=d!==void 0?d(l):l,m.memoizedState=m.baseState=l,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:l},m.queue=u,u=u.dispatch=eU.bind(null,lt,u),[m.memoizedState,u]},useRef:function(u){var l=Zr();return u={current:u},l.memoizedState=u},useState:XS,useDebugValue:Lg,useDeferredValue:function(u){return Zr().memoizedState=u},useTransition:function(){var u=XS(!1),l=u[0];return u=JI.bind(null,u[1]),Zr().memoizedState=u,[l,u]},useMutableSource:function(){},useSyncExternalStore:function(u,l,d){var m=lt,g=Zr();if(rt){if(d===void 0)throw Error(o(407));d=d()}else{if(d=l(),kt===null)throw Error(o(349));co&30||HS(m,l,d)}g.memoizedState=d;var x={value:d,getSnapshot:l};return g.queue=x,qS(jS.bind(null,m,x,u),[u]),m.flags|=2048,ul(9,VS.bind(null,m,x,d,l),void 0,null),d},useId:function(){var u=Zr(),l=kt.identifierPrefix;if(rt){var d=Di,m=Mi;d=(m&~(1<<32-Cr(m)-1)).toString(32)+d,l=":"+l+"R"+d,d=ol++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=ZI++,l=":"+l+"r"+d.toString(32)+":";return u.memoizedState=l},unstable_isNewReconciler:!1},rU={readContext:rr,useCallback:e3,useContext:rr,useEffect:Ug,useImperativeHandle:JS,useInsertionEffect:KS,useLayoutEffect:QS,useMemo:t3,useReducer:Fg,useRef:YS,useState:function(){return Fg(al)},useDebugValue:Lg,useDeferredValue:function(u){var l=sr();return n3(l,Et.memoizedState,u)},useTransition:function(){var u=Fg(al)[0],l=sr().memoizedState;return[u,l]},useMutableSource:GS,useSyncExternalStore:zS,useId:r3,unstable_isNewReconciler:!1},iU={readContext:rr,useCallback:e3,useContext:rr,useEffect:Ug,useImperativeHandle:JS,useInsertionEffect:KS,useLayoutEffect:QS,useMemo:t3,useReducer:Ig,useRef:YS,useState:function(){return Ig(al)},useDebugValue:Lg,useDeferredValue:function(u){var l=sr();return Et===null?l.memoizedState=u:n3(l,Et.memoizedState,u)},useTransition:function(){var u=Ig(al)[0],l=sr().memoizedState;return[u,l]},useMutableSource:GS,useSyncExternalStore:zS,useId:r3,unstable_isNewReconciler:!1};function Ar(u,l){if(u&&u.defaultProps){l=s({},l),u=u.defaultProps;for(var d in u)l[d]===void 0&&(l[d]=u[d]);return l}return l}function Ng(u,l,d,m){l=u.memoizedState,d=d(m,l),d=d==null?l:s({},l,d),u.memoizedState=d,u.lanes===0&&(u.updateQueue.baseState=d)}var Yh={isMounted:function(u){return(u=u._reactInternals)?k(u)===u:!1},enqueueSetState:function(u,l,d){u=u._reactInternals;var m=an(),g=vs(u),x=Oi(m,g);x.payload=l,d!=null&&(x.callback=d),l=ps(u,x,g),l!==null&&(or(l,u,g,m),Gh(l,u,g))},enqueueReplaceState:function(u,l,d){u=u._reactInternals;var m=an(),g=vs(u),x=Oi(m,g);x.tag=1,x.payload=l,d!=null&&(x.callback=d),l=ps(u,x,g),l!==null&&(or(l,u,g,m),Gh(l,u,g))},enqueueForceUpdate:function(u,l){u=u._reactInternals;var d=an(),m=vs(u),g=Oi(d,m);g.tag=2,l!=null&&(g.callback=l),l=ps(u,g,m),l!==null&&(or(l,u,m,d),Gh(l,u,m))}};function a3(u,l,d,m,g,x,E){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(m,x,E):l.prototype&&l.prototype.isPureReactComponent?!Ih(d,m)||!Ih(g,x):!0}function u3(u,l,d){var m=!1,g=fs,x=l.contextType;return typeof x=="object"&&x!==null?x=rr(x):(g=bn(l)?oo:nn.current,m=l.contextTypes,x=(m=m!=null)?ha(u,g):fs),l=new l(d,x),u.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Yh,u.stateNode=l,l._reactInternals=u,m&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=g,u.__reactInternalMemoizedMaskedChildContext=x),l}function l3(u,l,d,m){u=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,m),l.state!==u&&Yh.enqueueReplaceState(l,l.state,null)}function Gg(u,l,d,m){var g=u.stateNode;g.props=d,g.state=u.memoizedState,g.refs={},Eg(u);var x=l.contextType;typeof x=="object"&&x!==null?g.context=rr(x):(x=bn(l)?oo:nn.current,g.context=ha(u,x)),g.state=u.memoizedState,x=l.getDerivedStateFromProps,typeof x=="function"&&(Ng(u,l,x,d),g.state=u.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(l=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),l!==g.state&&Yh.enqueueReplaceState(g,g.state,null),zh(u,d,g,m),g.state=u.memoizedState),typeof g.componentDidMount=="function"&&(u.flags|=4194308)}function ya(u,l){try{var d="",m=l;do d+=QI(m),m=m.return;while(m);var g=d}catch(x){g=`
Error generating stack: `+x.message+`
`+x.stack}return{value:u,source:l,stack:g,digest:null}}function zg(u,l,d){return{value:u,source:null,stack:d??null,digest:l??null}}function Hg(u,l){try{console.error(l.value)}catch(d){setTimeout(function(){throw d})}}var sU=typeof WeakMap=="function"?WeakMap:Map;function c3(u,l,d){d=Oi(-1,d),d.tag=3,d.payload={element:null};var m=l.value;return d.callback=function(){lf||(lf=!0,u0=m),Hg(u,l)},d}function h3(u,l,d){d=Oi(-1,d),d.tag=3;var m=u.type.getDerivedStateFromError;if(typeof m=="function"){var g=l.value;d.payload=function(){return m(g)},d.callback=function(){Hg(u,l)}}var x=u.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(d.callback=function(){Hg(u,l),typeof m!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var E=l.stack;this.componentDidCatch(l.value,{componentStack:E!==null?E:""})}),d}function f3(u,l,d){var m=u.pingCache;if(m===null){m=u.pingCache=new sU;var g=new Set;m.set(l,g)}else g=m.get(l),g===void 0&&(g=new Set,m.set(l,g));g.has(d)||(g.add(d),u=xU.bind(null,u,l,d),l.then(u,u))}function d3(u){do{var l;if((l=u.tag===13)&&(l=u.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return u;u=u.return}while(u!==null);return null}function p3(u,l,d,m,g){return u.mode&1?(u.flags|=65536,u.lanes=g,u):(u===l?u.flags|=65536:(u.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(l=Oi(-1,1),l.tag=2,ps(d,l,1))),d.lanes|=1),u)}var oU=a.ReactCurrentOwner,Sn=!1;function dn(u,l,d,m){l.child=u===null?OS(l,null,d,m):ma(l,u.child,d,m)}function m3(u,l,d,m,g){d=d.render;var x=l.ref;return va(l,g),m=Og(u,l,d,m,x,g),d=kg(),u!==null&&!Sn?(l.updateQueue=u.updateQueue,l.flags&=-2053,u.lanes&=~g,ki(u,l,g)):(rt&&d&&gg(l),l.flags|=1,dn(u,l,m,g),l.child)}function g3(u,l,d,m,g){if(u===null){var x=d.type;return typeof x=="function"&&!p0(x)&&x.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(l.tag=15,l.type=x,v3(u,l,x,m,g)):(u=mf(d.type,null,m,l,l.mode,g),u.ref=l.ref,u.return=l,l.child=u)}if(x=u.child,!(u.lanes&g)){var E=x.memoizedProps;if(d=d.compare,d=d!==null?d:Ih,d(E,m)&&u.ref===l.ref)return ki(u,l,g)}return l.flags|=1,u=xs(x,m),u.ref=l.ref,u.return=l,l.child=u}function v3(u,l,d,m,g){if(u!==null){var x=u.memoizedProps;if(Ih(x,m)&&u.ref===l.ref)if(Sn=!1,l.pendingProps=m=x,(u.lanes&g)!==0)u.flags&131072&&(Sn=!0);else return l.lanes=u.lanes,ki(u,l,g)}return Vg(u,l,d,m,g)}function _3(u,l,d){var m=l.pendingProps,g=m.children,x=u!==null?u.memoizedState:null;if(m.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(Sa,zn),zn|=d;else{if(!(d&1073741824))return u=x!==null?x.baseLanes|d:d,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:u,cachePool:null,transitions:null},l.updateQueue=null,Ye(Sa,zn),zn|=u,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=x!==null?x.baseLanes:d,Ye(Sa,zn),zn|=m}else x!==null?(m=x.baseLanes|d,l.memoizedState=null):m=d,Ye(Sa,zn),zn|=m;return dn(u,l,g,d),l.child}function x3(u,l){var d=l.ref;(u===null&&d!==null||u!==null&&u.ref!==d)&&(l.flags|=512,l.flags|=2097152)}function Vg(u,l,d,m,g){var x=bn(d)?oo:nn.current;return x=ha(l,x),va(l,g),d=Og(u,l,d,m,x,g),m=kg(),u!==null&&!Sn?(l.updateQueue=u.updateQueue,l.flags&=-2053,u.lanes&=~g,ki(u,l,g)):(rt&&m&&gg(l),l.flags|=1,dn(u,l,d,g),l.child)}function y3(u,l,d,m,g){if(bn(d)){var x=!0;Ah(l)}else x=!1;if(va(l,g),l.stateNode===null)Kh(u,l),u3(l,d,m),Gg(l,d,m,g),m=!0;else if(u===null){var E=l.stateNode,R=l.memoizedProps;E.props=R;var F=E.context,$=d.contextType;typeof $=="object"&&$!==null?$=rr($):($=bn(d)?oo:nn.current,$=ha(l,$));var ne=d.getDerivedStateFromProps,_e=typeof ne=="function"||typeof E.getSnapshotBeforeUpdate=="function";_e||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(R!==m||F!==$)&&l3(l,E,m,$),ds=!1;var Q=l.memoizedState;E.state=Q,zh(l,m,E,g),F=l.memoizedState,R!==m||Q!==F||yn.current||ds?(typeof ne=="function"&&(Ng(l,d,ne,m),F=l.memoizedState),(R=ds||a3(l,d,R,m,Q,F,$))?(_e||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=F),E.props=m,E.state=F,E.context=$,m=R):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{E=l.stateNode,IS(u,l),R=l.memoizedProps,$=l.type===l.elementType?R:Ar(l.type,R),E.props=$,_e=l.pendingProps,Q=E.context,F=d.contextType,typeof F=="object"&&F!==null?F=rr(F):(F=bn(d)?oo:nn.current,F=ha(l,F));var et=d.getDerivedStateFromProps;(ne=typeof et=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(R!==_e||Q!==F)&&l3(l,E,m,F),ds=!1,Q=l.memoizedState,E.state=Q,zh(l,m,E,g);var Xe=l.memoizedState;R!==_e||Q!==Xe||yn.current||ds?(typeof et=="function"&&(Ng(l,d,et,m),Xe=l.memoizedState),($=ds||a3(l,d,$,m,Q,Xe,F)||!1)?(ne||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(m,Xe,F),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(m,Xe,F)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||R===u.memoizedProps&&Q===u.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||R===u.memoizedProps&&Q===u.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=Xe),E.props=m,E.state=Xe,E.context=F,m=$):(typeof E.componentDidUpdate!="function"||R===u.memoizedProps&&Q===u.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||R===u.memoizedProps&&Q===u.memoizedState||(l.flags|=1024),m=!1)}return jg(u,l,d,m,x,g)}function jg(u,l,d,m,g,x){x3(u,l);var E=(l.flags&128)!==0;if(!m&&!E)return g&&bS(l,d,!1),ki(u,l,x);m=l.stateNode,oU.current=l;var R=E&&typeof d.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,u!==null&&E?(l.child=ma(l,u.child,null,x),l.child=ma(l,null,R,x)):dn(u,l,R,x),l.memoizedState=m.state,g&&bS(l,d,!0),l.child}function b3(u){var l=u.stateNode;l.pendingContext?xS(u,l.pendingContext,l.pendingContext!==l.context):l.context&&xS(u,l.context,!1),Ag(u,l.containerInfo)}function S3(u,l,d,m,g){return pa(),yg(g),l.flags|=256,dn(u,l,d,m),l.child}var Wg={dehydrated:null,treeContext:null,retryLane:0};function $g(u){return{baseLanes:u,cachePool:null,transitions:null}}function w3(u,l,d){var m=l.pendingProps,g=ut.current,x=!1,E=(l.flags&128)!==0,R;if((R=E)||(R=u!==null&&u.memoizedState===null?!1:(g&2)!==0),R?(x=!0,l.flags&=-129):(u===null||u.memoizedState!==null)&&(g|=1),Ye(ut,g&1),u===null)return xg(l),u=l.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?(l.mode&1?ig(u)?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(E=m.children,u=m.fallback,x?(m=l.mode,x=l.child,E={mode:"hidden",children:E},!(m&1)&&x!==null?(x.childLanes=0,x.pendingProps=E):x=gf(E,m,0,null),u=go(u,m,d,null),x.return=l,u.return=l,x.sibling=u,l.child=x,l.child.memoizedState=$g(d),l.memoizedState=Wg,u):Xg(l,E));if(g=u.memoizedState,g!==null&&(R=g.dehydrated,R!==null))return aU(u,l,E,m,R,g,d);if(x){x=m.fallback,E=l.mode,g=u.child,R=g.sibling;var F={mode:"hidden",children:m.children};return!(E&1)&&l.child!==g?(m=l.child,m.childLanes=0,m.pendingProps=F,l.deletions=null):(m=xs(g,F),m.subtreeFlags=g.subtreeFlags&14680064),R!==null?x=xs(R,x):(x=go(x,E,d,null),x.flags|=2),x.return=l,m.return=l,m.sibling=x,l.child=m,m=x,x=l.child,E=u.child.memoizedState,E=E===null?$g(d):{baseLanes:E.baseLanes|d,cachePool:null,transitions:E.transitions},x.memoizedState=E,x.childLanes=u.childLanes&~d,l.memoizedState=Wg,m}return x=u.child,u=x.sibling,m=xs(x,{mode:"visible",children:m.children}),!(l.mode&1)&&(m.lanes=d),m.return=l,m.sibling=null,u!==null&&(d=l.deletions,d===null?(l.deletions=[u],l.flags|=16):d.push(u)),l.child=m,l.memoizedState=null,m}function Xg(u,l){return l=gf({mode:"visible",children:l},u.mode,0,null),l.return=u,u.child=l}function qh(u,l,d,m){return m!==null&&yg(m),ma(l,u.child,null,d),u=Xg(l,l.pendingProps.children),u.flags|=2,l.memoizedState=null,u}function aU(u,l,d,m,g,x,E){if(d)return l.flags&256?(l.flags&=-257,m=zg(Error(o(422))),qh(u,l,E,m)):l.memoizedState!==null?(l.child=u.child,l.flags|=128,null):(x=m.fallback,g=l.mode,m=gf({mode:"visible",children:m.children},g,0,null),x=go(x,g,E,null),x.flags|=2,m.return=l,x.return=l,m.sibling=x,l.child=m,l.mode&1&&ma(l,u.child,null,E),l.child.memoizedState=$g(E),l.memoizedState=Wg,x);if(!(l.mode&1))return qh(u,l,E,null);if(ig(g))return m=yI(g).digest,x=Error(o(419)),m=zg(x,m,void 0),qh(u,l,E,m);if(d=(E&u.childLanes)!==0,Sn||d){if(m=kt,m!==null){switch(E&-E){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(m.suspendedLanes|E)?0:g,g!==0&&g!==x.retryLane&&(x.retryLane=g,Kr(u,g),or(m,u,g,-1))}return d0(),m=zg(Error(o(421))),qh(u,l,E,m)}return _S(g)?(l.flags|=128,l.child=u.child,l=yU.bind(null,u),bI(g,l),null):(u=x.treeContext,Vt&&(nr=CI(g),Gn=l,rt=!0,Er=null,tl=!1,u!==null&&(er[tr++]=Mi,er[tr++]=Di,er[tr++]=ao,Mi=u.id,Di=u.overflow,ao=l)),l=Xg(l,m.children),l.flags|=4096,l)}function C3(u,l,d){u.lanes|=l;var m=u.alternate;m!==null&&(m.lanes|=l),Cg(u.return,l,d)}function Yg(u,l,d,m,g){var x=u.memoizedState;x===null?u.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:g}:(x.isBackwards=l,x.rendering=null,x.renderingStartTime=0,x.last=m,x.tail=d,x.tailMode=g)}function T3(u,l,d){var m=l.pendingProps,g=m.revealOrder,x=m.tail;if(dn(u,l,m.children,d),m=ut.current,m&2)m=m&1|2,l.flags|=128;else{if(u!==null&&u.flags&128)e:for(u=l.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&C3(u,d,l);else if(u.tag===19)C3(u,d,l);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}m&=1}if(Ye(ut,m),!(l.mode&1))l.memoizedState=null;else switch(g){case"forwards":for(d=l.child,g=null;d!==null;)u=d.alternate,u!==null&&Hh(u)===null&&(g=d),d=d.sibling;d=g,d===null?(g=l.child,l.child=null):(g=d.sibling,d.sibling=null),Yg(l,!1,g,d,x);break;case"backwards":for(d=null,g=l.child,l.child=null;g!==null;){if(u=g.alternate,u!==null&&Hh(u)===null){l.child=g;break}u=g.sibling,g.sibling=d,d=g,g=u}Yg(l,!0,d,null,x);break;case"together":Yg(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Kh(u,l){!(l.mode&1)&&u!==null&&(u.alternate=null,l.alternate=null,l.flags|=2)}function ki(u,l,d){if(u!==null&&(l.dependencies=u.dependencies),ho|=l.lanes,!(d&l.childLanes))return null;if(u!==null&&l.child!==u.child)throw Error(o(153));if(l.child!==null){for(u=l.child,d=xs(u,u.pendingProps),l.child=d,d.return=l;u.sibling!==null;)u=u.sibling,d=d.sibling=xs(u,u.pendingProps),d.return=l;d.sibling=null}return l.child}function uU(u,l,d){switch(l.tag){case 3:b3(l),pa();break;case 5:NS(l);break;case 1:bn(l.type)&&Ah(l);break;case 4:Ag(l,l.stateNode.containerInfo);break;case 10:kS(l,l.type._context,l.memoizedProps.value);break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(Ye(ut,ut.current&1),l.flags|=128,null):d&l.child.childLanes?w3(u,l,d):(Ye(ut,ut.current&1),u=ki(u,l,d),u!==null?u.sibling:null);Ye(ut,ut.current&1);break;case 19:if(m=(d&l.childLanes)!==0,u.flags&128){if(m)return T3(u,l,d);l.flags|=128}var g=l.memoizedState;if(g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Ye(ut,ut.current),m)break;return null;case 22:case 23:return l.lanes=0,_3(u,l,d)}return ki(u,l,d)}function Jr(u){u.flags|=4}function E3(u,l){if(u!==null&&u.child===l.child)return!0;if(l.flags&16)return!1;for(u=l.child;u!==null;){if(u.flags&12854||u.subtreeFlags&12854)return!1;u=u.sibling}return!0}var ll,cl,Qh,Zh;if(tn)ll=function(u,l){for(var d=l.child;d!==null;){if(d.tag===5||d.tag===6)ce(u,d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},cl=function(){},Qh=function(u,l,d,m,g){if(u=u.memoizedProps,u!==m){var x=l.stateNode,E=Qr(ir.current);d=Jt(x,d,u,m,g,E),(l.updateQueue=d)&&Jr(l)}},Zh=function(u,l,d,m){d!==m&&Jr(l)};else if(Ti){ll=function(u,l,d,m){for(var g=l.child;g!==null;){if(g.tag===5){var x=g.stateNode;d&&m&&(x=gS(x,g.type,g.memoizedProps,g)),ce(u,x)}else if(g.tag===6)x=g.stateNode,d&&m&&(x=vS(x,g.memoizedProps,g)),ce(u,x);else if(g.tag!==4){if(g.tag===22&&g.memoizedState!==null)x=g.child,x!==null&&(x.return=g),ll(u,g,!0,!0);else if(g.child!==null){g.child.return=g,g=g.child;continue}}if(g===l)break;for(;g.sibling===null;){if(g.return===null||g.return===l)return;g=g.return}g.sibling.return=g.return,g=g.sibling}};var A3=function(u,l,d,m){for(var g=l.child;g!==null;){if(g.tag===5){var x=g.stateNode;d&&m&&(x=gS(x,g.type,g.memoizedProps,g)),mS(u,x)}else if(g.tag===6)x=g.stateNode,d&&m&&(x=vS(x,g.memoizedProps,g)),mS(u,x);else if(g.tag!==4){if(g.tag===22&&g.memoizedState!==null)x=g.child,x!==null&&(x.return=g),A3(u,g,!0,!0);else if(g.child!==null){g.child.return=g,g=g.child;continue}}if(g===l)break;for(;g.sibling===null;){if(g.return===null||g.return===l)return;g=g.return}g.sibling.return=g.return,g=g.sibling}};cl=function(u,l){var d=l.stateNode;if(!E3(u,l)){u=d.containerInfo;var m=pS(u);A3(m,l,!1,!1),d.pendingChildren=m,Jr(l),gI(u,m)}},Qh=function(u,l,d,m,g){var x=u.stateNode,E=u.memoizedProps;if((u=E3(u,l))&&E===m)l.stateNode=x;else{var R=l.stateNode,F=Qr(ir.current),$=null;E!==m&&($=Jt(R,d,E,m,g,F)),u&&$===null?l.stateNode=x:(x=mI(x,$,d,E,m,l,u,R),Zt(x,d,m,g,F)&&Jr(l),l.stateNode=x,u?Jr(l):ll(x,l,!1,!1))}},Zh=function(u,l,d,m){d!==m?(u=Qr(_a.current),d=Qr(ir.current),l.stateNode=en(m,u,d,l),Jr(l)):l.stateNode=u.stateNode}}else cl=function(){},Qh=function(){},Zh=function(){};function hl(u,l){if(!rt)switch(u.tailMode){case"hidden":l=u.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?u.tail=null:d.sibling=null;break;case"collapsed":d=u.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?l||u.tail===null?u.tail=null:u.tail.sibling=null:m.sibling=null}}function sn(u){var l=u.alternate!==null&&u.alternate.child===u.child,d=0,m=0;if(l)for(var g=u.child;g!==null;)d|=g.lanes|g.childLanes,m|=g.subtreeFlags&14680064,m|=g.flags&14680064,g.return=u,g=g.sibling;else for(g=u.child;g!==null;)d|=g.lanes|g.childLanes,m|=g.subtreeFlags,m|=g.flags,g.return=u,g=g.sibling;return u.subtreeFlags|=m,u.childLanes=d,l}function lU(u,l,d){var m=l.pendingProps;switch(vg(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sn(l),null;case 1:return bn(l.type)&&Eh(),sn(l),null;case 3:return d=l.stateNode,xa(),Je(yn),Je(nn),Bg(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(u===null||u.child===null)&&(Fh(l)?Jr(l):u===null||u.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,Er!==null&&(h0(Er),Er=null))),cl(u,l),sn(l),null;case 5:Pg(l),d=Qr(_a.current);var g=l.type;if(u!==null&&l.stateNode!=null)Qh(u,l,g,m,d),u.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(o(166));return sn(l),null}if(u=Qr(ir.current),Fh(l)){if(!Vt)throw Error(o(175));u=TI(l.stateNode,l.type,l.memoizedProps,d,u,l,!tl),l.updateQueue=u,u!==null&&Jr(l)}else{var x=je(g,m,d,u,l);ll(x,l,!1,!1),l.stateNode=x,Zt(x,g,m,d,u)&&Jr(l)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return sn(l),null;case 6:if(u&&l.stateNode!=null)Zh(u,l,u.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(o(166));if(u=Qr(_a.current),d=Qr(ir.current),Fh(l)){if(!Vt)throw Error(o(176));if(u=l.stateNode,d=l.memoizedProps,(m=EI(u,d,l,!tl))&&(g=Gn,g!==null))switch(g.tag){case 3:kI(g.stateNode.containerInfo,u,d,(g.mode&1)!==0);break;case 5:FI(g.type,g.memoizedProps,g.stateNode,u,d,(g.mode&1)!==0)}m&&Jr(l)}else l.stateNode=en(m,u,d,l)}return sn(l),null;case 13:if(Je(ut),m=l.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(rt&&nr!==null&&l.mode&1&&!(l.flags&128))BS(),pa(),l.flags|=98560,g=!1;else if(g=Fh(l),m!==null&&m.dehydrated!==null){if(u===null){if(!g)throw Error(o(318));if(!Vt)throw Error(o(344));if(g=l.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(o(317));AI(g,l)}else pa(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;sn(l),g=!1}else Er!==null&&(h0(Er),Er=null),g=!0;if(!g)return l.flags&65536?l:null}return l.flags&128?(l.lanes=d,l):(d=m!==null,d!==(u!==null&&u.memoizedState!==null)&&d&&(l.child.flags|=8192,l.mode&1&&(u===null||ut.current&1?At===0&&(At=3):d0())),l.updateQueue!==null&&(l.flags|=4),sn(l),null);case 4:return xa(),cl(u,l),u===null&&Ei(l.stateNode.containerInfo),sn(l),null;case 10:return wg(l.type._context),sn(l),null;case 17:return bn(l.type)&&Eh(),sn(l),null;case 19:if(Je(ut),g=l.memoizedState,g===null)return sn(l),null;if(m=(l.flags&128)!==0,x=g.rendering,x===null)if(m)hl(g,!1);else{if(At!==0||u!==null&&u.flags&128)for(u=l.child;u!==null;){if(x=Hh(u),x!==null){for(l.flags|=128,hl(g,!1),u=x.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),l.subtreeFlags=0,u=d,d=l.child;d!==null;)m=d,g=u,m.flags&=14680066,x=m.alternate,x===null?(m.childLanes=0,m.lanes=g,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=x.childLanes,m.lanes=x.lanes,m.child=x.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=x.memoizedProps,m.memoizedState=x.memoizedState,m.updateQueue=x.updateQueue,m.type=x.type,g=x.dependencies,m.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),d=d.sibling;return Ye(ut,ut.current&1|2),l.child}u=u.sibling}g.tail!==null&&Dt()>a0&&(l.flags|=128,m=!0,hl(g,!1),l.lanes=4194304)}else{if(!m)if(u=Hh(x),u!==null){if(l.flags|=128,m=!0,u=u.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),hl(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!rt)return sn(l),null}else 2*Dt()-g.renderingStartTime>a0&&d!==1073741824&&(l.flags|=128,m=!0,hl(g,!1),l.lanes=4194304);g.isBackwards?(x.sibling=l.child,l.child=x):(u=g.last,u!==null?u.sibling=x:l.child=x,g.last=x)}return g.tail!==null?(l=g.tail,g.rendering=l,g.tail=l.sibling,g.renderingStartTime=Dt(),l.sibling=null,u=ut.current,Ye(ut,m?u&1|2:u&1),l):(sn(l),null);case 22:case 23:return f0(),d=l.memoizedState!==null,u!==null&&u.memoizedState!==null!==d&&(l.flags|=8192),d&&l.mode&1?zn&1073741824&&(sn(l),tn&&l.subtreeFlags&6&&(l.flags|=8192)):sn(l),null;case 24:return null;case 25:return null}throw Error(o(156,l.tag))}function cU(u,l){switch(vg(l),l.tag){case 1:return bn(l.type)&&Eh(),u=l.flags,u&65536?(l.flags=u&-65537|128,l):null;case 3:return xa(),Je(yn),Je(nn),Bg(),u=l.flags,u&65536&&!(u&128)?(l.flags=u&-65537|128,l):null;case 5:return Pg(l),null;case 13:if(Je(ut),u=l.memoizedState,u!==null&&u.dehydrated!==null){if(l.alternate===null)throw Error(o(340));pa()}return u=l.flags,u&65536?(l.flags=u&-65537|128,l):null;case 19:return Je(ut),null;case 4:return xa(),null;case 10:return wg(l.type._context),null;case 22:case 23:return f0(),null;case 24:return null;default:return null}}var Jh=!1,on=!1,hU=typeof WeakSet=="function"?WeakSet:Set,ee=null;function ba(u,l){var d=u.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){it(u,l,m)}else d.current=null}function qg(u,l,d){try{d()}catch(m){it(u,l,m)}}var P3=!1;function fU(u,l){for(z(u.containerInfo),ee=l;ee!==null;)if(u=ee,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,ee=l;else for(;ee!==null;){u=ee;try{var d=u.alternate;if(u.flags&1024)switch(u.tag){case 0:case 11:case 15:break;case 1:if(d!==null){var m=d.memoizedProps,g=d.memoizedState,x=u.stateNode,E=x.getSnapshotBeforeUpdate(u.elementType===u.type?m:Ar(u.type,m),g);x.__reactInternalSnapshotBeforeUpdate=E}break;case 3:tn&&pI(u.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(R){it(u,u.return,R)}if(l=u.sibling,l!==null){l.return=u.return,ee=l;break}ee=u.return}return d=P3,P3=!1,d}function fl(u,l,d){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var g=m=m.next;do{if((g.tag&u)===u){var x=g.destroy;g.destroy=void 0,x!==void 0&&qg(l,d,x)}g=g.next}while(g!==m)}}function ef(u,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&u)===u){var m=d.create;d.destroy=m()}d=d.next}while(d!==l)}}function Kg(u){var l=u.ref;if(l!==null){var d=u.stateNode;switch(u.tag){case 5:u=oe(d);break;default:u=d}typeof l=="function"?l(u):l.current=u}}function R3(u){var l=u.alternate;l!==null&&(u.alternate=null,R3(l)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(l=u.stateNode,l!==null&&Pi(l)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function B3(u){return u.tag===5||u.tag===3||u.tag===4}function M3(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||B3(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Qg(u,l,d){var m=u.tag;if(m===5||m===6)u=u.stateNode,l?aI(d,u,l):nI(d,u);else if(m!==4&&(u=u.child,u!==null))for(Qg(u,l,d),u=u.sibling;u!==null;)Qg(u,l,d),u=u.sibling}function Zg(u,l,d){var m=u.tag;if(m===5||m===6)u=u.stateNode,l?oI(d,u,l):tI(d,u);else if(m!==4&&(u=u.child,u!==null))for(Zg(u,l,d),u=u.sibling;u!==null;)Zg(u,l,d),u=u.sibling}var jt=null,Pr=!1;function ei(u,l,d){for(d=d.child;d!==null;)Jg(u,l,d),d=d.sibling}function Jg(u,l,d){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(Mh,d)}catch{}switch(d.tag){case 5:on||ba(d,l);case 6:if(tn){var m=jt,g=Pr;jt=null,ei(u,l,d),jt=m,Pr=g,jt!==null&&(Pr?lI(jt,d.stateNode):uI(jt,d.stateNode))}else ei(u,l,d);break;case 18:tn&&jt!==null&&(Pr?DI(jt,d.stateNode):MI(jt,d.stateNode));break;case 4:tn?(m=jt,g=Pr,jt=d.stateNode.containerInfo,Pr=!0,ei(u,l,d),jt=m,Pr=g):(Ti&&(m=d.stateNode.containerInfo,g=pS(m),rg(m,g)),ei(u,l,d));break;case 0:case 11:case 14:case 15:if(!on&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){g=m=m.next;do{var x=g,E=x.destroy;x=x.tag,E!==void 0&&(x&2||x&4)&&qg(d,l,E),g=g.next}while(g!==m)}ei(u,l,d);break;case 1:if(!on&&(ba(d,l),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(R){it(d,l,R)}ei(u,l,d);break;case 21:ei(u,l,d);break;case 22:d.mode&1?(on=(m=on)||d.memoizedState!==null,ei(u,l,d),on=m):ei(u,l,d);break;default:ei(u,l,d)}}function D3(u){var l=u.updateQueue;if(l!==null){u.updateQueue=null;var d=u.stateNode;d===null&&(d=u.stateNode=new hU),l.forEach(function(m){var g=bU.bind(null,u,m);d.has(m)||(d.add(m),m.then(g,g))})}}function Rr(u,l){var d=l.deletions;if(d!==null)for(var m=0;m<d.length;m++){var g=d[m];try{var x=u,E=l;if(tn){var R=E;e:for(;R!==null;){switch(R.tag){case 5:jt=R.stateNode,Pr=!1;break e;case 3:jt=R.stateNode.containerInfo,Pr=!0;break e;case 4:jt=R.stateNode.containerInfo,Pr=!0;break e}R=R.return}if(jt===null)throw Error(o(160));Jg(x,E,g),jt=null,Pr=!1}else Jg(x,E,g);var F=g.alternate;F!==null&&(F.return=null),g.return=null}catch($){it(g,l,$)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)O3(l,u),l=l.sibling}function O3(u,l){var d=u.alternate,m=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Rr(l,u),ti(u),m&4){try{fl(3,u,u.return),ef(3,u)}catch(Q){it(u,u.return,Q)}try{fl(5,u,u.return)}catch(Q){it(u,u.return,Q)}}break;case 1:Rr(l,u),ti(u),m&512&&d!==null&&ba(d,d.return);break;case 5:if(Rr(l,u),ti(u),m&512&&d!==null&&ba(d,d.return),tn){if(u.flags&32){var g=u.stateNode;try{dS(g)}catch(Q){it(u,u.return,Q)}}if(m&4&&(g=u.stateNode,g!=null)){var x=u.memoizedProps;if(d=d!==null?d.memoizedProps:x,m=u.type,l=u.updateQueue,u.updateQueue=null,l!==null)try{sI(g,l,m,d,x,u)}catch(Q){it(u,u.return,Q)}}}break;case 6:if(Rr(l,u),ti(u),m&4&&tn){if(u.stateNode===null)throw Error(o(162));g=u.stateNode,x=u.memoizedProps,d=d!==null?d.memoizedProps:x;try{rI(g,d,x)}catch(Q){it(u,u.return,Q)}}break;case 3:if(Rr(l,u),ti(u),m&4){if(tn&&Vt&&d!==null&&d.memoizedState.isDehydrated)try{RI(l.containerInfo)}catch(Q){it(u,u.return,Q)}if(Ti){g=l.containerInfo,x=l.pendingChildren;try{rg(g,x)}catch(Q){it(u,u.return,Q)}}}break;case 4:if(Rr(l,u),ti(u),m&4&&Ti){x=u.stateNode,g=x.containerInfo,x=x.pendingChildren;try{rg(g,x)}catch(Q){it(u,u.return,Q)}}break;case 13:Rr(l,u),ti(u),g=u.child,g.flags&8192&&(x=g.memoizedState!==null,g.stateNode.isHidden=x,!x||g.alternate!==null&&g.alternate.memoizedState!==null||(o0=Dt())),m&4&&D3(u);break;case 22:var E=d!==null&&d.memoizedState!==null;if(u.mode&1?(on=(d=on)||E,Rr(l,u),on=d):Rr(l,u),ti(u),m&8192){if(d=u.memoizedState!==null,(u.stateNode.isHidden=d)&&!E&&u.mode&1)for(ee=u,m=u.child;m!==null;){for(l=ee=m;ee!==null;){E=ee;var R=E.child;switch(E.tag){case 0:case 11:case 14:case 15:fl(4,E,E.return);break;case 1:ba(E,E.return);var F=E.stateNode;if(typeof F.componentWillUnmount=="function"){var $=E,ne=E.return;try{var _e=$;F.props=_e.memoizedProps,F.state=_e.memoizedState,F.componentWillUnmount()}catch(Q){it($,ne,Q)}}break;case 5:ba(E,E.return);break;case 22:if(E.memoizedState!==null){I3(l);continue}}R!==null?(R.return=E,ee=R):I3(l)}m=m.sibling}if(tn){e:if(m=null,tn)for(l=u;;){if(l.tag===5){if(m===null){m=l;try{g=l.stateNode,d?cI(g):fI(l.stateNode,l.memoizedProps)}catch(Q){it(u,u.return,Q)}}}else if(l.tag===6){if(m===null)try{x=l.stateNode,d?hI(x):dI(x,l.memoizedProps)}catch(Q){it(u,u.return,Q)}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===u)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;m===l&&(m=null),l=l.return}m===l&&(m=null),l.sibling.return=l.return,l=l.sibling}}}break;case 19:Rr(l,u),ti(u),m&4&&D3(u);break;case 21:break;default:Rr(l,u),ti(u)}}function ti(u){var l=u.flags;if(l&2){try{if(tn){e:{for(var d=u.return;d!==null;){if(B3(d)){var m=d;break e}d=d.return}throw Error(o(160))}switch(m.tag){case 5:var g=m.stateNode;m.flags&32&&(dS(g),m.flags&=-33);var x=M3(u);Zg(u,x,g);break;case 3:case 4:var E=m.stateNode.containerInfo,R=M3(u);Qg(u,R,E);break;default:throw Error(o(161))}}}catch(F){it(u,u.return,F)}u.flags&=-3}l&4096&&(u.flags&=-4097)}function dU(u,l,d){ee=u,k3(u)}function k3(u,l,d){for(var m=(u.mode&1)!==0;ee!==null;){var g=ee,x=g.child;if(g.tag===22&&m){var E=g.memoizedState!==null||Jh;if(!E){var R=g.alternate,F=R!==null&&R.memoizedState!==null||on;R=Jh;var $=on;if(Jh=E,(on=F)&&!$)for(ee=g;ee!==null;)E=ee,F=E.child,E.tag===22&&E.memoizedState!==null?U3(g):F!==null?(F.return=E,ee=F):U3(g);for(;x!==null;)ee=x,k3(x),x=x.sibling;ee=g,Jh=R,on=$}F3(u)}else g.subtreeFlags&8772&&x!==null?(x.return=g,ee=x):F3(u)}}function F3(u){for(;ee!==null;){var l=ee;if(l.flags&8772){var d=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:on||ef(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!on)if(d===null)m.componentDidMount();else{var g=l.elementType===l.type?d.memoizedProps:Ar(l.type,d.memoizedProps);m.componentDidUpdate(g,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var x=l.updateQueue;x!==null&&LS(l,x,m);break;case 3:var E=l.updateQueue;if(E!==null){if(d=null,l.child!==null)switch(l.child.tag){case 5:d=oe(l.child.stateNode);break;case 1:d=l.child.stateNode}LS(l,E,d)}break;case 5:var R=l.stateNode;d===null&&l.flags&4&&iI(R,l.type,l.memoizedProps,l);break;case 6:break;case 4:break;case 12:break;case 13:if(Vt&&l.memoizedState===null){var F=l.alternate;if(F!==null){var $=F.memoizedState;if($!==null){var ne=$.dehydrated;ne!==null&&BI(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}on||l.flags&512&&Kg(l)}catch(_e){it(l,l.return,_e)}}if(l===u){ee=null;break}if(d=l.sibling,d!==null){d.return=l.return,ee=d;break}ee=l.return}}function I3(u){for(;ee!==null;){var l=ee;if(l===u){ee=null;break}var d=l.sibling;if(d!==null){d.return=l.return,ee=d;break}ee=l.return}}function U3(u){for(;ee!==null;){var l=ee;try{switch(l.tag){case 0:case 11:case 15:var d=l.return;try{ef(4,l)}catch(F){it(l,d,F)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var g=l.return;try{m.componentDidMount()}catch(F){it(l,g,F)}}var x=l.return;try{Kg(l)}catch(F){it(l,x,F)}break;case 5:var E=l.return;try{Kg(l)}catch(F){it(l,E,F)}}}catch(F){it(l,l.return,F)}if(l===u){ee=null;break}var R=l.sibling;if(R!==null){R.return=l.return,ee=R;break}ee=l.return}}var tf=0,nf=1,rf=2,sf=3,of=4;if(typeof Symbol=="function"&&Symbol.for){var dl=Symbol.for;tf=dl("selector.component"),nf=dl("selector.has_pseudo_class"),rf=dl("selector.role"),sf=dl("selector.test_id"),of=dl("selector.text")}function e0(u){var l=Ku(u);if(l!=null){if(typeof l.memoizedProps["data-testname"]!="string")throw Error(o(364));return l}if(u=ng(u),u===null)throw Error(o(362));return u.stateNode.current}function t0(u,l){switch(l.$$typeof){case tf:if(u.type===l.value)return!0;break;case nf:e:{l=l.value,u=[u,0];for(var d=0;d<u.length;){var m=u[d++],g=u[d++],x=l[g];if(m.tag!==5||!Qu(m)){for(;x!=null&&t0(m,x);)g++,x=l[g];if(g===l.length){l=!0;break e}else for(m=m.child;m!==null;)u.push(m,g),m=m.sibling}}l=!1}return l;case rf:if(u.tag===5&&Z5(u.stateNode,l.value))return!0;break;case of:if((u.tag===5||u.tag===6)&&(u=Q5(u),u!==null&&0<=u.indexOf(l.value)))return!0;break;case sf:if(u.tag===5&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===l.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function n0(u){switch(u.$$typeof){case tf:return"<"+(I(u.value)||"Unknown")+">";case nf:return":has("+(n0(u)||"")+")";case rf:return'[role="'+u.value+'"]';case of:return'"'+u.value+'"';case sf:return'[data-testname="'+u.value+'"]';default:throw Error(o(365))}}function L3(u,l){var d=[];u=[u,0];for(var m=0;m<u.length;){var g=u[m++],x=u[m++],E=l[x];if(g.tag!==5||!Qu(g)){for(;E!=null&&t0(g,E);)x++,E=l[x];if(x===l.length)d.push(g);else for(g=g.child;g!==null;)u.push(g,x),g=g.sibling}}return d}function r0(u,l){if(!cs)throw Error(o(363));u=e0(u),u=L3(u,l),l=[],u=Array.from(u);for(var d=0;d<u.length;){var m=u[d++];if(m.tag===5)Qu(m)||l.push(m.stateNode);else for(m=m.child;m!==null;)u.push(m),m=m.sibling}return l}var pU=Math.ceil,af=a.ReactCurrentDispatcher,i0=a.ReactCurrentOwner,_t=a.ReactCurrentBatchConfig,Se=0,kt=null,wt=null,Wt=0,zn=0,Sa=hs(0),At=0,pl=null,ho=0,uf=0,s0=0,ml=null,wn=null,o0=0,a0=1/0,Fi=null;function wa(){a0=Dt()+500}var lf=!1,u0=null,ms=null,cf=!1,gs=null,hf=0,gl=0,l0=null,ff=-1,df=0;function an(){return Se&6?Dt():ff!==-1?ff:ff=Dt()}function vs(u){return u.mode&1?Se&2&&Wt!==0?Wt&-Wt:KI.transition!==null?(df===0&&(df=SS()),df):(u=ke,u!==0?u:Ai()):1}function or(u,l,d,m){if(50<gl)throw gl=0,l0=null,Error(o(185));el(u,d,m),(!(Se&2)||u!==kt)&&(u===kt&&(!(Se&2)&&(uf|=d),At===4&&_s(u,Wt)),Cn(u,m),d===1&&Se===0&&!(l.mode&1)&&(wa(),Dh&&qr()))}function Cn(u,l){var d=u.callbackNode;zI(u,l);var m=Bh(u,u===kt?Wt:0);if(m===0)d!==null&&CS(d),u.callbackNode=null,u.callbackPriority=0;else if(l=m&-m,u.callbackPriority!==l){if(d!=null&&CS(d),l===1)u.tag===0?qI(G3.bind(null,u)):TS(G3.bind(null,u)),Ri?tg(function(){!(Se&6)&&qr()}):fg(dg,qr),d=null;else{switch(wS(m)){case 1:d=dg;break;case 4:d=WI;break;case 16:d=pg;break;case 536870912:d=$I;break;default:d=pg}d=q3(d,N3.bind(null,u))}u.callbackPriority=l,u.callbackNode=d}}function N3(u,l){if(ff=-1,df=0,Se&6)throw Error(o(327));var d=u.callbackNode;if(mo()&&u.callbackNode!==d)return null;var m=Bh(u,u===kt?Wt:0);if(m===0)return null;if(m&30||m&u.expiredLanes||l)l=pf(u,m);else{l=m;var g=Se;Se|=2;var x=V3();(kt!==u||Wt!==l)&&(Fi=null,wa(),fo(u,l));do try{vU();break}catch(R){H3(u,R)}while(!0);Sg(),af.current=x,Se=g,wt!==null?l=0:(kt=null,Wt=0,l=At)}if(l!==0){if(l===2&&(g=lg(u),g!==0&&(m=g,l=c0(u,g))),l===1)throw d=pl,fo(u,0),_s(u,m),Cn(u,Dt()),d;if(l===6)_s(u,m);else{if(g=u.current.alternate,!(m&30)&&!mU(g)&&(l=pf(u,m),l===2&&(x=lg(u),x!==0&&(m=x,l=c0(u,x))),l===1))throw d=pl,fo(u,0),_s(u,m),Cn(u,Dt()),d;switch(u.finishedWork=g,u.finishedLanes=m,l){case 0:case 1:throw Error(o(345));case 2:po(u,wn,Fi);break;case 3:if(_s(u,m),(m&130023424)===m&&(l=o0+500-Dt(),10<l)){if(Bh(u,0)!==0)break;if(g=u.suspendedLanes,(g&m)!==m){an(),u.pingedLanes|=u.suspendedLanes&g;break}u.timeoutHandle=Xr(po.bind(null,u,wn,Fi),l);break}po(u,wn,Fi);break;case 4:if(_s(u,m),(m&4194240)===m)break;for(l=u.eventTimes,g=-1;0<m;){var E=31-Cr(m);x=1<<E,E=l[E],E>g&&(g=E),m&=~x}if(m=g,m=Dt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*pU(m/1960))-m,10<m){u.timeoutHandle=Xr(po.bind(null,u,wn,Fi),m);break}po(u,wn,Fi);break;case 5:po(u,wn,Fi);break;default:throw Error(o(329))}}}return Cn(u,Dt()),u.callbackNode===d?N3.bind(null,u):null}function c0(u,l){var d=ml;return u.current.memoizedState.isDehydrated&&(fo(u,l).flags|=256),u=pf(u,l),u!==2&&(l=wn,wn=d,l!==null&&h0(l)),u}function h0(u){wn===null?wn=u:wn.push.apply(wn,u)}function mU(u){for(var l=u;;){if(l.flags&16384){var d=l.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var g=d[m],x=g.getSnapshot;g=g.value;try{if(!Tr(x(),g))return!1}catch{return!1}}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===u)break;for(;l.sibling===null;){if(l.return===null||l.return===u)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function _s(u,l){for(l&=~s0,l&=~uf,u.suspendedLanes|=l,u.pingedLanes&=~l,u=u.expirationTimes;0<l;){var d=31-Cr(l),m=1<<d;u[d]=-1,l&=~m}}function G3(u){if(Se&6)throw Error(o(327));mo();var l=Bh(u,0);if(!(l&1))return Cn(u,Dt()),null;var d=pf(u,l);if(u.tag!==0&&d===2){var m=lg(u);m!==0&&(l=m,d=c0(u,m))}if(d===1)throw d=pl,fo(u,0),_s(u,l),Cn(u,Dt()),d;if(d===6)throw Error(o(345));return u.finishedWork=u.current.alternate,u.finishedLanes=l,po(u,wn,Fi),Cn(u,Dt()),null}function z3(u){gs!==null&&gs.tag===0&&!(Se&6)&&mo();var l=Se;Se|=1;var d=_t.transition,m=ke;try{if(_t.transition=null,ke=1,u)return u()}finally{ke=m,_t.transition=d,Se=l,!(Se&6)&&qr()}}function f0(){zn=Sa.current,Je(Sa)}function fo(u,l){u.finishedWork=null,u.finishedLanes=0;var d=u.timeoutHandle;if(d!==Ci&&(u.timeoutHandle=Ci,la(d)),wt!==null)for(d=wt.return;d!==null;){var m=d;switch(vg(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Eh();break;case 3:xa(),Je(yn),Je(nn),Bg();break;case 5:Pg(m);break;case 4:xa();break;case 13:Je(ut);break;case 19:Je(ut);break;case 10:wg(m.type._context);break;case 22:case 23:f0()}d=d.return}if(kt=u,wt=u=xs(u.current,null),Wt=zn=l,At=0,pl=null,s0=uf=ho=0,wn=ml=null,lo!==null){for(l=0;l<lo.length;l++)if(d=lo[l],m=d.interleaved,m!==null){d.interleaved=null;var g=m.next,x=d.pending;if(x!==null){var E=x.next;x.next=g,m.next=E}d.pending=m}lo=null}return u}function H3(u,l){do{var d=wt;try{if(Sg(),Vh.current=Xh,jh){for(var m=lt.memoizedState;m!==null;){var g=m.queue;g!==null&&(g.pending=null),m=m.next}jh=!1}if(co=0,Ot=Et=lt=null,sl=!1,ol=0,i0.current=null,d===null||d.return===null){At=1,pl=l,wt=null;break}e:{var x=u,E=d.return,R=d,F=l;if(l=Wt,R.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var $=F,ne=R,_e=ne.tag;if(!(ne.mode&1)&&(_e===0||_e===11||_e===15)){var Q=ne.alternate;Q?(ne.updateQueue=Q.updateQueue,ne.memoizedState=Q.memoizedState,ne.lanes=Q.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var et=d3(E);if(et!==null){et.flags&=-257,p3(et,E,R,x,l),et.mode&1&&f3(x,$,l),l=et,F=$;var Xe=l.updateQueue;if(Xe===null){var Tn=new Set;Tn.add(F),l.updateQueue=Tn}else Xe.add(F);break e}else{if(!(l&1)){f3(x,$,l),d0();break e}F=Error(o(426))}}else if(rt&&R.mode&1){var Ii=d3(E);if(Ii!==null){!(Ii.flags&65536)&&(Ii.flags|=256),p3(Ii,E,R,x,l),yg(ya(F,R));break e}}x=F=ya(F,R),At!==4&&(At=2),ml===null?ml=[x]:ml.push(x),x=E;do{switch(x.tag){case 3:x.flags|=65536,l&=-l,x.lanes|=l;var O=c3(x,F,l);US(x,O);break e;case 1:R=F;var B=x.type,U=x.stateNode;if(!(x.flags&128)&&(typeof B.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(ms===null||!ms.has(U)))){x.flags|=65536,l&=-l,x.lanes|=l;var Z=h3(x,R,l);US(x,Z);break e}}x=x.return}while(x!==null)}W3(d)}catch(ue){l=ue,wt===d&&d!==null&&(wt=d=d.return);continue}break}while(!0)}function V3(){var u=af.current;return af.current=Xh,u===null?Xh:u}function d0(){(At===0||At===3||At===2)&&(At=4),kt===null||!(ho&268435455)&&!(uf&268435455)||_s(kt,Wt)}function pf(u,l){var d=Se;Se|=2;var m=V3();(kt!==u||Wt!==l)&&(Fi=null,fo(u,l));do try{gU();break}catch(g){H3(u,g)}while(!0);if(Sg(),Se=d,af.current=m,wt!==null)throw Error(o(261));return kt=null,Wt=0,At}function gU(){for(;wt!==null;)j3(wt)}function vU(){for(;wt!==null&&!VI();)j3(wt)}function j3(u){var l=Y3(u.alternate,u,zn);u.memoizedProps=u.pendingProps,l===null?W3(u):wt=l,i0.current=null}function W3(u){var l=u;do{var d=l.alternate;if(u=l.return,l.flags&32768){if(d=cU(d,l),d!==null){d.flags&=32767,wt=d;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{At=6,wt=null;return}}else if(d=lU(d,l,zn),d!==null){wt=d;return}if(l=l.sibling,l!==null){wt=l;return}wt=l=u}while(l!==null);At===0&&(At=5)}function po(u,l,d){var m=ke,g=_t.transition;try{_t.transition=null,ke=1,_U(u,l,d,m)}finally{_t.transition=g,ke=m}return null}function _U(u,l,d,m){do mo();while(gs!==null);if(Se&6)throw Error(o(327));d=u.finishedWork;var g=u.finishedLanes;if(d===null)return null;if(u.finishedWork=null,u.finishedLanes=0,d===u.current)throw Error(o(177));u.callbackNode=null,u.callbackPriority=0;var x=d.lanes|d.childLanes;if(HI(u,x),u===kt&&(wt=kt=null,Wt=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||cf||(cf=!0,q3(pg,function(){return mo(),null})),x=(d.flags&15990)!==0,d.subtreeFlags&15990||x){x=_t.transition,_t.transition=null;var E=ke;ke=1;var R=Se;Se|=4,i0.current=null,fU(u,d),O3(d,u),W(u.containerInfo),u.current=d,dU(d),jI(),Se=R,ke=E,_t.transition=x}else u.current=d;if(cf&&(cf=!1,gs=u,hf=g),x=u.pendingLanes,x===0&&(ms=null),XI(d.stateNode),Cn(u,Dt()),l!==null)for(m=u.onRecoverableError,d=0;d<l.length;d++)g=l[d],m(g.value,{componentStack:g.stack,digest:g.digest});if(lf)throw lf=!1,u=u0,u0=null,u;return hf&1&&u.tag!==0&&mo(),x=u.pendingLanes,x&1?u===l0?gl++:(gl=0,l0=u):gl=0,qr(),null}function mo(){if(gs!==null){var u=wS(hf),l=_t.transition,d=ke;try{if(_t.transition=null,ke=16>u?16:u,gs===null)var m=!1;else{if(u=gs,gs=null,hf=0,Se&6)throw Error(o(331));var g=Se;for(Se|=4,ee=u.current;ee!==null;){var x=ee,E=x.child;if(ee.flags&16){var R=x.deletions;if(R!==null){for(var F=0;F<R.length;F++){var $=R[F];for(ee=$;ee!==null;){var ne=ee;switch(ne.tag){case 0:case 11:case 15:fl(8,ne,x)}var _e=ne.child;if(_e!==null)_e.return=ne,ee=_e;else for(;ee!==null;){ne=ee;var Q=ne.sibling,et=ne.return;if(R3(ne),ne===$){ee=null;break}if(Q!==null){Q.return=et,ee=Q;break}ee=et}}}var Xe=x.alternate;if(Xe!==null){var Tn=Xe.child;if(Tn!==null){Xe.child=null;do{var Ii=Tn.sibling;Tn.sibling=null,Tn=Ii}while(Tn!==null)}}ee=x}}if(x.subtreeFlags&2064&&E!==null)E.return=x,ee=E;else e:for(;ee!==null;){if(x=ee,x.flags&2048)switch(x.tag){case 0:case 11:case 15:fl(9,x,x.return)}var O=x.sibling;if(O!==null){O.return=x.return,ee=O;break e}ee=x.return}}var B=u.current;for(ee=B;ee!==null;){E=ee;var U=E.child;if(E.subtreeFlags&2064&&U!==null)U.return=E,ee=U;else e:for(E=B;ee!==null;){if(R=ee,R.flags&2048)try{switch(R.tag){case 0:case 11:case 15:ef(9,R)}}catch(ue){it(R,R.return,ue)}if(R===E){ee=null;break e}var Z=R.sibling;if(Z!==null){Z.return=R.return,ee=Z;break e}ee=R.return}}if(Se=g,qr(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(Mh,u)}catch{}m=!0}return m}finally{ke=d,_t.transition=l}}return!1}function $3(u,l,d){l=ya(d,l),l=c3(u,l,1),u=ps(u,l,1),l=an(),u!==null&&(el(u,1,l),Cn(u,l))}function it(u,l,d){if(u.tag===3)$3(u,u,d);else for(;l!==null;){if(l.tag===3){$3(l,u,d);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ms===null||!ms.has(m))){u=ya(d,u),u=h3(l,u,1),l=ps(l,u,1),u=an(),l!==null&&(el(l,1,u),Cn(l,u));break}}l=l.return}}function xU(u,l,d){var m=u.pingCache;m!==null&&m.delete(l),l=an(),u.pingedLanes|=u.suspendedLanes&d,kt===u&&(Wt&d)===d&&(At===4||At===3&&(Wt&130023424)===Wt&&500>Dt()-o0?fo(u,0):s0|=d),Cn(u,l)}function X3(u,l){l===0&&(u.mode&1?(l=Rh,Rh<<=1,!(Rh&130023424)&&(Rh=4194304)):l=1);var d=an();u=Kr(u,l),u!==null&&(el(u,l,d),Cn(u,d))}function yU(u){var l=u.memoizedState,d=0;l!==null&&(d=l.retryLane),X3(u,d)}function bU(u,l){var d=0;switch(u.tag){case 13:var m=u.stateNode,g=u.memoizedState;g!==null&&(d=g.retryLane);break;case 19:m=u.stateNode;break;default:throw Error(o(314))}m!==null&&m.delete(l),X3(u,d)}var Y3;Y3=function(u,l,d){if(u!==null)if(u.memoizedProps!==l.pendingProps||yn.current)Sn=!0;else{if(!(u.lanes&d)&&!(l.flags&128))return Sn=!1,uU(u,l,d);Sn=!!(u.flags&131072)}else Sn=!1,rt&&l.flags&1048576&&ES(l,kh,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;Kh(u,l),u=l.pendingProps;var g=ha(l,nn.current);va(l,d),g=Og(null,l,m,u,g,d);var x=kg();return l.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,bn(m)?(x=!0,Ah(l)):x=!1,l.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,Eg(l),g.updater=Yh,l.stateNode=g,g._reactInternals=l,Gg(l,m,u,d),l=jg(null,l,m,!0,x,d)):(l.tag=0,rt&&x&&gg(l),dn(null,l,g,d),l=l.child),l;case 16:m=l.elementType;e:{switch(Kh(u,l),u=l.pendingProps,g=m._init,m=g(m._payload),l.type=m,g=l.tag=wU(m),u=Ar(m,u),g){case 0:l=Vg(null,l,m,u,d);break e;case 1:l=y3(null,l,m,u,d);break e;case 11:l=m3(null,l,m,u,d);break e;case 14:l=g3(null,l,m,Ar(m.type,u),d);break e}throw Error(o(306,m,""))}return l;case 0:return m=l.type,g=l.pendingProps,g=l.elementType===m?g:Ar(m,g),Vg(u,l,m,g,d);case 1:return m=l.type,g=l.pendingProps,g=l.elementType===m?g:Ar(m,g),y3(u,l,m,g,d);case 3:e:{if(b3(l),u===null)throw Error(o(387));m=l.pendingProps,x=l.memoizedState,g=x.element,IS(u,l),zh(l,m,null,d);var E=l.memoizedState;if(m=E.element,Vt&&x.isDehydrated)if(x={element:m,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},l.updateQueue.baseState=x,l.memoizedState=x,l.flags&256){g=ya(Error(o(423)),l),l=S3(u,l,m,d,g);break e}else if(m!==g){g=ya(Error(o(424)),l),l=S3(u,l,m,d,g);break e}else for(Vt&&(nr=wI(l.stateNode.containerInfo),Gn=l,rt=!0,Er=null,tl=!1),d=OS(l,null,m,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(pa(),m===g){l=ki(u,l,d);break e}dn(u,l,m,d)}l=l.child}return l;case 5:return NS(l),u===null&&xg(l),m=l.type,g=l.pendingProps,x=u!==null?u.memoizedProps:null,E=g.children,Nn(m,g)?E=null:x!==null&&Nn(m,x)&&(l.flags|=32),x3(u,l),dn(u,l,E,d),l.child;case 6:return u===null&&xg(l),null;case 13:return w3(u,l,d);case 4:return Ag(l,l.stateNode.containerInfo),m=l.pendingProps,u===null?l.child=ma(l,null,m,d):dn(u,l,m,d),l.child;case 11:return m=l.type,g=l.pendingProps,g=l.elementType===m?g:Ar(m,g),m3(u,l,m,g,d);case 7:return dn(u,l,l.pendingProps,d),l.child;case 8:return dn(u,l,l.pendingProps.children,d),l.child;case 12:return dn(u,l,l.pendingProps.children,d),l.child;case 10:e:{if(m=l.type._context,g=l.pendingProps,x=l.memoizedProps,E=g.value,kS(l,m,E),x!==null)if(Tr(x.value,E)){if(x.children===g.children&&!yn.current){l=ki(u,l,d);break e}}else for(x=l.child,x!==null&&(x.return=l);x!==null;){var R=x.dependencies;if(R!==null){E=x.child;for(var F=R.firstContext;F!==null;){if(F.context===m){if(x.tag===1){F=Oi(-1,d&-d),F.tag=2;var $=x.updateQueue;if($!==null){$=$.shared;var ne=$.pending;ne===null?F.next=F:(F.next=ne.next,ne.next=F),$.pending=F}}x.lanes|=d,F=x.alternate,F!==null&&(F.lanes|=d),Cg(x.return,d,l),R.lanes|=d;break}F=F.next}}else if(x.tag===10)E=x.type===l.type?null:x.child;else if(x.tag===18){if(E=x.return,E===null)throw Error(o(341));E.lanes|=d,R=E.alternate,R!==null&&(R.lanes|=d),Cg(E,d,l),E=x.sibling}else E=x.child;if(E!==null)E.return=x;else for(E=x;E!==null;){if(E===l){E=null;break}if(x=E.sibling,x!==null){x.return=E.return,E=x;break}E=E.return}x=E}dn(u,l,g.children,d),l=l.child}return l;case 9:return g=l.type,m=l.pendingProps.children,va(l,d),g=rr(g),m=m(g),l.flags|=1,dn(u,l,m,d),l.child;case 14:return m=l.type,g=Ar(m,l.pendingProps),g=Ar(m.type,g),g3(u,l,m,g,d);case 15:return v3(u,l,l.type,l.pendingProps,d);case 17:return m=l.type,g=l.pendingProps,g=l.elementType===m?g:Ar(m,g),Kh(u,l),l.tag=1,bn(m)?(u=!0,Ah(l)):u=!1,va(l,d),u3(l,m,g),Gg(l,m,g,d),jg(null,l,m,!0,u,d);case 19:return T3(u,l,d);case 22:return _3(u,l,d)}throw Error(o(156,l.tag))};function q3(u,l){return fg(u,l)}function SU(u,l,d,m){this.tag=u,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ar(u,l,d,m){return new SU(u,l,d,m)}function p0(u){return u=u.prototype,!(!u||!u.isReactComponent)}function wU(u){if(typeof u=="function")return p0(u)?1:0;if(u!=null){if(u=u.$$typeof,u===S)return 11;if(u===w)return 14}return 2}function xs(u,l){var d=u.alternate;return d===null?(d=ar(u.tag,l,u.key,u.mode),d.elementType=u.elementType,d.type=u.type,d.stateNode=u.stateNode,d.alternate=u,u.alternate=d):(d.pendingProps=l,d.type=u.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=u.flags&14680064,d.childLanes=u.childLanes,d.lanes=u.lanes,d.child=u.child,d.memoizedProps=u.memoizedProps,d.memoizedState=u.memoizedState,d.updateQueue=u.updateQueue,l=u.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=u.sibling,d.index=u.index,d.ref=u.ref,d}function mf(u,l,d,m,g,x){var E=2;if(m=u,typeof u=="function")p0(u)&&(E=1);else if(typeof u=="string")E=5;else e:switch(u){case f:return go(d.children,g,x,l);case p:E=8,g|=8;break;case v:return u=ar(12,d,l,g|2),u.elementType=v,u.lanes=x,u;case C:return u=ar(13,d,l,g),u.elementType=C,u.lanes=x,u;case b:return u=ar(19,d,l,g),u.elementType=b,u.lanes=x,u;case A:return gf(d,g,x,l);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case _:E=10;break e;case y:E=9;break e;case S:E=11;break e;case w:E=14;break e;case T:E=16,m=null;break e}throw Error(o(130,u==null?u:typeof u,""))}return l=ar(E,d,l,g),l.elementType=u,l.type=m,l.lanes=x,l}function go(u,l,d,m){return u=ar(7,u,m,l),u.lanes=d,u}function gf(u,l,d,m){return u=ar(22,u,m,l),u.elementType=A,u.lanes=d,u.stateNode={isHidden:!1},u}function m0(u,l,d){return u=ar(6,u,null,l),u.lanes=d,u}function g0(u,l,d){return l=ar(4,u.children!==null?u.children:[],u.key,l),l.lanes=d,l.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},l}function CU(u,l,d,m,g){this.tag=l,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ci,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cg(0),this.expirationTimes=cg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cg(0),this.identifierPrefix=m,this.onRecoverableError=g,Vt&&(this.mutableSourceEagerHydrationData=null)}function K3(u,l,d,m,g,x,E,R,F){return u=new CU(u,l,d,R,F),l===1?(l=1,x===!0&&(l|=8)):l=0,x=ar(3,null,null,l),u.current=x,x.stateNode=u,x.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Eg(x),u}function Q3(u){if(!u)return fs;u=u._reactInternals;e:{if(k(u)!==u||u.tag!==1)throw Error(o(170));var l=u;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(bn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(o(171))}if(u.tag===1){var d=u.type;if(bn(d))return yS(u,d,l)}return l}function Z3(u){var l=u._reactInternals;if(l===void 0)throw typeof u.render=="function"?Error(o(188)):(u=Object.keys(u).join(","),Error(o(268,u)));return u=Ze(l),u===null?null:u.stateNode}function J3(u,l){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var d=u.retryLane;u.retryLane=d!==0&&d<l?d:l}}function vf(u,l){J3(u,l),(u=u.alternate)&&J3(u,l)}function TU(u){return u=Ze(u),u===null?null:u.stateNode}function EU(){return null}return n.attemptContinuousHydration=function(u){if(u.tag===13){var l=Kr(u,134217728);if(l!==null){var d=an();or(l,u,134217728,d)}vf(u,134217728)}},n.attemptDiscreteHydration=function(u){if(u.tag===13){var l=Kr(u,1);if(l!==null){var d=an();or(l,u,1,d)}vf(u,1)}},n.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13){var l=vs(u),d=Kr(u,l);if(d!==null){var m=an();or(d,u,l,m)}vf(u,l)}},n.attemptSynchronousHydration=function(u){switch(u.tag){case 3:var l=u.stateNode;if(l.current.memoizedState.isDehydrated){var d=Ju(l.pendingLanes);d!==0&&(hg(l,d|1),Cn(l,Dt()),!(Se&6)&&(wa(),qr()))}break;case 13:z3(function(){var m=Kr(u,1);if(m!==null){var g=an();or(m,u,1,g)}}),vf(u,1)}},n.batchedUpdates=function(u,l){var d=Se;Se|=1;try{return u(l)}finally{Se=d,Se===0&&(wa(),Dh&&qr())}},n.createComponentSelector=function(u){return{$$typeof:tf,value:u}},n.createContainer=function(u,l,d,m,g,x,E){return K3(u,l,!1,null,d,m,g,x,E)},n.createHasPseudoClassSelector=function(u){return{$$typeof:nf,value:u}},n.createHydrationContainer=function(u,l,d,m,g,x,E,R,F){return u=K3(d,m,!0,u,g,x,E,R,F),u.context=Q3(null),d=u.current,m=an(),g=vs(d),x=Oi(m,g),x.callback=l??null,ps(d,x,g),u.current.lanes=g,el(u,g,m),Cn(u,m),u},n.createPortal=function(u,l,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:m==null?null:""+m,children:u,containerInfo:l,implementation:d}},n.createRoleSelector=function(u){return{$$typeof:rf,value:u}},n.createTestNameSelector=function(u){return{$$typeof:sf,value:u}},n.createTextSelector=function(u){return{$$typeof:of,value:u}},n.deferredUpdates=function(u){var l=ke,d=_t.transition;try{return _t.transition=null,ke=16,u()}finally{ke=l,_t.transition=d}},n.discreteUpdates=function(u,l,d,m,g){var x=ke,E=_t.transition;try{return _t.transition=null,ke=1,u(l,d,m,g)}finally{ke=x,_t.transition=E,Se===0&&wa()}},n.findAllNodes=r0,n.findBoundingRects=function(u,l){if(!cs)throw Error(o(363));l=r0(u,l),u=[];for(var d=0;d<l.length;d++)u.push(fS(l[d]));for(l=u.length-1;0<l;l--){d=u[l];for(var m=d.x,g=m+d.width,x=d.y,E=x+d.height,R=l-1;0<=R;R--)if(l!==R){var F=u[R],$=F.x,ne=$+F.width,_e=F.y,Q=_e+F.height;if(m>=$&&x>=_e&&g<=ne&&E<=Q){u.splice(l,1);break}else if(m!==$||d.width!==F.width||Q<x||_e>E){if(!(x!==_e||d.height!==F.height||ne<m||$>g)){$>m&&(F.width+=$-m,F.x=m),ne<g&&(F.width=g-$),u.splice(l,1);break}}else{_e>x&&(F.height+=_e-x,F.y=x),Q<E&&(F.height=E-_e),u.splice(l,1);break}}}return u},n.findHostInstance=Z3,n.findHostInstanceWithNoPortals=function(u){return u=ie(u),u=u!==null?J(u):null,u===null?null:u.stateNode},n.findHostInstanceWithWarning=function(u){return Z3(u)},n.flushControlled=function(u){var l=Se;Se|=1;var d=_t.transition,m=ke;try{_t.transition=null,ke=1,u()}finally{ke=m,_t.transition=d,Se=l,Se===0&&(wa(),qr())}},n.flushPassiveEffects=mo,n.flushSync=z3,n.focusWithin=function(u,l){if(!cs)throw Error(o(363));for(u=e0(u),l=L3(u,l),l=Array.from(l),u=0;u<l.length;){var d=l[u++];if(!Qu(d)){if(d.tag===5&&J5(d.stateNode))return!0;for(d=d.child;d!==null;)l.push(d),d=d.sibling}}return!1},n.getCurrentUpdatePriority=function(){return ke},n.getFindAllNodesFailureDescription=function(u,l){if(!cs)throw Error(o(363));var d=0,m=[];u=[e0(u),0];for(var g=0;g<u.length;){var x=u[g++],E=u[g++],R=l[E];if((x.tag!==5||!Qu(x))&&(t0(x,R)&&(m.push(n0(R)),E++,E>d&&(d=E)),E<l.length))for(x=x.child;x!==null;)u.push(x,E),x=x.sibling}if(d<l.length){for(u=[];d<l.length;d++)u.push(n0(l[d]));return`findAllNodes was able to match part of the selector:
  `+(m.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},n.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return oe(u.child.stateNode);default:return u.child.stateNode}},n.injectIntoDevTools=function(u){if(u={bundleType:u.bundleType,version:u.version,rendererPackageName:u.rendererPackageName,rendererConfig:u.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:TU,findFiberByHostInstance:u.findFiberByHostInstance||EU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(l.isDisabled||!l.supportsFiber)u=!0;else{try{Mh=l.inject(u),Yr=l}catch{}u=!!l.checkDCE}}return u},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(u,l,d,m){if(!cs)throw Error(o(363));u=r0(u,l);var g=eI(u,d,m).disconnect;return{disconnect:function(){g()}}},n.registerMutableSourceForHydration=function(u,l){var d=l._getVersion;d=d(l._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[l,d]:u.mutableSourceEagerHydrationData.push(l,d)},n.runWithPriority=function(u,l){var d=ke;try{return ke=u,l()}finally{ke=d}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(u,l,d,m){var g=l.current,x=an(),E=vs(g);return d=Q3(d),l.context===null?l.context=d:l.pendingContext=d,l=Oi(x,E),l.payload={element:u},m=m===void 0?null:m,m!==null&&(l.callback=m),u=ps(g,l,E),u!==null&&(or(u,g,E,x),Gh(u,g,E)),E},n};Ak.exports=E7;var A7=Ak.exports;const P7=Jc(A7);var R7="@pixi/react",B7="0.0.0-development",M7="Write PixiJS applications using React declarative style.",D7=["react","pixi"],O7="https://github.com/pixijs/pixi-react#readme",k7={url:"https://github.com/pixijs/pixi-react/issues"},F7={type:"git",url:"git+https://github.com/pixijs/pixi-react.git"},I7="MIT",U7={".":{import:{types:"./types/index.d.ts",default:"./lib/index.mjs"},require:{types:"./types/index.d.ts",default:"./lib/index.js"}}},L7="lib/index.js",N7="lib/index.mjs",G7="types/index.d.ts",z7=["lib","dist","types"],H7={build:"rimraf dist lib types && npm run lint:fix && rollup -c && tsc",clean:"xs clean",docs:"xs docs",lint:"xs lint","lint:fix":"xs lint --fix",prepare:"husky install",prerelease:"npm run test:lint && npm run build",release:"xs bump,publish,git-push",test:"tsc --project tsconfig.test.json && vitest run","test:e2e":"tsc --project tsconfig.test.json && vitest run e2e","test:unit":"tsc --project tsconfig.test.json && vitest run unit","test:lint":"xs lint","test:watch":"vitest"},V7={hooks:{"pre-commit":"lint-staged"}},j7={"react-reconciler":"0.29.2"},W7={"@pixi/extension-scripts":"^2.4.1","@rollup/plugin-commonjs":"^25.0.8","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@testing-library/jest-dom":"^6.4.8","@testing-library/react":"^16.0.0","@testing-library/user-event":"^14.5.2","@types/eslint":"^8.56.10","@types/react":"^18.3.2","@types/react-reconciler":"0.28.8","@vitejs/plugin-react":"^4.3.1","@vitest/browser":"^2.0.4",canvas:"^2.11.2",husky:"^8.0.0",jsdom:"^25.0.0","pixi.js":"8.2.6",playwright:"^1.45.3",react:"^18.3.1","react-dom":"^18.3.1",rollup:"^4.18.0","rollup-plugin-esbuild":"^6.1.1","rollup-plugin-sourcemaps":"^0.6.3",typescript:"^5.4.5",vitest:"^2.0.0"},$7={"pixi.js":"^8.2.6",react:">=18.0.0","react-dom":">=18.0.0"},X7={"react-dom":{optional:!0}},Y7={rollup:"^4.18.0"},q7={access:"public"},K7={lint:["test","lib"],environments:["node"],docsName:"PixiJS React",docsTitle:"PixiJS React API Documentation",docsDescription:"Documentation for PixiJS React library",docsKeyword:"docs, documentation, pixi, pixijs, react, html5, javascript, jsdoc"},Q7={name:R7,version:B7,description:M7,keywords:D7,homepage:O7,bugs:k7,repository:F7,license:I7,exports:U7,main:L7,module:N7,types:G7,files:z7,scripts:H7,husky:V7,"lint-staged":{"*.{ts,js,mjs}":["eslint --cache --fix --max-warnings 0"]},dependencies:j7,devDependencies:W7,peerDependencies:$7,peerDependenciesMeta:X7,overrides:Y7,publishConfig:q7,extensionConfig:K7};function Z7(){}function Pk(t,e,n){e instanceof le&&(e.__pixireact.parent=t,typeof n=="number"?t.__pixireact.filters.splice(n,0,e):t.__pixireact.filters.push(e),t.filters=t.__pixireact.filters)}function Md(t,e){e&&(e instanceof $e?t.addChild(e):e instanceof le&&Pk(t,e))}function J7(){}function eH(){return!1}const A2=Object.freeze({onclick:"onClick",onglobalmousemove:"onGlobalMouseMove",onglobalpointermove:"onGlobalPointerMove",onglobaltouchmove:"onGlobalTouchMove",onmousedown:"onMouseDown",onmouseenter:"onMouseEnter",onmouseleave:"onMouseLeave",onmousemove:"onMouseMove",onmouseout:"onMouseOut",onmouseover:"onMouseOver",onmouseup:"onMouseUp",onmouseupoutside:"onMouseUpOutside",onpointercancel:"onPointerCancel",onpointerdown:"onPointerDown",onpointerenter:"onPointerEnter",onpointerleave:"onPointerLeave",onpointermove:"onPointerMove",onpointerout:"onPointerOut",onpointerover:"onPointerOver",onpointertap:"onPointerTap",onpointerup:"onPointerUp",onpointerupoutside:"onPointerUpOutside",onrightclick:"onRightClick",onrightdown:"onRightDown",onrightup:"onRightUp",onrightupoutside:"onRightUpOutside",ontap:"onTap",ontouchcancel:"onTouchCancel",ontouchend:"onTouchEnd",ontouchendoutside:"onTouchEndOutside",ontouchmove:"onTouchMove",ontouchstart:"onTouchStart",onwheel:"onWheel"}),Ap=Object.freeze({onClick:"onclick",onGlobalMouseMove:"onglobalmousemove",onGlobalPointerMove:"onglobalpointermove",onGlobalTouchMove:"onglobaltouchmove",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseUpOutside:"onmouseupoutside",onPointerCancel:"onpointercancel",onPointerDown:"onpointerdown",onPointerEnter:"onpointerenter",onPointerLeave:"onpointerleave",onPointerMove:"onpointermove",onPointerOut:"onpointerout",onPointerOver:"onpointerover",onPointerTap:"onpointertap",onPointerUp:"onpointerup",onPointerUpOutside:"onpointerupoutside",onRightClick:"onrightclick",onRightDown:"onrightdown",onRightUp:"onrightup",onRightUpOutside:"onrightupoutside",onTap:"ontap",onTouchCancel:"ontouchcancel",onTouchEnd:"ontouchend",onTouchEndOutside:"ontouchendoutside",onTouchMove:"ontouchmove",onTouchStart:"ontouchstart",onWheel:"onwheel"});function Rk(t){return Array.isArray(t)}function Bk(t,e,n={arrays:"reference",objects:"reference",strict:!0}){const{arrays:r,objects:i,strict:s}=n;if(typeof t!=typeof e||!!t!=!!e)return!1;if(iH(t)||nH(t))return t===e;const o=rH(t);if(o&&i==="reference")return t===e;const a=Rk(t);if(a&&r==="reference")return t===e;if((a||o)&&t===e)return!0;let c;for(c in t)if(!(c in e))return!1;let h=t;if(s&&(h=e),o&&r==="shallow"&&i==="shallow"){for(c in h)if(!Bk(t[c],e[c],{strict:s,objects:"reference"}))return!1}else for(c in h)if(t[c]!==e[c])return!1;if(Mk(c)){if(a&&t.length===0&&e.length===0||o&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}function tH(t){return t===null}function nH(t){return typeof t=="number"}function rH(t){return!(t!==Object(t)||Rk(t)||typeof t=="function")}function iH(t){return typeof t=="string"}function Mk(t){return t===void 0}const sH=Object.freeze(["children","key","ref"]);function oH(t,e=[]){const n={};return Object.entries(t).reduce((r,[i,s])=>(e.includes(i)||(r[i]=s),r),n)}function P2(t,e=[]){return oH(t,sH.concat(e))}const aH="__default";function Dk(t,e={},n=!1){const r=P2(t),i=P2(e),s=Object.entries(r),o=[];if(n){const a=Object.keys(i);let c=0;for(;c<a.length;){const h=a[c];!(h in r)&&s.unshift([h,`${aH}remove`]),c+=1}}return s.forEach(([a,c])=>{if(Bk(c,i[a]))return;if(a in Ap){o.push([a,c,!0,[]]);return}let h=[];a.includes("-")&&(h=a.split("-")),o.push([a,c,!1,h]);for(const f in r){const p=r[f];f.startsWith(`${a}-`)&&o.push([f,p,!1,f.split("-")])}}),{changes:o}}function uH(t){const e=t;return!(!e||!e.changes)}const lH="__default",LT=new Map,NT={};function GT(t,e){if(t){const n=t[e];if(!Mk(n)&&!tH(n))return n}return t}function Ok(t,e){const{__pixireact:n={},...r}=t;let i;uH(e)?i=e:i=Dk(e,r);const{changes:s}=i;let o=0;for(;o<s.length;){const a=s[o];let c=!1,h=a[0],f=a[1];const p=a[2],v=a[3];let _=t,y=_[h];if(h==="draw"&&typeof f=="function"&&(t instanceof $s?f(t):(c=!0,UT("warn",`The \`draw\` prop was used on a \`${n.type}\` component, but it's only valid on \`graphics\` components.`))),h in A2){const S=h;c=!0,NT[h]||(NT[h]=!0,UT("warn",`Event names must be pascal case; instead of \`${h}\`, you probably want \`${A2[S]}\`.`))}if(!c){if(v.length&&(y=v.reduce(GT,_),!(y&&y.set))){const[S,...C]=v.reverse();_=C.reverse().reduce(GT,_),h=S}if(f===`${lH}remove`)if(_ instanceof $e){let S=LT.get(_.constructor);S||(S=_.constructor,S=new S,LT.set(_.constructor,S)),f=S[h]}else f=0;if(p&&n){const C=Ap[h];f?_[C]=f:delete _[C]}else Tk(_,h)||(_[h]=f)}o+=1}return t}const cH=Object.freeze([...Object.keys(A2),"draw"]),R2={};function hH(t){const e=t.charAt(0),n=t.substring(1);return`${e.toUpperCase()}${n}`}function fH(t,e){return e.toLowerCase()}function dH(t){let e=t;return t.startsWith("pixi")&&(e=t.replace(/^pixi([A-Z])/,fH)),e}function kk(t,e,n){const r=dH(t),i=hH(r);if(!(i in R2))throw new Error(`${i} is not part of the PIXI namespace! Did you forget to extend?`);const s=R2[i],o=P2(e,cH);Object.entries(e).forEach(([c,h])=>{if(c in Ap){const f=Ap[c];o[f]=h}});const a=Ek(new s(o),{root:n,type:r});return Ok(a,e),a}function Fk(t){if(t instanceof le){const e=t.__pixireact.parent;if(e){const n=e.__pixireact.filters.indexOf(t);e.__pixireact.filters.splice(n,1),e.filters=e.__pixireact.filters}t.__pixireact.parent=null}}function B2(t,e){e instanceof le&&Fk(e),e.destroy()}function pH(t,e,n,r){const i=t.__pixireact?.parent;if(!i)return;const s=t.__pixireact.root,o=kk(e,n,s);t.__pixireact.autoRemovedBeforeAppend||B2(i,t),o.parent&&(o.__pixireact.autoRemovedBeforeAppend=!0),Md(i,o),[r,r.alternate].forEach(c=>{if(c!==null&&(c.stateNode=o,c.ref))if(typeof c.ref=="function")c.ref(o);else{const h=c.ref;h.current=o}})}function mH(t,e,n,r,i,s){const{diff:o,shouldReconstruct:a}=e;a?pH(t,n,i,s):o&&Ok(t,o)}function gH(t,e,n,r){throw new Error("Text instances are not yet supported. Please use a `<text>` component.")}function vH(){}function _H(){return!1}function xH(t){return t}function yH(){const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return Vl.DefaultEventPriority;switch(t.event?.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Vl.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Vl.ContinuousEventPriority;default:return Vl.DefaultEventPriority}}function bH(){return null}function SH(t){throw new Error("Not yet implemented.")}function wH(t){return t}function CH(){return null}function TH(t){t instanceof $e?t.visible=!1:t instanceof le&&(t.enabled=!1)}function zT(t,e,n){if(e instanceof $e){const r=e,i=e,s=n;r.parent===t&&t.removeChild(i);const o=t.getChildIndex(s);t.addChildAt(i,o)}else if(e instanceof le){const s=e.__pixireact.filters.indexOf(n);Fk(e),Pk(t,e,s)}}function EH(){return null}function AH(){}function PH(){}function RH(t,e,n,r){const i={shouldReconstruct:!1},{children:s,...o}=r,{children:a,...c}=n,h=Dk(o,c,!0);return h.changes.length&&(i.diff=h),i}function BH(){}function MH(){return!1}function DH(t){t instanceof $e?t.visible=!0:t instanceof le&&(t.enabled=!0)}const OH={isPrimaryRenderer:!1,noTimeout:-1,supportsHydration:!1,supportsMutation:!0,supportsPersistence:!1,afterActiveInstanceBlur:Z7,appendChild:Md,appendChildToContainer:Md,appendInitialChild:Md,beforeActiveInstanceBlur:J7,cancelTimeout:clearTimeout,clearContainer:eH,commitUpdate:mH,createInstance:kk,createTextInstance:gH,detachDeletedInstance:vH,finalizeInitialChildren:_H,getChildHostContext:xH,getCurrentEventPriority:yH,getInstanceFromNode:bH,getInstanceFromScope:SH,getPublicInstance:wH,getRootHostContext:CH,hideInstance:TH,insertBefore:zT,insertInContainerBefore:zT,prepareForCommit:EH,preparePortalMount:AH,prepareScopeUpdate:PH,prepareUpdate:RH,removeChild:B2,removeChildFromContainer:B2,resetAfterCommit:BH,scheduleTimeout:setTimeout,shouldSetTextContent:MH,unhideInstance:DH},M2=P7(OH);M2.injectIntoDevTools({bundleType:0,rendererPackageName:"@pixi/react",version:Q7.version});const HT=new Map;function kH(t,e={},n){let r=HT.get(t),i=r?.applicationState??{isInitialised:!1,isInitialising:!1};const s=r?.internalState??{};r||(i.app=new Gy,s.rootContainer=Ek(i.app.stage));const o=r?.fiber??M2.createContainer(s.rootContainer,Vl.ConcurrentRoot,null,!1,null,"",console.error,null);if(!r){let a;t instanceof HTMLCanvasElement&&(a=t),a||(a=document.createElement("canvas"),t.innerHTML="",t.appendChild(a)),r={applicationState:i,fiber:o,internalState:s,render:async(h,f)=>(!i.app.renderer&&!i.isInitialised&&!i.isInitialising&&(i.isInitialising=!0,await i.app.init({...f,canvas:a}),i.isInitialising=!1,i.isInitialised=!0,i={...i},(e.onInit??n)?.(i.app)),Object.entries(f).forEach(([p,v])=>{const _=p;Tk(f,_)||(i.app[_]=v)}),M2.updateContainer(Le.createElement(T7,{value:i},h),o,null,()=>{}),i.app)},HT.set(a,r)}return r}const ad=typeof window<"u"&&(window.document?.createElement||window.navigator?.product==="ReactNative")?Le.useLayoutEffect:Le.useEffect,FH={...Qt.defaultTextStyle},Ik=(t,e)=>{const{attachToDevTools:n,children:r,className:i,defaultTextStyle:s,extensions:o,onInit:a,resizeTo:c,...h}=t,f=Le.useRef(null),p=Le.useRef(null),v=Le.useRef(new Set),_=Le.useRef(null),y=Le.useCallback(()=>{const C=f.current;C&&(c?"current"in c?c.current instanceof HTMLElement&&(C.resizeTo=c.current):C.resizeTo=c:C.resizeTo=void 0)},[c]),S=Le.useCallback(C=>{if(e&&"current"in e&&(e.current=C),f.current=C,y(),a?.(C),n){const b=globalThis;b.__PIXI_APP__=C,Ec(()=>Promise.resolve().then(()=>C7),void 0).then(w=>{b.__PIXI_DEVTOOLS__={app:C,pixi:w,renderer:C.renderer,stage:C.stage}})}},[a]);return ad(()=>{if(o){const C=[...o],b=v.current;for(const w of b.values()){const T=C.indexOf(w);T===-1&&(Ne.remove(w),b.delete(w)),C.splice(T,1)}for(const w in C)Ne.add(w),b.add(w)}},[o]),ad(()=>{const C=p.current;C&&(_.current||(_.current=kH(C,{},S)),_.current.render(r,h))},[h,r,S,c]),ad(()=>{y()},[c]),ad(()=>{s?Object.assign(Qt.defaultTextStyle,s):Object.assign(Qt.defaultTextStyle,FH)},[s]),Le.createElement("canvas",{ref:p,className:i})};Ik.displayName="Application";const IH=Le.forwardRef(Ik);function UH(t){Object.assign(R2,t)}console.warn(`
Be aware that you are using a beta version of Pixi React.
- Things may be broken.
- Things may (but shouldn't) change.
- All functionality that's deprecated in the beta version WILL BE REMOVED for the production release.
`);function Me(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw new Error(typeof t=="number"?"[MobX] minified error nr: "+t+(n.length?" "+n.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+t)}var LH={};function Xb(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:LH}var Uk=Object.assign,Pp=Object.getOwnPropertyDescriptor,xi=Object.defineProperty,jm=Object.prototype,D2=[];Object.freeze(D2);var Lk={};Object.freeze(Lk);var NH=typeof Proxy<"u",GH=Object.toString();function Nk(){NH||Me("Proxy not available")}function Gk(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}var nu=function(){};function Hr(t){return typeof t=="function"}function Yo(t){var e=typeof t;switch(e){case"string":case"symbol":case"number":return!0}return!1}function Wm(t){return t!==null&&typeof t=="object"}function Xs(t){if(!Wm(t))return!1;var e=Object.getPrototypeOf(t);if(e==null)return!0;var n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n.toString()===GH}function zk(t){var e=t?.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function $m(t,e,n){xi(t,e,{enumerable:!1,writable:!0,configurable:!0,value:n})}function Hk(t,e,n){xi(t,e,{enumerable:!1,writable:!1,configurable:!0,value:n})}function ia(t,e){var n="isMobX"+t;return e.prototype[n]=!0,function(r){return Wm(r)&&r[n]===!0}}function $u(t){return t!=null&&Object.prototype.toString.call(t)==="[object Map]"}function zH(t){var e=Object.getPrototypeOf(t),n=Object.getPrototypeOf(e),r=Object.getPrototypeOf(n);return r===null}function Vi(t){return t!=null&&Object.prototype.toString.call(t)==="[object Set]"}var Vk=typeof Object.getOwnPropertySymbols<"u";function HH(t){var e=Object.keys(t);if(!Vk)return e;var n=Object.getOwnPropertySymbols(t);return n.length?[].concat(e,n.filter(function(r){return jm.propertyIsEnumerable.call(t,r)})):e}var Xm=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Vk?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames;function jk(t){return t===null?null:typeof t=="object"?""+t:t}function Ki(t,e){return jm.hasOwnProperty.call(t,e)}var VH=Object.getOwnPropertyDescriptors||function(e){var n={};return Xm(e).forEach(function(r){n[r]=Pp(e,r)}),n};function jn(t,e){return!!(t&e)}function Wn(t,e,n){return n?t|=e:t&=~e,t}function VT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function jH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$H(r.key),r)}}function Xu(t,e,n){return e&&jH(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ru(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=XH(t))||e){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qo(){return qo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qo.apply(null,arguments)}function Wk(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,O2(t,e)}function O2(t,e){return O2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},O2(t,e)}function WH(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function $H(t){var e=WH(t,"string");return typeof e=="symbol"?e:e+""}function XH(t,e){if(t){if(typeof t=="string")return VT(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VT(t,e):void 0}}var ci=Symbol("mobx-stored-annotations");function yi(t){function e(n,r){if(yh(r))return t.decorate_20223_(n,r);xh(n,r,t)}return Object.assign(e,t)}function xh(t,e,n){Ki(t,ci)||$m(t,ci,qo({},t[ci])),nV(n)||(t[ci][e]=n)}function YH(t){return Ki(t,ci)||$m(t,ci,qo({},t[ci])),t[ci]}function yh(t){return typeof t=="object"&&typeof t.kind=="string"}var pe=Symbol("mobx administration"),io=function(){function t(n){n===void 0&&(n="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=Ue.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=n}var e=t.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(r){return r()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(r){return r()})},e.reportObserved=function(){return aF(this)},e.reportChanged=function(){gr(),uF(this),vr()},e.toString=function(){return this.name_},Xu(t,[{key:"isBeingObserved",get:function(){return jn(this.flags_,t.isBeingObservedMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isBeingObservedMask_,r)}},{key:"isPendingUnobservation",get:function(){return jn(this.flags_,t.isPendingUnobservationMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isPendingUnobservationMask_,r)}},{key:"diffValue",get:function(){return jn(this.flags_,t.diffValueMask_)?1:0},set:function(r){this.flags_=Wn(this.flags_,t.diffValueMask_,r===1)}}])}();io.isBeingObservedMask_=1;io.isPendingUnobservationMask_=2;io.diffValueMask_=4;var Yb=ia("Atom",io);function $k(t,e,n){e===void 0&&(e=nu),n===void 0&&(n=nu);var r=new io(t);return e!==nu&&oj(r,e),n!==nu&&dF(r,n),r}function qH(t,e){return t===e}function KH(t,e){return tS(t,e)}function QH(t,e){return tS(t,e,1)}function ZH(t,e){return Object.is?Object.is(t,e):t===e?t!==0||1/t===1/e:t!==t&&e!==e}var Rp={identity:qH,structural:KH,default:ZH,shallow:QH};function Ko(t,e,n){return vF(t)?t:Array.isArray(t)?Xt.array(t,{name:n}):Xs(t)?Xt.object(t,void 0,{name:n}):$u(t)?Xt.map(t,{name:n}):Vi(t)?Xt.set(t,{name:n}):typeof t=="function"&&!Xc(t)&&!Yc(t)?zk(t)?Ou(t):$c(n,t):t}function JH(t,e,n){if(t==null||Jm(t)||Zm(t)||oa(t)||li(t))return t;if(Array.isArray(t))return Xt.array(t,{name:n,deep:!1});if(Xs(t))return Xt.object(t,void 0,{name:n,deep:!1});if($u(t))return Xt.map(t,{name:n,deep:!1});if(Vi(t))return Xt.set(t,{name:n,deep:!1})}function Ym(t){return t}function eV(t,e){return tS(t,e)?e:t}var tV="override";function nV(t){return t.annotationType_===tV}function bh(t,e){return{annotationType_:t,options_:e,make_:rV,extend_:iV,decorate_20223_:sV}}function rV(t,e,n,r){var i;if((i=this.options_)!=null&&i.bound)return this.extend_(t,e,n,!1)===null?0:1;if(r===t.target_)return this.extend_(t,e,n,!1)===null?0:2;if(Xc(n.value))return 1;var s=Xk(t,this,e,n,!1);return xi(r,e,s),2}function iV(t,e,n,r){var i=Xk(t,this,e,n);return t.defineProperty_(e,i,r)}function sV(t,e){var n=e.kind,r=e.name,i=e.addInitializer,s=this,o=function(h){var f,p,v,_;return Qo((f=(p=s.options_)==null?void 0:p.name)!=null?f:r.toString(),h,(v=(_=s.options_)==null?void 0:_.autoAction)!=null?v:!1)};if(n=="field")return function(c){var h,f=c;return Xc(f)||(f=o(f)),(h=s.options_)!=null&&h.bound&&(f=f.bind(this),f.isMobxAction=!0),f};if(n=="method"){var a;return Xc(t)||(t=o(t)),(a=this.options_)!=null&&a.bound&&i(function(){var c=this,h=c[r].bind(c);h.isMobxAction=!0,c[r]=h}),t}Me("Cannot apply '"+s.annotationType_+"' to '"+String(r)+"' (kind: "+n+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function oV(t,e,n,r){e.annotationType_,r.value}function Xk(t,e,n,r,i){var s,o,a,c,h,f,p;i===void 0&&(i=K.safeDescriptors),oV(t,e,n,r);var v=r.value;if((s=e.options_)!=null&&s.bound){var _;v=v.bind((_=t.proxy_)!=null?_:t.target_)}return{value:Qo((o=(a=e.options_)==null?void 0:a.name)!=null?o:n.toString(),v,(c=(h=e.options_)==null?void 0:h.autoAction)!=null?c:!1,(f=e.options_)!=null&&f.bound?(p=t.proxy_)!=null?p:t.target_:void 0),configurable:i?t.isPlainObject_:!0,enumerable:!1,writable:!i}}function Yk(t,e){return{annotationType_:t,options_:e,make_:aV,extend_:uV,decorate_20223_:lV}}function aV(t,e,n,r){var i;if(r===t.target_)return this.extend_(t,e,n,!1)===null?0:2;if((i=this.options_)!=null&&i.bound&&(!Ki(t.target_,e)||!Yc(t.target_[e]))&&this.extend_(t,e,n,!1)===null)return 0;if(Yc(n.value))return 1;var s=qk(t,this,e,n,!1,!1);return xi(r,e,s),2}function uV(t,e,n,r){var i,s=qk(t,this,e,n,(i=this.options_)==null?void 0:i.bound);return t.defineProperty_(e,s,r)}function lV(t,e){var n,r=e.name,i=e.addInitializer;return Yc(t)||(t=Ou(t)),(n=this.options_)!=null&&n.bound&&i(function(){var s=this,o=s[r].bind(s);o.isMobXFlow=!0,s[r]=o}),t}function cV(t,e,n,r){e.annotationType_,r.value}function qk(t,e,n,r,i,s){s===void 0&&(s=K.safeDescriptors),cV(t,e,n,r);var o=r.value;if(Yc(o)||(o=Ou(o)),i){var a;o=o.bind((a=t.proxy_)!=null?a:t.target_),o.isMobXFlow=!0}return{value:o,configurable:s?t.isPlainObject_:!0,enumerable:!1,writable:!s}}function qb(t,e){return{annotationType_:t,options_:e,make_:hV,extend_:fV,decorate_20223_:dV}}function hV(t,e,n){return this.extend_(t,e,n,!1)===null?0:1}function fV(t,e,n,r){return pV(t,this,e,n),t.defineComputedProperty_(e,qo({},this.options_,{get:n.get,set:n.set}),r)}function dV(t,e){var n=this,r=e.name,i=e.addInitializer;return i(function(){var s=Yu(this)[pe],o=qo({},n.options_,{get:t,context:this});o.name||(o.name="ObservableObject."+r.toString()),s.values_.set(r,new Vr(o))}),function(){return this[pe].getObservablePropValue_(r)}}function pV(t,e,n,r){e.annotationType_,r.get}function qm(t,e){return{annotationType_:t,options_:e,make_:mV,extend_:gV,decorate_20223_:vV}}function mV(t,e,n){return this.extend_(t,e,n,!1)===null?0:1}function gV(t,e,n,r){var i,s;return _V(t,this),t.defineObservableProperty_(e,n.value,(i=(s=this.options_)==null?void 0:s.enhancer)!=null?i:Ko,r)}function vV(t,e){var n=this,r=e.kind,i=e.name,s=new WeakSet;function o(a,c){var h,f,p=Yu(a)[pe],v=new ko(c,(h=(f=n.options_)==null?void 0:f.enhancer)!=null?h:Ko,"ObservableObject."+i.toString(),!1);p.values_.set(i,v),s.add(a)}if(r=="accessor")return{get:function(){return s.has(this)||o(this,t.get.call(this)),this[pe].getObservablePropValue_(i)},set:function(c){return s.has(this)||o(this,c),this[pe].setObservablePropValue_(i,c)},init:function(c){return s.has(this)||o(this,c),c}}}function _V(t,e,n,r){e.annotationType_}var xV="true",yV=Kk();function Kk(t){return{annotationType_:xV,options_:t,make_:bV,extend_:SV,decorate_20223_:wV}}function bV(t,e,n,r){var i,s;if(n.get)return Km.make_(t,e,n,r);if(n.set){var o=Qo(e.toString(),n.set);return r===t.target_?t.defineProperty_(e,{configurable:K.safeDescriptors?t.isPlainObject_:!0,set:o})===null?0:2:(xi(r,e,{configurable:!0,set:o}),2)}if(r!==t.target_&&typeof n.value=="function"){var a;if(zk(n.value)){var c,h=(c=this.options_)!=null&&c.autoBind?Ou.bound:Ou;return h.make_(t,e,n,r)}var f=(a=this.options_)!=null&&a.autoBind?$c.bound:$c;return f.make_(t,e,n,r)}var p=((i=this.options_)==null?void 0:i.deep)===!1?Xt.ref:Xt;if(typeof n.value=="function"&&(s=this.options_)!=null&&s.autoBind){var v;n.value=n.value.bind((v=t.proxy_)!=null?v:t.target_)}return p.make_(t,e,n,r)}function SV(t,e,n,r){var i,s;if(n.get)return Km.extend_(t,e,n,r);if(n.set)return t.defineProperty_(e,{configurable:K.safeDescriptors?t.isPlainObject_:!0,set:Qo(e.toString(),n.set)},r);if(typeof n.value=="function"&&(i=this.options_)!=null&&i.autoBind){var o;n.value=n.value.bind((o=t.proxy_)!=null?o:t.target_)}var a=((s=this.options_)==null?void 0:s.deep)===!1?Xt.ref:Xt;return a.extend_(t,e,n,r)}function wV(t,e){Me("'"+this.annotationType_+"' cannot be used as a decorator")}var CV="observable",TV="observable.ref",EV="observable.shallow",AV="observable.struct",Qk={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Qk);function ud(t){return t||Qk}var k2=qm(CV),PV=qm(TV,{enhancer:Ym}),RV=qm(EV,{enhancer:JH}),BV=qm(AV,{enhancer:eV}),Zk=yi(k2);function ld(t){return t.deep===!0?Ko:t.deep===!1?Ym:DV(t.defaultDecorator)}function MV(t){var e;return t?(e=t.defaultDecorator)!=null?e:Kk(t):void 0}function DV(t){var e,n;return t&&(e=(n=t.options_)==null?void 0:n.enhancer)!=null?e:Ko}function Jk(t,e,n){if(yh(e))return k2.decorate_20223_(t,e);if(Yo(e)){xh(t,e,k2);return}return vF(t)?t:Xs(t)?Xt.object(t,e,n):Array.isArray(t)?Xt.array(t,e):$u(t)?Xt.map(t,e):Vi(t)?Xt.set(t,e):typeof t=="object"&&t!==null?t:Xt.box(t,e)}Uk(Jk,Zk);var OV={box:function(e,n){var r=ud(n);return new ko(e,ld(r),r.name,!0,r.equals)},array:function(e,n){var r=ud(n);return(K.useProxies===!1||r.proxy===!1?Bj:yj)(e,ld(r),r.name)},map:function(e,n){var r=ud(n);return new xF(e,ld(r),r.name)},set:function(e,n){var r=ud(n);return new yF(e,ld(r),r.name)},object:function(e,n,r){return aa(function(){return cj(K.useProxies===!1||r?.proxy===!1?Yu({},r):vj({},r),e,n)})},ref:yi(PV),shallow:yi(RV),deep:Zk,struct:yi(BV)},Xt=Uk(Jk,OV),eF="computed",kV="computed.struct",F2=qb(eF),FV=qb(kV,{equals:Rp.structural}),Km=function(e,n){if(yh(n))return F2.decorate_20223_(e,n);if(Yo(n))return xh(e,n,F2);if(Xs(e))return yi(qb(eF,e));var r=Xs(n)?n:{};return r.get=e,r.name||(r.name=e.name||""),new Vr(r)};Object.assign(Km,F2);Km.struct=yi(FV);var jT,WT,Bp=0,IV=1,UV=(jT=(WT=Pp(function(){},"name"))==null?void 0:WT.configurable)!=null?jT:!1,$T={value:"action",configurable:!0,writable:!1,enumerable:!1};function Qo(t,e,n,r){n===void 0&&(n=!1);function i(){return LV(t,n,e,r||this,arguments)}return i.isMobxAction=!0,i.toString=function(){return e.toString()},UV&&($T.value=t,xi(i,"name",$T)),i}function LV(t,e,n,r,i){var s=NV(t,e);try{return n.apply(r,i)}catch(o){throw s.error_=o,o}finally{GV(s)}}function NV(t,e,n,r){var i=!1,s=0,o=K.trackingDerivation,a=!e||!o;gr();var c=K.allowStateChanges;a&&(sa(),c=Kb(!0));var h=Zb(!0),f={runAsAction_:a,prevDerivation_:o,prevAllowStateChanges_:c,prevAllowStateReads_:h,notifySpy_:i,startTime_:s,actionId_:IV++,parentActionId_:Bp};return Bp=f.actionId_,f}function GV(t){Bp!==t.actionId_&&Me(30),Bp=t.parentActionId_,t.error_!==void 0&&(K.suppressReactionErrors=!0),Qb(t.prevAllowStateChanges_),ac(t.prevAllowStateReads_),vr(),t.runAsAction_&&Qi(t.prevDerivation_),K.suppressReactionErrors=!1}function Kb(t){var e=K.allowStateChanges;return K.allowStateChanges=t,e}function Qb(t){K.allowStateChanges=t}var ko=function(t){function e(r,i,s,o,a){var c;return s===void 0&&(s="ObservableValue"),a===void 0&&(a=Rp.default),c=t.call(this,s)||this,c.enhancer=void 0,c.name_=void 0,c.equals=void 0,c.hasUnreportedChange_=!1,c.interceptors_=void 0,c.changeListeners_=void 0,c.value_=void 0,c.dehancer=void 0,c.enhancer=i,c.name_=s,c.equals=a,c.value_=i(r,void 0,s),c}Wk(e,t);var n=e.prototype;return n.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},n.set=function(i){this.value_,i=this.prepareNewValue_(i),i!==K.UNCHANGED&&this.setNewValue_(i)},n.prepareNewValue_=function(i){if(fr(this)){var s=dr(this,{object:this,type:bi,newValue:i});if(!s)return K.UNCHANGED;i=s.newValue}return i=this.enhancer(i,this.value_,this.name_),this.equals(this.value_,i)?K.UNCHANGED:i},n.setNewValue_=function(i){var s=this.value_;this.value_=i,this.reportChanged(),Nr(this)&&Gr(this,{type:bi,object:this,newValue:i,oldValue:s})},n.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},n.intercept_=function(i){return Sh(this,i)},n.observe_=function(i,s){return s&&i({observableKind:"value",debugObjectName:this.name_,object:this,type:bi,newValue:this.value_,oldValue:void 0}),wh(this,i)},n.raw=function(){return this.value_},n.toJSON=function(){return this.get()},n.toString=function(){return this.name_+"["+this.value_+"]"},n.valueOf=function(){return jk(this.get())},n[Symbol.toPrimitive]=function(){return this.valueOf()},e}(io),Vr=function(){function t(n){this.dependenciesState_=Ue.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ue.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new Dp(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=Mp.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,n.get||Me(31),this.derivation=n.get,this.name_=n.name||"ComputedValue",n.set&&(this.setter_=Qo("ComputedValue-setter",n.set)),this.equals_=n.equals||(n.compareStructural||n.struct?Rp.structural:Rp.default),this.scope_=n.context,this.requiresReaction_=n.requiresReaction,this.keepAlive_=!!n.keepAlive}var e=t.prototype;return e.onBecomeStale_=function(){WV(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(r){return r()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(r){return r()})},e.get=function(){if(this.isComputing&&Me(32,this.name_,this.derivation),K.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)I2(this)&&(this.warnAboutUntrackedRead_(),gr(),this.value_=this.computeValue_(!1),vr());else if(aF(this),I2(this)){var r=K.trackingContext;this.keepAlive_&&!r&&(K.trackingContext=this),this.trackAndCompute()&&jV(this),K.trackingContext=r}var i=this.value_;if(Dd(i))throw i.cause;return i},e.set=function(r){if(this.setter_){this.isRunningSetter&&Me(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,r)}finally{this.isRunningSetter=!1}}else Me(34,this.name_)},e.trackAndCompute=function(){var r=this.value_,i=this.dependenciesState_===Ue.NOT_TRACKING_,s=this.computeValue_(!0),o=i||Dd(r)||Dd(s)||!this.equals_(r,s);return o&&(this.value_=s),o},e.computeValue_=function(r){this.isComputing=!0;var i=Kb(!1),s;if(r)s=tF(this,this.derivation,this.scope_);else if(K.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(o){s=new Dp(o)}return Qb(i),this.isComputing=!1,s},e.suspend_=function(){this.keepAlive_||(U2(this),this.value_=void 0)},e.observe_=function(r,i){var s=this,o=!0,a=void 0;return tj(function(){var c=s.get();if(!o||i){var h=sa();r({observableKind:"computed",debugObjectName:s.name_,type:bi,object:s,newValue:c,oldValue:a}),Qi(h)}o=!1,a=c})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return jk(this.get())},e[Symbol.toPrimitive]=function(){return this.valueOf()},Xu(t,[{key:"isComputing",get:function(){return jn(this.flags_,t.isComputingMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isComputingMask_,r)}},{key:"isRunningSetter",get:function(){return jn(this.flags_,t.isRunningSetterMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isRunningSetterMask_,r)}},{key:"isBeingObserved",get:function(){return jn(this.flags_,t.isBeingObservedMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isBeingObservedMask_,r)}},{key:"isPendingUnobservation",get:function(){return jn(this.flags_,t.isPendingUnobservationMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isPendingUnobservationMask_,r)}},{key:"diffValue",get:function(){return jn(this.flags_,t.diffValueMask_)?1:0},set:function(r){this.flags_=Wn(this.flags_,t.diffValueMask_,r===1)}}])}();Vr.isComputingMask_=1;Vr.isRunningSetterMask_=2;Vr.isBeingObservedMask_=4;Vr.isPendingUnobservationMask_=8;Vr.diffValueMask_=16;var Qm=ia("ComputedValue",Vr),Ue;(function(t){t[t.NOT_TRACKING_=-1]="NOT_TRACKING_",t[t.UP_TO_DATE_=0]="UP_TO_DATE_",t[t.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",t[t.STALE_=2]="STALE_"})(Ue||(Ue={}));var Mp;(function(t){t[t.NONE=0]="NONE",t[t.LOG=1]="LOG",t[t.BREAK=2]="BREAK"})(Mp||(Mp={}));var Dp=function(e){this.cause=void 0,this.cause=e};function Dd(t){return t instanceof Dp}function I2(t){switch(t.dependenciesState_){case Ue.UP_TO_DATE_:return!1;case Ue.NOT_TRACKING_:case Ue.STALE_:return!0;case Ue.POSSIBLY_STALE_:{for(var e=Zb(!0),n=sa(),r=t.observing_,i=r.length,s=0;s<i;s++){var o=r[s];if(Qm(o)){if(K.disableErrorBoundaries)o.get();else try{o.get()}catch{return Qi(n),ac(e),!0}if(t.dependenciesState_===Ue.STALE_)return Qi(n),ac(e),!0}}return rF(t),Qi(n),ac(e),!1}}}function tF(t,e,n){var r=Zb(!0);rF(t),t.newObserving_=new Array(t.runId_===0?100:t.observing_.length),t.unboundDepsCount_=0,t.runId_=++K.runId;var i=K.trackingDerivation;K.trackingDerivation=t,K.inBatch++;var s;if(K.disableErrorBoundaries===!0)s=e.call(n);else try{s=e.call(n)}catch(o){s=new Dp(o)}return K.inBatch--,K.trackingDerivation=i,zV(t),ac(r),s}function zV(t){for(var e=t.observing_,n=t.observing_=t.newObserving_,r=Ue.UP_TO_DATE_,i=0,s=t.unboundDepsCount_,o=0;o<s;o++){var a=n[o];a.diffValue===0&&(a.diffValue=1,i!==o&&(n[i]=a),i++),a.dependenciesState_>r&&(r=a.dependenciesState_)}for(n.length=i,t.newObserving_=null,s=e.length;s--;){var c=e[s];c.diffValue===0&&sF(c,t),c.diffValue=0}for(;i--;){var h=n[i];h.diffValue===1&&(h.diffValue=0,VV(h,t))}r!==Ue.UP_TO_DATE_&&(t.dependenciesState_=r,t.onBecomeStale_())}function U2(t){var e=t.observing_;t.observing_=[];for(var n=e.length;n--;)sF(e[n],t);t.dependenciesState_=Ue.NOT_TRACKING_}function nF(t){var e=sa();try{return t()}finally{Qi(e)}}function sa(){var t=K.trackingDerivation;return K.trackingDerivation=null,t}function Qi(t){K.trackingDerivation=t}function Zb(t){var e=K.allowStateReads;return K.allowStateReads=t,e}function ac(t){K.allowStateReads=t}function rF(t){if(t.dependenciesState_!==Ue.UP_TO_DATE_){t.dependenciesState_=Ue.UP_TO_DATE_;for(var e=t.observing_,n=e.length;n--;)e[n].lowestObserverState_=Ue.UP_TO_DATE_}}var Od=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},kd=!0,iF=!1,K=function(){var t=Xb();return t.__mobxInstanceCount>0&&!t.__mobxGlobals&&(kd=!1),t.__mobxGlobals&&t.__mobxGlobals.version!==new Od().version&&(kd=!1),kd?t.__mobxGlobals?(t.__mobxInstanceCount+=1,t.__mobxGlobals.UNCHANGED||(t.__mobxGlobals.UNCHANGED={}),t.__mobxGlobals):(t.__mobxInstanceCount=1,t.__mobxGlobals=new Od):(setTimeout(function(){iF||Me(35)},1),new Od)}();function HV(){if((K.pendingReactions.length||K.inBatch||K.isRunningReactions)&&Me(36),iF=!0,kd){var t=Xb();--t.__mobxInstanceCount===0&&(t.__mobxGlobals=void 0),K=new Od}}function VV(t,e){t.observers_.add(e),t.lowestObserverState_>e.dependenciesState_&&(t.lowestObserverState_=e.dependenciesState_)}function sF(t,e){t.observers_.delete(e),t.observers_.size===0&&oF(t)}function oF(t){t.isPendingUnobservation===!1&&(t.isPendingUnobservation=!0,K.pendingUnobservations.push(t))}function gr(){K.inBatch++}function vr(){if(--K.inBatch===0){lF();for(var t=K.pendingUnobservations,e=0;e<t.length;e++){var n=t[e];n.isPendingUnobservation=!1,n.observers_.size===0&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBUO()),n instanceof Vr&&n.suspend_())}K.pendingUnobservations=[]}}function aF(t){var e=K.trackingDerivation;return e!==null?(e.runId_!==t.lastAccessedBy_&&(t.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=t,!t.isBeingObserved&&K.trackingContext&&(t.isBeingObserved=!0,t.onBO())),t.isBeingObserved):(t.observers_.size===0&&K.inBatch>0&&oF(t),!1)}function uF(t){t.lowestObserverState_!==Ue.STALE_&&(t.lowestObserverState_=Ue.STALE_,t.observers_.forEach(function(e){e.dependenciesState_===Ue.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=Ue.STALE_}))}function jV(t){t.lowestObserverState_!==Ue.STALE_&&(t.lowestObserverState_=Ue.STALE_,t.observers_.forEach(function(e){e.dependenciesState_===Ue.POSSIBLY_STALE_?e.dependenciesState_=Ue.STALE_:e.dependenciesState_===Ue.UP_TO_DATE_&&(t.lowestObserverState_=Ue.UP_TO_DATE_)}))}function WV(t){t.lowestObserverState_===Ue.UP_TO_DATE_&&(t.lowestObserverState_=Ue.POSSIBLY_STALE_,t.observers_.forEach(function(e){e.dependenciesState_===Ue.UP_TO_DATE_&&(e.dependenciesState_=Ue.POSSIBLY_STALE_,e.onBecomeStale_())}))}var os=function(){function t(n,r,i,s){n===void 0&&(n="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Ue.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=Mp.NONE,this.name_=n,this.onInvalidate_=r,this.errorHandler_=i,this.requiresObservable_=s}var e=t.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled||(this.isScheduled=!0,K.pendingReactions.push(this),lF())},e.runReaction_=function(){if(!this.isDisposed){gr(),this.isScheduled=!1;var r=K.trackingContext;if(K.trackingContext=this,I2(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(i){this.reportExceptionInDerivation_(i)}}K.trackingContext=r,vr()}},e.track=function(r){if(!this.isDisposed){gr(),this.isRunning=!0;var i=K.trackingContext;K.trackingContext=this;var s=tF(this,r,void 0);K.trackingContext=i,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&U2(this),Dd(s)&&this.reportExceptionInDerivation_(s.cause),vr()}},e.reportExceptionInDerivation_=function(r){var i=this;if(this.errorHandler_){this.errorHandler_(r,this);return}if(K.disableErrorBoundaries)throw r;var s="[mobx] uncaught error in '"+this+"'";K.suppressReactionErrors||console.error(s,r),K.globalReactionErrorHandlers.forEach(function(o){return o(r,i)})},e.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(gr(),U2(this),vr()))},e.getDisposer_=function(r){var i=this,s=function o(){i.dispose(),r==null||r.removeEventListener==null||r.removeEventListener("abort",o)};return r==null||r.addEventListener==null||r.addEventListener("abort",s),s[pe]=this,s},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(r){},Xu(t,[{key:"isDisposed",get:function(){return jn(this.flags_,t.isDisposedMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isDisposedMask_,r)}},{key:"isScheduled",get:function(){return jn(this.flags_,t.isScheduledMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isScheduledMask_,r)}},{key:"isTrackPending",get:function(){return jn(this.flags_,t.isTrackPendingMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isTrackPendingMask_,r)}},{key:"isRunning",get:function(){return jn(this.flags_,t.isRunningMask_)},set:function(r){this.flags_=Wn(this.flags_,t.isRunningMask_,r)}},{key:"diffValue",get:function(){return jn(this.flags_,t.diffValueMask_)?1:0},set:function(r){this.flags_=Wn(this.flags_,t.diffValueMask_,r===1)}}])}();os.isDisposedMask_=1;os.isScheduledMask_=2;os.isTrackPendingMask_=4;os.isRunningMask_=8;os.diffValueMask_=16;var $V=100,L2=function(e){return e()};function lF(){K.inBatch>0||K.isRunningReactions||L2(XV)}function XV(){K.isRunningReactions=!0;for(var t=K.pendingReactions,e=0;t.length>0;){++e===$V&&(console.error("[mobx] cycle in reaction: "+t[0]),t.splice(0));for(var n=t.splice(0),r=0,i=n.length;r<i;r++)n[r].runReaction_()}K.isRunningReactions=!1}var Op=ia("Reaction",os);function YV(t){var e=L2;L2=function(r){return t(function(){return e(r)})}}function uc(){return!1}function qV(t){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var cF="action",KV="action.bound",hF="autoAction",QV="autoAction.bound",ZV="<unnamed action>",N2=bh(cF),JV=bh(KV,{bound:!0}),G2=bh(hF,{autoAction:!0}),ej=bh(QV,{autoAction:!0,bound:!0});function fF(t){var e=function(r,i){if(Hr(r))return Qo(r.name||ZV,r,t);if(Hr(i))return Qo(r,i,t);if(yh(i))return(t?G2:N2).decorate_20223_(r,i);if(Yo(i))return xh(r,i,t?G2:N2);if(Yo(r))return yi(bh(t?hF:cF,{name:r,autoAction:t}))};return e}var Bo=fF(!1);Object.assign(Bo,N2);var $c=fF(!0);Object.assign($c,G2);Bo.bound=yi(JV);$c.bound=yi(ej);function Xc(t){return Hr(t)&&t.isMobxAction===!0}function tj(t,e){var n,r,i,s;e===void 0&&(e=Lk);var o=(n=(r=e)==null?void 0:r.name)!=null?n:"Autorun",a=!e.scheduler&&!e.delay,c;if(a)c=new os(o,function(){this.track(p)},e.onError,e.requiresObservable);else{var h=rj(e),f=!1;c=new os(o,function(){f||(f=!0,h(function(){f=!1,c.isDisposed||c.track(p)}))},e.onError,e.requiresObservable)}function p(){t(c)}return(i=e)!=null&&(i=i.signal)!=null&&i.aborted||c.schedule_(),c.getDisposer_((s=e)==null?void 0:s.signal)}var nj=function(e){return e()};function rj(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:nj}var ij="onBO",sj="onBUO";function oj(t,e,n){return pF(ij,t,e,n)}function dF(t,e,n){return pF(sj,t,e,n)}function pF(t,e,n,r){var i=Ip(e),s=Hr(r)?r:n,o=t+"L";return i[o]?i[o].add(s):i[o]=new Set([s]),function(){var a=i[o];a&&(a.delete(s),a.size===0&&delete i[o])}}var aj="never",cd="always",uj="observed";function lj(t){t.isolateGlobalState===!0&&HV();var e=t.useProxies,n=t.enforceActions;if(e!==void 0&&(K.useProxies=e===cd?!0:e===aj?!1:typeof Proxy<"u"),e==="ifavailable"&&(K.verifyProxies=!0),n!==void 0){var r=n===cd?cd:n===uj;K.enforceActions=r,K.allowStateChanges=!(r===!0||r===cd)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(i){i in t&&(K[i]=!!t[i])}),K.allowStateReads=!K.observableRequiresReaction,t.reactionScheduler&&YV(t.reactionScheduler)}function cj(t,e,n,r){var i=VH(e);return aa(function(){var s=Yu(t,r)[pe];Xm(i).forEach(function(o){s.extend_(o,i[o],n&&o in n?n[o]:!0)})}),t}function hj(t,e){return mF(Ip(t,e))}function mF(t){var e={name:t.name_};return t.observing_&&t.observing_.length>0&&(e.dependencies=fj(t.observing_).map(mF)),e}function fj(t){return Array.from(new Set(t))}var dj=0;function gF(){this.message="FLOW_CANCELLED"}gF.prototype=Object.create(Error.prototype);var Av=Yk("flow"),pj=Yk("flow.bound",{bound:!0}),Ou=Object.assign(function(e,n){if(yh(n))return Av.decorate_20223_(e,n);if(Yo(n))return xh(e,n,Av);var r=e,i=r.name||"<unnamed flow>",s=function(){var a=this,c=arguments,h=++dj,f=Bo(i+" - runid: "+h+" - init",r).apply(a,c),p,v=void 0,_=new Promise(function(y,S){var C=0;p=S;function b(A){v=void 0;var M;try{M=Bo(i+" - runid: "+h+" - yield "+C++,f.next).call(f,A)}catch(L){return S(L)}T(M)}function w(A){v=void 0;var M;try{M=Bo(i+" - runid: "+h+" - yield "+C++,f.throw).call(f,A)}catch(L){return S(L)}T(M)}function T(A){if(Hr(A?.then)){A.then(T,S);return}return A.done?y(A.value):(v=Promise.resolve(A.value),v.then(b,w))}b(void 0)});return _.cancel=Bo(i+" - runid: "+h+" - cancel",function(){try{v&&XT(v);var y=f.return(void 0),S=Promise.resolve(y.value);S.then(nu,nu),XT(S),p(new gF)}catch(C){p(C)}}),_};return s.isMobXFlow=!0,s},Av);Ou.bound=yi(pj);function XT(t){Hr(t.cancel)&&t.cancel()}function Yc(t){return t?.isMobXFlow===!0}function mj(t,e){return t?Jm(t)||!!t[pe]||Yb(t)||Op(t)||Qm(t):!1}function vF(t){return mj(t)}function ji(t,e){e===void 0&&(e=void 0),gr();try{return t.apply(e)}finally{vr()}}function Da(t){return t[pe]}var gj={has:function(e,n){return Da(e).has_(n)},get:function(e,n){return Da(e).get_(n)},set:function(e,n,r){var i;return Yo(n)?(i=Da(e).set_(n,r,!0))!=null?i:!0:!1},deleteProperty:function(e,n){var r;return Yo(n)?(r=Da(e).delete_(n,!0))!=null?r:!0:!1},defineProperty:function(e,n,r){var i;return(i=Da(e).defineProperty_(n,r))!=null?i:!0},ownKeys:function(e){return Da(e).ownKeys_()},preventExtensions:function(e){Me(13)}};function vj(t,e){var n,r;return Nk(),t=Yu(t,e),(r=(n=t[pe]).proxy_)!=null?r:n.proxy_=new Proxy(t,gj)}function fr(t){return t.interceptors_!==void 0&&t.interceptors_.length>0}function Sh(t,e){var n=t.interceptors_||(t.interceptors_=[]);return n.push(e),Gk(function(){var r=n.indexOf(e);r!==-1&&n.splice(r,1)})}function dr(t,e){var n=sa();try{for(var r=[].concat(t.interceptors_||[]),i=0,s=r.length;i<s&&(e=r[i](e),e&&!e.type&&Me(14),!!e);i++);return e}finally{Qi(n)}}function Nr(t){return t.changeListeners_!==void 0&&t.changeListeners_.length>0}function wh(t,e){var n=t.changeListeners_||(t.changeListeners_=[]);return n.push(e),Gk(function(){var r=n.indexOf(e);r!==-1&&n.splice(r,1)})}function Gr(t,e){var n=sa(),r=t.changeListeners_;if(r){r=r.slice();for(var i=0,s=r.length;i<s;i++)r[i](e);Qi(n)}}function wi(t,e,n){return aa(function(){var r,i=Yu(t,n)[pe];(r=e)!=null||(e=YH(t)),Xm(e).forEach(function(s){return i.make_(s,e[s])})}),t}var YT="splice",bi="update",_j=1e4,xj={get:function(e,n){var r=e[pe];return n===pe?r:n==="length"?r.getArrayLength_():typeof n=="string"&&!isNaN(n)?r.get_(parseInt(n)):Ki(kp,n)?kp[n]:e[n]},set:function(e,n,r){var i=e[pe];return n==="length"&&i.setArrayLength_(r),typeof n=="symbol"||isNaN(n)?e[n]=r:i.set_(parseInt(n),r),!0},preventExtensions:function(){Me(15)}},Jb=function(){function t(n,r,i,s){n===void 0&&(n="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=i,this.legacyMode_=s,this.atom_=new io(n),this.enhancer_=function(o,a){return r(o,a,"ObservableArray[..]")}}var e=t.prototype;return e.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},e.dehanceValues_=function(r){return this.dehancer!==void 0&&r.length>0?r.map(this.dehancer):r},e.intercept_=function(r){return Sh(this,r)},e.observe_=function(r,i){return i===void 0&&(i=!1),i&&r({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),wh(this,r)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(r){(typeof r!="number"||isNaN(r)||r<0)&&Me("Out of range: "+r);var i=this.values_.length;if(r!==i)if(r>i){for(var s=new Array(r-i),o=0;o<r-i;o++)s[o]=void 0;this.spliceWithArray_(i,0,s)}else this.spliceWithArray_(r,i-r)},e.updateArrayLength_=function(r,i){r!==this.lastKnownLength_&&Me(16),this.lastKnownLength_+=i,this.legacyMode_&&i>0&&CF(r+i+1)},e.spliceWithArray_=function(r,i,s){var o=this;this.atom_;var a=this.values_.length;if(r===void 0?r=0:r>a?r=a:r<0&&(r=Math.max(0,a+r)),arguments.length===1?i=a-r:i==null?i=0:i=Math.max(0,Math.min(i,a-r)),s===void 0&&(s=D2),fr(this)){var c=dr(this,{object:this.proxy_,type:YT,index:r,removedCount:i,added:s});if(!c)return D2;i=c.removedCount,s=c.added}if(s=s.length===0?s:s.map(function(p){return o.enhancer_(p,void 0)}),this.legacyMode_){var h=s.length-i;this.updateArrayLength_(a,h)}var f=this.spliceItemsIntoValues_(r,i,s);return(i!==0||s.length!==0)&&this.notifyArraySplice_(r,s,f),this.dehanceValues_(f)},e.spliceItemsIntoValues_=function(r,i,s){if(s.length<_j){var o;return(o=this.values_).splice.apply(o,[r,i].concat(s))}else{var a=this.values_.slice(r,r+i),c=this.values_.slice(r+i);this.values_.length+=s.length-i;for(var h=0;h<s.length;h++)this.values_[r+h]=s[h];for(var f=0;f<c.length;f++)this.values_[r+s.length+f]=c[f];return a}},e.notifyArrayChildUpdate_=function(r,i,s){var o=!this.owned_&&uc(),a=Nr(this),c=a||o?{observableKind:"array",object:this.proxy_,type:bi,debugObjectName:this.atom_.name_,index:r,newValue:i,oldValue:s}:null;this.atom_.reportChanged(),a&&Gr(this,c)},e.notifyArraySplice_=function(r,i,s){var o=!this.owned_&&uc(),a=Nr(this),c=a||o?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:YT,index:r,removed:s,added:i,removedCount:s.length,addedCount:i.length}:null;this.atom_.reportChanged(),a&&Gr(this,c)},e.get_=function(r){if(this.legacyMode_&&r>=this.values_.length){console.warn("[mobx] Out of bounds read: "+r);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[r])},e.set_=function(r,i){var s=this.values_;if(this.legacyMode_&&r>s.length&&Me(17,r,s.length),r<s.length){this.atom_;var o=s[r];if(fr(this)){var a=dr(this,{type:bi,object:this.proxy_,index:r,newValue:i});if(!a)return;i=a.newValue}i=this.enhancer_(i,o);var c=i!==o;c&&(s[r]=i,this.notifyArrayChildUpdate_(r,i,o))}else{for(var h=new Array(r+1-s.length),f=0;f<h.length-1;f++)h[f]=void 0;h[h.length-1]=i,this.spliceWithArray_(s.length,0,h)}},t}();function yj(t,e,n,r){return n===void 0&&(n="ObservableArray"),r===void 0&&(r=!1),Nk(),aa(function(){var i=new Jb(n,e,r,!1);Hk(i.values_,pe,i);var s=new Proxy(i.values_,xj);return i.proxy_=s,t&&t.length&&i.spliceWithArray_(0,0,t),s})}var kp={clear:function(){return this.splice(0)},replace:function(e){var n=this[pe];return n.spliceWithArray_(0,n.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];var o=this[pe];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,n)}return o.spliceWithArray_(e,n,i)},spliceWithArray:function(e,n,r){return this[pe].spliceWithArray_(e,n,r)},push:function(){for(var e=this[pe],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.spliceWithArray_(e.values_.length,0,r),e.values_.length},pop:function(){return this.splice(Math.max(this[pe].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[pe],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.spliceWithArray_(0,0,r),e.values_.length},reverse:function(){return K.trackingDerivation&&Me(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){K.trackingDerivation&&Me(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var n=this[pe],r=n.dehanceValues_(n.values_).indexOf(e);return r>-1?(this.splice(r,1),!0):!1}};Qe("at",Jn);Qe("concat",Jn);Qe("flat",Jn);Qe("includes",Jn);Qe("indexOf",Jn);Qe("join",Jn);Qe("lastIndexOf",Jn);Qe("slice",Jn);Qe("toString",Jn);Qe("toLocaleString",Jn);Qe("toSorted",Jn);Qe("toSpliced",Jn);Qe("with",Jn);Qe("every",$r);Qe("filter",$r);Qe("find",$r);Qe("findIndex",$r);Qe("findLast",$r);Qe("findLastIndex",$r);Qe("flatMap",$r);Qe("forEach",$r);Qe("map",$r);Qe("some",$r);Qe("toReversed",$r);Qe("reduce",_F);Qe("reduceRight",_F);function Qe(t,e){typeof Array.prototype[t]=="function"&&(kp[t]=e(t))}function Jn(t){return function(){var e=this[pe];e.atom_.reportObserved();var n=e.dehanceValues_(e.values_);return n[t].apply(n,arguments)}}function $r(t){return function(e,n){var r=this,i=this[pe];i.atom_.reportObserved();var s=i.dehanceValues_(i.values_);return s[t](function(o,a){return e.call(n,o,a,r)})}}function _F(t){return function(){var e=this,n=this[pe];n.atom_.reportObserved();var r=n.dehanceValues_(n.values_),i=arguments[0];return arguments[0]=function(s,o,a){return i(s,o,a,e)},r[t].apply(r,arguments)}}var bj=ia("ObservableArrayAdministration",Jb);function Zm(t){return Wm(t)&&bj(t[pe])}var Sj={},ks="add",Fp="delete",xF=function(){function t(n,r,i){var s=this;r===void 0&&(r=Ko),i===void 0&&(i="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[pe]=Sj,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=r,this.name_=i,Hr(Map)||Me(18),aa(function(){s.keysAtom_=$k("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,n&&s.merge(n)})}var e=t.prototype;return e.has_=function(r){return this.data_.has(r)},e.has=function(r){var i=this;if(!K.trackingDerivation)return this.has_(r);var s=this.hasMap_.get(r);if(!s){var o=s=new ko(this.has_(r),Ym,"ObservableMap.key?",!1);this.hasMap_.set(r,o),dF(o,function(){return i.hasMap_.delete(r)})}return s.get()},e.set=function(r,i){var s=this.has_(r);if(fr(this)){var o=dr(this,{type:s?bi:ks,object:this,newValue:i,name:r});if(!o)return this;i=o.newValue}return s?this.updateValue_(r,i):this.addValue_(r,i),this},e.delete=function(r){var i=this;if(this.keysAtom_,fr(this)){var s=dr(this,{type:Fp,object:this,name:r});if(!s)return!1}if(this.has_(r)){var o=uc(),a=Nr(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:Fp,object:this,oldValue:this.data_.get(r).value_,name:r}:null;return ji(function(){var h;i.keysAtom_.reportChanged(),(h=i.hasMap_.get(r))==null||h.setNewValue_(!1);var f=i.data_.get(r);f.setNewValue_(void 0),i.data_.delete(r)}),a&&Gr(this,c),!0}return!1},e.updateValue_=function(r,i){var s=this.data_.get(r);if(i=s.prepareNewValue_(i),i!==K.UNCHANGED){var o=uc(),a=Nr(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:bi,object:this,oldValue:s.value_,name:r,newValue:i}:null;s.setNewValue_(i),a&&Gr(this,c)}},e.addValue_=function(r,i){var s=this;this.keysAtom_,ji(function(){var h,f=new ko(i,s.enhancer_,"ObservableMap.key",!1);s.data_.set(r,f),i=f.value_,(h=s.hasMap_.get(r))==null||h.setNewValue_(!0),s.keysAtom_.reportChanged()});var o=uc(),a=Nr(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:ks,object:this,name:r,newValue:i}:null;a&&Gr(this,c)},e.get=function(r){return this.has(r)?this.dehanceValue_(this.data_.get(r).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var r=this,i=this.keys();return qc({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:r.get(c)}}})},e.entries=function(){var r=this,i=this.keys();return qc({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:[c,r.get(c)]}}})},e[Symbol.iterator]=function(){return this.entries()},e.forEach=function(r,i){for(var s=ru(this),o;!(o=s()).done;){var a=o.value,c=a[0],h=a[1];r.call(i,h,c,this)}},e.merge=function(r){var i=this;return oa(r)&&(r=new Map(r)),ji(function(){Xs(r)?HH(r).forEach(function(s){return i.set(s,r[s])}):Array.isArray(r)?r.forEach(function(s){var o=s[0],a=s[1];return i.set(o,a)}):$u(r)?(zH(r)||Me(19,r),r.forEach(function(s,o){return i.set(o,s)})):r!=null&&Me(20,r)}),this},e.clear=function(){var r=this;ji(function(){nF(function(){for(var i=ru(r.keys()),s;!(s=i()).done;){var o=s.value;r.delete(o)}})})},e.replace=function(r){var i=this;return ji(function(){for(var s=wj(r),o=new Map,a=!1,c=ru(i.data_.keys()),h;!(h=c()).done;){var f=h.value;if(!s.has(f)){var p=i.delete(f);if(p)a=!0;else{var v=i.data_.get(f);o.set(f,v)}}}for(var _=ru(s.entries()),y;!(y=_()).done;){var S=y.value,C=S[0],b=S[1],w=i.data_.has(C);if(i.set(C,b),i.data_.has(C)){var T=i.data_.get(C);o.set(C,T),w||(a=!0)}}if(!a)if(i.data_.size!==o.size)i.keysAtom_.reportChanged();else for(var A=i.data_.keys(),M=o.keys(),L=A.next(),I=M.next();!L.done;){if(L.value!==I.value){i.keysAtom_.reportChanged();break}L=A.next(),I=M.next()}i.data_=o}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(r,i){return wh(this,r)},e.intercept_=function(r){return Sh(this,r)},Xu(t,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),oa=ia("ObservableMap",xF);function wj(t){if($u(t)||oa(t))return t;if(Array.isArray(t))return new Map(t);if(Xs(t)){var e=new Map;for(var n in t)e.set(n,t[n]);return e}else return Me(21,t)}var Cj={},yF=function(){function t(n,r,i){var s=this;r===void 0&&(r=Ko),i===void 0&&(i="ObservableSet"),this.name_=void 0,this[pe]=Cj,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=i,Hr(Set)||Me(22),this.enhancer_=function(o,a){return r(o,a,i)},aa(function(){s.atom_=$k(s.name_),n&&s.replace(n)})}var e=t.prototype;return e.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},e.clear=function(){var r=this;ji(function(){nF(function(){for(var i=ru(r.data_.values()),s;!(s=i()).done;){var o=s.value;r.delete(o)}})})},e.forEach=function(r,i){for(var s=ru(this),o;!(o=s()).done;){var a=o.value;r.call(i,a,a,this)}},e.add=function(r){var i=this;if(this.atom_,fr(this)){var s=dr(this,{type:ks,object:this,newValue:r});if(!s)return this}if(!this.has(r)){ji(function(){i.data_.add(i.enhancer_(r,void 0)),i.atom_.reportChanged()});var o=!1,a=Nr(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:ks,object:this,newValue:r}:null;a&&Gr(this,c)}return this},e.delete=function(r){var i=this;if(fr(this)){var s=dr(this,{type:Fp,object:this,oldValue:r});if(!s)return!1}if(this.has(r)){var o=!1,a=Nr(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:Fp,object:this,oldValue:r}:null;return ji(function(){i.atom_.reportChanged(),i.data_.delete(r)}),a&&Gr(this,c),!0}return!1},e.has=function(r){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(r))},e.entries=function(){var r=0,i=Array.from(this.keys()),s=Array.from(this.values());return qc({next:function(){var a=r;return r+=1,a<s.length?{value:[i[a],s[a]],done:!1}:{done:!0}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var r=this,i=0,s=Array.from(this.data_.values());return qc({next:function(){return i<s.length?{value:r.dehanceValue_(s[i++]),done:!1}:{done:!0}}})},e.intersection=function(r){if(Vi(r)&&!li(r))return r.intersection(this);var i=new Set(this);return i.intersection(r)},e.union=function(r){if(Vi(r)&&!li(r))return r.union(this);var i=new Set(this);return i.union(r)},e.difference=function(r){return new Set(this).difference(r)},e.symmetricDifference=function(r){if(Vi(r)&&!li(r))return r.symmetricDifference(this);var i=new Set(this);return i.symmetricDifference(r)},e.isSubsetOf=function(r){return new Set(this).isSubsetOf(r)},e.isSupersetOf=function(r){return new Set(this).isSupersetOf(r)},e.isDisjointFrom=function(r){if(Vi(r)&&!li(r))return r.isDisjointFrom(this);var i=new Set(this);return i.isDisjointFrom(r)},e.replace=function(r){var i=this;return li(r)&&(r=new Set(r)),ji(function(){Array.isArray(r)?(i.clear(),r.forEach(function(s){return i.add(s)})):Vi(r)?(i.clear(),r.forEach(function(s){return i.add(s)})):r!=null&&Me("Cannot initialize set from "+r)}),this},e.observe_=function(r,i){return wh(this,r)},e.intercept_=function(r){return Sh(this,r)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Symbol.iterator]=function(){return this.values()},Xu(t,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),li=ia("ObservableSet",yF),qT=Object.create(null),KT="remove",bF=function(){function t(n,r,i,s){r===void 0&&(r=new Map),s===void 0&&(s=yV),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=n,this.values_=r,this.name_=i,this.defaultAnnotation_=s,this.keysAtom_=new io("ObservableObject.keys"),this.isPlainObject_=Xs(this.target_)}var e=t.prototype;return e.getObservablePropValue_=function(r){return this.values_.get(r).get()},e.setObservablePropValue_=function(r,i){var s=this.values_.get(r);if(s instanceof Vr)return s.set(i),!0;if(fr(this)){var o=dr(this,{type:bi,object:this.proxy_||this.target_,name:r,newValue:i});if(!o)return null;i=o.newValue}if(i=s.prepareNewValue_(i),i!==K.UNCHANGED){var a=Nr(this),c=!1,h=a||c?{type:bi,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:r,newValue:i}:null;s.setNewValue_(i),a&&Gr(this,h)}return!0},e.get_=function(r){return K.trackingDerivation&&!Ki(this.target_,r)&&this.has_(r),this.target_[r]},e.set_=function(r,i,s){return s===void 0&&(s=!1),Ki(this.target_,r)?this.values_.has(r)?this.setObservablePropValue_(r,i):s?Reflect.set(this.target_,r,i):(this.target_[r]=i,!0):this.extend_(r,{value:i,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},e.has_=function(r){if(!K.trackingDerivation)return r in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var i=this.pendingKeys_.get(r);return i||(i=new ko(r in this.target_,Ym,"ObservableObject.key?",!1),this.pendingKeys_.set(r,i)),i.get()},e.make_=function(r,i){if(i===!0&&(i=this.defaultAnnotation_),i!==!1){if(!(r in this.target_)){var s;if((s=this.target_[ci])!=null&&s[r])return;Me(1,i.annotationType_,this.name_+"."+r.toString())}for(var o=this.target_;o&&o!==jm;){var a=Pp(o,r);if(a){var c=i.make_(this,r,a,o);if(c===0)return;if(c===1)break}o=Object.getPrototypeOf(o)}ZT(this,i,r)}},e.extend_=function(r,i,s,o){if(o===void 0&&(o=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(r,i,o);var a=s.extend_(this,r,i,o);return a&&ZT(this,s,r),a},e.defineProperty_=function(r,i,s){s===void 0&&(s=!1),this.keysAtom_;try{gr();var o=this.delete_(r);if(!o)return o;if(fr(this)){var a=dr(this,{object:this.proxy_||this.target_,name:r,type:ks,newValue:i.value});if(!a)return null;var c=a.newValue;i.value!==c&&(i=qo({},i,{value:c}))}if(s){if(!Reflect.defineProperty(this.target_,r,i))return!1}else xi(this.target_,r,i);this.notifyPropertyAddition_(r,i.value)}finally{vr()}return!0},e.defineObservableProperty_=function(r,i,s,o){o===void 0&&(o=!1),this.keysAtom_;try{gr();var a=this.delete_(r);if(!a)return a;if(fr(this)){var c=dr(this,{object:this.proxy_||this.target_,name:r,type:ks,newValue:i});if(!c)return null;i=c.newValue}var h=QT(r),f={configurable:K.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:h.get,set:h.set};if(o){if(!Reflect.defineProperty(this.target_,r,f))return!1}else xi(this.target_,r,f);var p=new ko(i,s,"ObservableObject.key",!1);this.values_.set(r,p),this.notifyPropertyAddition_(r,p.value_)}finally{vr()}return!0},e.defineComputedProperty_=function(r,i,s){s===void 0&&(s=!1),this.keysAtom_;try{gr();var o=this.delete_(r);if(!o)return o;if(fr(this)){var a=dr(this,{object:this.proxy_||this.target_,name:r,type:ks,newValue:void 0});if(!a)return null}i.name||(i.name="ObservableObject.key"),i.context=this.proxy_||this.target_;var c=QT(r),h={configurable:K.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:c.get,set:c.set};if(s){if(!Reflect.defineProperty(this.target_,r,h))return!1}else xi(this.target_,r,h);this.values_.set(r,new Vr(i)),this.notifyPropertyAddition_(r,void 0)}finally{vr()}return!0},e.delete_=function(r,i){if(i===void 0&&(i=!1),this.keysAtom_,!Ki(this.target_,r))return!0;if(fr(this)){var s=dr(this,{object:this.proxy_||this.target_,name:r,type:KT});if(!s)return null}try{var o;gr();var a=Nr(this),c=!1,h=this.values_.get(r),f=void 0;if(!h&&(a||c)){var p;f=(p=Pp(this.target_,r))==null?void 0:p.value}if(i){if(!Reflect.deleteProperty(this.target_,r))return!1}else delete this.target_[r];if(h&&(this.values_.delete(r),h instanceof ko&&(f=h.value_),uF(h)),this.keysAtom_.reportChanged(),(o=this.pendingKeys_)==null||(o=o.get(r))==null||o.set(r in this.target_),a||c){var v={type:KT,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:f,name:r};a&&Gr(this,v)}}finally{vr()}return!0},e.observe_=function(r,i){return wh(this,r)},e.intercept_=function(r){return Sh(this,r)},e.notifyPropertyAddition_=function(r,i){var s,o=Nr(this),a=!1;if(o||a){var c=o||a?{type:ks,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:r,newValue:i}:null;o&&Gr(this,c)}(s=this.pendingKeys_)==null||(s=s.get(r))==null||s.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),Xm(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},t}();function Yu(t,e){var n;if(Ki(t,pe))return t;var r=(n=e?.name)!=null?n:"ObservableObject",i=new bF(t,new Map,String(r),MV(e));return $m(t,pe,i),t}var Tj=ia("ObservableObjectAdministration",bF);function QT(t){return qT[t]||(qT[t]={get:function(){return this[pe].getObservablePropValue_(t)},set:function(n){return this[pe].setObservablePropValue_(t,n)}})}function Jm(t){return Wm(t)?Tj(t[pe]):!1}function ZT(t,e,n){var r;(r=t.target_[ci])==null||delete r[n]}var Ej=wF(0),Aj=function(){var t=!1,e={};return Object.defineProperty(e,"0",{set:function(){t=!0}}),Object.create(e)[0]=1,t===!1}(),Pv=0,SF=function(){};function Pj(t,e){Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,e):t.prototype.__proto__!==void 0?t.prototype.__proto__=e:t.prototype=e}Pj(SF,Array.prototype);var eS=function(t){function e(r,i,s,o){var a;return s===void 0&&(s="ObservableArray"),o===void 0&&(o=!1),a=t.call(this)||this,aa(function(){var c=new Jb(s,i,o,!0);c.proxy_=a,Hk(a,pe,c),r&&r.length&&a.spliceWithArray(0,0,r),Aj&&Object.defineProperty(a,"0",Ej)}),a}Wk(e,t);var n=e.prototype;return n.concat=function(){this[pe].atom_.reportObserved();for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Array.prototype.concat.apply(this.slice(),s.map(function(a){return Zm(a)?a.slice():a}))},n[Symbol.iterator]=function(){var r=this,i=0;return qc({next:function(){return i<r.length?{value:r[i++],done:!1}:{done:!0,value:void 0}}})},Xu(e,[{key:"length",get:function(){return this[pe].getArrayLength_()},set:function(i){this[pe].setArrayLength_(i)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(SF);Object.entries(kp).forEach(function(t){var e=t[0],n=t[1];e!=="concat"&&$m(eS.prototype,e,n)});function wF(t){return{enumerable:!1,configurable:!0,get:function(){return this[pe].get_(t)},set:function(n){this[pe].set_(t,n)}}}function Rj(t){xi(eS.prototype,""+t,wF(t))}function CF(t){if(t>Pv){for(var e=Pv;e<t+100;e++)Rj(e);Pv=t}}CF(1e3);function Bj(t,e,n){return new eS(t,e,n)}function Ip(t,e){if(typeof t=="object"&&t!==null){if(Zm(t))return e!==void 0&&Me(23),t[pe].atom_;if(li(t))return t.atom_;if(oa(t)){if(e===void 0)return t.keysAtom_;var n=t.data_.get(e)||t.hasMap_.get(e);return n||Me(25,e,z2(t)),n}if(Jm(t)){if(!e)return Me(26);var r=t[pe].values_.get(e);return r||Me(27,e,z2(t)),r}if(Yb(t)||Qm(t)||Op(t))return t}else if(Hr(t)&&Op(t[pe]))return t[pe];Me(28)}function Mj(t,e){if(t||Me(29),Yb(t)||Qm(t)||Op(t)||oa(t)||li(t))return t;if(t[pe])return t[pe];Me(24,t)}function z2(t,e){var n;if(e!==void 0)n=Ip(t,e);else{if(Xc(t))return t.name;Jm(t)||oa(t)||li(t)?n=Mj(t):n=Ip(t)}return n.name_}function aa(t){var e=sa(),n=Kb(!0);gr();try{return t()}finally{vr(),Qb(n),Qi(e)}}var JT=jm.toString;function tS(t,e,n){return n===void 0&&(n=-1),H2(t,e,n)}function H2(t,e,n,r,i){if(t===e)return t!==0||1/t===1/e;if(t==null||e==null)return!1;if(t!==t)return e!==e;var s=typeof t;if(s!=="function"&&s!=="object"&&typeof e!="object")return!1;var o=JT.call(t);if(o!==JT.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:+t==0?1/+t===1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(t)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":n>=0&&n++;break}t=eE(t),e=eE(e);var a=o==="[object Array]";if(!a){if(typeof t!="object"||typeof e!="object")return!1;var c=t.constructor,h=e.constructor;if(c!==h&&!(Hr(c)&&c instanceof c&&Hr(h)&&h instanceof h)&&"constructor"in t&&"constructor"in e)return!1}if(n===0)return!1;n<0&&(n=-1),r=r||[],i=i||[];for(var f=r.length;f--;)if(r[f]===t)return i[f]===e;if(r.push(t),i.push(e),a){if(f=t.length,f!==e.length)return!1;for(;f--;)if(!H2(t[f],e[f],n-1,r,i))return!1}else{var p=Object.keys(t),v;if(f=p.length,Object.keys(e).length!==f)return!1;for(;f--;)if(v=p[f],!(Ki(e,v)&&H2(t[v],e[v],n-1,r,i)))return!1}return r.pop(),i.pop(),!0}function eE(t){return Zm(t)?t.slice():$u(t)||oa(t)||Vi(t)||li(t)?Array.from(t.entries()):t}function qc(t){return t[Symbol.iterator]=Dj,t}function Dj(){return this}["Symbol","Map","Set"].forEach(function(t){var e=Xb();typeof e[t]>"u"&&Me("MobX requires global '"+t+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:qV,extras:{getDebugName:z2},$mobx:pe});if(!Le.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!wi)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function Oj(t){t()}function kj(t){t||(t=Oj),lj({reactionScheduler:t})}function Fj(t){return hj(t)}var Ij=1e4,Uj=1e4,Lj=function(){function t(e){var n=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(r){r===void 0&&(r=Ij),clearTimeout(n.sweepTimeout),n.sweepTimeout=void 0;var i=Date.now();n.registrations.forEach(function(s,o){i-s.registeredAt>=r&&(n.finalize(s.value),n.registrations.delete(o))}),n.registrations.size>0&&n.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){n.sweep(0)}})}return Object.defineProperty(t.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,n,r){this.registrations.set(r,{value:n,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(t.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.registrations.delete(e)}}),Object.defineProperty(t.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,Uj))}}),t}(),Nj=typeof FinalizationRegistry<"u"?FinalizationRegistry:Lj,V2=new Nj(function(t){var e;(e=t.reaction)===null||e===void 0||e.dispose(),t.reaction=null}),TF={exports:{}},EF={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ku=Le;function Gj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zj=typeof Object.is=="function"?Object.is:Gj,Hj=ku.useState,Vj=ku.useEffect,jj=ku.useLayoutEffect,Wj=ku.useDebugValue;function $j(t,e){var n=e(),r=Hj({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return jj(function(){i.value=n,i.getSnapshot=e,Rv(i)&&s({inst:i})},[t,n,e]),Vj(function(){return Rv(i)&&s({inst:i}),t(function(){Rv(i)&&s({inst:i})})},[t]),Wj(n),n}function Rv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zj(t,n)}catch{return!0}}function Xj(t,e){return e()}var Yj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Xj:$j;EF.useSyncExternalStore=ku.useSyncExternalStore!==void 0?ku.useSyncExternalStore:Yj;TF.exports=EF;var qj=TF.exports;function tE(t){t.reaction=new os("observer".concat(t.name),function(){var e;t.stateVersion=Symbol(),(e=t.onStoreChange)===null||e===void 0||e.call(t)})}function Kj(t,e){e===void 0&&(e="observed");var n=rw.useRef(null);if(!n.current){var r={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:e,subscribe:function(a){return V2.unregister(r),r.onStoreChange=a,r.reaction||(tE(r),r.stateVersion=Symbol()),function(){var c;r.onStoreChange=null,(c=r.reaction)===null||c===void 0||c.dispose(),r.reaction=null}},getSnapshot:function(){return r.stateVersion}};n.current=r}var i=n.current;i.reaction||(tE(i),V2.register(n,i,i)),rw.useDebugValue(i.reaction,Fj),qj.useSyncExternalStore(i.subscribe,i.getSnapshot,i.getSnapshot);var s,o;if(i.reaction.track(function(){try{s=t()}catch(a){o=a}}),o)throw o;return s}var Bv,Mv,AF=typeof Symbol=="function"&&Symbol.for,Qj=(Mv=(Bv=Object.getOwnPropertyDescriptor(function(){},"name"))===null||Bv===void 0?void 0:Bv.configurable)!==null&&Mv!==void 0?Mv:!1,nE=AF?Symbol.for("react.forward_ref"):typeof Le.forwardRef=="function"&&Le.forwardRef(function(t){return null}).$$typeof,rE=AF?Symbol.for("react.memo"):typeof Le.memo=="function"&&Le.memo(function(t){return null}).$$typeof;function Ee(t,e){var n;if(rE&&t.$$typeof===rE)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var r=(n=void 0)!==null&&n!==void 0?n:!1,i=t,s=t.displayName||t.name;if(nE&&t.$$typeof===nE&&(r=!0,i=t.render,typeof i!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var o=function(a,c){return Kj(function(){return i(a,c)},s)};return o.displayName=t.displayName,Qj&&Object.defineProperty(o,"name",{value:t.name,writable:!0,configurable:!0}),t.contextTypes&&(o.contextTypes=t.contextTypes),r&&(o=Le.forwardRef(o)),o=Le.memo(o),Jj(t,o),o}var Zj={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function Jj(t,e){Object.keys(t).forEach(function(n){Zj[n]||Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}var Dv;kj(zP.unstable_batchedUpdates);Dv=V2.finalizeAllImmediately;let PF;function eW(t){return PF=t,t}function Kc(){return PF}class j2{static setParamValue(e,n){if(e.setValueAtTime){const r=Kc().context;e.setValueAtTime(n,r.audioContext.currentTime)}else e.value=n;return n}}class tW extends Mt{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(e){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}let nW=0;const W2=class extends Mt{constructor(t){super(),this.id=nW++,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"paused":this.paused=e;break;case"loop":this.loop=e;break;case"muted":this.muted=e;break}return this}get progress(){const{currentTime:t}=this._source;return t/this._duration}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(t){this._playing=!1,this._duration=t.source.duration;const e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh()}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}refresh(){const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const n=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);this._source.volume=i*n*r,this._source.playbackRate=this._speed*t.speed*e.speed}refreshPaused(){const t=this._media.context,e=this._media.parent,n=this._paused||e.paused||t.paused;n!==this._pausedReal&&(this._pausedReal=n,n?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",n))}play(t){const{start:e,end:n,speed:r,loop:i,volume:s,muted:o}=t;n&&console.assert(n>e,"End time is before start time"),this._speed=r,this._volume=s,this._loop=!!i,this._muted=o,this.refresh(),this.loop&&n!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=e,this._end=n||this._duration,this._start=Math.max(0,this._start-W2.PADDING),this._end=Math.min(this._end+W2.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=e,this._source.onloadedmetadata=null,this.emit("progress",e/this._duration,this._duration),at.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){at.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){at.shared.remove(this._onUpdate,this),this.removeAllListeners();const t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let RF=W2;RF.PADDING=.1;class rW extends Mt{init(e){this.parent=e,this._source=e.options.source||new Audio,e.url&&(this._source.src=e.url)}create(){return new RF(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(e){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(e){const n=this._source,r=this.parent;if(n.readyState===4){r.isLoaded=!0;const c=r.autoPlayStart();e&&setTimeout(()=>{e(null,r,c)},0);return}if(!r.url){e(new Error("sound.url or sound.source must be set"));return}n.src=r.url;const i=()=>{a(),r.isLoaded=!0;const c=r.autoPlayStart();e&&e(null,r,c)},s=()=>{a(),e&&e(new Error("Sound loading has been aborted"))},o=()=>{a();const c=`Failed to load audio element (code: ${n.error.code})`;e?e(new Error(c)):console.error(c)},a=()=>{n.removeEventListener("canplaythrough",i),n.removeEventListener("load",i),n.removeEventListener("abort",s),n.removeEventListener("error",o)};n.addEventListener("canplaythrough",i,!1),n.addEventListener("load",i,!1),n.addEventListener("abort",s,!1),n.addEventListener("error",o,!1),n.load()}}class iW{constructor(e,n){this.parent=e,Object.assign(this,n),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(e){return this.parent.play({complete:e,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}const Up=["ogg","oga","opus","m4a","mp3","mpeg","wav","aiff","wma","mid","caf"],sW=["audio/mpeg","audio/ogg"],Lp={};function oW(t){const e={m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},n=document.createElement("audio"),r={},i=/^no$/;Up.forEach(s=>{const o=n.canPlayType(`audio/${s}`).replace(i,""),a=e[s]?n.canPlayType(e[s]).replace(i,""):"";r[s]=!!o||!!a}),Object.assign(Lp,r)}oW();let aW=0;class uW extends Mt{constructor(e){super(),this.id=aW++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(e)}set(e,n){if(this[e]===void 0)throw new Error(`Property with name ${e} does not exist.`);switch(e){case"speed":this.speed=n;break;case"volume":this.volume=n;break;case"muted":this.muted=n;break;case"loop":this.loop=n;break;case"paused":this.paused=n;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(e){this._speed=e,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(e){this._volume=e,this.refresh()}get muted(){return this._muted}set muted(e){this._muted=e,this.refresh()}get loop(){return this._loop}set loop(e){this._loop=e,this.refresh()}get filters(){return this._filters}set filters(e){this._filters&&(this._filters?.filter(n=>n).forEach(n=>n.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=e?.length?e.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const e=this._media.context,n=this._media.parent;this._source.loop=this._loop||n.loop;const r=e.volume*(e.muted?0:1),i=n.volume*(n.muted?0:1),s=this._volume*(this._muted?0:1);j2.setParamValue(this._gain.gain,s*i*r),j2.setParamValue(this._source.playbackRate,this._speed*n.speed*e.speed),this.applyFilters()}applyFilters(){if(this._filters?.length){this._source.disconnect();let e=this._source;this._filters.forEach(n=>{e.connect(n.destination),e=n}),e.connect(this._gain)}}refreshPaused(){const e=this._media.context,n=this._media.parent,r=this._paused||n.paused||e.paused;r!==this._pausedReal&&(this._pausedReal=r,r?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",r))}play(e){const{start:n,end:r,speed:i,loop:s,volume:o,muted:a,filters:c}=e;r&&console.assert(r>n,"End time is before start time"),this._paused=!1;const{source:h,gain:f}=this._media.nodes.cloneBufferSource();this._source=h,this._gain=f,this._speed=i,this._volume=o,this._loop=!!s,this._muted=a,this._filters=c,this.refresh();const p=this._source.buffer.duration;this._duration=p,this._end=r,this._lastUpdate=this._now(),this._elapsed=n,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=r,this._source.loopStart=n,this._source.start(0,n)):r?this._source.start(0,n,r-n):this._source.start(0,n),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(e){at.shared.remove(this._updateListener,this),e&&at.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(e){this._paused=e,this.refreshPaused()}destroy(){this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),this._filters?.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(e=!1){if(this._source){const n=this._now(),r=n-this._lastUpdate;if(r>0||e){const i=this._source.playbackRate.value;this._elapsed+=r*i,this._lastUpdate=n;const s=this._duration;let o;if(this._source.loopStart){const a=this._source.loopEnd-this._source.loopStart;o=(this._source.loopStart+this._elapsed%a)/s}else o=this._elapsed%s/s;this._progress=o,this.emit("progress",this._progress,s)}}}init(e){this._media=e,e.context.events.on("refresh",this.refresh,this),e.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class BF{constructor(e,n){this._output=n,this._input=e}get destination(){return this._input}get filters(){return this._filters}set filters(e){if(this._filters&&(this._filters.forEach(n=>{n&&n.disconnect()}),this._filters=null,this._input.connect(this._output)),e&&e.length){this._filters=e.slice(0),this._input.disconnect();let n=null;e.forEach(r=>{n===null?this._input.connect(r.destination):n.connect(r.destination),n=r}),n.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const MF=class extends BF{constructor(t){const e=t.audioContext,n=e.createBufferSource(),r=e.createGain(),i=e.createAnalyser();n.connect(i),i.connect(r),r.connect(t.destination),super(i,r),this.context=t,this.bufferSource=n,this.gain=r,this.analyser=i}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(MF.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,j2.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;const n=this.context.audioContext.createGain();return e.connect(n),n.connect(this.destination),{source:e,gain:n}}get bufferSize(){return this.script.bufferSize}};let DF=MF;DF.BUFFER_SIZE=0;class lW{init(e){this.parent=e,this._nodes=new DF(this.context),this._source=this._nodes.bufferSource,this.source=e.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}this._source=null,this.source=null}create(){return new uW(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(e){this._nodes.filters=e}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(e){this._source.buffer=e}get nodes(){return this._nodes}load(e){this.source?this._decode(this.source,e):this.parent.url?this._loadUrl(e):e?e(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(e){const n=this.parent.url,r=await Ce.get().fetch(n);this._decode(await r.arrayBuffer(),e)}_decode(e,n){const r=(i,s)=>{if(i)n&&n(i);else{this.parent.isLoaded=!0,this.buffer=s;const o=this.parent.autoPlayStart();n&&n(null,this.parent,o)}};e instanceof AudioBuffer?r(null,e):this.parent.context.decode(e,r)}}const Ia=class{static from(t){let e={};typeof t=="string"?e.url=t:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?e.source=t:Array.isArray(t)?e.url=t:e=t,e={autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1,...e},Object.freeze(e);const n=Kc().useLegacy?new rW:new lW;return new Ia(n,e)}constructor(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);const n=e.complete;this._autoPlayOptions=n?{complete:n}:null,this.isLoaded=!1,this._preloadQueue=null,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=Array.isArray(e.url)?this.preferUrl(e.url):e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}preferUrl(t){const[e]=t.map(n=>({url:n,ext:zt.extname(n).slice(1)})).filter(({ext:n})=>Lp[n]).sort((n,r)=>Up.indexOf(n.ext)-Up.indexOf(r.ext));if(!e)throw new Error("No supported file type found");return e.url}get context(){return Kc().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh()}get filters(){return this.media.filters}set filters(t){this.media.filters=t}addSprites(t,e){if(typeof t=="object"){const r={};for(const i in t)r[i]=this.addSprites(i,t[i]);return r}console.assert(!this._sprites[t],`Alias ${t} is already taken`);const n=new iW(this,e);return this._sprites[t]=n,n}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(t){if(t){const e=this._sprites[t];e!==void 0&&(e.destroy(),delete this._sprites[t])}else for(const e in this._sprites)this.removeSprites(e);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this}play(t,e){let n;if(typeof t=="string"?n={sprite:t,loop:this.loop,complete:e}:typeof t=="function"?(n={},n.complete=t):n=t,n={complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1,...n||{}},n.sprite){const i=n.sprite;console.assert(!!this._sprites[i],`Alias ${i} is not available`);const s=this._sprites[i];n.start=s.start+(n.start||0),n.end=s.end,n.speed=s.speed||1,n.loop=s.loop||n.loop,delete n.sprite}if(n.offset&&(n.start=n.offset),!this.isLoaded)return this._preloadQueue?new Promise(i=>{this._preloadQueue.push(()=>{i(this.play(n))})}):(this._preloadQueue=[],this.autoPlay=!0,this._autoPlayOptions=n,new Promise((i,s)=>{this._preload((o,a,c)=>{this._preloadQueue.forEach(h=>h()),this._preloadQueue=null,o?s(o):(n.loaded&&n.loaded(o,a,c),i(c))})}));(this.singleInstance||n.singleInstance)&&this._removeInstances();const r=this._createInstance();return this._instances.push(r),this.isPlaying=!0,r.once("end",()=>{n.complete&&n.complete(this),this._onComplete(r)}),r.once("stop",()=>{this._onComplete(r)}),r.play(n),r}refresh(){const t=this._instances.length;for(let e=0;e<t;e++)this._instances[e].refresh()}refreshPaused(){const t=this._instances.length;for(let e=0;e<t;e++)this._instances[e].refreshPaused()}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}_preload(t){this.media.load(t)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t}_removeInstances(){for(let t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0}_onComplete(t){if(this._instances){const e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)}_createInstance(){if(Ia._pool.length>0){const t=Ia._pool.pop();return t.init(this.media),t}return this.media.create()}_poolInstance(t){t.destroy(),Ia._pool.indexOf(t)<0&&Ia._pool.push(t)}};let Np=Ia;Np._pool=[];class Qc extends BF{constructor(){const e=window,n=new Qc.AudioContext,r=n.createDynamicsCompressor(),i=n.createAnalyser();i.connect(r),r.connect(n.destination),super(i,r),this.autoPause=!0,this._ctx=n,this._offlineCtx=new Qc.OfflineAudioContext(1,2,e.OfflineAudioContext?Math.max(8e3,Math.min(96e3,n.sampleRate)):44100),this.compressor=r,this.analyser=i,this.events=new Mt,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,this._locked=n.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),this._locked&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0)),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),globalThis.addEventListener("focus",this.onFocus),globalThis.addEventListener("blur",this.onBlur)}onFocus(){if(!this.autoPause)return;const e=this._ctx.state;(e==="suspended"||e==="interrupted"||!this._locked)&&(this.paused=this._pausedOnBlur,this.refreshPaused())}onBlur(){this.autoPause&&(this._locked||(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused()))}_unlock(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))}playEmptySound(){const e=this._ctx.createBufferSource();e.buffer=this._ctx.createBuffer(1,1,22050),e.connect(this._ctx.destination),e.start(0,0,0),e.context.state==="suspended"&&e.context.resume()}static get AudioContext(){const e=window;return e.AudioContext||e.webkitAudioContext||null}static get OfflineAudioContext(){const e=window;return e.OfflineAudioContext||e.webkitOfflineAudioContext||null}destroy(){super.destroy();const e=this._ctx;typeof e.close<"u"&&e.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(e){e&&this._ctx.state==="running"?this._ctx.suspend():!e&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=e}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(e,n){const r=s=>{n(new Error(s?.message||"Unable to decode file"))},i=this._offlineCtx.decodeAudioData(e,s=>{n(null,s)},r);i&&i.catch(r)}}class cW{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Qc),this._htmlAudioContext=new tW,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(e){this.useLegacy||(this._context.filters=e)}get supported(){return Qc.AudioContext!==null}add(e,n){if(typeof e=="object"){const s={};for(const o in e){const a=this._getOptions(e[o],n);s[o]=this.add(o,a)}return s}if(console.assert(!this._sounds[e],`Sound with alias ${e} already exists.`),n instanceof Np)return this._sounds[e]=n,n;const r=this._getOptions(n),i=Np.from(r);return this._sounds[e]=i,i}_getOptions(e,n){let r;return typeof e=="string"?r={url:e}:Array.isArray(e)?r={url:e}:e instanceof ArrayBuffer||e instanceof AudioBuffer||e instanceof HTMLAudioElement?r={source:e}:r=e,r={...r,...n||{}},r}get useLegacy(){return this._useLegacy}set useLegacy(e){this._useLegacy=e,this._context=!e&&this.supported?this._webAudioContext:this._htmlAudioContext}get disableAutoPause(){return!this._webAudioContext.autoPause}set disableAutoPause(e){this._webAudioContext.autoPause=!e}remove(e){return this.exists(e,!0),this._sounds[e].destroy(),delete this._sounds[e],this}get volumeAll(){return this._context.volume}set volumeAll(e){this._context.volume=e,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(e){this._context.speed=e,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const e in this._sounds)this._sounds[e].destroy(),delete this._sounds[e];return this}stopAll(){for(const e in this._sounds)this._sounds[e].stop();return this}exists(e,n=!1){const r=!!this._sounds[e];return n&&console.assert(r,`No sound matching alias '${e}'.`),r}isPlaying(){for(const e in this._sounds)if(this._sounds[e].isPlaying)return!0;return!1}find(e){return this.exists(e,!0),this._sounds[e]}play(e,n){return this.find(e).play(n)}stop(e){return this.find(e).stop()}pause(e){return this.find(e).pause()}resume(e){return this.find(e).resume()}volume(e,n){const r=this.find(e);return n!==void 0&&(r.volume=n),r.volume}speed(e,n){const r=this.find(e);return n!==void 0&&(r.speed=n),r.speed}duration(e){return this.find(e).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}const iE=t=>{const e=t.src;let n=t?.alias?.[0];return(!n||t.src===n)&&(n=zt.basename(e,zt.extname(e))),n},hW={extension:P.Asset,detection:{test:async()=>!0,add:async t=>[...t,...Up.filter(e=>Lp[e])],remove:async t=>t.filter(e=>t.includes(e))},loader:{name:"sound",extension:{type:[P.LoadParser],priority:In.High},test(t){const e=zt.extname(t).slice(1);return!!Lp[e]||sW.some(n=>t.startsWith(`data:${n}`))},async load(t,e){const n=await new Promise((r,i)=>Np.from({...e.data,url:t,preload:!0,loaded(s,o){s?i(s):r(o),e.data?.loaded?.(s,o)}}));return Kc().add(iE(e),n),n},async unload(t,e){Kc().remove(iE(e))}}};Ne.add(hW);const Fo=eW(new cW),fW=H.load("gfx/Ant1_Dead.png?t=1729422983570"),dW=H.load("gfx/Ant1_Default.png?t=1729422983569"),pW=H.load("gfx/Ant2_Dead.png?t=1729422983570"),mW=H.load("gfx/Ant2_Default.png?t=1729422983570"),gW=H.load("gfx/Ant3_Dead.png?t=1729422983570"),vW=H.load("gfx/Ant3_Default.png?t=1729422983570"),_W=H.load("gfx/Ant_BloodStain.png?t=1729422983571"),xW=H.load("gfx/Bg.jpg?t=1729422983579"),yW=H.load("gfx/BtnCompleteTxt.png?t=1729422983571"),bW=H.load("gfx/BtnGamePausedTxt.png?t=1729422983571"),SW=H.load("gfx/BtnGameTxt.png?t=1729422983572"),wW=H.load("gfx/BtnLevelTxt.png?t=1729422983571"),CW=H.load("gfx/BtnOverTxt.png?t=1729422983572"),TW=H.load("gfx/FrozenArea.png?t=1729422983572"),EW=H.load("gfx/Logo.jpg?t=1729422983581"),AW=H.load("gfx/MenuMoon.png?t=1729422983603"),PW=H.load("gfx/MenuMoonGlow.png?t=1729422983602"),RW=H.load("gfx/MenuMoonSky.jpg?t=1729422983603"),BW=H.load("gfx/MenuMoon_Shadow.png?t=1729422983602"),MW=H.load("gfx/MenuMoon_Shadow2.png?t=1729422983603"),DW=H.load("gfx/PauseBtn.png?t=1729422983603"),OW=H.load("gfx/PowerUp1.png?t=1729422983604"),kW=H.load("gfx/PowerUp1On.png?t=1729422983604"),FW=H.load("gfx/PowerUp2.png?t=1729422983604"),IW=H.load("gfx/PowerUp2On.png?t=1729422983604"),UW=H.load("gfx/PowerUp3.png?t=1729422983604"),LW=H.load("gfx/PowerUp3On.png?t=1729422983604"),NW=H.load("gfx/PowerUp4.png?t=1729422983604"),GW=H.load("gfx/PowerUp4On.png?t=1729422983604"),zW=H.load("gfx/PowerUp5.png?t=1729422983605"),HW=H.load("gfx/PowerUp5On.png?t=1729422983605"),VW=H.load("gfx/PowerUpSnowflake.png?t=1729422983605"),jW=H.load("gfx/PowerUpSnowflakeGlow.png?t=1729422983605"),WW=H.load("gfx/SoundOffTxt.png?t=1729422983610"),$W=H.load("gfx/SoundOnTxt.png?t=1729422983611"),XW=H.load("gfx/Source1_Closed_Lvl1.png?t=1729422983613"),YW=H.load("gfx/Source1_Closed_Lvl2.png?t=1729422983612"),qW=H.load("gfx/Source1_Closed_Lvl3.png?t=1729422983613"),KW=H.load("gfx/Source1_Closed_Lvl4.png?t=1729422983612"),QW=H.load("gfx/Source1_Default.png?t=1729422983613"),ZW=H.load("gfx/Source1_Open.png?t=1729422983613"),JW=H.load("gfx/Target1.png?t=1729422983613"),e$=H.load("gfx/Target1_Item.png?t=1729422983613"),t$=H.load("gfx/Target1_Plate.png?t=1729422983613"),n$=H.load("gfx/Target1_PlateShadow.png?t=1729422983614"),r$=H.load("gfx/Target1_Shadow.png?t=1729422983614"),i$=H.load("gfx/Target2.png?t=1729422983614"),s$=H.load("gfx/Target3.png?t=1729422983614"),o$=H.load("gfx/Target4.png?t=1729422983614"),a$=H.load("gfx/Target5.png?t=1729422983614"),u$=H.load("gfx/Target6.png?t=1729422983614"),l$=H.load("gfx/Target7.png?t=1729422983614"),c$=H.load("gfx/Target_Shadow.png?t=1729422983614"),sE=H.load("gfx/Ant1.json?t=1729422983616"),oE=H.load("gfx/Ant2.json?t=1729422983617"),aE=H.load("gfx/Ant3.json?t=1729422983618"),uE=H.load("gfx/BombCountdown.json?t=1729422983618"),lE=H.load("gfx/BombExplosion.json?t=1729422983618"),cE=H.load("gfx/Hologram.json?t=1729422983629"),hE=H.load("gfx/Shockwave.json?t=1729422983619"),fE=H.load("gfx/SmokeFx.json?t=1729422983627"),dE=H.load("gfx/Target1End.json?t=1729422983618"),pE=H.load("gfx/Target2End.json?t=1729422983619"),mE=H.load("gfx/Target3End.json?t=1729422983620"),gE=H.load("gfx/Target4End.json?t=1729422983619"),vE=H.load("gfx/Target5End.json?t=1729422983620"),_E=H.load("gfx/Target6End.json?t=1729422983620"),xE=H.load("gfx/Target7End.json?t=1729422983624"),h$=H.load("audio/AntCrushed1.mp3?t=1729422983620"),f$=H.load("audio/AntCrushed2.mp3?t=1729422983620"),d$=H.load("audio/AntCrushed3.mp3?t=1729422983620"),p$=H.load("audio/AntCrushed4.mp3?t=1729422983620"),m$=H.load("audio/AntDie1.mp3?t=1729422983623"),g$=H.load("audio/AntDie2.mp3?t=1729422983625"),v$=H.load("audio/AntDie3.mp3?t=1729422983626"),_$=H.load("audio/AntDie4.mp3?t=1729422983630"),x$=H.load("audio/AntHappy.mp3?t=1729422983631"),y$=H.load("audio/AntsWalking.mp3?t=1729422983632"),b$=H.load("audio/BombPlaced.mp3?t=1729422983631"),S$=H.load("audio/Click.mp3?t=1729422983631"),w$=H.load("audio/CompleteLevel.mp3?t=1729422983631"),C$=H.load("audio/Explosion.mp3?t=1729422983631"),T$=H.load("audio/FreezeSound.mp3?t=1729422983633"),E$=H.load("audio/HologramSound.mp3?t=1729422983633"),A$=H.load("audio/LoseGame.mp3?t=1729422983633"),P$=H.load("audio/Music.mp3?t=1729422983640"),R$=H.load("audio/MusicMenu.mp3?t=1729422983653"),B$=H.load("audio/Push.mp3?t=1729422983633"),M$=H.load("audio/ShockwaveSound.mp3?t=1729422983633"),D$=H.load("audio/SourceDestroyed.mp3?t=1729422983634"),O$=H.load("audio/SourceReopen.mp3?t=1729422983634"),k$=H.load("audio/StartLevel.mp3?t=1729422983636"),F$=H.load("audio/TargetEnd.mp3?t=1729422983637"),I$=H.load("audio/TargetFall.mp3?t=1729422983637"),U$=H.load("audio/TextFall1.mp3?t=1729422983637"),L$=H.load("audio/TextFall2.mp3?t=1729422983643"),N$=H.load("fonts/Comix_Loud.ttf?t=1729422983643"),G$=H.load("fonts/Digital_Display_Tfb.ttf?t=1729422983644"),z$=H.load("fonts/Heroes_Legend.ttf?t=1729422983643"),H$=H.load("fonts/Laffayette_Comic_Pro.ttf?t=1729422983647"),[V$,JQ,j$,eZ,W$,tZ,$$,X$,Y$,OF,q$,K$,Q$,Ov,Z$,J$,eX,hd,nZ,yE,tX,nX,rX,iX,sX,oX,aX,uX,lX,cX,hX,rZ,iZ,sZ,oZ,fX,dX,pX,mX,aZ,gX,bE,uZ,lZ,cZ,hZ,vX,_X,xX,yX,bX,SX,nS,fZ,{animations:{Ant1:wX}},dZ,{animations:{Ant2:CX}},pZ,{animations:{Ant3:TX}},mZ,{animations:{BombCountdown:EX}},gZ,{animations:{BombExplosion:AX}},vZ,{animations:{Hologram:PX}},_Z,{animations:{Shockwave:RX}},xZ,{animations:{SmokeFx:yZ}},bZ,{animations:{Target1End:SE}},SZ,{animations:{Target2End:BX}},wZ,{animations:{Target3End:MX}},CZ,{animations:{Target4End:DX}},TZ,{animations:{Target5End:OX}},EZ,{animations:{Target6End:kX}},AZ,{animations:{Target7End:FX}},IX,UX,LX,NX,GX,zX,HX,VX,PZ,RZ,jX,ls,WX,$X,XX,YX,qX,Co,Oa,KX,QX,ZX,BZ,JX,eY,wE,MZ,DZ,OZ,kZ,FZ,IZ]=await Promise.all([fW,dW,pW,mW,gW,vW,_W,xW,yW,bW,SW,wW,CW,TW,EW,AW,PW,RW,BW,MW,DW,OW,kW,FW,IW,UW,LW,NW,GW,zW,HW,VW,jW,WW,$W,XW,YW,qW,KW,QW,ZW,JW,e$,t$,n$,r$,i$,s$,o$,a$,u$,l$,c$,sE,sE,oE,oE,aE,aE,uE,uE,lE,lE,cE,cE,hE,hE,fE,fE,dE,dE,pE,pE,mE,mE,gE,gE,vE,vE,_E,_E,xE,xE,h$,f$,d$,p$,m$,g$,v$,_$,x$,y$,b$,S$,w$,C$,T$,E$,A$,P$,R$,B$,M$,D$,O$,k$,F$,I$,U$,L$,N$,G$,z$,H$]),tY=()=>{const[,t]=Le.useReducer(e=>e+1,0);return t},kF=(t,e)=>Math.sqrt(FF(t,e)),FF=(t,e)=>{const n=e.x-t.x,r=e.y-t.y;return n*n+r*r},Gp=(t,e)=>{const n=Math.sqrt(Math.random())*e,r=Math.random()*Math.PI*2;return{x:t.x+n*Math.cos(r),y:t.y+n*Math.sin(r)}},nY=(t,e,n,r,i)=>{let o=Math.round(t/e);return i>2.5?o=Math.ceil(t/e):i<-2.5&&(o=Math.floor(t/e)),Math.min(r,Math.max(n,o*e))-t},CE=t=>t[Math.floor(Math.random()*t.length)],rY=42;class $2{lt=0;pos;destination=null;target=null;direction=0;speed;state;level;circularEdge=!1;edgeRadius=0;constructor(e){if(this.level=1,Math.random()<.2&&(this.level=2),Math.random()<.05&&(this.level=3),this.speed=[0,200,160,120][this.level]+(Math.random()-.5)*100,e){const{x:n,y:r}=Gp(e.pos,20);this.state="appearing",this.pos={x:n,y:r}}else{const n=Math.random()*1920,r=Math.random()*1080;this.pos={x:n,y:r},this.destination=null,this.target=null,this.direction=Math.random()*Math.PI*2,this.state="walking"}wi(this,{lt:!0,pos:!0,destination:!0,target:!0,direction:!0,speed:!0,state:!0,level:!0,circularEdge:!0,edgeRadius:!0,initCircle:!0,pickTarget:!0,setTarget:!0,stunnedCooldown:!0,tick:!0,dieDuration:!0,isGone:!0,getDeltas:!0,distance2:!0,distanceToTarget:!0,die:!0,appearDuration:!0,appear:!0,freezeFactor:!0,walk:!0,carry:!0,win:!0,passedShockwaves:!0,minDistanceShockwave:!0,shockwave:!0,baseStunDuration:!0,stun:!0,moveAwayIfTooClose:!0})}initCircle(e){const{x:n,y:r}=Gp({x:0,y:0},e);this.pos={x:n,y:r},this.destination=null,this.target=null,this.direction=Math.random()*Math.PI*2,this.state="walking",this.circularEdge=!0,this.edgeRadius=e}pickTarget(e,n){const r=n.some(s=>!s.isDestroyed),i=[...e.filter(()=>r),...n.filter(s=>s.isDestroyed||s.healthCurrent<s.healthMax*3/4)];this.target&&i.includes(this.target)||i.length!=0&&this.setTarget(CE(i))}setTarget(e){this.target=e;const r=Math.atan2(this.target.pos.y-this.pos.y,this.target.pos.x-this.pos.x)+(Math.random()-.5)*Math.PI/2;this.destination={x:0*Math.cos(r),y:0*Math.sin(r)},this.direction=Math.atan2(this.target.pos.y-this.destination.y-this.pos.y,this.target.pos.x-this.destination.x-this.pos.x)}stunnedCooldown=0;tick(e,n){switch(this.lt+=e,this.state){case"appearing":{this.appear();return}case"walking":{this.walk(e,n);return}case"carrying":{this.carry();return}case"stunned":{this.stunnedCooldown-=e,this.stunnedCooldown<0&&(this.stunnedCooldown=0,this.state="walking");return}case"dead":case"winning":return}}dieDuration=10;isGone(){return this.state=="dead"&&this.lt>this.dieDuration}getDeltas(){return!this.target||!this.destination?{dx:0,dy:0,ok:!1}:{dx:this.target.pos.x-this.destination.x-this.pos.x,dy:this.target.pos.y-this.destination.y-this.pos.y,ok:!0}}get distance2(){const{dx:e,dy:n,ok:r}=this.getDeltas();return r?e*e+n*n:1/0}distanceToTarget(){if(!this.target||!this.destination)return 1/0;const e=this.target.pos.x-this.destination.x-this.pos.x,n=this.target.pos.y-this.destination.y-this.pos.y,r=Math.atan2(n,e),i=this.target.radiusX*this.target.radiusY/Math.sqrt((this.target.radiusX*Math.sin(r))**2+(this.target.radiusY*Math.cos(r))**2);return Math.sqrt(e**2+n**2)-i}die(){this.state="dead",this.lt=0,CE([GX,zX,HX,VX,IX,UX,LX,NX]).play({volume:.3})}appearDuration=.5;appear(){this.lt>this.appearDuration&&(this.state="walking")}freezeFactor=1/6;walk(e,n){const{dx:r,dy:i,ok:s}=this.getDeltas();s&&(this.direction=Math.atan2(i,r));let o=s?this.speed:this.speed/3;for(const c of n)o*=this.freezeFactor**c.freezeFactor(this.pos);const a=Math.min(e*o,this.distanceToTarget()+2);if(this.pos.x+=Math.cos(this.direction)*a,this.pos.y+=Math.sin(this.direction)*a,this.circularEdge){if(this.pos.x**2+this.pos.y**2>this.edgeRadius**2){const c=Math.atan2(this.pos.y,this.pos.x);Math.cos(this.direction)*Math.cos(c)+Math.sin(this.direction)*Math.sin(c)>0&&(this.direction=2*c-this.direction+Math.PI)}}else this.pos.x<0&&(this.pos.x=0,this.direction=Math.PI-this.direction),this.pos.x>1920&&(this.pos.x=1920,this.direction=Math.PI-this.direction),this.pos.y<0&&(this.pos.y=0,this.direction=-this.direction),this.pos.y>1080&&(this.pos.y=1080,this.direction=-this.direction);this.distanceToTarget()<=0&&(this.state="carrying")}carry(){const{dx:e,dy:n,ok:r}=this.getDeltas();r&&(this.direction=Math.atan2(n,e)),this.distanceToTarget()>=2&&(this.state="walking")}win(){this.state!=="dead"&&(this.state="winning")}passedShockwaves=new WeakSet;minDistanceShockwave=50;shockwave(e,n,r){if(!(this.state=="dead"||this.state=="appearing"))for(const i of n){if(i.type=="push")continue;const{dx:s,dy:o}=i.speedAt(this.pos,e),a=i.nearStrengthAt(this.pos),c=i.passedPoint(this.pos);if(!this.passedShockwaves.has(i)&&c){this.passedShockwaves.add(i),this.stun(a);const f=[0,.6,.55,.5];if(Math.random()<f[this.level]*a){this.die();return}}let h=[0,100,50,25][this.level]*Math.random();for(const f of r)h*=this.freezeFactor**f.freezeFactor(this.pos);this.pos.x+=s*h,this.pos.y+=o*h}}baseStunDuration=[0,.5,.4,.3];stun(e){this.state="stunned",this.stunnedCooldown=this.baseStunDuration[this.level]*e}moveAwayIfTooClose(e){if(this.state=="dead")return;const n=this.distanceToTarget();if(n<=-2){const i=Math.min(-n,this.speed*.6*e);this.pos.x-=Math.cos(this.direction)*i,this.pos.y-=Math.sin(this.direction)*i}}}class iY{pos;timeout;duration=3;constructor(e){this.pos=e,this.timeout=this.duration,wi(this,{pos:!0,timeout:!0,duration:!0,tick:!0})}tick(e){this.timeout-=e,this.timeout<0&&(this.timeout=0)}}class sY{pos;appearDuration=.3;activeDuration=5;disappearDuration=1.5;radius=250;timeout=this.appearDuration;state;constructor(e){this.pos=e,this.state="appearing",wi(this,{pos:!0,appearDuration:!0,activeDuration:!0,disappearDuration:!0,radius:!0,timeout:!0,state:!0,tick:!0,freezeFactor:!0})}tick(e){if(this.timeout-=e,this.timeout<0)switch(this.state){case"appearing":this.state="active",this.timeout=this.activeDuration;break;case"active":this.state="disappearing",this.timeout=this.disappearDuration;break;case"disappearing":this.state="gone";break}}freezeFactor(e){if(kF(e,this.pos)>=this.radius)return 0;switch(this.state){case"active":return 1;case"disappearing":return this.timeout/this.disappearDuration}return 0}}const Ys=[{name:`Thats it!
Cheeese!`,initialAnts:10,targets:[{id:2,pos:{x:1920*3/4,y:1080*.5},delta:100}],sources:[{pos:{x:1920*1/4,y:1080*.5},delta:100}],powerUps:["shockwave"]},{name:`My sandwich?
MY SANDWICH?!`,initialAnts:20,targets:[{id:3,pos:{x:1920*.5,y:1080*.25},delta:100}],sources:[{pos:{x:1920*.15,y:1080*.7},delta:100},{pos:{x:1920*.85,y:1080*.7},delta:100}],powerUps:["shockwave"]},{name:"Cowabunga!",initialAnts:10,targets:[{id:4,pos:{x:1920*.3,y:1080*.25},delta:100},{id:4,pos:{x:1920*.7,y:1080*.25},delta:100},{id:4,pos:{x:1920*.5,y:1080*.65},delta:100}],sources:[{pos:{x:1920*.3,y:1080*.25},delta:100},{pos:{x:1920*.7,y:1080*.25},delta:100},{pos:{x:1920*.5,y:1080*.65},delta:100}],powerUps:["shockwave","push"]},{name:`Whats this? Whats this?
Theres crawlers everywhere!`,initialAnts:50,targets:[{id:5,pos:{x:1920*.2,y:1080*.5},delta:100},{id:5,pos:{x:1920*.8,y:1080*.5},delta:100}],sources:[{pos:{x:1920*.35,y:1080*.65},delta:100},{pos:{x:1920*.35,y:1080*.25},delta:100},{pos:{x:1920*.5,y:1080*.45},delta:100},{pos:{x:1920*.65,y:1080*.65},delta:100},{pos:{x:1920*.65,y:1080*.25},delta:100}],powerUps:["shockwave","push","bomb"]},{name:"The cake is a lie",initialAnts:100,targets:[{id:1,pos:{x:1920*.4,y:1080*.45},delta:100},{id:1,pos:{x:1920*.6,y:1080*.45},delta:100}],sources:[{pos:{x:1920*.15,y:1080*.2},delta:100},{pos:{x:1920*.15,y:1080*.7},delta:100},{pos:{x:1920*.85,y:1080*.7},delta:100},{pos:{x:1920*.85,y:1080*.2},delta:100}],powerUps:["shockwave","push","bomb","hologram"]},{name:`Humans are
interesting`,initialAnts:100,targets:[{id:7,pos:{x:1920*.5,y:1080*.45},delta:100}],sources:[{pos:{x:1920*.15,y:1080*.2},delta:100},{pos:{x:1920*.15,y:1080*.7},delta:100},{pos:{x:1920*.85,y:1080*.7},delta:100},{pos:{x:1920*.85,y:1080*.2},delta:100}],powerUps:["shockwave","push","bomb","hologram","freeze"]},{name:`Houston, we
have a problem`,initialAnts:200,targets:[{id:6,pos:{x:1920*.5,y:1080*.55},delta:100},{id:6,pos:{x:1920*.5,y:1080*.45},delta:100}],sources:[{pos:{x:1920*.15,y:1080*.2},delta:100},{pos:{x:1920*.15,y:1080*.7},delta:100},{pos:{x:1920*.85,y:1080*.7},delta:100},{pos:{x:1920*.5,y:1080*.5},delta:100},{pos:{x:1920*.85,y:1080*.2},delta:100}],powerUps:["shockwave","push","bomb","hologram","freeze"]}],rS="MoonPicnic/lastUnlockedLevel",oY=t=>{localStorage.setItem(rS,`${t}`)},aY=t=>{const e=Number(localStorage.getItem(rS));return!Number.isInteger(e)||e<1||e>t?1:e},uY=()=>{localStorage.removeItem(rS)},lY=.1,ai=2*Math.PI*.21;class cY{lt=0;lastLevel=aY(Ys.length);rotation=-ai*(this.lastLevel-1);speed=0;center={x:1920/2,y:1300};touchPoint=null;ants=[];lastSnapshot={lt:0,rotation:0};nextSnapshot={lt:0,rotation:0};constructor(){for(let e=0;e<100;e++){const n=new $2;n.initCircle(915),this.ants.push(n)}wi(this,{lt:!0,lastLevel:!0,rotation:!0,speed:!0,center:!0,touchPoint:!0,ants:!0,lastSnapshot:!0,nextSnapshot:!0,resetLastLevel:!0,unlockNextLevel:!0,tick:!0,getTouchAngle:!0,touchStart:!0,touchDrag:!0,touchEnd:!0})}resetLastLevel(){uY(),this.lastLevel=1}unlockNextLevel(e){this.lastLevel=Math.max(this.lastLevel,Math.min(Ys.length,e+1)),oY(this.lastLevel),this.rotation-=ai}tick(e){this.lt+=e;for(const i of this.ants)i.tick(e,[]);if(this.touchPoint){this.lastSnapshot.lt+lY<this.lt&&(this.lastSnapshot=this.nextSnapshot,this.nextSnapshot={lt:this.lt,rotation:this.rotation});return}const n=nY(this.rotation,ai,-ai*(this.lastLevel-1),0,this.speed);this.speed=n*10;const r=(n-e*this.speed)*10;this.rotation+=e*(this.speed+r)/2}getTouchAngle(){if(!this.touchPoint)throw new Error("Invalid call to getTouchAngle");const e=this.touchPoint.x-this.center.x,n=this.touchPoint.y-this.center.y;return Math.atan2(n,e)}touchStart(e){this.nextSnapshot={lt:this.lt,rotation:this.rotation},this.touchPoint=e,this.speed=0}touchDrag(e){if(!this.touchPoint)return;const n=this.getTouchAngle();this.touchPoint=e;const i=this.getTouchAngle()-n;this.rotation+=i}touchEnd(){this.touchPoint&&(this.touchPoint=null,this.speed=(this.rotation-this.lastSnapshot.rotation)/(this.lt-this.lastSnapshot.lt),this.nextSnapshot={lt:this.lt,rotation:this.rotation})}}class kv{lt=0;center;innerRadius;outerRadius;speed;strength;type;constructor(e,n,r,i,s,o="shockwave"){this.type=o,this.center=e,this.innerRadius=n,this.outerRadius=r,this.speed=i,this.strength=s,wi(this,{lt:!0,center:!0,innerRadius:!0,outerRadius:!0,speed:!0,strength:!0,type:!0,tick:!0,minDistance:!0,distanceForStrength:!0,timeDistance:!0,strengthAt:!0,nearStrengthAt:!0,speedAt:!0,passedPoint:!0,gone:!0})}tick(e){this.lt+=e,this.innerRadius+=e*this.speed,this.outerRadius+=e*this.speed}minDistance=50;distanceForStrength(e){const n=e.x-this.center.x,r=e.y-this.center.y;return Math.max(this.minDistance**2,n*n+r*r)}timeDistance(e,n){const r=this.distanceForStrength(e),i=Math.max(-n/2,(this.innerRadius-Math.sqrt(r))/this.speed),s=Math.min(n/2,(this.outerRadius-Math.sqrt(r))/this.speed);return Math.max(0,s-i)}strengthAt(e,n){const r=this.distanceForStrength(e),i=this.timeDistance(e,n),s=this.type=="bomb"?7:1;return this.strength*this.minDistance/Math.sqrt(r)*s*this.speed*i}nearStrengthAt(e){const n=this.distanceForStrength(e),r=this.type=="bomb"?7:1;return this.strength*this.minDistance**2/n*r}speedAt(e,n){const r=e.x-this.center.x,i=e.y-this.center.y,s=this.distanceForStrength(e),o=this.timeDistance(e,n),a=this.type=="bomb"?7:1,c=this.strength*this.speed*a*o/s;return{dx:r*c,dy:i*c}}passedPoint(e){const n=this.distanceForStrength(e);return this.outerRadius**2>=n}get gone(){return this.innerRadius>1920}}class hY{pos;healthMax=100;healthCurrent=this.healthMax;isDestroyed=!1;radiusX=50;radiusY=50;constructor(e,n=!1){this.pos=e,n&&this.destroy(),wi(this,{pos:!0,healthMax:!0,healthCurrent:!0,isDestroyed:!0,radiusX:!0,radiusY:!0,destroy:!0,shockwave:!0,freezeFactor:!0,heal:!0})}destroy(){this.isDestroyed||setTimeout(()=>{ZX.play({volume:1})},200),this.isDestroyed=!0,this.healthCurrent=0}shockwave(e,n){const r=(this.isDestroyed,.05);for(const i of n){if(i.type=="push")continue;const s=i.strengthAt(this.pos,e);this.healthCurrent-=s*r}this.healthCurrent<0&&this.destroy()}freezeFactor=1/6;heal(e,n,r){for(const i of r)n*=this.freezeFactor**i.freezeFactor(this.pos);this.healthCurrent+=n*e,this.healthCurrent>this.healthMax&&(this.healthCurrent=this.healthMax,this.isDestroyed=!1)}}const fY=10;class TE{lt=0;item;pos;speedPerAnt=2;state="appearing";onIdle;isHologram;hologramTimeout=0;gt=0;radiusX=65;radiusY=57;constructor(e,n,r,i=!1){this.item=e,this.pos=n,this.onIdle=r,this.isHologram=i,this.isHologram&&(this.speedPerAnt=0,this.hologramTimeout=fY),wi(this,{lt:!0,item:!0,pos:!0,speedPerAnt:!0,state:!0,onIdle:!0,isHologram:!0,hologramTimeout:!0,gt:!0,radiusX:!0,radiusY:!0,appearOffset:!0,appearDuration:!0,tick:!0,setIdle:!0,freezeFactor:!0,carry:!0,isCloseToSource:!0,shockwaveSpeed:!0,shockwave:!0,disappear:!0,disappearDuration:!0})}appearOffset=1;appearDuration=.7;tick(e){switch(this.lt+=e,this.gt+=e,this.hologramTimeout-=e,this.hologramTimeout<0&&(this.hologramTimeout=0),this.state){case"appearing":{this.lt>=this.appearDuration+this.appearOffset&&this.setIdle();break}case"idle":{this.isHologram&&this.hologramTimeout==0&&(this.state="disappearing",this.lt=0);break}}const n=30;this.pos.x<n&&(this.pos.x=n),this.pos.x>1920-n&&(this.pos.x=1920-n),this.pos.y<n&&(this.pos.y=n),this.pos.y>1080-n&&(this.pos.y=1080-n)}setIdle(){this.lt=0,this.state="idle",this.onIdle(this)}freezeFactor=1/6;carry(e,n,r,i){if(r.length==0)return{dx:0,dy:0};let s=n*this.speedPerAnt;for(const v of i)s*=this.freezeFactor**v.freezeFactor(this.pos);const o=[...r];o.sort((v,_)=>{const y=S=>{const C=S.pos.x-this.pos.x,b=S.pos.y-this.pos.y;return C*C+b*b};return y(v)-y(_)});let a=0;for(;a<r.length-1&&!(Math.random()<.7);)a++;const c=o[a],h=Math.atan2(c.pos.y-this.pos.y,c.pos.x-this.pos.x),f=Math.cos(h)*s*e,p=Math.sin(h)*s*e;return this.pos.x+=f,this.pos.y+=p,{dx:f,dy:p}}isCloseToSource(e){for(const n of e)if(!n.isDestroyed&&FF(n.pos,this.pos)<5*5)return!0;return!1}shockwaveSpeed=5;shockwave(e,n){if(this.state!="disappearing")for(const r of n){const{dx:i,dy:s}=r.speedAt(this.pos,e);let o=Math.random()*this.shockwaveSpeed;r.type=="push"&&(o*=30),this.isHologram&&(o=0),this.pos.x+=i*o,this.pos.y+=s*o}}disappear(){this.lt=0,this.state="disappearing",Co.pause(),eY.play({volume:.5})}disappearDuration=.85}class dY{lt=0;ants=[];targets=[];sources=[];shockwaves=[];bombs=[];freezes=[];levelSelector;antValue=0;level=0;powerUps=["shockwave","push","bomb","hologram","freeze"];activePowerUp="shockwave";cooldowns={shockwave:0,push:0,bomb:0,hologram:0,freeze:0};delays={shockwave:.7,push:2,bomb:7,hologram:5,freeze:5};startLt=0;isPaused=!1;state="logo";constructor(){this.ants=[],this.targets=[],this.sources=[],this.shockwaves=[],this.bombs=[],this.freezes=[],this.levelSelector=new cY,wi(this,{lt:!0,ants:!0,targets:!0,sources:!0,shockwaves:!0,bombs:!0,freezes:!0,levelSelector:!0,antValue:!0,level:!0,powerUps:!0,activePowerUp:!0,cooldowns:!0,delays:!0,startLt:!0,isPaused:!0,state:!0,updateGameGlow:!0,resetLastUnlockedLevel:!0,skipLogo:!0,reset:!0,backToMainMenu:!0,nextLevel:!0,restart:!0,startLevel:!0,onTargetIdle:!0,selectPowerUpByIndex:!0,selectPowerUp:!0,carryingForce:!0,healingForce:!0,pause:!0,resume:!0,tick:!0,gameOver:!0,win:!0,tap:!0,isAlmostWon:!0,shockwave:!0,push:!0,bomb:!0,hologram:!0,freeze:!0})}updateGameGlow(){document.body.className=this.state=="levelSelect"?"levelSelector":""}resetLastUnlockedLevel(){this.levelSelector.resetLastLevel()}skipLogo(){this.state="levelSelect",this.updateGameGlow(),Oa.singleInstance=!0,Oa.play({loop:!0,volume:.5})}reset(){this.antValue=0,this.ants=[],this.targets=[],this.sources=[],this.shockwaves=[],this.bombs=[],this.freezes=[],this.cooldowns.shockwave=0,this.cooldowns.push=0,this.cooldowns.bomb=0,this.cooldowns.hologram=0,this.cooldowns.freeze=0,this.activePowerUp="shockwave",this.isPaused=!1,Co.stop()}backToMainMenu(){this.reset(),this.state="levelSelect",this.updateGameGlow(),Oa.resume()}nextLevel(){this.level++,this.restart()}restart(){this.reset(),this.startLevel(this.level)}startLevel(e){Oa.pause(),JX.play({volume:.5}),this.level=e,this.state="gameStarting",this.startLt=0,this.activePowerUp="shockwave",this.updateGameGlow(),setTimeout(()=>{Co.singleInstance=!0,Co.play({loop:!0,volume:.3})},700);const n=Ys[e-1];if(!n){console.error("level not found");return}for(const r of n.targets)this.targets.push(new TE(r.id,Gp(r.pos,r.delta),i=>this.onTargetIdle(i)));for(const r of n.sources)this.sources.push(new hY(Gp(r.pos,r.delta)));for(let r=0;r<n.initialAnts;r++)this.ants.push(new $2);this.powerUps=n.powerUps}onTargetIdle(e){wE.singleInstance=!0,wE.play({volume:.5});for(const n of this.ants)n.pickTarget(this.targets,this.sources);this.shockwave(e.pos),this.cooldowns.shockwave=0,this.state="game"}selectPowerUpByIndex(e){e<=this.powerUps.length&&!this.isPaused&&(this.state=="game"||this.state=="gameStarting")&&this.selectPowerUp(this.powerUps[e-1])}selectPowerUp(e){this.cooldowns[e]==0&&this.activePowerUp!=e&&(this.activePowerUp=e,navigator?.vibrate(50),ls.play())}carryingForce(e){let n=0;for(const r of this.ants)r.state!=="carrying"||r.target!=e||(n+=r.level*r.level);return n}healingForce(e){const n=[rY,5,15,30],r=.2;let i=0;for(const s of this.ants)s.state!=="carrying"||s.target!=e||(i+=n[s.level]);return e.isDestroyed?i*r:i}pause(){Co.pause(),Oa.pause(),this.isPaused=!0}resume(){this.state=="levelSelect"?Oa.resume():Co.resume(),this.isPaused=!1}tick(e){if(!this.isPaused){if(this.lt+=e,this.startLt+=e,this.levelSelector.tick(e),this.state=="game")for(this.antValue+=e*2;this.antValue>=1;this.antValue--)for(const n of this.sources){if(n.isDestroyed)continue;const r=new $2(n);this.ants.push(r),r.pickTarget(this.targets,this.sources)}for(const n of this.targets){const r=this.carryingForce(n);n.carry(e,r,this.sources.filter(i=>!i.isDestroyed),this.freezes),n.tick(e),n.shockwave(e,this.shockwaves),n.isCloseToSource(this.sources)&&!n.isHologram&&n.state!="disappearing"&&n.disappear()}this.targets=this.targets.filter(n=>!(n.isHologram&&n.state=="disappearing"&&n.lt>n.disappearDuration)),this.ants=this.ants.filter(n=>!n.isGone());for(const n of this.ants)n.tick(e,this.freezes),n.shockwave(e,this.shockwaves,this.freezes),n.moveAwayIfTooClose(e),this.state=="game"&&n.pickTarget(this.targets,this.sources);for(const n of this.sources){n.shockwave(e,this.shockwaves);const r=this.healingForce(n);n.heal(e,r,this.freezes)}this.shockwaves=this.shockwaves.filter(n=>!n.gone);for(const n of this.shockwaves)n.tick(e);for(const n of this.bombs)n.tick(e),n.timeout==0&&(navigator?.vibrate([50,50,300]),$X.play({volume:.5}),this.shockwaves.push(new kv(n.pos,-300,100,5e3,1,"bomb")));this.bombs=this.bombs.filter(n=>n.timeout>0);for(const n of this.freezes)n.tick(e);this.freezes=this.freezes.filter(n=>n.state!="gone");for(const n of this.powerUps)this.cooldowns[n]-=e,this.cooldowns[n]<0&&(this.cooldowns[n]=0);this.targets.some(n=>n.state=="disappearing"&&n.lt>n.disappearDuration&&!n.isHologram)&&this.gameOver(),this.ants.every(n=>n.state=="dead")&&this.sources.every(n=>n.isDestroyed)&&this.state=="game"&&this.win()}}gameOver(){if(this.state!="gameover"){qX.play({volume:.5}),this.state="gameover";for(const e of this.ants)e.win();this.cooldowns.shockwave=0,this.cooldowns.push=0,this.cooldowns.bomb=0,this.cooldowns.hologram=0,this.cooldowns.freeze=0}}win(){Co.pause(),WX.play({volume:.5}),this.levelSelector.unlockNextLevel(this.level),this.state="win",this.startLt=0,this.cooldowns.shockwave=0,this.cooldowns.push=0,this.cooldowns.bomb=0,this.cooldowns.hologram=0,this.cooldowns.freeze=0}tap(e){switch(this.activePowerUp){case"shockwave":this.shockwave(e);break;case"push":this.push(e);break;case"bomb":this.bomb(e);break;case"hologram":this.hologram(e);break;case"freeze":this.freeze(e);break}}isAlmostWon(){return this.ants.length<=5&&this.sources.every(e=>e.isDestroyed)}shockwave(e){if(this.state=="gameover"||this.state=="win")return;const n=1-this.cooldowns.shockwave/this.delays.shockwave;navigator?.vibrate(50*n),QX.play({volume:.3*n}),this.cooldowns.shockwave=this.delays.shockwave;const r=this.isAlmostWon()?n*5:n;this.shockwaves.push(new kv(e,-300,100,5e3,r))}push(e){this.state=="gameover"||this.state=="win"||this.cooldowns.push>0||(KX.play({volume:.5}),navigator?.vibrate(100),this.cooldowns.push=this.delays.push,this.shockwaves.push(new kv(e,-300,100,5e3,1,"push")),this.activePowerUp="shockwave")}bomb(e){this.state=="gameover"||this.state=="win"||this.cooldowns.bomb>0||(navigator?.vibrate(50),jX.play({volume:.7}),this.bombs.push(new iY(e)),this.cooldowns.bomb=this.delays.bomb,this.activePowerUp="shockwave")}hologram(e){this.state=="gameover"||this.state=="win"||this.cooldowns.hologram>0||(this.cooldowns.hologram=this.delays.hologram,this.activePowerUp="shockwave",navigator?.vibrate([150,50,150]),YX.play({volume:.5}),this.targets.push(new TE(0,e,n=>{for(const r of this.ants)Math.random()<100/kF(r.pos,n.pos)&&r.setTarget(n)},!0)))}freeze(e){this.state=="gameover"||this.state=="win"||this.cooldowns.freeze>0||(navigator?.vibrate([300]),XX.play({volume:.5}),this.freezes.push(new sY(e)),this.cooldowns.freeze=this.delays.freeze,this.activePowerUp="shockwave")}}const pY=()=>{Fo.init()},mY=()=>{Fo.stopAll(),Fo.removeAll(),Fo.close()},gY=()=>{const t=tY();return[Fo.volumeAll,e=>{const n=e(Fo.volumeAll);Fo.volumeAll=n,t()}]};class vY{speed=1;game=new dY;constructor(){this.init(),wi(this,{speed:!0,game:!0,init:!0})}init(){window.cleanup?.(),pY();const e=Bo(n=>{const r=n.deltaTime/60*this.speed;this.game.tick(r)});at.shared.add(e),window.cleanup=()=>{at.shared.remove(e),mY()}}}const Fd=new vY;Ne.add(dy,py,my,gy,vy,_y,xy,yy,by,Sy,wy,Ty,Cy,Ey,Ay,Py,Ry,By,My,Dy,Oy);const St=Ee(({myRef:t,style:e,...n})=>D.jsx("pixiText",{ref:t,style:new Qt({fontFamily:"Laffayette Comic Pro",fontSize:50,letterSpacing:4,lineHeight:50,stroke:{width:3,color:"#333"},fill:"#FFFFFF",align:"center",...e}),...n}));St.displayName="CustomText";const Kn=Ee(({x:t,y:e,width:n,height:r,color:i=2236962,alpha:s=1,myRef:o,...a})=>{const c=Le.useCallback(h=>{h.clear(),h.rect(t,e,n,r),h.fill({color:i,alpha:s})},[t,e,n,r,i,s]);return D.jsx("graphics",{ref:o,...a,draw:c})});Kn.displayName="Rectangle";const X2=Ee(({x:t=0,y:e=0,radius:n,strokeWidth:r,color:i=16711935,alpha:s=1,...o})=>{const a=Le.useCallback(c=>{c.clear(),c.circle(t,e,n),c.setStrokeStyle({width:r}),c.stroke({color:i,alpha:s})},[t,e,n,i,s,r]);return D.jsx("graphics",{...o,draw:a})});X2.displayName="Ring";const Fu=(t,e,n,r="loop")=>{switch(r){case"loop":return t[Math.floor(n*e)%t.length];case"hold":return t[Math.min(Math.floor(n*e),t.length-1)];case"remove":{const i=Math.floor(n*e);return i>=t.length?X.EMPTY:t[i]}}},_Y=(t,e)=>{if(!t)throw new Error("no animation");const n=Math.min(Math.max(Math.floor(e*t.length),0),t.length-1);return t[n]};var De=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Oe=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}`,xY=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uGamma;
uniform float uContrast;
uniform float uSaturation;
uniform float uBrightness;
uniform vec4 uColor;

void main()
{
    vec4 c = texture(uTexture, vTextureCoord);

    if (c.a > 0.0) {
        c.rgb /= c.a;

        vec3 rgb = pow(c.rgb, vec3(1. / uGamma));
        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, uSaturation), uContrast);
        rgb.r *= uColor.r;
        rgb.g *= uColor.g;
        rgb.b *= uColor.b;
        c.rgb = rgb * uBrightness;

        c.rgb *= c.a;
    }

    finalColor = c * uColor.a;
}
`,yY=`struct AdjustmentUniforms {
  uGamma: f32,
  uContrast: f32,
  uSaturation: f32,
  uBrightness: f32,
  uColor: vec4<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> adjustmentUniforms : AdjustmentUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  var sample = textureSample(uTexture, uSampler, uv);
  let color = adjustmentUniforms.uColor;

  if (sample.a > 0.0) 
  {
    sample = vec4<f32>(sample.rgb / sample.a, sample.a);
    var rgb: vec3<f32> = pow(sample.rgb, vec3<f32>(1. / adjustmentUniforms.uGamma));
    rgb = mix(vec3<f32>(.5), mix(vec3<f32>(dot(vec3<f32>(.2125, .7154, .0721), rgb)), rgb, adjustmentUniforms.uSaturation), adjustmentUniforms.uContrast);
    rgb.r *= color.r;
    rgb.g *= color.g;
    rgb.b *= color.b;
    sample = vec4<f32>(rgb.rgb * adjustmentUniforms.uBrightness, sample.a);
    sample = vec4<f32>(sample.rgb * sample.a, sample.a);
  }

  return sample * color.a;
}`,bY=Object.defineProperty,SY=(t,e,n)=>e in t?bY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,IF=(t,e,n)=>(SY(t,typeof e!="symbol"?e+"":e,n),n);const wY=class UF extends le{constructor(e){e={...UF.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:yY,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:xY,name:"adjustment-filter"});super({gpuProgram:n,glProgram:r,resources:{adjustmentUniforms:{uGamma:{value:e.gamma,type:"f32"},uContrast:{value:e.contrast,type:"f32"},uSaturation:{value:e.saturation,type:"f32"},uBrightness:{value:e.brightness,type:"f32"},uColor:{value:[e.red,e.green,e.blue,e.alpha],type:"vec4<f32>"}}}}),IF(this,"uniforms"),this.uniforms=this.resources.adjustmentUniforms.uniforms}get gamma(){return this.uniforms.uGamma}set gamma(e){this.uniforms.uGamma=e}get contrast(){return this.uniforms.uContrast}set contrast(e){this.uniforms.uContrast=e}get saturation(){return this.uniforms.uSaturation}set saturation(e){this.uniforms.uSaturation=e}get brightness(){return this.uniforms.uBrightness}set brightness(e){this.uniforms.uBrightness=e}get red(){return this.uniforms.uColor[0]}set red(e){this.uniforms.uColor[0]=e}get green(){return this.uniforms.uColor[1]}set green(e){this.uniforms.uColor[1]=e}get blue(){return this.uniforms.uColor[2]}set blue(e){this.uniforms.uColor[2]=e}get alpha(){return this.uniforms.uColor[3]}set alpha(e){this.uniforms.uColor[3]=e}};IF(wY,"DEFAULT_OPTIONS",{gamma:1,contrast:1,saturation:1,brightness:1,red:1,green:1,blue:1,alpha:1});var CY=`
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    finalColor = color;
}`,TY=`struct KawaseBlurUniforms {
  uOffset:vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOffset = kawaseBlurUniforms.uOffset;
  var color: vec4<f32> = vec4<f32>(0.0);

  // Sample top left pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y));
  // Sample top right pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y));
  // Sample bottom right pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y));
  // Sample bottom left pixel
  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y));
  // Average
  color *= 0.25;

  return color;
}`,EY=`
precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uOffset;

uniform vec4 uInputClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample top right pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample bottom right pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Sample bottom left pixel
    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));

    // Average
    color *= 0.25;

    finalColor = color;
}
`,AY=`struct KawaseBlurUniforms {
  uOffset:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOffset = kawaseBlurUniforms.uOffset;
  var color: vec4<f32> = vec4(0.0);

  // Sample top left pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample top right pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample bottom right pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Sample bottom left pixel
  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
  // Average
  color *= 0.25;
    
  return color;
}`,PY=Object.defineProperty,RY=(t,e,n)=>e in t?PY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,To=(t,e,n)=>(RY(t,typeof e!="symbol"?e+"":e,n),n);const LF=class NF extends le{constructor(...e){let n=e[0]??{};(typeof n=="number"||Array.isArray(n))&&(q("6.0.0","KawaseBlurFilter constructor params are now options object. See params: { strength, quality, clamp, pixelSize }"),n={strength:n},e[1]!==void 0&&(n.quality=e[1]),e[2]!==void 0&&(n.clamp=e[2])),n={...NF.DEFAULT_OPTIONS,...n};const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:n?.clamp?AY:TY,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:n?.clamp?EY:CY,name:"kawase-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{kawaseBlurUniforms:{uOffset:{value:new Float32Array(2),type:"vec2<f32>"}}}}),To(this,"uniforms"),To(this,"_pixelSize",{x:0,y:0}),To(this,"_clamp"),To(this,"_kernels",[]),To(this,"_blur"),To(this,"_quality"),this.uniforms=this.resources.kawaseBlurUniforms.uniforms,this.pixelSize=n.pixelSize??{x:1,y:1},Array.isArray(n.strength)?this.kernels=n.strength:typeof n.strength=="number"&&(this._blur=n.strength,this.quality=n.quality??3),this._clamp=!!n.clamp}apply(e,n,r,i){const s=this.pixelSizeX/n.source.width,o=this.pixelSizeY/n.source.height;let a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,n,r,i);else{const c=Ge.getSameSizeTexture(n);let h=n,f=c,p;const v=this._quality-1;for(let _=0;_<v;_++)a=this._kernels[_]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,h,f,!0),p=h,h=f,f=p;a=this._kernels[v]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*o,e.applyFilter(this,h,r,i),Ge.returnTexture(c)}}get strength(){return this._blur}set strength(e){this._blur=e,this._generateKernels()}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get pixelSize(){return this._pixelSize}set pixelSize(e){if(typeof e=="number"){this.pixelSizeX=this.pixelSizeY=e;return}if(Array.isArray(e)){this.pixelSizeX=e[0],this.pixelSizeY=e[1];return}this._pixelSize=e}get pixelSizeX(){return this.pixelSize.x}set pixelSizeX(e){this.pixelSize.x=e}get pixelSizeY(){return this.pixelSize.y}set pixelSizeY(e){this.pixelSize.y=e}get clamp(){return this._clamp}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,n)=>e+n+.5,0))}_generateKernels(){const e=this._blur,n=this._quality,r=[e];if(e>0){let i=e;const s=e/n;for(let o=1;o<n;o++)i-=s,r.push(i)}this._kernels=r,this._updatePadding()}};To(LF,"DEFAULT_OPTIONS",{strength:4,quality:3,clamp:!1,pixelSize:{x:1,y:1}});let GF=LF;var BY=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform float uBloomScale;
uniform float uBrightness;

void main() {
    vec4 color = texture(uTexture, vTextureCoord);
    color.rgb *= uBrightness;
    vec4 bloomColor = vec4(texture(uMapTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= uBloomScale;
    finalColor = color + bloomColor;
}
`,MY=`struct AdvancedBloomUniforms {
  uBloomScale: f32,
  uBrightness: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> advancedBloomUniforms : AdvancedBloomUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color = textureSample(uTexture, uSampler, uv);
  color = vec4<f32>(color.rgb * advancedBloomUniforms.uBrightness, color.a);

  var bloomColor = vec4<f32>(textureSample(uMapTexture, uSampler, uv).rgb, 0.0);
  bloomColor = vec4<f32>(bloomColor.rgb * advancedBloomUniforms.uBloomScale, bloomColor.a);
  
  return color + bloomColor;
}
`,DY=`
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uThreshold;

void main() {
    vec4 color = texture(uTexture, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > uThreshold) {
        finalColor = color;
    } else {
        finalColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`,OY=`struct ExtractBrightnessUniforms {
  uThreshold: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> extractBrightnessUniforms : ExtractBrightnessUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  // A simple & fast algorithm for getting brightness.
  // It's inaccurate, but good enough for this feature.
  let max: f32 = max(max(color.r, color.g), color.b);
  let min: f32 = min(min(color.r, color.g), color.b);
  let brightness: f32 = (max + min) * 0.5;

  return select(vec4<f32>(0.), color, brightness > extractBrightnessUniforms.uThreshold);
}
`,kY=Object.defineProperty,FY=(t,e,n)=>e in t?kY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zF=(t,e,n)=>(FY(t,typeof e!="symbol"?e+"":e,n),n);const HF=class VF extends le{constructor(e){e={...VF.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:OY,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:DY,name:"extract-brightness-filter"});super({gpuProgram:n,glProgram:r,resources:{extractBrightnessUniforms:{uThreshold:{value:e.threshold,type:"f32"}}}}),zF(this,"uniforms"),this.uniforms=this.resources.extractBrightnessUniforms.uniforms}get threshold(){return this.uniforms.uThreshold}set threshold(e){this.uniforms.uThreshold=e}};zF(HF,"DEFAULT_OPTIONS",{threshold:.5});let IY=HF;var UY=Object.defineProperty,LY=(t,e,n)=>e in t?UY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ua=(t,e,n)=>(LY(t,typeof e!="symbol"?e+"":e,n),n);const NY=class jF extends le{constructor(e){e={...jF.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:MY,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:BY,name:"advanced-bloom-filter"});super({gpuProgram:n,glProgram:r,resources:{advancedBloomUniforms:{uBloomScale:{value:e.bloomScale,type:"f32"},uBrightness:{value:e.brightness,type:"f32"}},uMapTexture:X.WHITE}}),Ua(this,"uniforms"),Ua(this,"bloomScale",1),Ua(this,"brightness",1),Ua(this,"_extractFilter"),Ua(this,"_blurFilter"),this.uniforms=this.resources.advancedBloomUniforms.uniforms,this._extractFilter=new IY({threshold:e.threshold}),this._blurFilter=new GF({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),Object.assign(this,e)}apply(e,n,r,i){const s=Ge.getSameSizeTexture(n);this._extractFilter.apply(e,n,s,!0);const o=Ge.getSameSizeTexture(n);this._blurFilter.apply(e,s,o,!0),this.uniforms.uBloomScale=this.bloomScale,this.uniforms.uBrightness=this.brightness,this.resources.uMapTexture=o.source,e.applyFilter(this,n,r,i),Ge.returnTexture(o),Ge.returnTexture(s)}get threshold(){return this._extractFilter.threshold}set threshold(e){this._extractFilter.threshold=e}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.strength}set blur(e){this._blurFilter.strength=e}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._blurFilter.pixelSize=e}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(e){this._blurFilter.pixelSizeX=e}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(e){this._blurFilter.pixelSizeY=e}};Ua(NY,"DEFAULT_OPTIONS",{threshold:.5,bloomScale:1,brightness:1,blur:8,quality:4,pixelSize:{x:1,y:1}});var GY=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uSize;
uniform vec3 uColor;
uniform float uReplaceColor;

uniform vec4 uInputSize;

vec2 mapCoord( vec2 coord )
{
    coord *= uInputSize.xy;
    coord += uInputSize.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= uInputSize.zw;
    coord /= uInputSize.xy;

    return coord;
}

vec2 pixelate(vec2 coord, vec2 size)
{
    return floor(coord / size) * size;
}

vec2 getMod(vec2 coord, vec2 size)
{
    return mod(coord, size) / size;
}

float character(float n, vec2 p)
{
    p = floor(p*vec2(4.0, 4.0) + 2.5);

    if (clamp(p.x, 0.0, 4.0) == p.x)
    {
        if (clamp(p.y, 0.0, 4.0) == p.y)
        {
            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;
        }
    }
    return 0.0;
}

void main()
{
    vec2 coord = mapCoord(vTextureCoord);

    // get the grid position
    vec2 pixCoord = pixelate(coord, vec2(uSize));
    pixCoord = unmapCoord(pixCoord);

    // sample the color at grid position
    vec4 color = texture(uTexture, pixCoord);

    // brightness of the color as it's perceived by the human eye
    float gray = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;

    // determine the character to use
    float n =  65536.0;             // .
    if (gray > 0.2) n = 65600.0;    // :
    if (gray > 0.3) n = 332772.0;   // *
    if (gray > 0.4) n = 15255086.0; // o
    if (gray > 0.5) n = 23385164.0; // &
    if (gray > 0.6) n = 15252014.0; // 8
    if (gray > 0.7) n = 13199452.0; // @
    if (gray > 0.8) n = 11512810.0; // #

    // get the mod..
    vec2 modd = getMod(coord, vec2(uSize));

    finalColor = (uReplaceColor > 0.5 ? vec4(uColor, 1.) : color) * character( n, vec2(-1.0) + modd * 2.0);
}
`,zY=`struct AsciiUniforms {
    uSize: f32,
    uColor: vec3<f32>,
    uReplaceColor: f32,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> asciiUniforms : AsciiUniforms;

@fragment
fn mainFragment(
    @location(0) uv: vec2<f32>,
    @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let pixelSize: f32 = asciiUniforms.uSize;
    let coord: vec2<f32> = mapCoord(uv);

    // get the rounded color..
    var pixCoord: vec2<f32> = pixelate(coord, vec2<f32>(pixelSize));
    pixCoord = unmapCoord(pixCoord);

    var color = textureSample(uTexture, uSampler, pixCoord);

    // determine the character to use
    let gray: f32 = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;
    
    var n: f32 = 65536.0; // .
    if (gray > 0.2) {
        n = 65600.0;    // :
    }
    if (gray > 0.3) {
        n = 332772.0;   // *
    }
    if (gray > 0.4) {
        n = 15255086.0; // o
    }
    if (gray > 0.5) {
        n = 23385164.0; // &
    }
    if (gray > 0.6) {
        n = 15252014.0; // 8
    }
    if (gray > 0.7) {
        n = 13199452.0; // @
    }
    if (gray > 0.8) {
        n = 11512810.0; // #
    }

    // get the mod..
    let modd: vec2<f32> = getMod(coord, vec2<f32>(pixelSize));
    return select(color, vec4<f32>(asciiUniforms.uColor, 1.), asciiUniforms.uReplaceColor > 0.5) * character(n, vec2<f32>(-1.0) + modd * 2.0);
}

fn pixelate(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>
{
    return floor( coord / size ) * size;
}

fn getMod(coord: vec2<f32>, size: vec2<f32>) -> vec2<f32>
{
    return moduloVec2( coord , size) / size;
}

fn character(n: f32, p: vec2<f32>) -> f32
{
    var q: vec2<f32> = floor(p*vec2<f32>(4.0, 4.0) + 2.5);

    if (clamp(q.x, 0.0, 4.0) == q.x)
    {
        if (clamp(q.y, 0.0, 4.0) == q.y)
        {
        if (i32(modulo(n/exp2(q.x + 5.0*q.y), 2.0)) == 1)
        {
            return 1.0;
        }
        }
    }

    return 0.0;
}

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn moduloVec2(x: vec2<f32>, y: vec2<f32>) -> vec2<f32>
{
  return x - y * floor(x/y);
}

fn mapCoord(coord: vec2<f32> ) -> vec2<f32>
{
    var mappedCoord: vec2<f32> = coord;
    mappedCoord *= gfu.uInputSize.xy;
    mappedCoord += gfu.uOutputFrame.xy;
    return mappedCoord;
}

fn unmapCoord(coord: vec2<f32> ) -> vec2<f32>
{
    var mappedCoord: vec2<f32> = coord;
    mappedCoord -= gfu.uOutputFrame.xy;
    mappedCoord /= gfu.uInputSize.xy;
    return mappedCoord;
}`,HY=Object.defineProperty,VY=(t,e,n)=>e in t?HY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Y2=(t,e,n)=>(VY(t,typeof e!="symbol"?e+"":e,n),n);const jY=class WF extends le{constructor(...e){let n=e[0]??{};typeof n=="number"&&(q("6.0.0","AsciiFilter constructor params are now options object. See params: { size, color, replaceColor }"),n={size:n});const r=n?.color&&n.replaceColor!==!1;n={...WF.DEFAULT_OPTIONS,...n};const i=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:zY,entryPoint:"mainFragment"}}),s=me.from({vertex:De,fragment:GY,name:"ascii-filter"});super({gpuProgram:i,glProgram:s,resources:{asciiUniforms:{uSize:{value:n.size,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uReplaceColor:{value:Number(r),type:"f32"}}}}),Y2(this,"uniforms"),Y2(this,"_color"),this.uniforms=this.resources.asciiUniforms.uniforms,this._color=new ve,this.color=n.color??16777215}get size(){return this.uniforms.uSize}set size(e){this.uniforms.uSize=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[n,r,i]=this._color.toArray();this.uniforms.uColor[0]=n,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get replaceColor(){return this.uniforms.uReplaceColor>.5}set replaceColor(e){this.uniforms.uReplaceColor=e?1:0}};Y2(jY,"DEFAULT_OPTIONS",{size:8,color:16777215,replaceColor:!1});var WY=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uBackground;

void main(void){
    vec4 front = texture(uTexture, vTextureCoord);
    vec4 back = texture(uBackground, vTextureCoord);

    if (front.a == 0.0) {
        discard;
    }
    
    vec3 color = mix(back.rgb, front.rgb / front.a, front.a);

    finalColor = vec4(color, 1.0);
}`,$Y=`@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var uBackground: texture_2d<f32>; 

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    var front: vec4<f32> = textureSample(uTexture, uSampler, uv);
    var back: vec4<f32> = textureSample(uBackground, uSampler, uv);
    
    if (front.a == 0.0) {
        discard;
    }

    var color: vec3<f32> = mix(back.rgb, front.rgb / front.a, front.a);

    return vec4<f32>(color, 1.0);
}`,XY=Object.defineProperty,YY=(t,e,n)=>e in t?XY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qY=(t,e,n)=>(YY(t,e+"",n),n);class $F extends w1{constructor(e){super(e),qY(this,"_blendPass"),this.blendRequired=!0,this.padding=0,this._blendPass=new le({gpuProgram:he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:$Y,entryPoint:"mainFragment"}}),glProgram:me.from({vertex:De,fragment:WY,name:"drop-shadow-filter"}),resources:{uBackground:X.EMPTY}})}apply(e,n,r,i){const s=e._activeFilterData.backTexture,o=Ge.getSameSizeTexture(n);super.apply(e,s,o,!0),this._blendPass.resources.uBackground=o.source,this._blendPass.apply(e,n,r,i),Ge.returnTexture(o)}updatePadding(){this.padding=0}}var KY=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTransform;
uniform vec3 uLightColor;
uniform float uLightAlpha;
uniform vec3 uShadowColor;
uniform float uShadowAlpha;

uniform vec4 uInputSize;

void main(void) {
    vec2 transform = vec2(1.0 / uInputSize) * vec2(uTransform.x, uTransform.y);
    vec4 color = texture(uTexture, vTextureCoord);
    float light = texture(uTexture, vTextureCoord - transform).a;
    float shadow = texture(uTexture, vTextureCoord + transform).a;

    color.rgb = mix(color.rgb, uLightColor, clamp((color.a - light) * uLightAlpha, 0.0, 1.0));
    color.rgb = mix(color.rgb, uShadowColor, clamp((color.a - shadow) * uShadowAlpha, 0.0, 1.0));
    finalColor = vec4(color.rgb * color.a, color.a);
}
`,QY=`struct BevelUniforms {
  uLightColor: vec3<f32>,
  uLightAlpha: f32,
  uShadowColor: vec3<f32>,
  uShadowAlpha: f32,
  uTransform: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> bevelUniforms : BevelUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let transform = vec2<f32>(1.0 / gfu.uInputSize.xy) * vec2<f32>(bevelUniforms.uTransform.x, bevelUniforms.uTransform.y);
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let lightSample: f32 = textureSample(uTexture, uSampler, uv - transform).a;
  let shadowSample: f32 = textureSample(uTexture, uSampler, uv + transform).a;

  let light = vec4<f32>(bevelUniforms.uLightColor, bevelUniforms.uLightAlpha);
  let shadow = vec4<f32>(bevelUniforms.uShadowColor, bevelUniforms.uShadowAlpha);

  color = vec4<f32>(mix(color.rgb, light.rgb, clamp((color.a - lightSample) * light.a, 0.0, 1.0)), color.a);
  color = vec4<f32>(mix(color.rgb, shadow.rgb, clamp((color.a - shadowSample) * shadow.a, 0.0, 1.0)), color.a);
  
  return vec4<f32>(color.rgb * color.a, color.a);
}`,ZY=Object.defineProperty,JY=(t,e,n)=>e in t?ZY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,La=(t,e,n)=>(JY(t,typeof e!="symbol"?e+"":e,n),n);const eq=class XF extends le{constructor(e){e={...XF.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:QY,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:KY,name:"bevel-filter"});super({gpuProgram:n,glProgram:r,resources:{bevelUniforms:{uLightColor:{value:new Float32Array(3),type:"vec3<f32>"},uLightAlpha:{value:e.lightAlpha,type:"f32"},uShadowColor:{value:new Float32Array(3),type:"vec3<f32>"},uShadowAlpha:{value:e.shadowAlpha,type:"f32"},uTransform:{value:new Float32Array(2),type:"vec2<f32>"}}},padding:1}),La(this,"uniforms"),La(this,"_thickness"),La(this,"_rotation"),La(this,"_lightColor"),La(this,"_shadowColor"),this.uniforms=this.resources.bevelUniforms.uniforms,this._lightColor=new ve,this._shadowColor=new ve,this.lightColor=e.lightColor??16777215,this.shadowColor=e.shadowColor??0,Object.assign(this,e)}get rotation(){return this._rotation/Ho}set rotation(e){this._rotation=e*Ho,this._updateTransform()}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this._updateTransform()}get lightColor(){return this._lightColor.value}set lightColor(e){this._lightColor.setValue(e);const[n,r,i]=this._lightColor.toArray();this.uniforms.uLightColor[0]=n,this.uniforms.uLightColor[1]=r,this.uniforms.uLightColor[2]=i}get lightAlpha(){return this.uniforms.uLightAlpha}set lightAlpha(e){this.uniforms.uLightAlpha=e}get shadowColor(){return this._shadowColor.value}set shadowColor(e){this._shadowColor.setValue(e);const[n,r,i]=this._shadowColor.toArray();this.uniforms.uShadowColor[0]=n,this.uniforms.uShadowColor[1]=r,this.uniforms.uShadowColor[2]=i}get shadowAlpha(){return this.uniforms.uShadowAlpha}set shadowAlpha(e){this.uniforms.uShadowAlpha=e}_updateTransform(){this.uniforms.uTransform[0]=this.thickness*Math.cos(this._rotation),this.uniforms.uTransform[1]=this.thickness*Math.sin(this._rotation)}};La(eq,"DEFAULT_OPTIONS",{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7});var tq=Object.defineProperty,nq=(t,e,n)=>e in t?tq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Id=(t,e,n)=>(nq(t,typeof e!="symbol"?e+"":e,n),n);const rq=class YF extends bM{constructor(...e){let n=e[0]??{};if(typeof n=="number"||Array.isArray(n)||"x"in n&&"y"in n){q("6.0.0","BloomFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }");let r=n;Array.isArray(r)&&(r={x:r[0],y:r[1]}),n={strength:r},e[1]!==void 0&&(n.quality=e[1]),e[2]!==void 0&&(n.resolution=e[2]),e[3]!==void 0&&(n.kernelSize=e[3])}n={...YF.DEFAULT_OPTIONS,...n},super(),Id(this,"_blurXFilter"),Id(this,"_blurYFilter"),Id(this,"_strength"),this._strength={x:2,y:2},n.strength&&(typeof n.strength=="number"?(this._strength.x=n.strength,this._strength.y=n.strength):(this._strength.x=n.strength.x,this._strength.y=n.strength.y)),this._blurXFilter=new gu({...n,horizontal:!0,strength:this.strengthX}),this._blurYFilter=new gu({...n,horizontal:!1,strength:this.strengthY}),this._blurYFilter.blendMode="screen",Object.assign(this,n)}apply(e,n,r,i){const s=Ge.getSameSizeTexture(n);e.applyFilter(this,n,r,i),this._blurXFilter.apply(e,n,s,!0),this._blurYFilter.apply(e,s,r,!1),Ge.returnTexture(s)}get strength(){return this._strength}set strength(e){this._strength=typeof e=="number"?{x:e,y:e}:e,this._updateStrength()}get strengthX(){return this.strength.x}set strengthX(e){this.strength.x=e,this._updateStrength()}get strengthY(){return this.strength.y}set strengthY(e){this.strength.y=e,this._updateStrength()}_updateStrength(){this._blurXFilter.blur=this.strengthX,this._blurYFilter.blur=this.strengthY}get blur(){return q("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strengthX}set blur(e){q("6.0.0","BloomFilter.blur is deprecated, please use BloomFilter.strength instead"),this.strength=e}get blurX(){return q("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX}set blurX(e){q("6.0.0","BloomFilter.blurX is deprecated, please use BloomFilter.strengthX instead"),this.strengthX=e}get blurY(){return q("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY}set blurY(e){q("6.0.0","BloomFilter.blurY is deprecated, please use BloomFilter.strengthY instead"),this.strengthY=e}};Id(rq,"DEFAULT_OPTIONS",{strength:{x:2,y:2},quality:4,resolution:1,kernelSize:5});var iq=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uDimensions;
uniform vec2 uCenter;
uniform float uRadius;
uniform float uStrength;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

void main()
{
    vec2 coord = vTextureCoord * uInputSize.xy;
    coord -= uCenter * uDimensions.xy;
    float distance = length(coord);

    if (distance < uRadius) {
        float percent = distance / uRadius;
        if (uStrength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, uRadius / distance, percent), uStrength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + uStrength * 0.75) * uRadius / distance, 1.0 - percent);
        }
    }

    coord += uCenter * uDimensions.xy;
    coord /= uInputSize.xy;
    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    vec4 color = texture(uTexture, clampedCoord);

    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    finalColor = color;
}
`,sq=`struct BulgePinchUniforms {
  uDimensions: vec2<f32>,
  uCenter: vec2<f32>,
  uRadius: f32,
  uStrength: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> bulgePinchUniforms : BulgePinchUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let dimensions: vec2<f32> = bulgePinchUniforms.uDimensions;
  let center: vec2<f32> = bulgePinchUniforms.uCenter;
  let radius: f32 = bulgePinchUniforms.uRadius;
  let strength: f32 = bulgePinchUniforms.uStrength;
  var coord: vec2<f32> = (uv * gfu.uInputSize.xy) - center * dimensions.xy;

  let distance: f32 = length(coord);

  if (distance < radius) {
      let percent: f32 = distance / radius;
      if (strength > 0.0) {
          coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
      } else {
          coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
      }
  }
    coord += (center * dimensions.xy);
    coord /= gfu.uInputSize.xy;

    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);
    var color: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);
    if (coord.x != clampedCoord.x && coord.y != clampedCoord.y) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    return color;
}

fn compareVec2(x: vec2<f32>, y: vec2<f32>) -> bool
{
  if (x.x == y.x && x.y == y.y)
  {
    return true;
  }

  return false;
}`,oq=Object.defineProperty,aq=(t,e,n)=>e in t?oq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qF=(t,e,n)=>(aq(t,typeof e!="symbol"?e+"":e,n),n);const uq=class KF extends le{constructor(e){e={...KF.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:sq,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:iq,name:"bulge-pinch-filter"});super({gpuProgram:n,glProgram:r,resources:{bulgePinchUniforms:{uDimensions:{value:[0,0],type:"vec2<f32>"},uCenter:{value:e.center,type:"vec2<f32>"},uRadius:{value:e.radius,type:"f32"},uStrength:{value:e.strength,type:"f32"}}}}),qF(this,"uniforms"),this.uniforms=this.resources.bulgePinchUniforms.uniforms,Object.assign(this,e)}apply(e,n,r,i){this.uniforms.uDimensions[0]=n.frame.width,this.uniforms.uDimensions[1]=n.frame.height,e.applyFilter(this,n,r,i)}get center(){return this.uniforms.uCenter}set center(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}};qF(uq,"DEFAULT_OPTIONS",{center:{x:.5,y:.5},radius:100,strength:1});var lq=`precision highp float;
in vec2 vTextureCoord;
in vec2 vFilterCoord;
out vec4 finalColor;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform sampler2D uTexture;
uniform vec4 uOptions;
uniform vec2 uCounts;
uniform vec3 uColors[MAX_STOPS];
uniform vec4 uStops[MAX_STOPS];

const float PI = 3.1415926538;
const float PI_2 = PI*2.;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(pos, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    int uType = int(uOptions[0]);
    float uAngle = uOptions[1];
    float uAlpha = uOptions[2];
    float uReplace = uOptions[3];

    int uNumStops = int(uCounts[0]);
    float uMaxColors = uCounts[1];

    // current/original color
    vec4 currentColor = texture(uTexture, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        finalColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, int(uType), radians(uAngle));

    // check gradient bounds
    float offsetMin = uStops[0][0];
    float offsetMax = 0.0;

    int numStops = int(uNumStops);

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == numStops-1){ // last index
            offsetMax = uStops[i][0];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        finalColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0.) {
        float stepSize = 1./uMaxColors;
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uStops[i][0]) {
            from = ColorStop(uStops[i][0], uColors[i], uStops[i][1]);
            to = ColorStop(uStops[i+1][0], uColors[i+1], uStops[i+1][1]);
        }

        if (i == numStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    if (uReplace < 0.5) {
        // mix resulting color with current color
        finalColor = gradientColor + currentColor*(1.-gradientColor.a);
    } else {
        // replace with gradient color
        finalColor = gradientColor;
    }
}
`,cq=`in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 vFilterCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
    vFilterCoord = vTextureCoord * uInputSize.xy / uOutputFrame.zw;
}
`,EE=`struct BaseUniforms {
  uOptions: vec4<f32>,
  uCounts: vec2<f32>,
};

struct StopsUniforms {
  uColors: array<vec3<f32>, MAX_STOPS>,
  uStops: array<vec4<f32>, MAX_STOPS>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> baseUniforms : BaseUniforms;
@group(1) @binding(1) var<uniform> stopsUniforms : StopsUniforms;

struct VSOutput {
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
  @location(1) coord : vec2<f32>
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn filterCoord( vTextureCoord:vec2<f32> ) -> vec2<f32>
{
    return vTextureCoord * gfu.uInputSize.xy / gfu.uOutputFrame.zw;
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  let vTextureCoord: vec2<f32> = filterTextureCoord(aPosition);
  return VSOutput(
   filterVertexPosition(aPosition),
   vTextureCoord,
   filterCoord(vTextureCoord),
  );
}

struct ColorStop {
  offset: f32,
  color: vec3<f32>,
  alpha: f32,
};

fn rotate2d(angle: f32) -> mat2x2<f32>{
  return mat2x2(cos(angle), -sin(angle),
  sin(angle), cos(angle));
}

fn projectLinearPosition(pos: vec2<f32>, angle: f32) -> f32 {
  var center: vec2<f32> = vec2<f32>(0.5);
  var result: vec2<f32> = pos - center;
  result = rotate2d(angle) * result;
  result = result + center;
  return clamp(result.x, 0.0, 1.0);
}

fn projectRadialPosition(pos: vec2<f32>) -> f32 {
  var r: f32 = distance(pos, vec2<f32>(0.5));
  return clamp(2.0 * r, 0.0, 1.0);
}

fn projectAnglePosition(pos: vec2<f32>, angle: f32) -> f32 {
  var center: vec2<f32> = pos - vec2<f32>(0.5, 0.5);
  var polarAngle: f32 = atan2(-center.y, center.x);
  return ((polarAngle + angle) % PI_2) / PI_2;
}

fn projectPosition(pos: vec2<f32>, gradientType: i32, angle: f32) -> f32 {
  if (gradientType == TYPE_LINEAR) {
      return projectLinearPosition(pos, angle);
  } else if (gradientType == TYPE_RADIAL) {
      return projectRadialPosition(pos);
  } else if (gradientType == TYPE_CONIC) {
      return projectAnglePosition(pos, angle);
  }

  return pos.y;
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
  @location(1) coord : vec2<f32>
) -> @location(0) vec4<f32> {
  let uType: i32 = i32(baseUniforms.uOptions[0]);
  let uAngle: f32 = baseUniforms.uOptions[1];
  let uAlpha: f32 = baseUniforms.uOptions[2];
  let uReplace: f32 = baseUniforms.uOptions[3];

  let uNumStops: i32 = i32(baseUniforms.uCounts[0]);
  let uMaxColors: f32 = baseUniforms.uCounts[1];

  // current/original color
  var currentColor: vec4<f32> = textureSample(uTexture, uSampler, uv);

  // skip calculations if gradient alpha is 0
  if (uAlpha == 0.0) { return currentColor; }

  // project position
  var y: f32 = projectPosition(coord, uType, radians(uAngle));

  // check gradient bounds
  var offsetMin: f32 = stopsUniforms.uStops[0][0];
  var offsetMax: f32 = 0.0;

  let numStops: i32 = uNumStops;

  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {
      if (i == numStops - 1) { // last index
          offsetMax = stopsUniforms.uStops[i][0];
      }
  }

  if (y  < offsetMin || y > offsetMax) { return currentColor; }

  // limit colors
  if (uMaxColors > 0.0) {
      var stepSize: f32 = 1.0 / uMaxColors;
      var stepNumber: f32 = floor(y / stepSize);
      y = stepSize * (stepNumber + 0.5); // offset by 0.5 to use color from middle of segment
  }

  // find color stops
  var stopFrom: ColorStop;
  var stopTo: ColorStop;

  for (var i: i32 = 0; i < MAX_STOPS; i = i + 1) {
      if (y >= stopsUniforms.uStops[i][0]) {
          stopFrom = ColorStop(stopsUniforms.uStops[i][0], stopsUniforms.uColors[i], stopsUniforms.uStops[i][1]);
          stopTo = ColorStop(stopsUniforms.uStops[i + 1][0], stopsUniforms.uColors[i + 1], stopsUniforms.uStops[i + 1][1]);
      }

      if (i == numStops - 1) { // last index
          break;
      }
  }

  // mix colors from stops
  var colorFrom: vec4<f32> = vec4<f32>(stopFrom.color * stopFrom.alpha, stopFrom.alpha);
  var colorTo: vec4<f32> = vec4<f32>(stopTo.color * stopTo.alpha, stopTo.alpha);

  var segmentHeight: f32 = stopTo.offset - stopFrom.offset;
  var relativePos: f32 = y - stopFrom.offset; // position from 0 to [segmentHeight]
  var relativePercent: f32 = relativePos / segmentHeight; // position in percent between [from.offset] and [to.offset].

  var gradientAlpha: f32 = uAlpha * currentColor.a;
  var gradientColor: vec4<f32> = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

  if (uReplace < 0.5) {
      // mix resulting color with current color
      return gradientColor + currentColor * (1.0 - gradientColor.a);
  } else {
      // replace with gradient color
      return gradientColor;
  }
}

const PI: f32 = 3.14159265358979323846264;
const PI_2: f32 = PI * 2.0;

const TYPE_LINEAR: i32 = 0;
const TYPE_RADIAL: i32 = 1;
const TYPE_CONIC: i32 = 2;
const MAX_STOPS: i32 = 32;`,ua=ua||{};ua.stringify=function(){var t={"visit_linear-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return t.visit_gradient(e)},"visit_radial-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return t.visit_gradient(e)},visit_gradient:function(e){var n=t.visit(e.orientation);return n&&(n+=", "),e.type+"("+n+t.visit(e.colorStops)+")"},visit_shape:function(e){var n=e.value,r=t.visit(e.at),i=t.visit(e.style);return i&&(n+=" "+i),r&&(n+=" at "+r),n},"visit_default-radial":function(e){var n="",r=t.visit(e.at);return r&&(n+=r),n},"visit_extent-keyword":function(e){var n=e.value,r=t.visit(e.at);return r&&(n+=" at "+r),n},"visit_position-keyword":function(e){return e.value},visit_position:function(e){return t.visit(e.value.x)+" "+t.visit(e.value.y)},"visit_%":function(e){return e.value+"%"},visit_em:function(e){return e.value+"em"},visit_px:function(e){return e.value+"px"},visit_literal:function(e){return t.visit_color(e.value,e)},visit_hex:function(e){return t.visit_color("#"+e.value,e)},visit_rgb:function(e){return t.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return t.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,n){var r=e,i=t.visit(n.length);return i&&(r+=" "+i),r},visit_angular:function(e){return e.value+"deg"},visit_directional:function(e){return"to "+e.value},visit_array:function(e){var n="",r=e.length;return e.forEach(function(i,s){n+=t.visit(i),s<r-1&&(n+=", ")}),n},visit:function(e){if(!e)return"";var n="";if(e instanceof Array)return t.visit_array(e,n);if(e.type){var r=t["visit_"+e.type];if(r)return r(e);throw Error("Missing visitor visit_"+e.type)}else throw Error("Invalid node.")}};return function(e){return t.visit(e)}}();var ua=ua||{};ua.parse=function(){var t={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(Y){var V=new Error(e+": "+Y);throw V.source=e,V}function r(){var Y=i();return e.length>0&&n("Invalid input not EOF"),Y}function i(){return T(s)}function s(){return o("linear-gradient",t.linearGradient,c)||o("repeating-linear-gradient",t.repeatingLinearGradient,c)||o("radial-gradient",t.radialGradient,p)||o("repeating-radial-gradient",t.repeatingRadialGradient,p)}function o(Y,V,z){return a(V,function(W){var je=z();return je&&(ye(t.comma)||n("Missing comma before color stops")),{type:Y,orientation:je,colorStops:T(A)}})}function a(Y,V){var z=ye(Y);if(z){ye(t.startCall)||n("Missing (");var W=V(z);return ye(t.endCall)||n("Missing )"),W}}function c(){return h()||f()}function h(){return J("directional",t.sideOrCorner,1)}function f(){return J("angular",t.angleValue,1)}function p(){var Y,V=v(),z;return V&&(Y=[],Y.push(V),z=e,ye(t.comma)&&(V=v(),V?Y.push(V):e=z)),Y}function v(){var Y=_()||y();if(Y)Y.at=C();else{var V=S();if(V){Y=V;var z=C();z&&(Y.at=z)}else{var W=b();W&&(Y={type:"default-radial",at:W})}}return Y}function _(){var Y=J("shape",/^(circle)/i,0);return Y&&(Y.style=re()||S()),Y}function y(){var Y=J("shape",/^(ellipse)/i,0);return Y&&(Y.style=ie()||S()),Y}function S(){return J("extent-keyword",t.extentKeywords,1)}function C(){if(J("position",/^at/,0)){var Y=b();return Y||n("Missing positioning value"),Y}}function b(){var Y=w();if(Y.x||Y.y)return{type:"position",value:Y}}function w(){return{x:ie(),y:ie()}}function T(Y){var V=Y(),z=[];if(V)for(z.push(V);ye(t.comma);)V=Y(),V?z.push(V):n("One extra comma");return z}function A(){var Y=M();return Y||n("Expected color definition"),Y.length=ie(),Y}function M(){return I()||k()||N()||L()}function L(){return J("literal",t.literalColor,0)}function I(){return J("hex",t.hexColor,1)}function N(){return a(t.rgbColor,function(){return{type:"rgb",value:T(G)}})}function k(){return a(t.rgbaColor,function(){return{type:"rgba",value:T(G)}})}function G(){return ye(t.number)[1]}function ie(){return J("%",t.percentageValue,1)||Ze()||re()}function Ze(){return J("position-keyword",t.positionKeywords,1)}function re(){return J("px",t.pixelValue,1)||J("em",t.emValue,1)}function J(Y,V,z){var W=ye(V);if(W)return{type:Y,value:W[z]}}function ye(Y){var V,z;return z=/^[\n\r\t\s]+/.exec(e),z&&oe(z[0].length),V=Y.exec(e),V&&oe(V[0].length),V}function oe(Y){e=e.substr(Y)}return function(Y){return e=Y.toString(),r()}}();var hq=ua.parse;ua.stringify;function fq(t){const e=hq(yq(t));if(e.length===0)throw new Error("Invalid CSS gradient.");if(e.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const n=e[0],r=dq(n.type),i=pq(n.colorStops),s=_q(n.orientation);return{type:r,stops:i,angle:s}}function dq(t){const e={"linear-gradient":0,"radial-gradient":1};if(!(t in e))throw new Error(`Unsupported gradient type "${t}"`);return e[t]}function pq(t){const e=gq(t),n=[],r=new ve;for(let i=0;i<t.length;i++){const s=mq(t[i]),o=r.setValue(s).toArray();n.push({offset:e[i],color:o.slice(0,3),alpha:o[3]})}return n}function mq(t){switch(t.type){case"hex":return`#${t.value}`;case"literal":return t.value;default:return`${t.type}(${t.value.join(",")})`}}function gq(t){const e=[];for(let s=0;s<t.length;s++){const o=t[s];let a=-1;o.type==="literal"&&o.length&&"type"in o.length&&o.length.type==="%"&&"value"in o.length&&(a=parseFloat(o.length.value)/100),e.push(a)}const r=s=>{for(let o=s;o<e.length;o++)if(e[o]!==-1)return{indexDelta:o-s,offset:e[o]};return{indexDelta:e.length-1-s,offset:1}};let i=0;for(let s=0;s<e.length;s++){const o=e[s];if(o!==-1)i=o;else if(s===0)e[s]=0;else if(s+1===e.length)e[s]=1;else{const a=r(s),h=(a.offset-i)/(1+a.indexDelta);for(let f=0;f<=a.indexDelta;f++)e[s+f]=i+(f+1)*h;s+=a.indexDelta,i=e[s]}}return e.map(vq)}function vq(t){return t.toString().length>6?parseFloat(t.toString().substring(0,6)):t}function _q(t){if(typeof t>"u")return 0;if("type"in t&&"value"in t)switch(t.type){case"angular":return parseFloat(t.value);case"directional":return xq(t.value)}return 0}function xq(t){const e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(t in e))throw new Error(`Unsupported directional value "${t}"`);return e[t]}function yq(t){let e=t.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}var bq=Object.defineProperty,Sq=(t,e,n)=>e in t?bq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Io=(t,e,n)=>(Sq(t,typeof e!="symbol"?e+"":e,n),n);const Fv=90;function wq(t){return[...t].sort((e,n)=>e.offset-n.offset)}const Zc=class Ud extends le{constructor(e){if(e&&"css"in e?e={...fq(e.css||""),alpha:e.alpha??Ud.defaults.alpha,maxColors:e.maxColors??Ud.defaults.maxColors}:e={...Ud.defaults,...e},!e.stops||e.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");const n=he.from({vertex:{source:EE,entryPoint:"mainVertex"},fragment:{source:EE,entryPoint:"mainFragment"}}),r=me.from({vertex:cq,fragment:lq,name:"color-gradient-filter"}),i=32;super({gpuProgram:n,glProgram:r,resources:{baseUniforms:{uOptions:{value:[e.type,e.angle??Fv,e.alpha,e.replace?1:0],type:"vec4<f32>"},uCounts:{value:[e.stops.length,e.maxColors],type:"vec2<f32>"}},stopsUniforms:{uColors:{value:new Float32Array(i*3),type:"vec3<f32>",size:i},uStops:{value:new Float32Array(i*4),type:"vec4<f32>",size:i}}}}),Io(this,"baseUniforms"),Io(this,"stopsUniforms"),Io(this,"_stops",[]),this.baseUniforms=this.resources.baseUniforms.uniforms,this.stopsUniforms=this.resources.stopsUniforms.uniforms,Object.assign(this,e)}get stops(){return this._stops}set stops(e){const n=wq(e),r=new ve;let i,s,o;for(let a=0;a<n.length;a++){r.setValue(n[a].color);const c=a*3;[i,s,o]=r.toArray(),this.stopsUniforms.uColors[c]=i,this.stopsUniforms.uColors[c+1]=s,this.stopsUniforms.uColors[c+2]=o,this.stopsUniforms.uStops[a*4]=n[a].offset,this.stopsUniforms.uStops[a*4+1]=n[a].alpha}this.baseUniforms.uCounts[0]=n.length,this._stops=n}get type(){return this.baseUniforms.uOptions[0]}set type(e){this.baseUniforms.uOptions[0]=e}get angle(){return this.baseUniforms.uOptions[1]+Fv}set angle(e){this.baseUniforms.uOptions[1]=e-Fv}get alpha(){return this.baseUniforms.uOptions[2]}set alpha(e){this.baseUniforms.uOptions[2]=e}get maxColors(){return this.baseUniforms.uCounts[1]}set maxColors(e){this.baseUniforms.uCounts[1]=e}get replace(){return this.baseUniforms.uOptions[3]>.5}set replace(e){this.baseUniforms.uOptions[3]=e?1:0}};Io(Zc,"LINEAR",0);Io(Zc,"RADIAL",1);Io(Zc,"CONIC",2);Io(Zc,"defaults",{type:Zc.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1});var Cq=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform float uMix;
uniform float uSize;
uniform float uSliceSize;
uniform float uSlicePixelSize;
uniform float uSliceInnerSize;

void main() {
    vec4 color = texture(uTexture, vTextureCoord.xy);
    vec4 adjusted;

    if (color.a > 0.0) {
        color.rgb /= color.a;
        float innerWidth = uSize - 1.0;
        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);
        float zSlice1 = min(zSlice0 + 1.0, innerWidth);
        float xOffset = uSlicePixelSize * 0.5 + color.r * uSliceInnerSize;
        float s0 = xOffset + (zSlice0 * uSliceSize);
        float s1 = xOffset + (zSlice1 * uSliceSize);
        float yOffset = uSliceSize * 0.5 + color.g * (1.0 - uSliceSize);
        vec4 slice0Color = texture(uMapTexture, vec2(s0,yOffset));
        vec4 slice1Color = texture(uMapTexture, vec2(s1,yOffset));
        float zOffset = fract(color.b * innerWidth);
        adjusted = mix(slice0Color, slice1Color, zOffset);

        color.rgb *= color.a;
    }

    finalColor = vec4(mix(color, adjusted, uMix).rgb, color.a);

}`,Tq=`struct ColorMapUniforms {
  uMix: f32,
  uSize: f32,
  uSliceSize: f32,
  uSlicePixelSize: f32,
  uSliceInnerSize: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorMapUniforms : ColorMapUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler: sampler;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color:vec4<f32> = textureSample(uTexture, uSampler, uv);

  var adjusted: vec4<f32>;

  var altColor: vec4<f32> = vec4<f32>(color.rgb / color.a, color.a);
  let innerWidth: f32 = colorMapUniforms.uSize - 1.0;
  let zSlice0: f32 = min(floor(color.b * innerWidth), innerWidth);
  let zSlice1: f32 = min(zSlice0 + 1.0, innerWidth);
  let xOffset: f32 = colorMapUniforms.uSlicePixelSize * 0.5 + color.r * colorMapUniforms.uSliceInnerSize;
  let s0: f32 = xOffset + (zSlice0 * colorMapUniforms.uSliceSize);
  let s1: f32 = xOffset + (zSlice1 * colorMapUniforms.uSliceSize);
  let yOffset: f32 = colorMapUniforms.uSliceSize * 0.5 + color.g * (1.0 - colorMapUniforms.uSliceSize);
  let slice0Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s0,yOffset));
  let slice1Color: vec4<f32> = textureSample(uMapTexture, uMapSampler, vec2(s1,yOffset));
  let zOffset: f32 = fract(color.b * innerWidth);
  adjusted = mix(slice0Color, slice1Color, zOffset);
  altColor = vec4<f32>(color.rgb * color.a, color.a);

  let realColor: vec4<f32> = select(color, altColor, color.a > 0.0);

  return vec4<f32>(mix(realColor, adjusted, colorMapUniforms.uMix).rgb, realColor.a);
}`,Eq=Object.defineProperty,Aq=(t,e,n)=>e in t?Eq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ni=(t,e,n)=>(Aq(t,typeof e!="symbol"?e+"":e,n),n);const Pq=class QF extends le{constructor(...e){let n=e[0]??{};if((n instanceof X||n instanceof dt)&&(q("6.0.0","ColorMapFilter constructor params are now options object. See params: { colorMap, nearest, mix }"),n={colorMap:n},e[1]!==void 0&&(n.nearest=e[1]),e[2]!==void 0&&(n.mix=e[2])),n={...QF.DEFAULT_OPTIONS,...n},!n.colorMap)throw Error("No color map texture source was provided to ColorMapFilter");const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:Tq,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:Cq,name:"color-map-filter"});super({gpuProgram:r,glProgram:i,resources:{colorMapUniforms:{uMix:{value:n.mix,type:"f32"},uSize:{value:0,type:"f32"},uSliceSize:{value:0,type:"f32"},uSlicePixelSize:{value:0,type:"f32"},uSliceInnerSize:{value:0,type:"f32"}},uMapTexture:n.colorMap.source,uMapSampler:n.colorMap.source.style}}),Ni(this,"uniforms"),Ni(this,"_size",0),Ni(this,"_sliceSize",0),Ni(this,"_slicePixelSize",0),Ni(this,"_sliceInnerSize",0),Ni(this,"_nearest",!1),Ni(this,"_scaleMode","linear"),Ni(this,"_colorMap"),this.uniforms=this.resources.colorMapUniforms.uniforms,Object.assign(this,n)}get mix(){return this.uniforms.uMix}set mix(e){this.uniforms.uMix=e}get colorSize(){return this._size}get colorMap(){return this._colorMap}set colorMap(e){if(!e||e===this.colorMap)return;const n=e instanceof X?e.source:e;n.style.scaleMode=this._scaleMode,n.autoGenerateMipmaps=!1,this._size=n.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms.uSize=this._size,this.uniforms.uSliceSize=this._sliceSize,this.uniforms.uSlicePixelSize=this._slicePixelSize,this.uniforms.uSliceInnerSize=this._sliceInnerSize,this.resources.uMapTexture=n,this._colorMap=e}get nearest(){return this._nearest}set nearest(e){this._nearest=e,this._scaleMode=e?"nearest":"linear";const n=this._colorMap;n&&n.source&&(n.source.scaleMode=this._scaleMode,n.source.autoGenerateMipmaps=!1,n.source.style.update(),n.source.update())}updateColorMap(){const e=this._colorMap;e?.source&&(e.source.update(),this.colorMap=e)}destroy(){this._colorMap?.destroy(),super.destroy()}};Ni(Pq,"DEFAULT_OPTIONS",{colorMap:X.WHITE,nearest:!1,mix:1});var Rq=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uColor;
uniform float uAlpha;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);
    finalColor = vec4(mix(c.rgb, uColor.rgb, c.a * uAlpha), c.a);
}
`,Bq=`struct ColorOverlayUniforms {
    uColor: vec3<f32>,
    uAlpha: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorOverlayUniforms : ColorOverlayUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    let c = textureSample(uTexture, uSampler, uv);
    return vec4<f32>(mix(c.rgb, colorOverlayUniforms.uColor.rgb, c.a * colorOverlayUniforms.uAlpha), c.a);
}
`,Mq=Object.defineProperty,Dq=(t,e,n)=>e in t?Mq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,q2=(t,e,n)=>(Dq(t,typeof e!="symbol"?e+"":e,n),n);const Oq=class ZF extends le{constructor(...e){let n=e[0]??{};(typeof n=="number"||Array.isArray(n)||n instanceof Float32Array)&&(q("6.0.0","ColorOverlayFilter constructor params are now options object. See params: { color, alpha }"),n={color:n},e[1]!==void 0&&(n.alpha=e[1])),n={...ZF.DEFAULT_OPTIONS,...n};const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:Bq,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:Rq,name:"color-overlay-filter"});super({gpuProgram:r,glProgram:i,resources:{colorOverlayUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:n.alpha,type:"f32"}}}}),q2(this,"uniforms"),q2(this,"_color"),this.uniforms=this.resources.colorOverlayUniforms.uniforms,this._color=new ve,this.color=n.color??0}get color(){return this._color.value}set color(e){this._color.setValue(e);const[n,r,i]=this._color.toArray();this.uniforms.uColor[0]=n,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};q2(Oq,"DEFAULT_OPTIONS",{color:0,alpha:1});var kq=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uOriginalColor;
uniform vec3 uTargetColor;
uniform float uTolerance;

void main(void) {
    vec4 c = texture(uTexture, vTextureCoord);
    vec3 colorDiff = uOriginalColor - (c.rgb / max(c.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    float doReplace = step(colorDistance, uTolerance);
    finalColor = vec4(mix(c.rgb, (uTargetColor + colorDiff) * c.a, doReplace), c.a);
}
`,Fq=`struct ColorReplaceUniforms {
  uOriginalColor: vec3<f32>,
  uTargetColor: vec3<f32>,
  uTolerance: f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> colorReplaceUniforms : ColorReplaceUniforms;

@fragment
fn mainFragment(
   @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sample: vec4<f32> = textureSample(uTexture, uSampler, uv);

  let colorDiff: vec3<f32> = colorReplaceUniforms.uOriginalColor - (sample.rgb / max(sample.a, 0.0000000001));
  let colorDistance: f32 = length(colorDiff);
  let doReplace: f32 = step(colorDistance, colorReplaceUniforms.uTolerance);

  return vec4<f32>(mix(sample.rgb, (colorReplaceUniforms.uTargetColor + colorDiff) * sample.a, doReplace), sample.a);
}`,Iq=Object.defineProperty,Uq=(t,e,n)=>e in t?Iq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ld=(t,e,n)=>(Uq(t,typeof e!="symbol"?e+"":e,n),n);const Lq=class JF extends le{constructor(...e){let n=e[0]??{};(typeof n=="number"||Array.isArray(n)||n instanceof Float32Array)&&(q("6.0.0","ColorReplaceFilter constructor params are now options object. See params: { originalColor, targetColor, tolerance }"),n={originalColor:n},e[1]!==void 0&&(n.targetColor=e[1]),e[2]!==void 0&&(n.tolerance=e[2])),n={...JF.DEFAULT_OPTIONS,...n};const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:Fq,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:kq,name:"color-replace-filter"});super({gpuProgram:r,glProgram:i,resources:{colorReplaceUniforms:{uOriginalColor:{value:new Float32Array(3),type:"vec3<f32>"},uTargetColor:{value:new Float32Array(3),type:"vec3<f32>"},uTolerance:{value:n.tolerance,type:"f32"}}}}),Ld(this,"uniforms"),Ld(this,"_originalColor"),Ld(this,"_targetColor"),this.uniforms=this.resources.colorReplaceUniforms.uniforms,this._originalColor=new ve,this._targetColor=new ve,this.originalColor=n.originalColor??16711680,this.targetColor=n.targetColor??0,Object.assign(this,n)}get originalColor(){return this._originalColor.value}set originalColor(e){this._originalColor.setValue(e);const[n,r,i]=this._originalColor.toArray();this.uniforms.uOriginalColor[0]=n,this.uniforms.uOriginalColor[1]=r,this.uniforms.uOriginalColor[2]=i}get targetColor(){return this._targetColor.value}set targetColor(e){this._targetColor.setValue(e);const[n,r,i]=this._targetColor.toArray();this.uniforms.uTargetColor[0]=n,this.uniforms.uTargetColor[1]=r,this.uniforms.uTargetColor[2]=i}get tolerance(){return this.uniforms.uTolerance}set tolerance(e){this.uniforms.uTolerance=e}set newColor(e){q("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor=e}get newColor(){return q("6.0.0","ColorReplaceFilter.newColor is deprecated, please use ColorReplaceFilter.targetColor instead"),this.targetColor}set epsilon(e){q("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance=e}get epsilon(){return q("6.0.0","ColorReplaceFilter.epsilon is deprecated, please use ColorReplaceFilter.tolerance instead"),this.tolerance}};Ld(Lq,"DEFAULT_OPTIONS",{originalColor:16711680,targetColor:0,tolerance:.4});var Nq=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTexelSize;
uniform mat3 uMatrix;

void main(void)
{
    vec4 c11 = texture(uTexture, vTextureCoord - uTexelSize); // top left
    vec4 c12 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y - uTexelSize.y)); // top center
    vec4 c13 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y - uTexelSize.y)); // top right

    vec4 c21 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y)); // mid left
    vec4 c22 = texture(uTexture, vTextureCoord); // mid center
    vec4 c23 = texture(uTexture, vec2(vTextureCoord.x + uTexelSize.x, vTextureCoord.y)); // mid right

    vec4 c31 = texture(uTexture, vec2(vTextureCoord.x - uTexelSize.x, vTextureCoord.y + uTexelSize.y)); // bottom left
    vec4 c32 = texture(uTexture, vec2(vTextureCoord.x, vTextureCoord.y + uTexelSize.y)); // bottom center
    vec4 c33 = texture(uTexture, vTextureCoord + uTexelSize); // bottom right

    finalColor =
        c11 * uMatrix[0][0] + c12 * uMatrix[0][1] + c13 * uMatrix[0][2] +
        c21 * uMatrix[1][0] + c22 * uMatrix[1][1] + c23 * uMatrix[1][2] +
        c31 * uMatrix[2][0] + c32 * uMatrix[2][1] + c33 * uMatrix[2][2];

    finalColor.a = c22.a;
}`,Gq=`struct ConvolutionUniforms {
    uMatrix: mat3x3<f32>,
    uTexelSize: vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> convolutionUniforms : ConvolutionUniforms;

@fragment
fn mainFragment(
    @location(0) uv: vec2<f32>,
    @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let texelSize = convolutionUniforms.uTexelSize;
    let matrix = convolutionUniforms.uMatrix;

    let c11: vec4<f32> = textureSample(uTexture, uSampler, uv - texelSize); // top left
    let c12: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y - texelSize.y)); // top center
    let c13: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y - texelSize.y)); // top right

    let c21: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y)); // mid left
    let c22: vec4<f32> = textureSample(uTexture, uSampler, uv); // mid center
    let c23: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x + texelSize.x, uv.y)); // mid right

    let c31: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x - texelSize.x, uv.y + texelSize.y)); // bottom left
    let c32: vec4<f32> = textureSample(uTexture, uSampler, vec2<f32>(uv.x, uv.y + texelSize.y)); // bottom center
    let c33: vec4<f32> = textureSample(uTexture, uSampler, uv + texelSize); // bottom right

    var finalColor: vec4<f32> = vec4<f32>(
        c11 * matrix[0][0] + c12 * matrix[0][1] + c13 * matrix[0][2] +
        c21 * matrix[1][0] + c22 * matrix[1][1] + c23 * matrix[1][2] +
        c31 * matrix[2][0] + c32 * matrix[2][1] + c33 * matrix[2][2]
    );

    finalColor.a = c22.a;

    return finalColor;
}`,zq=Object.defineProperty,Hq=(t,e,n)=>e in t?zq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,e5=(t,e,n)=>(Hq(t,typeof e!="symbol"?e+"":e,n),n);const Vq=class t5 extends le{constructor(...e){let n=e[0]??{};Array.isArray(n)&&(q("6.0.0","ConvolutionFilter constructor params are now options object. See params: { matrix, width, height }"),n={matrix:n},e[1]!==void 0&&(n.width=e[1]),e[2]!==void 0&&(n.height=e[2])),n={...t5.DEFAULT_OPTIONS,...n};const r=n.width??200,i=n.height??200,s=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:Gq,entryPoint:"mainFragment"}}),o=me.from({vertex:De,fragment:Nq,name:"convolution-filter"});super({gpuProgram:s,glProgram:o,resources:{convolutionUniforms:{uMatrix:{value:n.matrix,type:"mat3x3<f32>"},uTexelSize:{value:{x:1/r,y:1/i},type:"vec2<f32>"}}}}),e5(this,"uniforms"),this.uniforms=this.resources.convolutionUniforms.uniforms,this.width=r,this.height=i}get matrix(){return this.uniforms.uMatrix}set matrix(e){e.forEach((n,r)=>{this.uniforms.uMatrix[r]=n})}get width(){return 1/this.uniforms.uTexelSize.x}set width(e){this.uniforms.uTexelSize.x=1/e}get height(){return 1/this.uniforms.uTexelSize.y}set height(e){this.uniforms.uTexelSize.y=1/e}};e5(Vq,"DEFAULT_OPTIONS",{matrix:new Float32Array(9),width:200,height:200});var jq=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uLine;
uniform vec2 uNoise;
uniform vec3 uVignette;
uniform float uSeed;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

float vignette(vec3 co, vec2 coord)
{
    float outter = SQRT_2 - uVignette[0] * SQRT_2;
    vec2 dir = vec2(0.5) - coord;
    dir.y *= uDimensions.y / uDimensions.x;
    float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
    return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

float noise(vec2 coord)
{
    vec2 pixelCoord = coord * uInputSize.xy;
    pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
    pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
    return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

vec3 interlaceLines(vec3 co, vec2 coord)
{
    vec3 color = co;

    float curvature = uLine[0];
    float lineWidth = uLine[1];
    float lineContrast = uLine[2];
    float verticalLine = uLine[3];

    vec2 dir = vec2(coord * uInputSize.xy / uDimensions - 0.5);

    float _c = curvature > 0. ? curvature : 1.;
    float k = curvature > 0. ? (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
    vec2 uv = dir * k;
    float v = verticalLine > 0.5 ? uv.x * uDimensions.x : uv.y * uDimensions.y;
    v *= min(1.0, 2.0 / lineWidth ) / _c;
    float j = 1. + cos(v * 1.2 - uTime) * 0.5 * lineContrast;
    color *= j;

    float segment = verticalLine > 0.5 ? mod((dir.x + .5) * uDimensions.x, 4.) : mod((dir.y + .5) * uDimensions.y, 4.);
    color *= 0.99 + ceil(segment) * 0.015;

    return color;
}

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);
    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
    {
        float n = noise(vTextureCoord);
        finalColor += vec4(n, n, n, finalColor.a);
    }

    if (uVignette[0] > 0.)
    {
        float v = vignette(finalColor.rgb, coord);
        finalColor *= vec4(v, v, v, finalColor.a);
    }

    if (uLine[1] > 0.0)
    {
        finalColor = vec4(interlaceLines(finalColor.rgb, vTextureCoord), finalColor.a);  
    }
}
`,Wq=`struct CRTUniforms {
    uLine: vec4<f32>,
    uNoise: vec2<f32>,
    uVignette: vec3<f32>,
    uSeed: f32,
    uTime: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> crtUniforms : CRTUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let coord: vec2<f32> = uv * gfu.uInputSize.xy / crtUniforms.uDimensions;

  let uNoise = crtUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  if (crtUniforms.uVignette[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  if (crtUniforms.uLine[1] > 0.0)
  {
    color = vec4<f32>(vec3<f32>(interlaceLines(color.rgb, uv)), color.a);  
  }

  return color;
}

const SQRT_2: f32 = 1.414213;

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignette = crtUniforms.uVignette;
  let uDimensions = crtUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignette[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(0.5) - coord;
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = crtUniforms.uNoise;
  let uSeed = crtUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

fn interlaceLines(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;

  let uDimensions = crtUniforms.uDimensions;

  let curvature: f32 = crtUniforms.uLine[0];
  let lineWidth: f32 = crtUniforms.uLine[1];
  let lineContrast: f32 = crtUniforms.uLine[2];
  let verticalLine: f32 = crtUniforms.uLine[3];

  let dir: vec2<f32> = vec2<f32>(coord * gfu.uInputSize.xy / uDimensions - 0.5);

  let _c: f32 = select(1., curvature, curvature > 0.);
  let k: f32 = select(1., (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c), curvature > 0.);
  let uv: vec2<f32> = dir * k;
  let v: f32 = select(uv.y * uDimensions.y, uv.x * uDimensions.x, verticalLine > 0.5) * min(1.0, 2.0 / lineWidth ) / _c;
  let j: f32 = 1. + cos(v * 1.2 - crtUniforms.uTime) * 0.5 * lineContrast;
  color *= j;

  let segment: f32 = select(modulo((dir.y + .5) * uDimensions.y, 4.), modulo((dir.x + .5) * uDimensions.x, 4.), verticalLine > 0.5);
  color *= 0.99 + ceil(segment) * 0.015;

  return color;
}`,$q=Object.defineProperty,Xq=(t,e,n)=>e in t?$q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nd=(t,e,n)=>(Xq(t,typeof e!="symbol"?e+"":e,n),n);const Yq=class n5 extends le{constructor(e){e={...n5.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:Wq,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:jq,name:"crt-filter"});super({gpuProgram:n,glProgram:r,resources:{crtUniforms:{uLine:{value:new Float32Array(4),type:"vec4<f32>"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uVignette:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Nd(this,"uniforms"),Nd(this,"seed"),Nd(this,"time"),this.uniforms=this.resources.crtUniforms.uniforms,Object.assign(this,e)}apply(e,n,r,i){this.uniforms.uDimensions[0]=n.frame.width,this.uniforms.uDimensions[1]=n.frame.height,this.uniforms.uSeed=this.seed,this.uniforms.uTime=this.time,e.applyFilter(this,n,r,i)}get curvature(){return this.uniforms.uLine[0]}set curvature(e){this.uniforms.uLine[0]=e}get lineWidth(){return this.uniforms.uLine[1]}set lineWidth(e){this.uniforms.uLine[1]=e}get lineContrast(){return this.uniforms.uLine[2]}set lineContrast(e){this.uniforms.uLine[2]=e}get verticalLine(){return this.uniforms.uLine[3]>.5}set verticalLine(e){this.uniforms.uLine[3]=e?1:0}get noise(){return this.uniforms.uNoise[0]}set noise(e){this.uniforms.uNoise[0]=e}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(e){this.uniforms.uNoise[1]=e}get vignetting(){return this.uniforms.uVignette[0]}set vignetting(e){this.uniforms.uVignette[0]=e}get vignettingAlpha(){return this.uniforms.uVignette[1]}set vignettingAlpha(e){this.uniforms.uVignette[1]=e}get vignettingBlur(){return this.uniforms.uVignette[2]}set vignettingBlur(e){this.uniforms.uVignette[2]=e}};Nd(Yq,"DEFAULT_OPTIONS",{curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0,seed:0});var qq=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uAngle;
uniform float uScale;
uniform bool uGrayScale;

uniform vec4 uInputSize;

float pattern()
{
    float s = sin(uAngle), c = cos(uAngle);
    vec2 tex = vTextureCoord * uInputSize.xy;
    vec2 point = vec2(
        c * tex.x - s * tex.y,
        s * tex.x + c * tex.y
    ) * uScale;
    return (sin(point.x) * sin(point.y)) * 4.0;
    }

    void main()
    {
    vec4 color = texture(uTexture, vTextureCoord);
    vec3 colorRGB = vec3(color);

    if (uGrayScale)
    {
        colorRGB = vec3(color.r + color.g + color.b) / 3.0;
    }

    finalColor = vec4(colorRGB * 10.0 - 5.0 + pattern(), color.a);
}
`,Kq=`struct DotUniforms {
  uScale:f32,
  uAngle:f32,
  uGrayScale:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> dotUniforms : DotUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let gray: vec3<f32> = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)));
  // dotUniforms.uGrayScale == 1 doesn't ever pass so it is converted to a float and compared to 0.5 instead 
  let finalColor: vec3<f32> = select(color.rgb, gray, f32(dotUniforms.uGrayScale) >= 0.5);

  return vec4<f32>(finalColor * 10.0 - 5.0 + pattern(uv), color.a);
}

fn pattern(uv: vec2<f32>) -> f32
{
  let s: f32 = sin(dotUniforms.uAngle);
  let c: f32 = cos(dotUniforms.uAngle);
  
  let tex: vec2<f32> = uv * gfu.uInputSize.xy;
  
  let p: vec2<f32> = vec2<f32>(
      c * tex.x - s * tex.y,
      s * tex.x + c * tex.y
  ) * dotUniforms.uScale;

  return (sin(p.x) * sin(p.y)) * 4.0;
}`,Qq=Object.defineProperty,Zq=(t,e,n)=>e in t?Qq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jq=(t,e,n)=>(Zq(t,e+"",n),n);const eK=class r5 extends le{constructor(...e){let n=e[0]??{};typeof n=="number"&&(q("6.0.0","DotFilter constructor params are now options object. See params: { scale, angle, grayscale }"),n={scale:n},e[1]!==void 0&&(n.angle=e[1]),e[2]!==void 0&&(n.grayscale=e[2])),n={...r5.DEFAULT_OPTIONS,...n};const r={uScale:{value:n.scale,type:"f32"},uAngle:{value:n.angle,type:"f32"},uGrayScale:{value:n.grayscale?1:0,type:"f32"}},i=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:Kq,entryPoint:"mainFragment"}}),s=me.from({vertex:De,fragment:qq,name:"dot-filter"});super({gpuProgram:i,glProgram:s,resources:{dotUniforms:r}})}get scale(){return this.resources.dotUniforms.uniforms.uScale}set scale(e){this.resources.dotUniforms.uniforms.uScale=e}get angle(){return this.resources.dotUniforms.uniforms.uAngle}set angle(e){this.resources.dotUniforms.uniforms.uAngle=e}get grayscale(){return this.resources.dotUniforms.uniforms.uGrayScale===1}set grayscale(e){this.resources.dotUniforms.uniforms.uGrayScale=e?1:0}};Jq(eK,"DEFAULT_OPTIONS",{scale:1,angle:5,grayscale:!0});var tK=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uAlpha;
uniform vec3 uColor;
uniform vec2 uOffset;

uniform vec4 uInputSize;

void main(void){
    vec4 sample = texture(uTexture, vTextureCoord - uOffset * uInputSize.zw);

    // Premultiply alpha
    sample.rgb = uColor.rgb * sample.a;

    // alpha user alpha
    sample *= uAlpha;

    finalColor = sample;
}`,nK=`struct DropShadowUniforms {
  uAlpha: f32,
  uColor: vec3<f32>,
  uOffset: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> dropShadowUniforms : DropShadowUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv - dropShadowUniforms.uOffset * gfu.uInputSize.zw);

  // Premultiply alpha
  color = vec4<f32>(vec3<f32>(dropShadowUniforms.uColor.rgb * color.a), color.a);
  // alpha user alpha
  color *= dropShadowUniforms.uAlpha;

  return color;
}`,rK=Object.defineProperty,iK=(t,e,n)=>e in t?rK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Na=(t,e,n)=>(iK(t,typeof e!="symbol"?e+"":e,n),n);const sK=class i5 extends le{constructor(e){e={...i5.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:nK,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:tK,name:"drop-shadow-filter"});super({gpuProgram:n,glProgram:r,resources:{dropShadowUniforms:{uAlpha:{value:e.alpha,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},resolution:e.resolution}),Na(this,"uniforms"),Na(this,"shadowOnly",!1),Na(this,"_color"),Na(this,"_blurFilter"),Na(this,"_basePass"),this.uniforms=this.resources.dropShadowUniforms.uniforms,this._color=new ve,this.color=e.color??0,this._blurFilter=new GF({strength:e.kernels??e.blur,quality:e.kernels?void 0:e.quality}),this._basePass=new le({gpuProgram:he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:`
                    @group(0) @binding(1) var uTexture: texture_2d<f32>; 
                    @group(0) @binding(2) var uSampler: sampler;
                    @fragment
                    fn mainFragment(
                        @builtin(position) position: vec4<f32>,
                        @location(0) uv : vec2<f32>
                    ) -> @location(0) vec4<f32> {
                        return textureSample(uTexture, uSampler, uv);
                    }
                    `,entryPoint:"mainFragment"}}),glProgram:me.from({vertex:De,fragment:`
                in vec2 vTextureCoord;
                out vec4 finalColor;
                uniform sampler2D uTexture;

                void main(void){
                    finalColor = texture(uTexture, vTextureCoord);
                }
                `,name:"drop-shadow-filter"}),resources:{}}),Object.assign(this,e)}apply(e,n,r,i){const s=Ge.getSameSizeTexture(n);e.applyFilter(this,n,s,!0),this._blurFilter.apply(e,s,r,i),this.shadowOnly||e.applyFilter(this._basePass,n,r,!1),Ge.returnTexture(s)}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e,this._updatePadding()}get offsetX(){return this.offset.x}set offsetX(e){this.offset.x=e,this._updatePadding()}get offsetY(){return this.offset.y}set offsetY(e){this.offset.y=e,this._updatePadding()}get color(){return this._color.value}set color(e){this._color.setValue(e);const[n,r,i]=this._color.toArray();this.uniforms.uColor[0]=n,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get blur(){return this._blurFilter.strength}set blur(e){this._blurFilter.strength=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e,this._updatePadding()}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){typeof e=="number"&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._blurFilter.pixelSize=e}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(e){this._blurFilter.pixelSizeX=e}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(e){this._blurFilter.pixelSizeY=e}_updatePadding(){const e=Math.max(Math.abs(this.offsetX),Math.abs(this.offsetY));this.padding=e+this.blur*2+this.quality*4}};Na(sK,"DEFAULT_OPTIONS",{offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:void 0,blur:2,quality:3,pixelSize:{x:1,y:1},resolution:1});var oK=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uDisplacementMap;
uniform float uSeed;
uniform vec2 uDimensions;
uniform float uAspect;
uniform float uFillMode;
uniform float uOffset;
uniform float uDirection;
uniform vec2 uRed;
uniform vec2 uGreen;
uniform vec2 uBlue;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * uInputSize.xy) / uDimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float sinDir = sin(uDirection);
    float cosDir = cos(uDirection);

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * uAspect;
    float ny = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture(uDisplacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (uOffset / uInputSize.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * uAspect);

    int fillMode = int(uFillMode);

    if (fillMode == CLAMP) {
        coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    } else {
        if( coord.x > uInputClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= uInputClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = uInputClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < uInputClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += uInputClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -uInputClamp.z;
            }
        }

        if( coord.y > uInputClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= uInputClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = uInputClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < uInputClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += uInputClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -uInputClamp.w;
            }
        }
    }

    finalColor.r = texture(uTexture, coord + uRed * (1.0 - uSeed * 0.4) / uInputSize.xy).r;
    finalColor.g = texture(uTexture, coord + uGreen * (1.0 - uSeed * 0.3) / uInputSize.xy).g;
    finalColor.b = texture(uTexture, coord + uBlue * (1.0 - uSeed * 0.2) / uInputSize.xy).b;
    finalColor.a = texture(uTexture, coord).a;
}
`,aK=`struct GlitchUniforms {
  uSeed: f32,
  uDimensions: vec2<f32>,
  uAspect: f32,
  uFillMode: f32,
  uOffset: f32,
  uDirection: f32,
  uRed: vec2<f32>,
  uGreen: vec2<f32>,
  uBlue: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> glitchUniforms : GlitchUniforms;
@group(1) @binding(1) var uDisplacementMap: texture_2d<f32>; 
@group(1) @binding(2) var uDisplacementSampler: sampler; 

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uSeed: f32 = glitchUniforms.uSeed;
  let uDimensions: vec2<f32> = glitchUniforms.uDimensions;
  let uAspect: f32 = glitchUniforms.uAspect;
  let uOffset: f32 = glitchUniforms.uOffset;
  let uDirection: f32 = glitchUniforms.uDirection;
  let uRed: vec2<f32> = glitchUniforms.uRed;
  let uGreen: vec2<f32> = glitchUniforms.uGreen;
  let uBlue: vec2<f32> = glitchUniforms.uBlue;

  let uInputSize: vec4<f32> = gfu.uInputSize;
  let uInputClamp: vec4<f32> = gfu.uInputClamp;

  var discarded: bool = false;
  var coord: vec2<f32> = (uv * uInputSize.xy) / uDimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
      discarded = true;
    }

    let sinDir: f32 = sin(uDirection);
    let cosDir: f32 = cos(uDirection);

    let cx: f32 = coord.x - 0.5;
    let cy: f32 = (coord.y - 0.5) * uAspect;
    var ny: f32 = (-sinDir * cx + cosDir * cy) / uAspect + 0.5;

    ny = select(select(ny, -ny, ny < 0.0), 2.0 - ny, ny > 1.0);

    let dc: vec4<f32> = textureSample(uDisplacementMap, uDisplacementSampler, vec2<f32>(0.5, ny));

    let displacement: f32 = (dc.r - dc.g) * (uOffset / uInputSize.x);

    coord = uv + vec2<f32>(cosDir * displacement, sinDir * displacement * uAspect);

    let fillMode: i32 = i32(glitchUniforms.uFillMode);

    if (fillMode == CLAMP) {
      coord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    } else {
      if (coord.x > uInputClamp.z) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.x = coord.x - uInputClamp.z;
        } else if (fillMode == MIRROR) {
          coord.x = uInputClamp.z * 2.0 - coord.x;
        }
      } else if (coord.x < uInputClamp.x) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.x = coord.x + uInputClamp.z;
        } else if (fillMode == MIRROR) {
          coord.x = coord.x * -uInputClamp.z;
        }
      }

      if (coord.y > uInputClamp.w) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.y = coord.y - uInputClamp.w;
        } else if (fillMode == MIRROR) {
          coord.y = uInputClamp.w * 2.0 - coord.y;
        }
      } else if (coord.y < uInputClamp.y) {
        if (fillMode == TRANSPARENT) {
          discarded = true;
        } else if (fillMode == LOOP) {
          coord.y = coord.y + uInputClamp.w;
        } else if (fillMode == MIRROR) {
          coord.y = coord.y * -uInputClamp.w;
        }
      }
    }

    let seedR: f32 = 1.0 - uSeed * 0.4;
    let seedG: f32 = 1.0 - uSeed * 0.3;
    let seedB: f32 = 1.0 - uSeed * 0.2;

    let offsetR: vec2<f32> = vec2(uRed.x * seedR / uInputSize.x, uRed.y * seedR / uInputSize.y);
    let offsetG: vec2<f32> = vec2(uGreen.x * seedG / uInputSize.x, uGreen.y * seedG / uInputSize.y);
    let offsetB: vec2<f32> = vec2(uBlue.x * seedB / uInputSize.x, uBlue.y * seedB / uInputSize.y);

    let r = textureSample(uTexture, uSampler, coord + offsetR).r;
    let g = textureSample(uTexture, uSampler, coord + offsetG).g;
    let b = textureSample(uTexture, uSampler, coord + offsetB).b;
    let a = textureSample(uTexture, uSampler, coord).a;

    return select(vec4<f32>(r, g, b, a), vec4<f32>(0.0,0.0,0.0,0.0), discarded);
}

const TRANSPARENT: i32 = 0;
const ORIGINAL: i32 = 1;
const LOOP: i32 = 2;
const CLAMP: i32 = 3;
const MIRROR: i32 = 4;`,uK=Object.defineProperty,lK=(t,e,n)=>e in t?uK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,si=(t,e,n)=>(lK(t,typeof e!="symbol"?e+"":e,n),n);const cK=class s5 extends le{constructor(e){e={...s5.defaults,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:aK,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:oK,name:"glitch-filter"}),i=document.createElement("canvas");i.width=4,i.height=e.sampleSize??512;const s=new X({source:new Zs({resource:i})});super({gpuProgram:n,glProgram:r,resources:{glitchUniforms:{uSeed:{value:e?.seed??0,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"},uAspect:{value:1,type:"f32"},uFillMode:{value:e?.fillMode??0,type:"f32"},uOffset:{value:e?.offset??100,type:"f32"},uDirection:{value:e?.direction??0,type:"f32"},uRed:{value:e.red,type:"vec2<f32>"},uGreen:{value:e.green,type:"vec2<f32>"},uBlue:{value:e.blue,type:"vec2<f32>"}},uDisplacementMap:s.source,uDisplacementSampler:s.source.style}}),si(this,"uniforms"),si(this,"average",!1),si(this,"minSize",8),si(this,"sampleSize",512),si(this,"_canvas"),si(this,"texture"),si(this,"_slices",0),si(this,"_sizes",new Float32Array(1)),si(this,"_offsets",new Float32Array(1)),this.uniforms=this.resources.glitchUniforms.uniforms,this._canvas=i,this.texture=s,Object.assign(this,e)}apply(e,n,r,i){const{width:s,height:o}=n.frame;this.uniforms.uDimensions[0]=s,this.uniforms.uDimensions[1]=o,this.uniforms.uAspect=o/s,e.applyFilter(this,n,r,i)}_randomizeSizes(){const e=this._sizes,n=this._slices-1,r=this.sampleSize,i=Math.min(this.minSize/r,.9/this._slices);if(this.average){const s=this._slices;let o=1;for(let a=0;a<n;a++){const c=o/(s-a),h=Math.max(c*(1-Math.random()*.6),i);e[a]=h,o-=h}e[n]=o}else{let s=1;const o=Math.sqrt(1/this._slices);for(let a=0;a<n;a++){const c=Math.max(o*s*Math.random(),i);e[a]=c,s-=c}e[n]=s}this.shuffle()}shuffle(){const e=this._sizes,n=this._slices-1;for(let r=n;r>0;r--){const i=Math.random()*r>>0,s=e[r];e[r]=e[i],e[i]=s}}_randomizeOffsets(){for(let e=0;e<this._slices;e++)this._offsets[e]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const e=this.sampleSize,n=this.texture,r=this._canvas.getContext("2d");r.clearRect(0,0,8,e);let i,s=0;for(let o=0;o<this._slices;o++){i=Math.floor(this._offsets[o]*256);const a=this._sizes[o]*e,c=i>0?i:0,h=i<0?-i:0;r.fillStyle=`rgba(${c}, ${h}, 0, 1)`,r.fillRect(0,s>>0,e,a+1>>0),s+=a}n.source.update()}set sizes(e){const n=Math.min(this._slices,e.length);for(let r=0;r<n;r++)this._sizes[r]=e[r]}get sizes(){return this._sizes}set offsets(e){const n=Math.min(this._slices,e.length);for(let r=0;r<n;r++)this._offsets[r]=e[r]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(e){this._slices!==e&&(this._slices=e,this._sizes=new Float32Array(e),this._offsets=new Float32Array(e),this.refresh())}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}get fillMode(){return this.uniforms.uFillMode}set fillMode(e){this.uniforms.uFillMode=e}get direction(){return this.uniforms.uDirection/Ho}set direction(e){this.uniforms.uDirection=e*Ho}get red(){return this.uniforms.uRed}set red(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uRed=e}get green(){return this.uniforms.uGreen}set green(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uGreen=e}get blue(){return this.uniforms.uBlue}set blue(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uBlue=e}destroy(){this.texture?.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};si(cK,"defaults",{slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:{x:0,y:0},green:{x:0,y:0},blue:{x:0,y:0},minSize:8,sampleSize:512});var hK=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uStrength;
uniform vec3 uColor;
uniform float uKnockout;
uniform float uAlpha;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const float PI = 3.14159265358979323846264;

// Hard-assignment of DIST and ANGLE_STEP_SIZE instead of using uDistance and uQuality to allow them to be use on GLSL loop conditions
const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.);
const float ANGLE_STEP_NUM = ceil(PI * 2. / ANGLE_STEP_SIZE);
const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.) / 2.;

void main(void) {
    vec2 px = vec2(1.) / uInputSize.xy;

    float totalAlpha = 0.;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.; angle < PI * 2.; angle += ANGLE_STEP_SIZE) {
      direction = vec2(cos(angle), sin(angle)) * px;

      for (float curDistance = 0.; curDistance < DIST; curDistance++) {
          displaced = clamp(vTextureCoord + direction * (curDistance + 1.), uInputClamp.xy, uInputClamp.zw);
          curColor = texture(uTexture, displaced);
          totalAlpha += (DIST - curDistance) * curColor.a;
      }
    }
    
    curColor = texture(uTexture, vTextureCoord);

    vec4 glowColor = vec4(uColor, uAlpha);
    bool knockout = uKnockout > .5;
    float innerStrength = uStrength[0];
    float outerStrength = uStrength[1];

    float alphaRatio = totalAlpha / MAX_TOTAL_ALPHA;
    float innerGlowAlpha = (1. - alphaRatio) * innerStrength * curColor.a * uAlpha;
    float innerGlowStrength = min(1., innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);
    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a) * uAlpha;
    float outerGlowStrength = min(1. - innerColor.a, outerGlowAlpha);
    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;

    if (knockout) {
      float resultAlpha = outerGlowAlpha + innerGlowAlpha;
      finalColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      finalColor = innerColor + outerGlowColor;
    }
}
`,fK=`struct GlowUniforms {
  uDistance: f32,
  uStrength: vec2<f32>,
  uColor: vec3<f32>,
  uAlpha: f32,
  uQuality: f32,
  uKnockout: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> glowUniforms : GlowUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let quality = glowUniforms.uQuality;
  let distance = glowUniforms.uDistance;

  let dist: f32 = glowUniforms.uDistance;
  let angleStepSize: f32 = min(1. / quality / distance, PI * 2.0);
  let angleStepNum: f32 = ceil(PI * 2.0 / angleStepSize);

  let px: vec2<f32> = vec2<f32>(1.0 / gfu.uInputSize.xy);

  var totalAlpha: f32 = 0.0;

  var direction: vec2<f32>;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.0; angle < PI * 2.0; angle += angleStepSize) {
    direction = vec2<f32>(cos(angle), sin(angle)) * px;
    for (var curDistance = 0.0; curDistance < dist; curDistance+=1) {
      displaced = vec2<f32>(clamp(uv + direction * (curDistance + 1.0), gfu.uInputClamp.xy, gfu.uInputClamp.zw));
      curColor = textureSample(uTexture, uSampler, displaced);
      totalAlpha += (dist - curDistance) * curColor.a;
    }
  }
    
  curColor = textureSample(uTexture, uSampler, uv);

  let glowColorRGB = glowUniforms.uColor;
  let glowAlpha = glowUniforms.uAlpha;
  let glowColor = vec4<f32>(glowColorRGB, glowAlpha);
  let knockout: bool = glowUniforms.uKnockout > 0.5;
  let innerStrength = glowUniforms.uStrength[0];
  let outerStrength = glowUniforms.uStrength[1];

  let alphaRatio: f32 = (totalAlpha / (angleStepNum * dist * (dist + 1.0) / 2.0));
  let innerGlowAlpha: f32 = (1.0 - alphaRatio) * innerStrength * curColor.a * glowAlpha;
  let innerGlowStrength: f32 = min(1.0, innerGlowAlpha);
  
  let innerColor: vec4<f32> = mix(curColor, glowColor, innerGlowStrength);
  let outerGlowAlpha: f32 = alphaRatio * outerStrength * (1. - curColor.a) * glowAlpha;
  let outerGlowStrength: f32 = min(1.0 - innerColor.a, outerGlowAlpha);
  let outerGlowColor: vec4<f32> = outerGlowStrength * glowColor.rgba;
  
  if (knockout) {
    let resultAlpha: f32 = outerGlowAlpha + innerGlowAlpha;
    return vec4<f32>(glowColor.rgb * resultAlpha, resultAlpha);
  }
  else {
    return innerColor + outerGlowColor;
  }
}

const PI: f32 = 3.14159265358979323846264;`,dK=Object.defineProperty,pK=(t,e,n)=>e in t?dK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,K2=(t,e,n)=>(pK(t,typeof e!="symbol"?e+"":e,n),n);const mK=class o5 extends le{constructor(e){e={...o5.DEFAULT_OPTIONS,...e};const n=e.distance??10,r=e.quality??.1,i=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:fK,entryPoint:"mainFragment"}}),s=me.from({vertex:De,fragment:hK.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/r/n).toFixed(7)}`).replace(/__DIST__/gi,`${n.toFixed(0)}.0`),name:"glow-filter"});super({gpuProgram:i,glProgram:s,resources:{glowUniforms:{uDistance:{value:n,type:"f32"},uStrength:{value:[e.innerStrength,e.outerStrength],type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:e.alpha,type:"f32"},uQuality:{value:r,type:"f32"},uKnockout:{value:e?.knockout??!1?1:0,type:"f32"}}},padding:n}),K2(this,"uniforms"),K2(this,"_color"),this.uniforms=this.resources.glowUniforms.uniforms,this._color=new ve,this.color=e.color??16777215}get distance(){return this.uniforms.uDistance}set distance(e){this.uniforms.uDistance=this.padding=e}get innerStrength(){return this.uniforms.uStrength[0]}set innerStrength(e){this.uniforms.uStrength[0]=e}get outerStrength(){return this.uniforms.uStrength[1]}set outerStrength(e){this.uniforms.uStrength[1]=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[n,r,i]=this._color.toArray();this.uniforms.uColor[0]=n,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get quality(){return this.uniforms.uQuality}set quality(e){this.uniforms.uQuality=e}get knockout(){return this.uniforms.uKnockout===1}set knockout(e){this.uniforms.uKnockout=e?1:0}};K2(mK,"DEFAULT_OPTIONS",{distance:10,outerStrength:4,innerStrength:0,color:16777215,alpha:1,quality:.1,knockout:!1});var gK=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uDimensions;
uniform float uParallel;
uniform vec2 uLight;
uniform float uAspect;
uniform float uTime;
uniform vec3 uRay;

uniform vec4 uInputSize;

\${PERLIN}

void main(void) {
    vec2 uDimensions = uDimensions;
    bool uParallel = uParallel > 0.5;
    vec2 uLight = uLight;
    float uAspect = uAspect;

    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    float d;

    if (uParallel) {
        float _cos = uLight.x;
        float _sin = uLight.y;
        d = (_cos * coord.x) + (_sin * coord.y * uAspect);
    } else {
        float dx = coord.x - uLight.x / uDimensions.x;
        float dy = (coord.y - uLight.y / uDimensions.y) * uAspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    float uTime = uTime;
    vec3 uRay = uRay;

    float gain = uRay[0];
    float lacunarity = uRay[1];
    float alpha = uRay[2];

    vec3 dir = vec3(d, d, 0.0);
    float noise = turb(dir + vec3(uTime, 0.0, 62.1 + uTime) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(vec3(noise), 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    finalColor = texture(uTexture, vTextureCoord) + mist;
}
`,vK=`struct GodrayUniforms {
  uLight: vec2<f32>,
  uParallel: f32,
  uAspect: f32,
  uTime: f32,
  uRay: vec3<f32>,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> godrayUniforms : GodrayUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uDimensions: vec2<f32> = godrayUniforms.uDimensions;
  let uParallel: bool = godrayUniforms.uParallel > 0.5;
  let uLight: vec2<f32> = godrayUniforms.uLight;
  let uAspect: f32 = godrayUniforms.uAspect;

  let coord: vec2<f32> = uv * gfu.uInputSize.xy / uDimensions;

  var d: f32;

  if (uParallel) {
    let _cos: f32 = uLight.x;
    let _sin: f32 = uLight.y;
    d = (_cos * coord.x) + (_sin * coord.y * uAspect);
  } else {
    let dx: f32 = coord.x - uLight.x / uDimensions.x;
    let dy: f32 = (coord.y - uLight.y / uDimensions.y) * uAspect;
    let dis: f32 = sqrt(dx * dx + dy * dy) + 0.00001;
    d = dy / dis;
  }

  let uTime: f32 = godrayUniforms.uTime;
  let uRay: vec3<f32> = godrayUniforms.uRay;
  
  let gain = uRay[0];
  let lacunarity = uRay[1];
  let alpha = uRay[2];

  let dir: vec3<f32> = vec3<f32>(d, d, 0.0);
  var noise: f32 = turb(dir + vec3<f32>(uTime, 0.0, 62.1 + uTime) * 0.05, vec3<f32>(480.0, 320.0, 480.0), lacunarity, gain);
  noise = mix(noise, 0.0, 0.3);
  //fade vertically.
  var mist: vec4<f32> = vec4<f32>(vec3<f32>(noise), 1.0) * (1.0 - coord.y);
  mist.a = 1.0;
  // apply user alpha
  mist *= alpha;
  return textureSample(uTexture, uSampler, uv) + mist;
}

\${PERLIN}`,_K=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,xK=`// Taken from https://gist.github.com/munrocket/236ed5ba7e409b8bdf1ff6eca5dcdc39

fn moduloVec3(x: vec3<f32>, y: vec3<f32>) -> vec3<f32>
{
  return x - y * floor(x/y);
}
fn mod289Vec3(x: vec3<f32>) -> vec3<f32>
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
fn mod289Vec4(x: vec4<f32>) -> vec4<f32>
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
fn permute4(x: vec4<f32>) -> vec4<f32>
{
    return mod289Vec4(((x * 34.0) + 1.0) * x);
}
fn taylorInvSqrt(r: vec4<f32>) -> vec4<f32>
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
fn fade3(t: vec3<f32>) -> vec3<f32>
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
fn fade2(t: vec2<f32>) -> vec2<f32> { return t * t * t * (t * (t * 6. - 15.) + 10.); }

fn perlinNoise2(P: vec2<f32>) -> f32 {
  var Pi: vec4<f32> = floor(P.xyxy) + vec4<f32>(0., 0., 1., 1.);
  let Pf = fract(P.xyxy) - vec4<f32>(0., 0., 1., 1.);
  Pi = Pi % vec4<f32>(289.); // To avoid truncation effects in permutation
  let ix = Pi.xzxz;
  let iy = Pi.yyww;
  let fx = Pf.xzxz;
  let fy = Pf.yyww;
  let i = permute4(permute4(ix) + iy);
  var gx: vec4<f32> = 2. * fract(i * 0.0243902439) - 1.; // 1/41 = 0.024...
  let gy = abs(gx) - 0.5;
  let tx = floor(gx + 0.5);
  gx = gx - tx;
  var g00: vec2<f32> = vec2<f32>(gx.x, gy.x);
  var g10: vec2<f32> = vec2<f32>(gx.y, gy.y);
  var g01: vec2<f32> = vec2<f32>(gx.z, gy.z);
  var g11: vec2<f32> = vec2<f32>(gx.w, gy.w);
  let norm = 1.79284291400159 - 0.85373472095314 *
      vec4<f32>(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11));
  g00 = g00 * norm.x;
  g01 = g01 * norm.y;
  g10 = g10 * norm.z;
  g11 = g11 * norm.w;
  let n00 = dot(g00, vec2<f32>(fx.x, fy.x));
  let n10 = dot(g10, vec2<f32>(fx.y, fy.y));
  let n01 = dot(g01, vec2<f32>(fx.z, fy.z));
  let n11 = dot(g11, vec2<f32>(fx.w, fy.w));
  let fade_xy = fade2(Pf.xy);
  let n_x = mix(vec2<f32>(n00, n01), vec2<f32>(n10, n11), vec2<f32>(fade_xy.x));
  let n_xy = mix(n_x.x, n_x.y, fade_xy.y);
  return 2.3 * n_xy;
}

// Classic Perlin noise, periodic variant
fn perlinNoise3(P: vec3<f32>, rep: vec3<f32>) -> f32
{
    var Pi0: vec3<f32> = moduloVec3(floor(P), rep); // Integer part, modulo period
    var Pi1: vec3<f32> = moduloVec3(Pi0 + vec3<f32>(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289Vec3(Pi0);
    Pi1 = mod289Vec3(Pi1);
    let Pf0: vec3<f32> = fract(P); // Fractional part for interpolation
    let Pf1: vec3<f32> = Pf0 - vec3<f32>(1.0); // Fractional part - 1.0
    let ix: vec4<f32> = vec4<f32>(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    let iy: vec4<f32> = vec4<f32>(Pi0.yy, Pi1.yy);
    let iz0: vec4<f32> = Pi0.zzzz;
    let iz1: vec4<f32> = Pi1.zzzz;
    let ixy: vec4<f32> = permute4(permute4(ix) + iy);
    let ixy0: vec4<f32> = permute4(ixy + iz0);
    let ixy1: vec4<f32> = permute4(ixy + iz1);
    var gx0: vec4<f32> = ixy0 * (1.0 / 7.0);
    var gy0: vec4<f32> = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    let gz0: vec4<f32> = vec4<f32>(0.5) - abs(gx0) - abs(gy0);
    let sz0: vec4<f32> = step(gz0, vec4<f32>(0.0));
    gx0 -= sz0 * (step(vec4<f32>(0.0), gx0) - 0.5);
    gy0 -= sz0 * (step(vec4<f32>(0.0), gy0) - 0.5);
    var gx1: vec4<f32> = ixy1 * (1.0 / 7.0);
    var gy1: vec4<f32> = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    let gz1: vec4<f32> = vec4<f32>(0.5) - abs(gx1) - abs(gy1);
    let sz1: vec4<f32> = step(gz1, vec4<f32>(0.0));
    gx1 -= sz1 * (step(vec4<f32>(0.0), gx1) - 0.5);
    gy1 -= sz1 * (step(vec4<f32>(0.0), gy1) - 0.5);
    var g000: vec3<f32> = vec3<f32>(gx0.x, gy0.x, gz0.x);
    var g100: vec3<f32> = vec3<f32>(gx0.y, gy0.y, gz0.y);
    var g010: vec3<f32> = vec3<f32>(gx0.z, gy0.z, gz0.z);
    var g110: vec3<f32> = vec3<f32>(gx0.w, gy0.w, gz0.w);
    var g001: vec3<f32> = vec3<f32>(gx1.x, gy1.x, gz1.x);
    var g101: vec3<f32> = vec3<f32>(gx1.y, gy1.y, gz1.y);
    var g011: vec3<f32> = vec3<f32>(gx1.z, gy1.z, gz1.z);
    var g111: vec3<f32> = vec3<f32>(gx1.w, gy1.w, gz1.w);
    let norm0: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    let norm1: vec4<f32> = taylorInvSqrt(vec4<f32>(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    let n000: f32 = dot(g000, Pf0);
    let n100: f32 = dot(g100, vec3<f32>(Pf1.x, Pf0.yz));
    let n010: f32 = dot(g010, vec3<f32>(Pf0.x, Pf1.y, Pf0.z));
    let n110: f32 = dot(g110, vec3<f32>(Pf1.xy, Pf0.z));
    let n001: f32 = dot(g001, vec3<f32>(Pf0.xy, Pf1.z));
    let n101: f32 = dot(g101, vec3<f32>(Pf1.x, Pf0.y, Pf1.z));
    let n011: f32 = dot(g011, vec3<f32>(Pf0.x, Pf1.yz));
    let n111: f32 = dot(g111, Pf1);
    let fade_xyz: vec3<f32> = fade3(Pf0);
    let n_z: vec4<f32> = mix(vec4<f32>(n000, n100, n010, n110), vec4<f32>(n001, n101, n011, n111), fade_xyz.z);
    let n_yz: vec2<f32> = mix(n_z.xy, n_z.zw, fade_xyz.y);
    let n_xyz: f32 = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
fn turb(P: vec3<f32>, rep: vec3<f32>, lacunarity: f32, gain: f32) -> f32
{
    var sum: f32 = 0.0;
    var sc: f32 = 1.0;
    var totalgain: f32 = 1.0;
    for (var i = 0.0; i < 6.0; i += 1)
    {
        sum += totalgain * perlinNoise3(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}`,yK=Object.defineProperty,bK=(t,e,n)=>e in t?yK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ga=(t,e,n)=>(bK(t,typeof e!="symbol"?e+"":e,n),n);const SK=class a5 extends le{constructor(e){e={...a5.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:vK.replace("${PERLIN}",xK),entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:gK.replace("${PERLIN}",_K),name:"god-ray-filter"});super({gpuProgram:n,glProgram:r,resources:{godrayUniforms:{uLight:{value:new Float32Array(2),type:"vec2<f32>"},uParallel:{value:0,type:"f32"},uAspect:{value:0,type:"f32"},uTime:{value:e.time,type:"f32"},uRay:{value:new Float32Array(3),type:"vec3<f32>"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),Ga(this,"uniforms"),Ga(this,"time",0),Ga(this,"_angleLight",[0,0]),Ga(this,"_angle",0),Ga(this,"_center"),this.uniforms=this.resources.godrayUniforms.uniforms,Object.assign(this,e)}apply(e,n,r,i){const s=n.frame.width,o=n.frame.height;this.uniforms.uLight[0]=this.parallel?this._angleLight[0]:this._center.x,this.uniforms.uLight[1]=this.parallel?this._angleLight[1]:this._center.y,this.uniforms.uDimensions[0]=s,this.uniforms.uDimensions[1]=o,this.uniforms.uAspect=o/s,this.uniforms.uTime=this.time,e.applyFilter(this,n,r,i)}get angle(){return this._angle}set angle(e){this._angle=e;const n=e*Ho;this._angleLight[0]=Math.cos(n),this._angleLight[1]=Math.sin(n)}get parallel(){return this.uniforms.uParallel>.5}set parallel(e){this.uniforms.uParallel=e?1:0}get center(){return this._center}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._center=e}get centerX(){return this.center.x}set centerX(e){this.center.x=e}get centerY(){return this.center.y}set centerY(e){this.center.y=e}get gain(){return this.uniforms.uRay[0]}set gain(e){this.uniforms.uRay[0]=e}get lacunarity(){return this.uniforms.uRay[1]}set lacunarity(e){this.uniforms.uRay[1]=e}get alpha(){return this.uniforms.uRay[2]}set alpha(e){this.uniforms.uRay[2]=e}};Ga(SK,"DEFAULT_OPTIONS",{angle:30,gain:.5,lacunarity:2.5,parallel:!0,time:0,center:{x:0,y:0},alpha:1});var wK=`in vec2 vTextureCoord;

out vec4 finalColor;

uniform sampler2D uTexture;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

void main()
{
    vec4 c = texture(uTexture, vTextureCoord);
    finalColor = vec4(
        vec3(c.r * weight.r + c.g * weight.g  + c.b * weight.b),
        c.a
    );
}
`,CK=`@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  let color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  let g: f32 = dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114));
  return vec4<f32>(vec3<f32>(g), 1.);
}`;class TK extends le{constructor(){const e=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:CK,entryPoint:"mainFragment"}}),n=me.from({vertex:De,fragment:wK,name:"grayscale-filter"});super({gpuProgram:e,glProgram:n,resources:{}})}}var EK=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec3 uHsl;
uniform float uAlpha;
uniform float uColorize;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    vec3 resultRGB = color.rgb;

    float hue = uHsl[0];
    float saturation = uHsl[1];
    float lightness = uHsl[2];

    // colorize
    if (uColorize > 0.5) {
        resultRGB = vec3(getWeightedAverage(resultRGB), 0., 0.);
    }

    // hue
    resultRGB = hueShift(resultRGB, hue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;

    if (saturation > 0.) {
        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));
    } else {
        resultRGB -= (average - resultRGB) * saturation;
    }

    // lightness
    resultRGB = mix(resultRGB, vec3(ceil(lightness)) * color.a, abs(lightness));

    // alpha
    finalColor = mix(color, vec4(resultRGB, color.a), uAlpha);
}
`,AK=`struct HslUniforms {
  uHsl:vec3<f32>,
  uColorize:f32,
  uAlpha:f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> hslUniforms : HslUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
    let color: vec4<f32> = textureSample(uTexture, uSampler, uv);
    var resultRGB: vec3<f32> = color.rgb;

    let hue: f32 = hslUniforms.uHsl[0];
    let saturation: f32 = hslUniforms.uHsl[1];
    let lightness: f32 = hslUniforms.uHsl[2];

    // colorize
    if (hslUniforms.uColorize > 0.5) {
        resultRGB = vec3<f32>(dot(color.rgb, vec3<f32>(0.299, 0.587, 0.114)), 0., 0.);
    }

    // hue
    resultRGB = hueShift(resultRGB, hue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    let average: f32 = (resultRGB.r + resultRGB.g + resultRGB.b) / 3.0;

    if (saturation > 0.) {
        resultRGB += (average - resultRGB) * (1. - 1. / (1.001 - saturation));
    } else {
        resultRGB -= (average - resultRGB) * saturation;
    }

    // lightness
    resultRGB = mix(resultRGB, vec3<f32>(ceil(lightness)) * color.a, abs(lightness));

    // alpha
    return mix(color, vec4<f32>(resultRGB, color.a), hslUniforms.uAlpha);
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const k: vec3<f32> = vec3(0.57735, 0.57735, 0.57735);

fn hueShift(color: vec3<f32>, angle: f32) -> vec3<f32> 
{
    let cosAngle: f32 = cos(angle);
    return vec3<f32>(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}`,PK=Object.defineProperty,RK=(t,e,n)=>e in t?PK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Q2=(t,e,n)=>(RK(t,typeof e!="symbol"?e+"":e,n),n);const BK=class u5 extends le{constructor(e){e={...u5.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:AK,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:EK,name:"hsl-adjustment-filter"});super({gpuProgram:n,glProgram:r,resources:{hslUniforms:{uHsl:{value:new Float32Array(3),type:"vec3<f32>"},uColorize:{value:e.colorize?1:0,type:"f32"},uAlpha:{value:e.alpha,type:"f32"}}}}),Q2(this,"uniforms"),Q2(this,"_hue"),this.uniforms=this.resources.hslUniforms.uniforms,Object.assign(this,e)}get hue(){return this._hue}set hue(e){this._hue=e,this.uniforms.uHsl[0]=e*(Math.PI/180)}get saturation(){return this.uniforms.uHsl[1]}set saturation(e){this.uniforms.uHsl[1]=e}get lightness(){return this.uniforms.uHsl[2]}set lightness(e){this.uniforms.uHsl[2]=e}get colorize(){return this.uniforms.uColorize===1}set colorize(e){this.uniforms.uColorize=e?1:0}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};Q2(BK,"DEFAULT_OPTIONS",{hue:0,saturation:0,lightness:0,colorize:!1,alpha:1});var MK=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uVelocity;
uniform int uKernelSize;
uniform float uOffset;

uniform vec4 uInputSize;

const int MAX_KERNEL_SIZE = 2048;

// Notice:
// the perfect way:
//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);
// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.
// So use uKernelSize directly.

void main(void)
{
    vec4 color = texture(uTexture, vTextureCoord);

    if (uKernelSize == 0)
    {
        finalColor = color;
        return;
    }

    vec2 velocity = uVelocity / uInputSize.xy;
    float offset = -uOffset / length(uVelocity) - 0.5;
    int k = uKernelSize - 1;

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }
        vec2 bias = velocity * (float(i) / float(k) + offset);
        color += texture(uTexture, vTextureCoord + bias);
    }
    finalColor = color / float(uKernelSize);
}
`,DK=`struct MotionBlurUniforms {
  uVelocity: vec2<f32>,
  uKernelSize: f32,
  uOffset: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> motionBlurUniforms : MotionBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uVelocity = motionBlurUniforms.uVelocity;
  let uKernelSize = motionBlurUniforms.uKernelSize;
  let uOffset = motionBlurUniforms.uOffset;

  let velocity: vec2<f32> = uVelocity / gfu.uInputSize.xy;
  let offset: f32 = -uOffset / length(uVelocity) - 0.5;
  let k: i32 = i32(min(uKernelSize - 1, MAX_KERNEL_SIZE - 1));

  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  for(var i: i32 = 0; i < k; i += 1) {
    let bias: vec2<f32> = velocity * (f32(i) / f32(k) + offset);
    color += textureSample(uTexture, uSampler, uv + bias);
  }
  
  return select(color / f32(uKernelSize), textureSample(uTexture, uSampler, uv), uKernelSize == 0);
}

const MAX_KERNEL_SIZE: f32 = 2048;`,OK=Object.defineProperty,kK=(t,e,n)=>e in t?OK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z2=(t,e,n)=>(kK(t,typeof e!="symbol"?e+"":e,n),n);const FK=class l5 extends le{constructor(...e){let n=e[0]??{};if(Array.isArray(n)||"x"in n&&"y"in n||n instanceof xt){q("6.0.0","MotionBlurFilter constructor params are now options object. See params: { velocity, kernelSize, offset }");const s="x"in n?n.x:n[0],o="y"in n?n.y:n[1];n={velocity:{x:s,y:o}},e[1]!==void 0&&(n.kernelSize=e[1]),e[2]!==void 0&&(n.offset=e[2])}n={...l5.DEFAULT_OPTIONS,...n};const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:DK,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:MK,name:"motion-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{motionBlurUniforms:{uVelocity:{value:n.velocity,type:"vec2<f32>"},uKernelSize:{value:Math.trunc(n.kernelSize??5),type:"i32"},uOffset:{value:n.offset,type:"f32"}}}}),Z2(this,"uniforms"),Z2(this,"_kernelSize"),this.uniforms=this.resources.motionBlurUniforms.uniforms,Object.assign(this,n)}get velocity(){return this.uniforms.uVelocity}set velocity(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uVelocity=e,this._updateDirty()}get velocityX(){return this.velocity.x}set velocityX(e){this.velocity.x=e,this._updateDirty()}get velocityY(){return this.velocity.y}set velocityY(e){this.velocity.y=e,this._updateDirty()}get kernelSize(){return this._kernelSize}set kernelSize(e){this._kernelSize=e,this._updateDirty()}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}_updateDirty(){this.padding=(Math.max(Math.abs(this.velocityX),Math.abs(this.velocityY))>>0)+1,this.uniforms.uKernelSize=this.velocityX!==0||this.velocityY!==0?this._kernelSize:0}};Z2(FK,"DEFAULT_OPTIONS",{velocity:{x:0,y:0},kernelSize:5,offset:0});var IK=`in vec2 vTextureCoord;
out vec4 finalColor;

const int MAX_COLORS = \${MAX_COLORS};

uniform sampler2D uTexture;
uniform vec3 uOriginalColors[MAX_COLORS];
uniform vec3 uTargetColors[MAX_COLORS];
uniform float uTolerance;

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);

    float alpha = finalColor.a;
    if (alpha < 0.0001)
    {
      return;
    }

    vec3 color = finalColor.rgb / alpha;

    for(int i = 0; i < MAX_COLORS; i++)
    {
      vec3 origColor = uOriginalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      vec3 colorDiff = origColor - color;
      if (length(colorDiff) < uTolerance)
      {
        vec3 targetColor = uTargetColors[i];
        finalColor = vec4((targetColor + colorDiff) * alpha, alpha);
        return;
      }
    }
}
`,UK=`struct MultiColorReplaceUniforms {
  uOriginalColors: array<vec3<f32>, MAX_COLORS>,
  uTargetColors: array<vec3<f32>, MAX_COLORS>,
  uTolerance:f32,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> multiColorReplaceUniforms : MultiColorReplaceUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uOriginalColors = multiColorReplaceUniforms.uOriginalColors;
  let uTargetColors = multiColorReplaceUniforms.uTargetColors;
  let uTolerance = multiColorReplaceUniforms.uTolerance;

  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  let alpha: f32 = color.a;

  if (alpha > 0.0001)
  {
    var modColor: vec3<f32> = vec3<f32>(color.rgb) / alpha;

    for(var i: i32 = 0; i < MAX_COLORS; i += 1)
    {
      let origColor: vec3<f32> = uOriginalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      let colorDiff: vec3<f32> = origColor - modColor;
      
      if (length(colorDiff) < uTolerance)
      {
        let targetColor: vec3<f32> = uTargetColors[i];
        color = vec4((targetColor + colorDiff) * alpha, alpha);
        return color;
      }
    }
  }

  return color;
}

const MAX_COLORS: i32 = \${MAX_COLORS};`,LK=Object.defineProperty,NK=(t,e,n)=>e in t?LK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gd=(t,e,n)=>(NK(t,typeof e!="symbol"?e+"":e,n),n);const GK=class c5 extends le{constructor(...e){let n=e[0]??{};Array.isArray(n)&&(q("6.0.0","MultiColorReplaceFilter constructor params are now options object. See params: { replacements, tolerance, maxColors }"),n={replacements:n},e[1]&&(n.tolerance=e[1]),e[2]&&(n.maxColors=e[2])),n={...c5.DEFAULT_OPTIONS,...n};const r=n.maxColors??n.replacements.length,i=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:UK.replace(/\$\{MAX_COLORS\}/g,r.toFixed(0)),entryPoint:"mainFragment"}}),s=me.from({vertex:De,fragment:IK.replace(/\$\{MAX_COLORS\}/g,r.toFixed(0)),name:"multi-color-replace-filter"});super({gpuProgram:i,glProgram:s,resources:{multiColorReplaceUniforms:{uOriginalColors:{value:new Float32Array(3*r),type:"vec3<f32>",size:r},uTargetColors:{value:new Float32Array(3*r),type:"vec3<f32>",size:r},uTolerance:{value:n.tolerance,type:"f32"}}}}),Gd(this,"uniforms"),Gd(this,"_replacements",[]),Gd(this,"_maxColors"),this._maxColors=r,this.uniforms=this.resources.multiColorReplaceUniforms.uniforms,this.replacements=n.replacements}set replacements(e){const n=this.uniforms.uOriginalColors,r=this.uniforms.uTargetColors,i=e.length,s=new ve;if(i>this._maxColors)throw new Error(`Length of replacements (${i}) exceeds the maximum colors length (${this._maxColors})`);n[i*3]=-1;let o,a,c;for(let h=0;h<i;h++){const f=e[h];s.setValue(f[0]),[o,a,c]=s.toArray(),n[h*3]=o,n[h*3+1]=a,n[h*3+2]=c,s.setValue(f[1]),[o,a,c]=s.toArray(),r[h*3]=o,r[h*3+1]=a,r[h*3+2]=c}this._replacements=e}get replacements(){return this._replacements}refresh(){this.replacements=this._replacements}get maxColors(){return this._maxColors}get tolerance(){return this.uniforms.uTolerance}set tolerance(e){this.uniforms.uTolerance=e}set epsilon(e){q("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance=e}get epsilon(){return q("6.0.0","MultiColorReplaceFilter.epsilon is deprecated, please use MultiColorReplaceFilter.tolerance instead"),this.tolerance}};Gd(GK,"DEFAULT_OPTIONS",{replacements:[[16711680,255]],tolerance:.05,maxColors:void 0});var zK=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uSepia;
uniform vec2 uNoise;
uniform vec3 uScratch;
uniform vec3 uVignetting;
uniform float uSeed;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    finalColor = texture(uTexture, vTextureCoord);
    vec3 color = finalColor.rgb;

    if (uSepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + uSepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions.xy;

    float vignette = uVignetting[0];
    float vignetteAlpha = uVignetting[1];
    float vignetteBlur = uVignetting[2];

    if (vignette > 0.0)
    {
        float outter = SQRT_2 - vignette * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= uDimensions.y / uDimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignetteBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignetteAlpha);
    }

    float scratch = uScratch[0];
    float scratchDensity = uScratch[1];
    float scratchWidth = uScratch[2];

    if (scratchDensity > uSeed && scratch != 0.0)
    {
        float phase = uSeed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(uSeed * dist, abs(s - uSeed * dist)));
        if (d < uSeed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / uDimensions.x * (0.75 + uSeed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    float noise = uNoise[0];
    float noiseSize = uNoise[1];

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + uSeed * 512.0, 1024.0 - uSeed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * uSeed) - 0.5;
        color += _noise * noise;
    }

    finalColor.rgb = color;
}`,HK=`struct OldFilmUniforms {
    uSepia: f32,
    uNoise: vec2<f32>,
    uScratch: vec3<f32>,
    uVignetting: vec3<f32>,
    uSeed: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> oldFilmUniforms : OldFilmUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);

  if (oldFilmUniforms.uSepia > 0.)
  {
    color = vec4<f32>(sepia(color.rgb), color.a);
  }

  let coord: vec2<f32> = uv * gfu.uInputSize.xy / oldFilmUniforms.uDimensions;

  if (oldFilmUniforms.uVignetting[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  let uScratch = oldFilmUniforms.uScratch; 

  if (uScratch[1] > oldFilmUniforms.uSeed && uScratch[0] != 0.)
  {
    color = vec4<f32>(scratch(color.rgb, coord), color.a);
  }

  let uNoise = oldFilmUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  return color;
}

const SQRT_2: f32 = 1.414213;
const SEPIA_RGB: vec3<f32> = vec3<f32>(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn overlay(src: vec3<f32>, dst: vec3<f32>) -> vec3<f32>
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)

    return vec3<f32>(
      select((1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)), (2.0 * src.x * dst.x), (dst.x <= 0.5)), 
      select((1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)), (2.0 * src.y * dst.y), (dst.y <= 0.5)),
      select((1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)), (2.0 * src.z * dst.z), (dst.z <= 0.5))
    );
}

fn sepia(co: vec3<f32>) -> vec3<f32>
{
  let gray: f32 = (co.x + co.y + co.z) / 3.0;
  let grayscale: vec3<f32> = vec3<f32>(gray);
  let color = overlay(SEPIA_RGB, grayscale);
  return grayscale + oldFilmUniforms.uSepia * (color - grayscale);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignetting = oldFilmUniforms.uVignetting;
  let uDimensions = oldFilmUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignetting[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(vec2<f32>(0.5) - coord);
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignetting[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignetting[1]);
}

fn scratch(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;
  let uScratch = oldFilmUniforms.uScratch;
  let uSeed = oldFilmUniforms.uSeed;
  let uDimensions = oldFilmUniforms.uDimensions;

  let phase: f32 = uSeed * 256.0;
  let s: f32 = modulo(floor(phase), 2.0);
  let dist: f32 = 1.0 / uScratch[1];
  let d: f32 = distance(coord, vec2<f32>(uSeed * dist, abs(s - uSeed * dist)));

  if (d < uSeed * 0.6 + 0.4)
  {
    let period: f32 = uScratch[1] * 10.0;

    let xx: f32 = coord.x * period + phase;
    let aa: f32 = abs(modulo(xx, 0.5) * 4.0);
    let bb: f32 = modulo(floor(xx / 0.5), 2.0);
    let yy: f32 = (1.0 - bb) * aa + bb * (2.0 - aa);

    let kk: f32 = 2.0 * period;
    let dw: f32 = uScratch[2] / uDimensions.x * (0.75 + uSeed);
    let dh: f32 = dw * kk;

    var tine: f32 = (yy - (2.0 - dh));

    if (tine > 0.0) {
        let _sign: f32 = sign(uScratch[0]);

        tine = s * tine / period + uScratch[0] + 0.1;
        tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

        color *= tine;
    }
  }

  return color;
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = oldFilmUniforms.uNoise;
  let uSeed = oldFilmUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}`,VK=Object.defineProperty,jK=(t,e,n)=>e in t?VK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,J2=(t,e,n)=>(jK(t,typeof e!="symbol"?e+"":e,n),n);const WK=class h5 extends le{constructor(e){e={...h5.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:HK,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:zK,name:"old-film-filter"});super({gpuProgram:n,glProgram:r,resources:{oldFilmUniforms:{uSepia:{value:e.sepia,type:"f32"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uScratch:{value:new Float32Array(3),type:"vec3<f32>"},uVignetting:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:e.seed,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),J2(this,"uniforms"),J2(this,"seed"),this.uniforms=this.resources.oldFilmUniforms.uniforms,Object.assign(this,e)}apply(e,n,r,i){this.uniforms.uDimensions[0]=n.frame.width,this.uniforms.uDimensions[1]=n.frame.height,this.uniforms.uSeed=this.seed,e.applyFilter(this,n,r,i)}get sepia(){return this.uniforms.uSepia}set sepia(e){this.uniforms.uSepia=e}get noise(){return this.uniforms.uNoise[0]}set noise(e){this.uniforms.uNoise[0]=e}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(e){this.uniforms.uNoise[1]=e}get scratch(){return this.uniforms.uScratch[0]}set scratch(e){this.uniforms.uScratch[0]=e}get scratchDensity(){return this.uniforms.uScratch[1]}set scratchDensity(e){this.uniforms.uScratch[1]=e}get scratchWidth(){return this.uniforms.uScratch[2]}set scratchWidth(e){this.uniforms.uScratch[2]=e}get vignetting(){return this.uniforms.uVignetting[0]}set vignetting(e){this.uniforms.uVignetting[0]=e}get vignettingAlpha(){return this.uniforms.uVignetting[1]}set vignettingAlpha(e){this.uniforms.uVignetting[1]=e}get vignettingBlur(){return this.uniforms.uVignetting[2]}set vignettingBlur(e){this.uniforms.uVignetting[2]=e}};J2(WK,"DEFAULT_OPTIONS",{sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,seed:0});var $K=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uThickness;
uniform vec3 uColor;
uniform float uAlpha;
uniform float uKnockout;

uniform vec4 uInputClamp;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${ANGLE_STEP};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture(uTexture, clamp(displacedPos, uInputClamp.xy, uInputClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture(uTexture, vTextureCoord);
    vec4 contentColor = sourceColor * float(uKnockout < 0.5);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    finalColor = contentColor + outlineColor;
}
`,XK=`struct OutlineUniforms {
  uThickness:vec2<f32>,
  uColor:vec3<f32>,
  uAlpha:f32,
  uAngleStep:f32,
  uKnockout:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> outlineUniforms : OutlineUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sourceColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let contentColor: vec4<f32> = sourceColor * (1. - outlineUniforms.uKnockout);
  
  let outlineAlpha: f32 = outlineUniforms.uAlpha * outlineMaxAlphaAtPos(uv) * (1. - sourceColor.a);
  let outlineColor: vec4<f32> = vec4<f32>(vec3<f32>(outlineUniforms.uColor) * outlineAlpha, outlineAlpha);
  
  return contentColor + outlineColor;
}

fn outlineMaxAlphaAtPos(uv: vec2<f32>) -> f32 {
  let thickness = outlineUniforms.uThickness;

  if (thickness.x == 0. || thickness.y == 0.) {
    return 0.;
  }
  
  let angleStep = outlineUniforms.uAngleStep;

  var displacedColor: vec4<f32>;
  var displacedPos: vec2<f32>;

  var maxAlpha: f32 = 0.;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.; angle <= DOUBLE_PI; angle += angleStep)
  {
    displaced.x = uv.x + thickness.x * cos(angle);
    displaced.y = uv.y + thickness.y * sin(angle);
    curColor = textureSample(uTexture, uSampler, clamp(displaced, gfu.uInputClamp.xy, gfu.uInputClamp.zw));
    maxAlpha = max(maxAlpha, curColor.a);
  }

  return maxAlpha;
}

const DOUBLE_PI: f32 = 3.14159265358979323846264 * 2.;`,YK=Object.defineProperty,qK=(t,e,n)=>e in t?YK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Mo=(t,e,n)=>(qK(t,typeof e!="symbol"?e+"":e,n),n);const iS=class Eo extends le{constructor(...e){let n=e[0]??{};typeof n=="number"&&(q("6.0.0","OutlineFilter constructor params are now options object. See params: { thickness, color, quality, alpha, knockout }"),n={thickness:n},e[1]!==void 0&&(n.color=e[1]),e[2]!==void 0&&(n.quality=e[2]),e[3]!==void 0&&(n.alpha=e[3]),e[4]!==void 0&&(n.knockout=e[4])),n={...Eo.DEFAULT_OPTIONS,...n};const r=n.quality??.1,i=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:XK,entryPoint:"mainFragment"}}),s=me.from({vertex:De,fragment:$K.replace(/\$\{ANGLE_STEP\}/,Eo.getAngleStep(r).toFixed(7)),name:"outline-filter"});super({gpuProgram:i,glProgram:s,resources:{outlineUniforms:{uThickness:{value:new Float32Array(2),type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:n.alpha,type:"f32"},uAngleStep:{value:0,type:"f32"},uKnockout:{value:n.knockout?1:0,type:"f32"}}}}),Mo(this,"uniforms"),Mo(this,"_thickness"),Mo(this,"_quality"),Mo(this,"_color"),this.uniforms=this.resources.outlineUniforms.uniforms,this.uniforms.uAngleStep=Eo.getAngleStep(r),this._color=new ve,this.color=n.color??0,Object.assign(this,n)}apply(e,n,r,i){this.uniforms.uThickness[0]=this.thickness/n.source.width,this.uniforms.uThickness[1]=this.thickness/n.source.height,e.applyFilter(this,n,r,i)}static getAngleStep(e){return parseFloat((Math.PI*2/Math.max(e*Eo.MAX_SAMPLES,Eo.MIN_SAMPLES)).toFixed(7))}get thickness(){return this._thickness}set thickness(e){this._thickness=this.padding=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[n,r,i]=this._color.toArray();this.uniforms.uColor[0]=n,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get quality(){return this._quality}set quality(e){this._quality=e,this.uniforms.uAngleStep=Eo.getAngleStep(e)}get knockout(){return this.uniforms.uKnockout===1}set knockout(e){this.uniforms.uKnockout=e?1:0}};Mo(iS,"DEFAULT_OPTIONS",{thickness:1,color:0,alpha:1,quality:.1,knockout:!1});Mo(iS,"MIN_SAMPLES",1);Mo(iS,"MAX_SAMPLES",100);var KK=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uRadian;
uniform vec2 uCenter;
uniform float uRadius;
uniform int uKernelSize;

uniform vec4 uInputSize;

const int MAX_KERNEL_SIZE = 2048;

void main(void)
{
    vec4 color = texture(uTexture, vTextureCoord);

    if (uKernelSize == 0)
    {
        finalColor = color;
        return;
    }

    float aspect = uInputSize.y / uInputSize.x;
    vec2 center = uCenter.xy / uInputSize.xy;
    float gradient = uRadius / uInputSize.x * 0.3;
    float radius = uRadius / uInputSize.x - gradient * 0.5;
    int k = uKernelSize - 1;

    vec2 coord = vTextureCoord;
    vec2 dir = vec2(center - coord);
    float dist = length(vec2(dir.x, dir.y * aspect));

    float radianStep = uRadian;
    if (radius >= 0.0 && dist > radius) {
        float delta = dist - radius;
        float gap = gradient;
        float scale = 1.0 - abs(delta / gap);
        if (scale <= 0.0) {
            finalColor = color;
            return;
        }
        radianStep *= scale;
    }
    radianStep /= float(k);

    float s = sin(radianStep);
    float c = cos(radianStep);
    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }

        coord -= center;
        coord.y *= aspect;
        coord = rotationMatrix * coord;
        coord.y /= aspect;
        coord += center;

        vec4 sample = texture(uTexture, coord);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample;
    }

    finalColor = color / float(uKernelSize);
}
`,QK=`struct RadialBlurUniforms {
  uRadian: f32,
  uCenter: vec2<f32>,
  uKernelSize: f32,
  uRadius: f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> radialBlurUniforms : RadialBlurUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uRadian = radialBlurUniforms.uRadian;
  let uCenter = radialBlurUniforms.uCenter;
  let uKernelSize = radialBlurUniforms.uKernelSize;
  let uRadius = radialBlurUniforms.uRadius;
  
  var returnColorOnly = false;

  if (uKernelSize == 0)
  {
    returnColorOnly = true;
  }

  let aspect: f32 = gfu.uInputSize.y / gfu.uInputSize.x;
  let center: vec2<f32> = uCenter.xy / gfu.uInputSize.xy;
  let gradient: f32 = uRadius / gfu.uInputSize.x * 0.3;
  let radius: f32 = uRadius / gfu.uInputSize.x - gradient * 0.5;
  let k: i32 = i32(uKernelSize - 1);

  var coord: vec2<f32> = uv;
  let dir: vec2<f32> = vec2<f32>(center - coord);
  let dist: f32 = length(vec2<f32>(dir.x, dir.y * aspect));

  var radianStep: f32 = uRadian;
  
  if (radius >= 0.0 && dist > radius)
  {
    let delta: f32 = dist - radius;
    let gap: f32 = gradient;
    let scale: f32 = 1.0 - abs(delta / gap);
    if (scale <= 0.0) {
      returnColorOnly = true;
    }
    radianStep *= scale;
  }

  radianStep /= f32(k);

  let s: f32 = sin(radianStep);
  let c: f32 = cos(radianStep);
  let rotationMatrix: mat2x2<f32> = mat2x2<f32>(vec2<f32>(c, -s), vec2<f32>(s, c));
  
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let baseColor = vec4<f32>(color);

  let minK: i32 = min(i32(uKernelSize) - 1, MAX_KERNEL_SIZE - 1);

  for(var i: i32 = 0; i < minK; i += 1) 
  {
    coord -= center;
    coord.y *= aspect;
    coord = rotationMatrix * coord;
    coord.y /= aspect;
    coord += center;
    let sample: vec4<f32> = textureSample(uTexture, uSampler, coord);
    // switch to pre-multiplied alpha to correctly blur transparent images
    // sample.rgb *= sample.a;
    color += sample;
  }

  return select(color / f32(uKernelSize), baseColor, returnColorOnly);
}

const MAX_KERNEL_SIZE: i32 = 2048;`,ZK=Object.defineProperty,JK=(t,e,n)=>e in t?ZK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zd=(t,e,n)=>(JK(t,typeof e!="symbol"?e+"":e,n),n);const eQ=class f5 extends le{constructor(...e){let n=e[0]??{};if(typeof n=="number"){if(q("6.0.0","RadialBlurFilter constructor params are now options object. See params: { angle, center, kernelSize, radius }"),n={angle:n},e[1]){const s="x"in e[1]?e[1].x:e[1][0],o="y"in e[1]?e[1].y:e[1][1];n.center={x:s,y:o}}e[2]&&(n.kernelSize=e[2]),e[3]&&(n.radius=e[3])}n={...f5.DEFAULT_OPTIONS,...n};const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:QK,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:KK,name:"radial-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{radialBlurUniforms:{uRadian:{value:0,type:"f32"},uCenter:{value:n.center,type:"vec2<f32>"},uKernelSize:{value:n.kernelSize,type:"i32"},uRadius:{value:n.radius,type:"f32"}}}}),zd(this,"uniforms"),zd(this,"_angle"),zd(this,"_kernelSize"),this.uniforms=this.resources.radialBlurUniforms.uniforms,Object.assign(this,n)}_updateKernelSize(){this.uniforms.uKernelSize=this._angle!==0?this.kernelSize:0}get angle(){return this._angle}set angle(e){this._angle=e,this.uniforms.uRadian=e*Math.PI/180,this._updateKernelSize()}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.center.x}set centerX(e){this.center.x=e}get centerY(){return this.center.y}set centerY(e){this.center.y=e}get kernelSize(){return this._kernelSize}set kernelSize(e){this._kernelSize=e,this._updateKernelSize()}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e<0||e===1/0?-1:e}};zd(eQ,"DEFAULT_OPTIONS",{angle:0,center:{x:0,y:0},kernelSize:5,radius:-1});var tQ=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uMirror;
uniform float uBoundary;
uniform vec2 uAmplitude;
uniform vec2 uWavelength;
uniform vec2 uAlpha;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * uInputSize.xy;
    vec2 coord = pixelCoord / uDimensions;

    if (coord.y < uBoundary) {
        finalColor = texture(uTexture, vTextureCoord);
        return;
    }

    float k = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);
    float areaY = uBoundary * uDimensions.y / uInputSize.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = uMirror > 0.5 ? v : vTextureCoord.y;

    float _amplitude = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / uInputSize.x;
    float _waveLength = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / uInputSize.y;
    float _alpha = (uAlpha.y - uAlpha.x) * k + uAlpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - uTime) * _amplitude;
    x = clamp(x, uInputClamp.x, uInputClamp.z);

    vec4 color = texture(uTexture, vec2(x, y));

    finalColor = color * _alpha;
}
`,nQ=`struct ReflectionUniforms {
  uMirror: f32,
  uBoundary: f32,
  uAmplitude: vec2<f32>,
  uWavelength: vec2<f32>,
  uAlpha: vec2<f32>,
  uTime: f32,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> reflectionUniforms : ReflectionUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uDimensions: vec2<f32> = reflectionUniforms.uDimensions;
  let uBoundary: f32 = reflectionUniforms.uBoundary;
  let uMirror: bool = reflectionUniforms.uMirror > 0.5;
  let uAmplitude: vec2<f32> = reflectionUniforms.uAmplitude;
  let uWavelength: vec2<f32> = reflectionUniforms.uWavelength;
  let uAlpha: vec2<f32> = reflectionUniforms.uAlpha;
  let uTime: f32 = reflectionUniforms.uTime;

  let pixelCoord: vec2<f32> = uv * gfu.uInputSize.xy;
  let coord: vec2<f32> = pixelCoord /uDimensions;
  var returnColorOnly: bool = false;

  if (coord.y < uBoundary) {
    returnColorOnly = true;
  }

  let k: f32 = (coord.y - uBoundary) / (1. - uBoundary + 0.0001);
  let areaY: f32 = uBoundary * uDimensions.y / gfu.uInputSize.y;
  let v: f32 = areaY + areaY - uv.y;
  let y: f32 = select(uv.y, v, uMirror);

  let amplitude: f32 = ((uAmplitude.y - uAmplitude.x) * k + uAmplitude.x ) / gfu.uInputSize.x;
  let waveLength: f32 = ((uWavelength.y - uWavelength.x) * k + uWavelength.x) / gfu.uInputSize.y;
  let alpha: f32 = select((uAlpha.y - uAlpha.x) * k + uAlpha.x, 1., returnColorOnly);

  var x: f32 = uv.x + cos(v * 6.28 / waveLength - uTime) * amplitude;
  x = clamp(x, gfu.uInputClamp.x, gfu.uInputClamp.z);
  
  return textureSample(uTexture, uSampler, select(vec2<f32>(x, y), uv, returnColorOnly)) * alpha;
}

fn rand(co: vec2<f32>) -> f32 
{
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}`,rQ=Object.defineProperty,iQ=(t,e,n)=>e in t?rQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ex=(t,e,n)=>(iQ(t,typeof e!="symbol"?e+"":e,n),n);const sQ=class d5 extends le{constructor(e){e={...d5.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:nQ,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:tQ,name:"reflection-filter"});super({gpuProgram:n,glProgram:r,resources:{reflectionUniforms:{uMirror:{value:e.mirror?1:0,type:"f32"},uBoundary:{value:e.boundary,type:"f32"},uAmplitude:{value:e.amplitude,type:"vec2<f32>"},uWavelength:{value:e.waveLength,type:"vec2<f32>"},uAlpha:{value:e.alpha,type:"vec2<f32>"},uTime:{value:e.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),ex(this,"uniforms"),ex(this,"time",0),this.uniforms=this.resources.reflectionUniforms.uniforms,Object.assign(this,e)}apply(e,n,r,i){this.uniforms.uDimensions[0]=n.frame.width,this.uniforms.uDimensions[1]=n.frame.height,this.uniforms.uTime=this.time,e.applyFilter(this,n,r,i)}get mirror(){return this.uniforms.uMirror>.5}set mirror(e){this.uniforms.uMirror=e?1:0}get boundary(){return this.uniforms.uBoundary}set boundary(e){this.uniforms.uBoundary=e}get amplitude(){return Array.from(this.uniforms.uAmplitude)}set amplitude(e){this.uniforms.uAmplitude[0]=e[0],this.uniforms.uAmplitude[1]=e[1]}get amplitudeStart(){return this.uniforms.uAmplitude[0]}set amplitudeStart(e){this.uniforms.uAmplitude[0]=e}get amplitudeEnd(){return this.uniforms.uAmplitude[1]}set amplitudeEnd(e){this.uniforms.uAmplitude[1]=e}get waveLength(){return Array.from(this.uniforms.uWavelength)}set waveLength(e){this.uniforms.uWavelength[0]=e[0],this.uniforms.uWavelength[1]=e[1]}get wavelengthStart(){return this.uniforms.uWavelength[0]}set wavelengthStart(e){this.uniforms.uWavelength[0]=e}get wavelengthEnd(){return this.uniforms.uWavelength[1]}set wavelengthEnd(e){this.uniforms.uWavelength[1]=e}get alpha(){return Array.from(this.uniforms.uAlpha)}set alpha(e){this.uniforms.uAlpha[0]=e[0],this.uniforms.uAlpha[1]=e[1]}get alphaStart(){return this.uniforms.uAlpha[0]}set alphaStart(e){this.uniforms.uAlpha[0]=e}get alphaEnd(){return this.uniforms.uAlpha[1]}set alphaEnd(e){this.uniforms.uAlpha[1]=e}};ex(sQ,"DEFAULT_OPTIONS",{mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0});var oQ=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uInputSize;
uniform vec2 uRed;
uniform vec2 uGreen;
uniform vec2 uBlue;

void main(void)
{
   float r = texture(uTexture, vTextureCoord + uRed/uInputSize.xy).r;
   float g = texture(uTexture, vTextureCoord + uGreen/uInputSize.xy).g;
   float b = texture(uTexture, vTextureCoord + uBlue/uInputSize.xy).b;
   float a = texture(uTexture, vTextureCoord).a;
   finalColor = vec4(r, g, b, a);
}
`,aQ=`struct RgbSplitUniforms {
    uRed: vec2<f32>,
    uGreen: vec2<f32>,
    uBlue: vec3<f32>,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> rgbSplitUniforms : RgbSplitUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    let r = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uRed.x / gfu.uInputSize.x, rgbSplitUniforms.uRed.y / gfu.uInputSize.y)).r;
    let g = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uGreen.x / gfu.uInputSize.x, rgbSplitUniforms.uGreen.y / gfu.uInputSize.y)).g;
    let b = textureSample(uTexture, uSampler, uv + vec2<f32>(rgbSplitUniforms.uBlue.x / gfu.uInputSize.x, rgbSplitUniforms.uBlue.y / gfu.uInputSize.y)).b;
    let a = textureSample(uTexture, uSampler, uv).a;
    return vec4<f32>(r, g, b, a);
}
`,uQ=Object.defineProperty,lQ=(t,e,n)=>e in t?uQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p5=(t,e,n)=>(lQ(t,typeof e!="symbol"?e+"":e,n),n);const cQ=class m5 extends le{constructor(...e){let n=e[0]??{};(Array.isArray(n)||"x"in n&&"y"in n)&&(q("6.0.0","RGBSplitFilter constructor params are now options object. See params: { red, green, blue }"),n={red:n},e[1]!==void 0&&(n.green=e[1]),e[2]!==void 0&&(n.blue=e[2])),n={...m5.DEFAULT_OPTIONS,...n};const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:aQ,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:oQ,name:"rgb-split-filter"});super({gpuProgram:r,glProgram:i,resources:{rgbSplitUniforms:{uRed:{value:n.red,type:"vec2<f32>"},uGreen:{value:n.green,type:"vec2<f32>"},uBlue:{value:n.blue,type:"vec2<f32>"}}}}),p5(this,"uniforms"),this.uniforms=this.resources.rgbSplitUniforms.uniforms,Object.assign(this,n)}get red(){return this.uniforms.uRed}set red(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uRed=e}get redX(){return this.red.x}set redX(e){this.red.x=e}get redY(){return this.red.y}set redY(e){this.red.y=e}get green(){return this.uniforms.uGreen}set green(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uGreen=e}get greenX(){return this.green.x}set greenX(e){this.green.x=e}get greenY(){return this.green.y}set greenY(e){this.green.y=e}get blue(){return this.uniforms.uBlue}set blue(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uBlue=e}get blueX(){return this.blue.x}set blueX(e){this.blue.x=e}get blueY(){return this.blue.y}set blueY(e){this.blue.y=e}};p5(cQ,"DEFAULT_OPTIONS",{red:{x:-10,y:0},green:{x:0,y:10},blue:{x:0,y:0}});var hQ=`
precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uCenter;
uniform float uTime;
uniform float uSpeed;
uniform vec4 uWave;

uniform vec4 uInputSize;
uniform vec4 uInputClamp;

const float PI = 3.14159;

void main()
{
    float uAmplitude = uWave[0];
    float uWavelength = uWave[1];
    float uBrightness = uWave[2];
    float uRadius = uWave[3];

    float halfWavelength = uWavelength * 0.5 / uInputSize.x;
    float maxRadius = uRadius / uInputSize.x;
    float currentRadius = uTime * uSpeed / uInputSize.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            finalColor = texture(uTexture, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - uCenter / uInputSize.xy);
    dir.y *= uInputSize.y / uInputSize.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        finalColor = texture(uTexture, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );

    vec2 offset = diffUV * powDiff / uInputSize.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, uInputClamp.xy, uInputClamp.zw);
    vec4 color = texture(uTexture, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // finalColor = texture(uTexture, vTextureCoord + offset);

    color.rgb *= 1.0 + (uBrightness - 1.0) * p * fade;

    finalColor = color;
}
`,fQ=`
struct ShockWaveUniforms {
    uTime: f32,
    uOffset: vec2<f32>,
    uSpeed: f32,
    uWave: vec4<f32>,
};

struct GlobalFilterUniforms {
    uInputSize:vec4<f32>,
    uInputPixel:vec4<f32>,
    uInputClamp:vec4<f32>,
    uOutputFrame:vec4<f32>,
    uGlobalFrame:vec4<f32>,
    uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> shockwaveUniforms : ShockWaveUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {

    let uTime = shockwaveUniforms.uTime;
    let uOffset = shockwaveUniforms.uOffset;
    let uSpeed = shockwaveUniforms.uSpeed;
    let uAmplitude = shockwaveUniforms.uWave[0];
    let uWavelength = shockwaveUniforms.uWave[1];
    let uBrightness = shockwaveUniforms.uWave[2];
    let uRadius = shockwaveUniforms.uWave[3];
    let halfWavelength: f32 = uWavelength * 0.5 / gfu.uInputSize.x;
    let maxRadius: f32 = uRadius / gfu.uInputSize.x;
    let currentRadius: f32 = uTime * uSpeed / gfu.uInputSize.x;
    var fade: f32 = 1.0;
    var returnColorOnly: bool = false;
    
    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            returnColorOnly = true;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }
    var dir: vec2<f32> = vec2<f32>(uv - uOffset / gfu.uInputSize.xy);
    dir.y *= gfu.uInputSize.y / gfu.uInputSize.x;

    let dist:f32 = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        returnColorOnly = true;
    }

    let diffUV: vec2<f32> = normalize(dir);
    let diff: f32 = (dist - currentRadius) / halfWavelength;
    let p: f32 = 1.0 - pow(abs(diff), 2.0);
    let powDiff: f32 = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );
    let offset: vec2<f32> = diffUV * powDiff / gfu.uInputSize.xy;
    // Do clamp :
    let coord: vec2<f32> = uv + offset;
    let clampedCoord: vec2<f32> = clamp(coord, gfu.uInputClamp.xy, gfu.uInputClamp.zw);

    var clampedColor: vec4<f32> = textureSample(uTexture, uSampler, clampedCoord);
    
    if (boolVec2(coord, clampedCoord)) 
    {
        clampedColor *= max(0.0, 1.0 - length(coord - clampedCoord));
    }
    // No clamp :
    var finalColor = clampedColor;

    return select(finalColor, textureSample(uTexture, uSampler, uv), returnColorOnly);
}

fn boolVec2(x: vec2<f32>, y: vec2<f32>) -> bool
{
    if (x.x == y.x && x.y == y.y)
    {
        return true;
    }
    
    return false;
}

const PI: f32 = 3.14159265358979323846264;
`,dQ=Object.defineProperty,pQ=(t,e,n)=>e in t?dQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,tx=(t,e,n)=>(pQ(t,typeof e!="symbol"?e+"":e,n),n);const mQ=class g5 extends le{constructor(...e){let n=e[0]??{};(Array.isArray(n)||"x"in n&&"y"in n)&&(q("6.0.0","ShockwaveFilter constructor params are now options object. See params: { center, speed, amplitude, wavelength, brightness, radius, time }"),n={center:n,...e[1]},e[2]!==void 0&&(n.time=e[2])),n={...g5.DEFAULT_OPTIONS,...n};const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:fQ,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:hQ,name:"shockwave-filter"});super({gpuProgram:r,glProgram:i,resources:{shockwaveUniforms:{uTime:{value:n.time,type:"f32"},uCenter:{value:n.center,type:"vec2<f32>"},uSpeed:{value:n.speed,type:"f32"},uWave:{value:new Float32Array(4),type:"vec4<f32>"}}}}),tx(this,"uniforms"),tx(this,"time"),this.time=0,this.uniforms=this.resources.shockwaveUniforms.uniforms,Object.assign(this,n)}apply(e,n,r,i){this.uniforms.uTime=this.time,e.applyFilter(this,n,r,i)}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get speed(){return this.uniforms.uSpeed}set speed(e){this.uniforms.uSpeed=e}get amplitude(){return this.uniforms.uWave[0]}set amplitude(e){this.uniforms.uWave[0]=e}get wavelength(){return this.uniforms.uWave[1]}set wavelength(e){this.uniforms.uWave[1]=e}get brightness(){return this.uniforms.uWave[2]}set brightness(e){this.uniforms.uWave[2]=e}get radius(){return this.uniforms.uWave[3]}set radius(e){this.uniforms.uWave[3]=e}};tx(mQ,"DEFAULT_OPTIONS",{center:{x:0,y:0},speed:500,amplitude:30,wavelength:160,brightness:1,radius:-1});var gQ=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;
uniform vec3 uColor;
uniform float uAlpha;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

void main() {
    vec4 diffuseColor = texture(uTexture, vTextureCoord);
    vec2 lightCoord = (vTextureCoord * uInputSize.xy) / uDimensions;
    vec4 light = texture(uMapTexture, lightCoord);
    vec3 ambient = uColor.rgb * uAlpha;
    vec3 intensity = ambient + light.rgb;
    vec3 color = diffuseColor.rgb * intensity;
    finalColor = vec4(color, diffuseColor.a);
}
`,vQ=`struct SimpleLightmapUniforms {
  uColor: vec3<f32>,
  uAlpha: f32,
  uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> simpleLightmapUniforms : SimpleLightmapUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler: sampler;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>,
) -> @location(0) vec4<f32> {
  let uColor = simpleLightmapUniforms.uColor;
  let uAlpha = simpleLightmapUniforms.uAlpha;
  let uDimensions = simpleLightmapUniforms.uDimensions;

  let diffuseColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let lightCoord: vec2<f32> = (uv * gfu.uInputSize.xy) / simpleLightmapUniforms.uDimensions;
  let light: vec4<f32> = textureSample(uMapTexture, uMapSampler, lightCoord);
  let ambient: vec3<f32> = uColor * uAlpha;
  let intensity: vec3<f32> = ambient + light.rgb;
  let finalColor: vec3<f32> = diffuseColor.rgb * intensity;
  return vec4<f32>(finalColor, diffuseColor.a);
}`,_Q=Object.defineProperty,xQ=(t,e,n)=>e in t?_Q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hd=(t,e,n)=>(xQ(t,typeof e!="symbol"?e+"":e,n),n);const yQ=class v5 extends le{constructor(...e){let n=e[0]??{};if(n instanceof X&&(q("6.0.0","SimpleLightmapFilter constructor params are now options object. See params: { lightMap, color, alpha }"),n={lightMap:n},e[1]!==void 0&&(n.color=e[1]),e[2]!==void 0&&(n.alpha=e[2])),n={...v5.DEFAULT_OPTIONS,...n},!n.lightMap)throw Error("No light map texture source was provided to SimpleLightmapFilter");const r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:vQ,entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:gQ,name:"simple-lightmap-filter"});super({gpuProgram:r,glProgram:i,resources:{simpleLightmapUniforms:{uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:n.alpha,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}},uMapTexture:n.lightMap.source,uMapSampler:n.lightMap.source.style}}),Hd(this,"uniforms"),Hd(this,"_color"),Hd(this,"_lightMap"),this.uniforms=this.resources.simpleLightmapUniforms.uniforms,this._color=new ve,this.color=n.color??0,Object.assign(this,n)}apply(e,n,r,i){this.uniforms.uDimensions[0]=n.frame.width,this.uniforms.uDimensions[1]=n.frame.height,e.applyFilter(this,n,r,i)}get lightMap(){return this._lightMap}set lightMap(e){this._lightMap=e,this.resources.uMapTexture=e.source,this.resources.uMapSampler=e.source.style}get color(){return this._color.value}set color(e){this._color.setValue(e);const[n,r,i]=this._color.toArray();this.uniforms.uColor[0]=n,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}};Hd(yQ,"DEFAULT_OPTIONS",{lightMap:X.WHITE,color:0,alpha:1});var bQ=`in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uBlur;
uniform vec2 uStart;
uniform vec2 uEnd;
uniform vec2 uDelta;
uniform vec2 uDimensions;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float blur = uBlur[0];
    float gradientBlur = uBlur[1];

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(uStart.y - uEnd.y, uEnd.x - uStart.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * uDimensions - uStart, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture(uTexture, vTextureCoord + uDelta / uDimensions * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    finalColor = color;
}
`,SQ=`struct TiltShiftUniforms {
  uBlur: vec2<f32>,
  uStart: vec2<f32>,
  uEnd: vec2<f32>,
  uDelta: vec2<f32>,
  uDimensions: vec2<f32>,
};

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> tiltShiftUniforms : TiltShiftUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uBlur = tiltShiftUniforms.uBlur[0];
  let uBlurGradient = tiltShiftUniforms.uBlur[1];
  let uStart = tiltShiftUniforms.uStart;
  let uEnd = tiltShiftUniforms.uEnd;
  let uDelta = tiltShiftUniforms.uDelta;
  let uDimensions = tiltShiftUniforms.uDimensions;

  var color: vec4<f32> = vec4<f32>(0.0);
  var total: f32 = 0.0;

  let offset: f32 = random(position, vec3<f32>(12.9898, 78.233, 151.7182), 0.0);
  let normal: vec2<f32> = normalize(vec2<f32>(uStart.y - uEnd.y, uEnd.x - uStart.x));
  let radius: f32 = smoothstep(0.0, 1.0, abs(dot(uv * uDimensions - uStart, normal)) / uBlurGradient) * uBlur;

  for (var t: f32 = -30.0; t <= 30.0; t += 1.0)
  {
    var percent: f32 = (t + offset - 0.5) / 30.0;
    var weight: f32 = 1.0 - abs(percent);
    var sample: vec4<f32> = textureSample(uTexture, uSampler, uv + uDelta / uDimensions * percent * radius);
    sample = vec4<f32>(sample.xyz * sample.a, sample.a); // multiply sample.rgb with sample.a
    color += sample * weight;
    total += weight;
  }

  color /= total;
  color = vec4<f32>(color.xyz / (color.a + 0.00001), color.a); // divide color.rgb by color.a + 0.00001

  return color;
}


fn random(position: vec4<f32>, scale: vec3<f32>, seed: f32) -> f32
{
  return fract(sin(dot(position.xyz + seed, scale)) * 43758.5453 + seed);
}`,wQ=Object.defineProperty,CQ=(t,e,n)=>e in t?wQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nx=(t,e,n)=>(CQ(t,typeof e!="symbol"?e+"":e,n),n);const TQ=class _5 extends le{constructor(e){const{width:n,height:r}=Tb.defaultOptions;e={..._5.DEFAULT_OPTIONS,start:{x:0,y:r/2},end:{x:n,y:r/2},...e};const i=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:SQ,entryPoint:"mainFragment"}}),s=me.from({vertex:De,fragment:bQ,name:"tilt-shift-axis-filter"});super({gpuProgram:i,glProgram:s,resources:{tiltShiftUniforms:{uBlur:{value:new Float32Array([e.blur,e.gradientBlur]),type:"vec2<f32>"},uStart:{value:e.start,type:"vec2<f32>"},uEnd:{value:e.end,type:"vec2<f32>"},uDelta:{value:new Float32Array([0,0]),type:"vec2<f32>"},uDimensions:{value:new Float32Array([n,r]),type:"vec2<f32>"}}}}),nx(this,"uniforms"),nx(this,"_tiltAxis"),this.uniforms=this.resources.tiltShiftUniforms.uniforms,this._tiltAxis=e.axis}updateDimensions(e){const{uDimensions:n}=this.uniforms;n[0]=e.frame.width,n[1]=e.frame.height}updateDelta(){if(this.uniforms.uDelta[0]=0,this.uniforms.uDelta[1]=0,this._tiltAxis===void 0)return;const e=this.uniforms.uEnd,n=this.uniforms.uStart,r=e.x-n.x,i=e.y-n.y,s=Math.sqrt(r*r+i*i),o=this._tiltAxis==="vertical";this.uniforms.uDelta[0]=o?-i/s:r/s,this.uniforms.uDelta[1]=o?r/s:i/s}};nx(TQ,"DEFAULT_OPTIONS",{blur:100,gradientBlur:600});var EQ=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uTwist;
uniform vec2 uOffset;
uniform vec4 uInputSize;

vec2 mapCoord( vec2 coord )
{
    coord *= uInputSize.xy;
    coord += uInputSize.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= uInputSize.zw;
    coord /= uInputSize.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= uOffset;

    float dist = length(coord);
    float uRadius = uTwist[0];
    float uAngle = uTwist[1];

    if (dist < uRadius)
    {
        float ratioDist = (uRadius - dist) / uRadius;
        float angleMod = ratioDist * ratioDist * uAngle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += uOffset;

    return coord;
}

void main(void)
{
    vec2 coord = mapCoord(vTextureCoord);
    coord = twist(coord);
    coord = unmapCoord(coord);
    finalColor = texture(uTexture, coord);
}
`,AQ=`struct TwistUniforms {
  uTwist:vec2<f32>,
  uOffset:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> twistUniforms : TwistUniforms;

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
  return textureSample(uTexture, uSampler, unmapCoord(twist(mapCoord(uv))));
}

fn mapCoord(coord: vec2<f32> ) -> vec2<f32>
{
  var mappedCoord: vec2<f32> = coord;
  mappedCoord *= gfu.uInputSize.xy;
  mappedCoord += gfu.uOutputFrame.xy;
  return mappedCoord;
}

fn unmapCoord(coord: vec2<f32> ) -> vec2<f32>
{
  var mappedCoord: vec2<f32> = coord;
  mappedCoord -= gfu.uOutputFrame.xy;
  mappedCoord /= gfu.uInputSize.xy;
  return mappedCoord;
}

fn twist(coord: vec2<f32>) -> vec2<f32>
{
  var twistedCoord: vec2<f32> = coord;
  let uRadius = twistUniforms.uTwist[0];
  let uAngle = twistUniforms.uTwist[1];
  let uOffset = twistUniforms.uOffset;

  twistedCoord -= uOffset;
  
  let dist = length(twistedCoord);

  if (dist < uRadius)
  {
    let ratioDist: f32 = (uRadius - dist) / uRadius;
    let angleMod: f32 = ratioDist * ratioDist * uAngle;
    let s: f32 = sin(angleMod);
    let c: f32 = cos(angleMod);
    twistedCoord = vec2<f32>(twistedCoord.x * c - twistedCoord.y * s, twistedCoord.x * s + twistedCoord.y * c);
  }

  twistedCoord += uOffset;
  return twistedCoord;
}
`,PQ=Object.defineProperty,RQ=(t,e,n)=>e in t?PQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,x5=(t,e,n)=>(RQ(t,typeof e!="symbol"?e+"":e,n),n);const BQ=class y5 extends le{constructor(e){e={...y5.DEFAULT_OPTIONS,...e};const n=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:AQ,entryPoint:"mainFragment"}}),r=me.from({vertex:De,fragment:EQ,name:"twist-filter"});super({gpuProgram:n,glProgram:r,resources:{twistUniforms:{uTwist:{value:[e.radius??0,e.angle??0],type:"vec2<f32>"},uOffset:{value:e.offset,type:"vec2<f32>"}}},...e}),x5(this,"uniforms"),this.uniforms=this.resources.twistUniforms.uniforms}get radius(){return this.uniforms.uTwist[0]}set radius(e){this.uniforms.uTwist[0]=e}get angle(){return this.uniforms.uTwist[1]}set angle(e){this.uniforms.uTwist[1]=e}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e}get offsetX(){return this.offset.x}set offsetX(e){this.offset.x=e}get offsetY(){return this.offset.y}set offsetY(e){this.offset.y=e}};x5(BQ,"DEFAULT_OPTIONS",{padding:20,radius:200,angle:4,offset:{x:0,y:0}});var MQ=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform float uStrength;
uniform vec2 uCenter;
uniform vec2 uRadii;

uniform vec4 uInputSize;

const float MAX_KERNEL_SIZE = \${MAX_KERNEL_SIZE};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {
    float minGradient = uRadii[0] * 0.3;
    float innerRadius = (uRadii[0] + minGradient * 0.5) / uInputSize.x;

    float gradient = uRadii[1] * 0.3;
    float radius = (uRadii[1] - gradient * 0.5) / uInputSize.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / uInputSize.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * uInputSize.y / uInputSize.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / uInputSize.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture(uTexture, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture(uTexture, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,DQ=`struct ZoomBlurUniforms {
    uStrength:f32,
    uCenter:vec2<f32>,
    uRadii:vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> zoomBlurUniforms : ZoomBlurUniforms;

@fragment
fn mainFragment(
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let uStrength = zoomBlurUniforms.uStrength;
  let uCenter = zoomBlurUniforms.uCenter;
  let uRadii = zoomBlurUniforms.uRadii;

  let minGradient: f32 = uRadii[0] * 0.3;
  let innerRadius: f32 = (uRadii[0] + minGradient * 0.5) / gfu.uInputSize.x;

  let gradient: f32 = uRadii[1] * 0.3;
  let radius: f32 = (uRadii[1] - gradient * 0.5) / gfu.uInputSize.x;

  let MAX_KERNEL_SIZE: f32 = \${MAX_KERNEL_SIZE};

  var countLimit: f32 = MAX_KERNEL_SIZE;

  var dir: vec2<f32> = vec2<f32>(uCenter / gfu.uInputSize.xy - uv);
  let dist: f32 = length(vec2<f32>(dir.x, dir.y * gfu.uInputSize.y / gfu.uInputSize.x));

  var strength: f32 = uStrength;

  var delta: f32 = 0.0;
  var gap: f32;

  if (dist < innerRadius) {
      delta = innerRadius - dist;
      gap = minGradient;
  } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
      delta = dist - radius;
      gap = gradient;
  }

  var returnColorOnly: bool = false;

  if (delta > 0.0) {
    let normalCount: f32 = gap / gfu.uInputSize.x;
    delta = (normalCount - delta) / normalCount;
    countLimit *= delta;
    strength *= delta;
    
    if (countLimit < 1.0)
    {
      returnColorOnly = true;;
    }
  }

  // randomize the lookup values to hide the fixed number of samples
  let offset: f32 = rand(uv, 0.0);

  var total: f32 = 0.0;
  var color: vec4<f32> = vec4<f32>(0.);

  dir *= strength;

  for (var t = 0.0; t < MAX_KERNEL_SIZE; t += 1.0) {
    let percent: f32 = (t + offset) / MAX_KERNEL_SIZE;
    let weight: f32 = 4.0 * (percent - percent * percent);
    let p: vec2<f32> = uv + dir * percent;
    let sample: vec4<f32> = textureSample(uTexture, uSampler, p);
    
    if (t < countLimit)
    {
      color += sample * weight;
      total += weight;
    }
  }

  color /= total;

  return select(color, textureSample(uTexture, uSampler, uv), returnColorOnly);
}

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
fn rand(co: vec2<f32>, seed: f32) -> f32
{
  let a: f32 = 12.9898;
  let b: f32 = 78.233;
  let c: f32 = 43758.5453;
  let dt: f32 = dot(co + seed, vec2<f32>(a, b));
  let sn: f32 = modulo(dt, 3.14159);
  return fract(sin(sn) * c + seed);
}`,OQ=Object.defineProperty,kQ=(t,e,n)=>e in t?OQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,b5=(t,e,n)=>(kQ(t,typeof e!="symbol"?e+"":e,n),n);const FQ=class S5 extends le{constructor(e){e={...S5.DEFAULT_OPTIONS,...e};const n=e.maxKernelSize??32,r=he.from({vertex:{source:Oe,entryPoint:"mainVertex"},fragment:{source:DQ.replace("${MAX_KERNEL_SIZE}",n.toFixed(1)),entryPoint:"mainFragment"}}),i=me.from({vertex:De,fragment:MQ.replace("${MAX_KERNEL_SIZE}",n.toFixed(1)),name:"zoom-blur-filter"});super({gpuProgram:r,glProgram:i,resources:{zoomBlurUniforms:{uStrength:{value:e.strength,type:"f32"},uCenter:{value:e.center,type:"vec2<f32>"},uRadii:{value:new Float32Array(2),type:"vec2<f32>"}}}}),b5(this,"uniforms"),this.uniforms=this.resources.zoomBlurUniforms.uniforms,Object.assign(this,e)}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}get center(){return this.uniforms.uCenter}set center(e){Array.isArray(e)&&(e={x:e[0],y:e[1]}),this.uniforms.uCenter=e}get centerX(){return this.uniforms.uCenter.x}set centerX(e){this.uniforms.uCenter.x=e}get centerY(){return this.uniforms.uCenter.y}set centerY(e){this.uniforms.uCenter.y=e}get innerRadius(){return this.uniforms.uRadii[0]}set innerRadius(e){this.uniforms.uRadii[0]=e}get radius(){return this.uniforms.uRadii[1]}set radius(e){this.uniforms.uRadii[1]=e<0||e===1/0?-1:e}};b5(FQ,"DEFAULT_OPTIONS",{strength:.1,center:{x:0,y:0},innerRadius:0,radius:-1,maxKernelSize:32});const Ch=850,w5=1920/3,IQ=1920/2,sS=1920*2/3,oS=new $F,UQ=new $F({strength:0}),qu="#DDD",C5=Ee(({game:t})=>D.jsxs("container",{children:[D.jsx("sprite",{texture:Z$,cursor:"pointer",eventMode:"static",onPointerDown:()=>{t.skipLogo()}}),D.jsx(St,{anchor:.5,x:1920/2,y:900,text:"Click to start"})]}));C5.displayName="LogoScreen";const LQ=1.5,T5=Ee(({game:t})=>{const e=t.level;return D.jsxs("container",{children:[D.jsx(Kn,{x:0,y:0,width:1920,height:1080,draw:()=>{},alpha:.01,color:0,filters:UQ}),D.jsx("container",{x:1920/2,y:400,anchor:0,alpha:1-(t.startLt/LQ)**2,scale:1.5,children:D.jsx(lS,{game:t,level:e,name:Ys[e-1].name})})]})});T5.displayName="LevelIntro";const E5=Ee(({game:t})=>D.jsxs("container",{children:[D.jsx(Kn,{x:0,y:0,width:1920,height:1080,draw:()=>{},alpha:.01,color:0,filters:oS,cursor:"pointer",eventMode:"static",onPointerDown:()=>{ls.play(),t.resume()}}),D.jsx("sprite",{texture:OF,anchor:.5,x:1920/2,y:450,scale:1.5}),D.jsx(aS,{game:t}),D.jsx(eg,{game:t}),D.jsx(St,{x:1920/2,y:980,anchor:.5,text:"(click anywhere to resume)",style:{fontSize:20,fontFamily:"Heroes Legend",fill:qu,dropShadow:{angle:90,distance:3}}})]}));E5.displayName="PauseScreen";const A5=Ee(({game:t})=>D.jsxs("container",{children:[D.jsx(Kn,{x:0,y:0,width:1920,height:1080,draw:()=>{},alpha:.01,color:0,filters:oS,cursor:"pointer",eventMode:"static",onPointerDown:()=>{ls.play(),t.resume()}}),D.jsx("sprite",{texture:OF,anchor:.5,x:1920/2,y:450,scale:1.5}),D.jsx(eg,{game:t}),D.jsx(B5,{game:t}),D.jsx(St,{x:1920/2,y:980,anchor:.5,text:"(click anywhere to resume)",style:{fontSize:20,fontFamily:"Heroes Legend",fill:qu,dropShadow:{angle:90,distance:3}}})]}));A5.displayName="LevelSelectPauseScreen";const aS=Ee(({game:t})=>D.jsx(St,{x:sS,y:Ch,anchor:.5,text:"Restart",cursor:"pointer",eventMode:"static",style:{fontFamily:"Heroes Legend",fill:qu,dropShadow:{angle:90,distance:6}},onPointerDown:()=>{ls.play(),t.restart()}}));aS.displayName="RestartButton";const P5=Ee(({game:t})=>t.level==Ys.length?null:D.jsx(St,{x:sS,y:Ch,anchor:.5,text:"Next level",cursor:"pointer",eventMode:"static",style:{fontFamily:"Heroes Legend",fill:qu,dropShadow:{angle:90,distance:6}},onPointerDown:()=>{ls.play(),t.nextLevel()}}));P5.displayName="NextLevelButton";const eg=Ee(({game:t})=>D.jsx(St,{x:w5,y:Ch,anchor:.5,text:"Main menu",style:{fontFamily:"Heroes Legend",fill:qu,dropShadow:{angle:90,distance:6}},cursor:"pointer",eventMode:"static",onPointerDown:()=>{ls.play(),t.backToMainMenu()}}));eg.displayName="MainMenuButton";const R5=Ee(({game:t})=>D.jsx(St,{x:t.level==Ys.length?IQ:w5,y:Ch,anchor:.5,text:"Main menu",style:{fontFamily:"Heroes Legend",fill:qu,dropShadow:{angle:90,distance:6}},cursor:"pointer",eventMode:"static",onPointerDown:()=>{ls.play(),t.backToMainMenu()}}));R5.displayName="MainMenuButton2";const B5=Ee(({game:t})=>D.jsx(St,{x:sS,y:Ch,anchor:.5,text:"Wipe save (!)",style:{fontFamily:"Heroes Legend",fill:"#D44",dropShadow:{angle:90,distance:6}},cursor:"pointer",eventMode:"static",onPointerDown:()=>{ls.play(),t.resetLastUnlockedLevel(),t.resume()}}));B5.displayName="WipeSaveButton";const M5=Ee(({game:t})=>D.jsxs("container",{children:[D.jsx(Kn,{x:0,y:0,width:1920,height:1080,draw:()=>{},filters:oS,alpha:.3,color:0,eventMode:"static"}),D.jsxs("container",{x:1920/2,y:450,children:[D.jsx("sprite",{texture:q$,anchor:.5}),D.jsx("sprite",{texture:Q$,anchor:.5})]}),D.jsxs("container",{y:70,children:[D.jsx(aS,{game:t}),D.jsx(eg,{game:t})]})]}));M5.displayName="GameOverScreen";const D5=Ee(({game:t})=>{const e=Math.min(t.startLt/.5,1);return e<1?null:D.jsxs("container",{alpha:e*e,children:[D.jsx(Kn,{x:0,y:0,width:1920,height:1080,draw:()=>{},alpha:.3,color:0,eventMode:"static"}),D.jsxs("container",{x:1920/2,y:400,children:[D.jsx("sprite",{texture:K$,anchor:.5}),D.jsx("sprite",{texture:Y$,anchor:.5})]}),D.jsx(P5,{game:t}),D.jsx(R5,{game:t})]})});D5.displayName="WinScreen";const O5=(t,e)=>{Le.useEffect(()=>(window.addEventListener(t,e),()=>{window.removeEventListener(t,e)}))},k5=Ee(({game:t})=>(O5("keydown",e=>{switch(e.code){case"Digit1":t.selectPowerUpByIndex(1);break;case"Digit2":t.selectPowerUpByIndex(2);break;case"Digit3":t.selectPowerUpByIndex(3);break;case"Digit4":t.selectPowerUpByIndex(4);break;case"Digit5":t.selectPowerUpByIndex(5);break}}),t.state=="logo"?D.jsx(C5,{game:t}):t.state=="levelSelect"?D.jsx(U5,{game:t}):D.jsxs("container",{children:[D.jsx("sprite",{texture:X$,x:0,y:0,eventMode:"static",onPointerDown:e=>{const{x:n,y:r}=e.global;t.tap({x:n,y:r})}}),t.sources.map((e,n)=>e.isDestroyed&&D.jsx(rx,{source:e},n)),t.sources.map((e,n)=>!e.isDestroyed&&D.jsx(rx,{source:e},n)),t.freezes.map((e,n)=>D.jsx("container",{x:e.pos.x,y:e.pos.y,alpha:.5,children:D.jsx(ix,{freeze:e})},n)),t.ants.map((e,n)=>e.state=="dead"&&D.jsx(j5,{ant:e},n)),t.ants.map((e,n)=>e.state=="dead"&&D.jsx(V5,{ant:e},n)),t.ants.map((e,n)=>e.state!="dead"&&D.jsx(hS,{ant:e},n)),t.ants.map((e,n)=>e.state!="dead"&&D.jsx(cS,{ant:e},n)),t.freezes.map((e,n)=>D.jsx("container",{x:e.pos.x,y:e.pos.y,alpha:.5,children:D.jsx(ix,{freeze:e})},n)),t.bombs.map((e,n)=>D.jsx(X5,{bomb:e},n)),t.targets.map((e,n)=>D.jsx(W5,{target:e},n)),t.state!=="gameStarting"&&t.sources.map((e,n)=>D.jsx(G5,{source:e},n)),t.shockwaves.map((e,n)=>D.jsx(Y5,{shockwave:e},n)),D.jsx(F5,{game:t}),t.state=="gameStarting"&&D.jsx(T5,{game:t}),D.jsx(uS,{game:t}),t.state=="gameover"&&D.jsx(M5,{game:t}),t.state=="win"&&D.jsx(D5,{game:t}),t.isPaused&&D.jsx(E5,{game:t})]})));k5.displayName="GameC";const AE=250,F5=Ee(({game:t})=>t.powerUps.map((e,n)=>D.jsx("container",{x:(1920-(t.powerUps.length-1)*AE)/2+n*AE,y:950,children:D.jsx(I5,{game:t,powerUp:e})},n)));F5.displayName="PowerUpButtons";const NQ={shockwave:nX,push:iX,bomb:oX,hologram:uX,freeze:cX},GQ={shockwave:rX,push:sX,bomb:aX,hologram:lX,freeze:hX},I5=Ee(({game:t,powerUp:e})=>{const n=Le.useRef(null),r=100*t.cooldowns[e]/t.delays[e]-50,i=t.activePowerUp==e?GQ[e]:NQ[e];return D.jsxs("container",{children:[D.jsx(Kn,{x:-75,y:-75,width:150,height:150,alpha:0,draw:()=>{},cursor:"pointer",eventMode:"static",onPointerDown:()=>{t.selectPowerUp(e)}}),D.jsx("sprite",{texture:i,anchor:.5,alpha:.25}),D.jsx("sprite",{texture:i,anchor:.5,mask:n.current}),D.jsx(Kn,{myRef:n,x:-200,y:r,width:400,height:400,draw:()=>{}})]})});I5.displayName="PowerUpButton";const uS=Ee(({game:t})=>D.jsxs("container",{x:1870,y:50,children:[D.jsx(Kn,{x:-50,y:-50,width:100,height:100,alpha:0,cursor:"pointer",eventMode:"static",onPointerDown:()=>{ls.play(),t.pause()},draw:()=>{}}),D.jsx("sprite",{texture:tX,anchor:.5})]}));uS.displayName="PauseButton";const zQ=Ee(({game:t})=>{const e=`LEVEL ${t.level}`;return D.jsxs("container",{x:1800,y:42,scale:.7,children:[D.jsx(St,{anchor:{x:1,y:.5},x:0,y:5,style:{fill:"#222",fontSize:36,fontFamily:"Comix Loud"},text:e}),D.jsx(St,{anchor:{x:1,y:.5},style:{fill:"#ff75f1",fontSize:36,fontFamily:"Comix Loud"},text:e})]})});zQ.displayName="LevelIndicator";const U5=Ee(({game:t})=>D.jsxs("container",{children:[D.jsx(Kn,{x:0,y:0,width:1920,height:1080,draw:()=>{},alpha:0,eventMode:"static",onPointerDown:n=>{t.levelSelector.touchStart({...n.global})},onGlobalPointerMove:n=>{t.levelSelector.touchDrag({...n.global})},onPointerUp:()=>{t.levelSelector.touchEnd()},onPointerUpOutside:()=>{t.levelSelector.touchEnd()}}),D.jsx("sprite",{anchor:0,scale:1.62,texture:hd,x:t.levelSelector.center.x,y:t.levelSelector.center.y,rotation:t.lt*.01}),D.jsx("sprite",{anchor:0,scale:1.62,texture:hd,x:t.levelSelector.center.x,y:t.levelSelector.center.y,rotation:t.lt*.01+Math.PI/2}),D.jsx("sprite",{anchor:0,scale:1.62,texture:hd,x:t.levelSelector.center.x,y:t.levelSelector.center.y,rotation:t.lt*.01+Math.PI}),D.jsx("sprite",{anchor:0,scale:1.62,texture:hd,x:t.levelSelector.center.x,y:t.levelSelector.center.y,rotation:t.lt*.01+Math.PI*3/2}),D.jsxs("container",{x:t.levelSelector.center.x,y:t.levelSelector.center.y,rotation:t.levelSelector.rotation,children:[D.jsx("sprite",{anchor:.5,scale:2,texture:J$}),t.levelSelector.ants.map((n,r)=>D.jsx(hS,{ant:n},r)),t.levelSelector.ants.map((n,r)=>D.jsx(cS,{ant:n},r))]}),D.jsx("sprite",{anchor:.5,scale:2,texture:eX,blendMode:"add",x:t.levelSelector.center.x,y:t.levelSelector.center.y}),D.jsx("sprite",{anchor:.5,scale:2,texture:yE,blendMode:"multiply",alpha:.85,x:t.levelSelector.center.x,y:t.levelSelector.center.y-100}),D.jsx("container",{x:t.levelSelector.center.x,y:t.levelSelector.center.y,rotation:t.levelSelector.rotation,children:Ys.map(({name:n},r)=>D.jsx(N5,{game:t,level:r+1,name:n,mainRotation:t.levelSelector.rotation},r))}),D.jsx("sprite",{anchor:.5,scale:2,texture:yE,blendMode:"multiply",alpha:.3,x:t.levelSelector.center.x,y:t.levelSelector.center.y-100}),D.jsx(uS,{game:t}),t.isPaused&&D.jsx(A5,{game:t})]}));U5.displayName="LevelSelectScreen";const L5=[bE,bE,vX,_X,xX,yX,bX,SX],HQ=.1,Iv=new TK,N5=Ee(({game:t,level:e,name:n,mainRotation:r})=>{const i=(e-1)*ai,s=-r+ai-Math.PI,o=-r+ai+Math.PI,a=Le.useRef(!1);return e*ai<s||e*ai>o?null:D.jsxs("container",{x:800*Math.sin(i),y:-800*Math.cos(i),rotation:i,children:[D.jsx(Kn,{x:-220,y:-150,width:440,height:420,alpha:0,cursor:"pointer",draw:()=>{},eventMode:"static",onPointerDown:c=>{a.current=!0,t.levelSelector.touchStart({...c.global})},onPointerUp:()=>{t.levelSelector.touchEnd(),a.current&&Math.abs(r+(e-1)*ai)<HQ&&t.startLevel(e),a.current=!1},onPointerUpOutside:()=>{t.levelSelector.touchEnd(),a.current=!1}}),D.jsx(lS,{game:t,level:e,name:n})]})});N5.displayName="LevelCard";const lS=Ee(({game:t,level:e,name:n})=>{const r=`LEVEL ${e}`,i=Ys[e-1].targets[0].id,s=e>t.levelSelector.lastLevel;return D.jsxs("container",{children:[D.jsx("sprite",{anchor:.5,scale:2,texture:nS}),D.jsx("sprite",{anchor:.5,scale:2,texture:L5[i],filters:s?Iv:void 0}),s&&D.jsxs("container",{children:[D.jsx(St,{anchor:.5,angle:-25,y:3,text:"LOCKED",style:{fill:"#222",fontSize:30,letterSpacing:10,fontFamily:"Comix Loud"}}),D.jsx(St,{anchor:.5,angle:-25,text:"LOCKED",style:{fill:"#db402c",fontSize:30,letterSpacing:10,fontFamily:"Comix Loud"}})]}),D.jsxs("container",{y:150,filters:s?Iv:void 0,children:[D.jsx(St,{anchor:.5,x:0,y:5,style:{fill:"#222",fontSize:36,fontFamily:"Comix Loud"},text:r}),D.jsx(St,{anchor:.5,style:{fill:"#ff75f1",fontSize:36,fontFamily:"Comix Loud"},text:r})]}),D.jsxs("container",{y:200,filters:e>1?Iv:void 0,children:[D.jsx(St,{anchor:{x:.5,y:0},x:0,y:5,style:{fill:"#222",fontSize:40,fontFamily:"Laffayette Comic Pro"},text:n}),D.jsx(St,{anchor:{x:.5,y:0},style:{fill:"#ffdefc",fontSize:40,fontFamily:"Laffayette Comic Pro"},text:n})]})]})});lS.displayName="LevelCardContents";const VQ=[fX,dX,pX,mX],rx=Ee(({source:t})=>D.jsx("sprite",{anchor:.5,texture:t.isDestroyed?VQ[Math.floor(t.healthCurrent/t.healthMax*3)]:gX,x:t.pos.x,y:t.pos.y}));rx.displayName="SourceC";const G5=Ee(({source:t})=>D.jsxs("container",{children:[D.jsx(Kn,{x:t.pos.x-100/2,y:t.pos.y-8/2-70,width:100,height:8,color:t.isDestroyed?2763306:13895424,draw:()=>{}}),D.jsx(Kn,{x:t.pos.x-100/2,y:t.pos.y-8/2-70,width:100*t.healthCurrent/t.healthMax,height:8,color:t.isDestroyed?54527:1165568,draw:()=>{}})]}));G5.displayName="SourceHealth";const z5={1:wX,2:CX,3:TX},jQ={1:V$,2:j$,3:W$},cS=Ee(({ant:t})=>{const e=t.state=="appearing"?t.lt/t.appearDuration:1;return D.jsx("container",{children:D.jsx("sprite",{anchor:.5,texture:Fu(z5[t.level],20,t.lt),x:t.pos.x,y:t.pos.y,rotation:t.direction+Math.PI/2,alpha:e})})});cS.displayName="AntC";const H5=new MM;H5.matrix=[0,0,0,0,16/256,0,0,0,0,16/256,0,0,0,0,16/256,0,0,0,1,0];const WQ=1,$Q=2,hS=Ee(({ant:t})=>{const e=t.state=="appearing"?t.lt/t.appearDuration:1;return D.jsx("container",{children:D.jsx("sprite",{filters:[H5],anchor:.5,texture:Fu(z5[t.level],20,t.lt),x:t.pos.x+WQ,y:t.pos.y+$Q,rotation:t.direction+Math.PI/2,alpha:e*.6})})});hS.displayName="AntShadowC";const V5=Ee(({ant:t})=>{const e=1-t.lt/t.dieDuration;return D.jsx("sprite",{anchor:.5,texture:jQ[t.level],x:t.pos.x,y:t.pos.y,rotation:t.direction+Math.PI/2,alpha:e})});V5.displayName="DeadAntC";const j5=Ee(({ant:t})=>{const e=1-t.lt/t.dieDuration;return D.jsx("sprite",{anchor:.5,texture:$$,blendMode:"overlay",alpha:e,x:t.pos.x,y:t.pos.y})});j5.displayName="DeadAntBloodStainC";const XQ=[SE,SE,BX,MX,DX,OX,kX,FX],W5=Ee(({target:t})=>{if(t.isHologram)return D.jsx($5,{target:t});const e=t.state=="idle"||t.state=="disappearing"?1:t.lt<t.appearOffset?0:Math.pow((t.lt-t.appearOffset)/t.appearDuration,2),n=800*(1-e),r=e,i=(1-e)*3+1,s=t.state=="disappearing"?0:e,o=(1-e)*2+1;return D.jsxs("container",{children:[D.jsx("sprite",{anchor:.5,texture:nS,alpha:s,scale:o,x:t.pos.x,y:t.pos.y}),D.jsx("sprite",{anchor:.5,texture:t.state=="disappearing"?Fu(XQ[t.item],20,t.lt,"remove"):L5[t.item],alpha:r,scale:i,x:t.pos.x,y:t.pos.y-n})]})});W5.displayName="TargetC";const $5=Ee(({target:t})=>{const e=t.state=="appearing"?t.lt/t.appearDuration:t.state=="disappearing"?1-t.lt/t.disappearDuration:1;return D.jsx("container",{children:D.jsx("sprite",{anchor:.5,texture:Fu(PX,20,t.gt),alpha:e,x:t.pos.x,y:t.pos.y})})});$5.displayName="HologramC";const X5=Ee(({bomb:t})=>{const e=Math.floor(t.timeout),n=Math.floor(10*(t.timeout-e)),r=Math.floor(100*(t.timeout-e-n/10)),i={stroke:"red",fill:"white",fontWeight:"600",fontFamily:"Digital Display Tfb"};return D.jsxs("container",{x:t.pos.x,y:t.pos.y,children:[D.jsx("sprite",{texture:nS,anchor:.5,scale:.6,y:10}),D.jsx("sprite",{texture:_Y(EX,1-t.timeout/t.duration),anchor:.5}),D.jsxs("container",{scale:.5,y:-5,children:[D.jsx(St,{text:`${e}`,anchor:.5,x:-25,style:i}),D.jsx(St,{text:":",anchor:.5,x:-9,style:i}),D.jsx(St,{text:`${n}${r}`,anchor:.5,x:18,style:i})]})]})});X5.displayName="BombC";const Y5=Ee(({shockwave:t})=>D.jsxs("container",{x:t.center.x,y:t.center.y,children:[t.type=="bomb"&&D.jsx("sprite",{anchor:.5,texture:Fu(AX,20,t.lt,"remove")}),D.jsx("sprite",{anchor:.5,texture:Fu(RX,50,t.lt,"remove"),tint:t.type=="bomb"?16551939:16777215,scale:t.strength+.5,alpha:t.strength*.7+.3}),D.jsx(X2,{radius:t.innerRadius,strokeWidth:10,color:16711680,alpha:0,draw:()=>{}}),D.jsx(X2,{radius:t.outerRadius,strokeWidth:10,color:16711680,alpha:0,draw:()=>{}})]}));Y5.displayName="ShockwaveC";const ix=Ee(({freeze:t})=>{const e=t.radius/150,n=.7;switch(t.state){case"appearing":return D.jsx("sprite",{texture:Ov,anchor:.5,alpha:n,scale:(1-t.timeout/t.appearDuration)*e});case"active":return D.jsx("container",{children:D.jsx("sprite",{texture:Ov,anchor:.5,scale:e,alpha:n,blendMode:"normal"})});case"disappearing":return D.jsx("sprite",{texture:Ov,anchor:.5,alpha:t.timeout/t.disappearDuration*n,scale:e})}});ix.displayName="FreezeC";const q5=Ee(t=>{const[e,n]=gY(),r=()=>{n(i=>1-i)};return D.jsx(St,{text:e==1?"Sound on":"Sound off",cursor:"pointer",eventMode:"static",onPointerDown:r,x:10,y:5,style:{fontSize:25,fontFamily:"Heroes Legend",fill:e==1?"#DDD":"#448",dropShadow:{angle:90,distance:3}}})});q5.displayName="SoundButton";const K5=Ee(()=>(O5("keydown",t=>{}),D.jsxs("container",{children:[D.jsx(k5,{game:Fd.game}),D.jsx(q5,{})]})));K5.displayName="AppC";UH({Container:$e,Sprite:br,Text:km,Graphics:$s,NineSliceSprite:jb});const YQ=HP(document.getElementById("container"));YQ.render(D.jsx(Le.StrictMode,{children:D.jsx(IH,{width:1920,height:1080,backgroundColor:2959679,useBackBuffer:!0,children:D.jsx(K5,{})})}));document.addEventListener("visibilitychange",()=>{document.visibilityState=="hidden"?Fd.game.pause():document.visibilityState=="visible"&&Fd.game.state=="levelSelect"&&Fd.game.resume()});export{B4 as A,lk as B,$e as C,vM as E,Wz as F,RO as G,$b as H,jO as M,qO as N,sR as R,oR as T,F6 as a,Ky as b,yk as c,_k as d,Ne as e,ck as f,rk as g,GM as h,UM as i};
